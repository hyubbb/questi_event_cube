(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function Bm(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var Gg={exports:{}},Ad={},Wg={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ax;function IE(){if(Ax)return $t;Ax=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),g=Symbol.iterator;function y(k){return k===null||typeof k!="object"?null:(k=g&&k[g]||k["@@iterator"],typeof k=="function"?k:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,A={};function E(k,J,Ce){this.props=k,this.context=J,this.refs=A,this.updater=Ce||_}E.prototype.isReactComponent={},E.prototype.setState=function(k,J){if(typeof k!="object"&&typeof k!="function"&&k!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,k,J,"setState")},E.prototype.forceUpdate=function(k){this.updater.enqueueForceUpdate(this,k,"forceUpdate")};function S(){}S.prototype=E.prototype;function P(k,J,Ce){this.props=k,this.context=J,this.refs=A,this.updater=Ce||_}var b=P.prototype=new S;b.constructor=P,M(b,E.prototype),b.isPureReactComponent=!0;var L=Array.isArray,B=Object.prototype.hasOwnProperty,D={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function j(k,J,Ce){var Ve,se={},Re=null,ke=null;if(J!=null)for(Ve in J.ref!==void 0&&(ke=J.ref),J.key!==void 0&&(Re=""+J.key),J)B.call(J,Ve)&&!F.hasOwnProperty(Ve)&&(se[Ve]=J[Ve]);var Le=arguments.length-2;if(Le===1)se.children=Ce;else if(1<Le){for(var tt=Array(Le),xt=0;xt<Le;xt++)tt[xt]=arguments[xt+2];se.children=tt}if(k&&k.defaultProps)for(Ve in Le=k.defaultProps,Le)se[Ve]===void 0&&(se[Ve]=Le[Ve]);return{$$typeof:s,type:k,key:Re,ref:ke,props:se,_owner:D.current}}function O(k,J){return{$$typeof:s,type:k.type,key:J,ref:k.ref,props:k.props,_owner:k._owner}}function N(k){return typeof k=="object"&&k!==null&&k.$$typeof===s}function X(k){var J={"=":"=0",":":"=2"};return"$"+k.replace(/[=:]/g,function(Ce){return J[Ce]})}var te=/\/+/g;function Q(k,J){return typeof k=="object"&&k!==null&&k.key!=null?X(""+k.key):J.toString(36)}function ue(k,J,Ce,Ve,se){var Re=typeof k;(Re==="undefined"||Re==="boolean")&&(k=null);var ke=!1;if(k===null)ke=!0;else switch(Re){case"string":case"number":ke=!0;break;case"object":switch(k.$$typeof){case s:case e:ke=!0}}if(ke)return ke=k,se=se(ke),k=Ve===""?"."+Q(ke,0):Ve,L(se)?(Ce="",k!=null&&(Ce=k.replace(te,"$&/")+"/"),ue(se,J,Ce,"",function(xt){return xt})):se!=null&&(N(se)&&(se=O(se,Ce+(!se.key||ke&&ke.key===se.key?"":(""+se.key).replace(te,"$&/")+"/")+k)),J.push(se)),1;if(ke=0,Ve=Ve===""?".":Ve+":",L(k))for(var Le=0;Le<k.length;Le++){Re=k[Le];var tt=Ve+Q(Re,Le);ke+=ue(Re,J,Ce,tt,se)}else if(tt=y(k),typeof tt=="function")for(k=tt.call(k),Le=0;!(Re=k.next()).done;)Re=Re.value,tt=Ve+Q(Re,Le++),ke+=ue(Re,J,Ce,tt,se);else if(Re==="object")throw J=String(k),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return ke}function fe(k,J,Ce){if(k==null)return k;var Ve=[],se=0;return ue(k,Ve,"","",function(Re){return J.call(Ce,Re,se++)}),Ve}function ye(k){if(k._status===-1){var J=k._result;J=J(),J.then(function(Ce){(k._status===0||k._status===-1)&&(k._status=1,k._result=Ce)},function(Ce){(k._status===0||k._status===-1)&&(k._status=2,k._result=Ce)}),k._status===-1&&(k._status=0,k._result=J)}if(k._status===1)return k._result.default;throw k._result}var Me={current:null},W={transition:null},ee={ReactCurrentDispatcher:Me,ReactCurrentBatchConfig:W,ReactCurrentOwner:D};return $t.Children={map:fe,forEach:function(k,J,Ce){fe(k,function(){J.apply(this,arguments)},Ce)},count:function(k){var J=0;return fe(k,function(){J++}),J},toArray:function(k){return fe(k,function(J){return J})||[]},only:function(k){if(!N(k))throw Error("React.Children.only expected to receive a single React element child.");return k}},$t.Component=E,$t.Fragment=t,$t.Profiler=i,$t.PureComponent=P,$t.StrictMode=n,$t.Suspense=d,$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,$t.cloneElement=function(k,J,Ce){if(k==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+k+".");var Ve=M({},k.props),se=k.key,Re=k.ref,ke=k._owner;if(J!=null){if(J.ref!==void 0&&(Re=J.ref,ke=D.current),J.key!==void 0&&(se=""+J.key),k.type&&k.type.defaultProps)var Le=k.type.defaultProps;for(tt in J)B.call(J,tt)&&!F.hasOwnProperty(tt)&&(Ve[tt]=J[tt]===void 0&&Le!==void 0?Le[tt]:J[tt])}var tt=arguments.length-2;if(tt===1)Ve.children=Ce;else if(1<tt){Le=Array(tt);for(var xt=0;xt<tt;xt++)Le[xt]=arguments[xt+2];Ve.children=Le}return{$$typeof:s,type:k.type,key:se,ref:Re,props:Ve,_owner:ke}},$t.createContext=function(k){return k={$$typeof:u,_currentValue:k,_currentValue2:k,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},k.Provider={$$typeof:o,_context:k},k.Consumer=k},$t.createElement=j,$t.createFactory=function(k){var J=j.bind(null,k);return J.type=k,J},$t.createRef=function(){return{current:null}},$t.forwardRef=function(k){return{$$typeof:f,render:k}},$t.isValidElement=N,$t.lazy=function(k){return{$$typeof:m,_payload:{_status:-1,_result:k},_init:ye}},$t.memo=function(k,J){return{$$typeof:p,type:k,compare:J===void 0?null:J}},$t.startTransition=function(k){var J=W.transition;W.transition={};try{k()}finally{W.transition=J}},$t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},$t.useCallback=function(k,J){return Me.current.useCallback(k,J)},$t.useContext=function(k){return Me.current.useContext(k)},$t.useDebugValue=function(){},$t.useDeferredValue=function(k){return Me.current.useDeferredValue(k)},$t.useEffect=function(k,J){return Me.current.useEffect(k,J)},$t.useId=function(){return Me.current.useId()},$t.useImperativeHandle=function(k,J,Ce){return Me.current.useImperativeHandle(k,J,Ce)},$t.useInsertionEffect=function(k,J){return Me.current.useInsertionEffect(k,J)},$t.useLayoutEffect=function(k,J){return Me.current.useLayoutEffect(k,J)},$t.useMemo=function(k,J){return Me.current.useMemo(k,J)},$t.useReducer=function(k,J,Ce){return Me.current.useReducer(k,J,Ce)},$t.useRef=function(k){return Me.current.useRef(k)},$t.useState=function(k){return Me.current.useState(k)},$t.useSyncExternalStore=function(k,J,Ce){return Me.current.useSyncExternalStore(k,J,Ce)},$t.useTransition=function(){return Me.current.useTransition()},$t.version="18.2.0",$t}var Cx;function Cf(){return Cx||(Cx=1,Wg.exports=IE()),Wg.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bx;function NE(){if(bx)return Ad;bx=1;var s=Cf(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function u(f,d,p){var m,g={},y=null,_=null;p!==void 0&&(y=""+p),d.key!==void 0&&(y=""+d.key),d.ref!==void 0&&(_=d.ref);for(m in d)n.call(d,m)&&!o.hasOwnProperty(m)&&(g[m]=d[m]);if(f&&f.defaultProps)for(m in d=f.defaultProps,d)g[m]===void 0&&(g[m]=d[m]);return{$$typeof:e,type:f,key:y,ref:_,props:g,_owner:i.current}}return Ad.Fragment=t,Ad.jsx=u,Ad.jsxs=u,Ad}var Rx;function DE(){return Rx||(Rx=1,Gg.exports=NE()),Gg.exports}var V=DE(),ve=Cf();const Pm=Bm(ve);var Mp={},jg={exports:{}},Dr={},Xg={exports:{}},Yg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Px;function UE(){return Px||(Px=1,(function(s){function e(W,ee){var k=W.length;W.push(ee);e:for(;0<k;){var J=k-1>>>1,Ce=W[J];if(0<i(Ce,ee))W[J]=ee,W[k]=Ce,k=J;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var ee=W[0],k=W.pop();if(k!==ee){W[0]=k;e:for(var J=0,Ce=W.length,Ve=Ce>>>1;J<Ve;){var se=2*(J+1)-1,Re=W[se],ke=se+1,Le=W[ke];if(0>i(Re,k))ke<Ce&&0>i(Le,Re)?(W[J]=Le,W[ke]=k,J=ke):(W[J]=Re,W[se]=k,J=se);else if(ke<Ce&&0>i(Le,k))W[J]=Le,W[ke]=k,J=ke;else break e}}return ee}function i(W,ee){var k=W.sortIndex-ee.sortIndex;return k!==0?k:W.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();s.unstable_now=function(){return u.now()-f}}var d=[],p=[],m=1,g=null,y=3,_=!1,M=!1,A=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(W){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=W)n(p),ee.sortIndex=ee.expirationTime,e(d,ee);else break;ee=t(p)}}function L(W){if(A=!1,b(W),!M)if(t(d)!==null)M=!0,ye(B);else{var ee=t(p);ee!==null&&Me(L,ee.startTime-W)}}function B(W,ee){M=!1,A&&(A=!1,S(j),j=-1),_=!0;var k=y;try{for(b(ee),g=t(d);g!==null&&(!(g.expirationTime>ee)||W&&!X());){var J=g.callback;if(typeof J=="function"){g.callback=null,y=g.priorityLevel;var Ce=J(g.expirationTime<=ee);ee=s.unstable_now(),typeof Ce=="function"?g.callback=Ce:g===t(d)&&n(d),b(ee)}else n(d);g=t(d)}if(g!==null)var Ve=!0;else{var se=t(p);se!==null&&Me(L,se.startTime-ee),Ve=!1}return Ve}finally{g=null,y=k,_=!1}}var D=!1,F=null,j=-1,O=5,N=-1;function X(){return!(s.unstable_now()-N<O)}function te(){if(F!==null){var W=s.unstable_now();N=W;var ee=!0;try{ee=F(!0,W)}finally{ee?Q():(D=!1,F=null)}}else D=!1}var Q;if(typeof P=="function")Q=function(){P(te)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,fe=ue.port2;ue.port1.onmessage=te,Q=function(){fe.postMessage(null)}}else Q=function(){E(te,0)};function ye(W){F=W,D||(D=!0,Q())}function Me(W,ee){j=E(function(){W(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(W){W.callback=null},s.unstable_continueExecution=function(){M||_||(M=!0,ye(B))},s.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<W?Math.floor(1e3/W):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_getFirstCallbackNode=function(){return t(d)},s.unstable_next=function(W){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var k=y;y=ee;try{return W()}finally{y=k}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(W,ee){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var k=y;y=W;try{return ee()}finally{y=k}},s.unstable_scheduleCallback=function(W,ee,k){var J=s.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?J+k:J):k=J,W){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=k+Ce,W={id:m++,callback:ee,priorityLevel:W,startTime:k,expirationTime:Ce,sortIndex:-1},k>J?(W.sortIndex=k,e(p,W),t(d)===null&&W===t(p)&&(A?(S(j),j=-1):A=!0,Me(L,k-J))):(W.sortIndex=Ce,e(d,W),M||_||(M=!0,ye(B))),W},s.unstable_shouldYield=X,s.unstable_wrapCallback=function(W){var ee=y;return function(){var k=y;y=ee;try{return W.apply(this,arguments)}finally{y=k}}}})(Yg)),Yg}var Lx;function OE(){return Lx||(Lx=1,Xg.exports=UE()),Xg.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ix;function kE(){if(Ix)return Dr;Ix=1;var s=Cf(),e=OE();function t(r){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+r,h=1;h<arguments.length;h++)a+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function o(r,a){u(r,a),u(r+"Capture",a)}function u(r,a){for(i[r]=a,r=0;r<a.length;r++)n.add(a[r])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},g={};function y(r){return d.call(g,r)?!0:d.call(m,r)?!1:p.test(r)?g[r]=!0:(m[r]=!0,!1)}function _(r,a,h,x){if(h!==null&&h.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return x?!1:h!==null?!h.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function M(r,a,h,x){if(a===null||typeof a>"u"||_(r,a,h,x))return!0;if(x)return!1;if(h!==null)switch(h.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function A(r,a,h,x,T,R,U){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=x,this.attributeNamespace=T,this.mustUseProperty=h,this.propertyName=r,this.type=a,this.sanitizeURL=R,this.removeEmptyString=U}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){E[r]=new A(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var a=r[0];E[a]=new A(a,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){E[r]=new A(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){E[r]=new A(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){E[r]=new A(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){E[r]=new A(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){E[r]=new A(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){E[r]=new A(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){E[r]=new A(r,5,!1,r.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function P(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var a=r.replace(S,P);E[a]=new A(a,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var a=r.replace(S,P);E[a]=new A(a,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var a=r.replace(S,P);E[a]=new A(a,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){E[r]=new A(r,1,!1,r.toLowerCase(),null,!1,!1)}),E.xlinkHref=new A("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){E[r]=new A(r,1,!1,r.toLowerCase(),null,!0,!0)});function b(r,a,h,x){var T=E.hasOwnProperty(a)?E[a]:null;(T!==null?T.type!==0:x||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(M(a,h,T,x)&&(h=null),x||T===null?y(a)&&(h===null?r.removeAttribute(a):r.setAttribute(a,""+h)):T.mustUseProperty?r[T.propertyName]=h===null?T.type===3?!1:"":h:(a=T.attributeName,x=T.attributeNamespace,h===null?r.removeAttribute(a):(T=T.type,h=T===3||T===4&&h===!0?"":""+h,x?r.setAttributeNS(x,a,h):r.setAttribute(a,h))))}var L=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,B=Symbol.for("react.element"),D=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),X=Symbol.for("react.context"),te=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),fe=Symbol.for("react.memo"),ye=Symbol.for("react.lazy"),Me=Symbol.for("react.offscreen"),W=Symbol.iterator;function ee(r){return r===null||typeof r!="object"?null:(r=W&&r[W]||r["@@iterator"],typeof r=="function"?r:null)}var k=Object.assign,J;function Ce(r){if(J===void 0)try{throw Error()}catch(h){var a=h.stack.trim().match(/\n( *(at )?)/);J=a&&a[1]||""}return`
`+J+r}var Ve=!1;function se(r,a){if(!r||Ve)return"";Ve=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(_e){var x=_e}Reflect.construct(r,[],a)}else{try{a.call()}catch(_e){x=_e}r.call(a.prototype)}else{try{throw Error()}catch(_e){x=_e}r()}}catch(_e){if(_e&&x&&typeof _e.stack=="string"){for(var T=_e.stack.split(`
`),R=x.stack.split(`
`),U=T.length-1,Z=R.length-1;1<=U&&0<=Z&&T[U]!==R[Z];)Z--;for(;1<=U&&0<=Z;U--,Z--)if(T[U]!==R[Z]){if(U!==1||Z!==1)do if(U--,Z--,0>Z||T[U]!==R[Z]){var $=`
`+T[U].replace(" at new "," at ");return r.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",r.displayName)),$}while(1<=U&&0<=Z);break}}}finally{Ve=!1,Error.prepareStackTrace=h}return(r=r?r.displayName||r.name:"")?Ce(r):""}function Re(r){switch(r.tag){case 5:return Ce(r.type);case 16:return Ce("Lazy");case 13:return Ce("Suspense");case 19:return Ce("SuspenseList");case 0:case 2:case 15:return r=se(r.type,!1),r;case 11:return r=se(r.type.render,!1),r;case 1:return r=se(r.type,!0),r;default:return""}}function ke(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case F:return"Fragment";case D:return"Portal";case O:return"Profiler";case j:return"StrictMode";case Q:return"Suspense";case ue:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case X:return(r.displayName||"Context")+".Consumer";case N:return(r._context.displayName||"Context")+".Provider";case te:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case fe:return a=r.displayName||null,a!==null?a:ke(r.type)||"Memo";case ye:a=r._payload,r=r._init;try{return ke(r(a))}catch{}}return null}function Le(r){var a=r.type;switch(r.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=a.render,r=r.displayName||r.name||"",a.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ke(a);case 8:return a===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function tt(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function xt(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ae(r){var a=xt(r)?"checked":"value",h=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),x=""+r[a];if(!r.hasOwnProperty(a)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var T=h.get,R=h.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return T.call(this)},set:function(U){x=""+U,R.call(this,U)}}),Object.defineProperty(r,a,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(U){x=""+U},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function Mt(r){r._valueTracker||(r._valueTracker=ae(r))}function Ae(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var h=a.getValue(),x="";return r&&(x=xt(r)?r.checked?"true":"false":r.value),r=x,r!==h?(a.setValue(r),!0):!1}function Oe(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function De(r,a){var h=a.checked;return k({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??r._wrapperState.initialChecked})}function Xe(r,a){var h=a.defaultValue==null?"":a.defaultValue,x=a.checked!=null?a.checked:a.defaultChecked;h=tt(a.value!=null?a.value:h),r._wrapperState={initialChecked:x,initialValue:h,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function xe(r,a){a=a.checked,a!=null&&b(r,"checked",a,!1)}function Fe(r,a){xe(r,a);var h=tt(a.value),x=a.type;if(h!=null)x==="number"?(h===0&&r.value===""||r.value!=h)&&(r.value=""+h):r.value!==""+h&&(r.value=""+h);else if(x==="submit"||x==="reset"){r.removeAttribute("value");return}a.hasOwnProperty("value")?q(r,a.type,h):a.hasOwnProperty("defaultValue")&&q(r,a.type,tt(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(r.defaultChecked=!!a.defaultChecked)}function $e(r,a,h){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var x=a.type;if(!(x!=="submit"&&x!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+r._wrapperState.initialValue,h||a===r.value||(r.value=a),r.defaultValue=a}h=r.name,h!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,h!==""&&(r.name=h)}function q(r,a,h){(a!=="number"||Oe(r.ownerDocument)!==r)&&(h==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+h&&(r.defaultValue=""+h))}var z=Array.isArray;function de(r,a,h,x){if(r=r.options,a){a={};for(var T=0;T<h.length;T++)a["$"+h[T]]=!0;for(h=0;h<r.length;h++)T=a.hasOwnProperty("$"+r[h].value),r[h].selected!==T&&(r[h].selected=T),T&&x&&(r[h].defaultSelected=!0)}else{for(h=""+tt(h),a=null,T=0;T<r.length;T++){if(r[T].value===h){r[T].selected=!0,x&&(r[T].defaultSelected=!0);return}a!==null||r[T].disabled||(a=r[T])}a!==null&&(a.selected=!0)}}function Ie(r,a){if(a.dangerouslySetInnerHTML!=null)throw Error(t(91));return k({},a,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function ze(r,a){var h=a.value;if(h==null){if(h=a.children,a=a.defaultValue,h!=null){if(a!=null)throw Error(t(92));if(z(h)){if(1<h.length)throw Error(t(93));h=h[0]}a=h}a==null&&(a=""),h=a}r._wrapperState={initialValue:tt(h)}}function Ue(r,a){var h=tt(a.value),x=tt(a.defaultValue);h!=null&&(h=""+h,h!==r.value&&(r.value=h),a.defaultValue==null&&r.defaultValue!==h&&(r.defaultValue=h)),x!=null&&(r.defaultValue=""+x)}function vt(r){var a=r.textContent;a===r._wrapperState.initialValue&&a!==""&&a!==null&&(r.value=a)}function Je(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ke(r,a){return r==null||r==="http://www.w3.org/1999/xhtml"?Je(a):r==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Ct,qe=(function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,h,x,T){MSApp.execUnsafeLocalFunction(function(){return r(a,h,x,T)})}:r})(function(r,a){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=a;else{for(Ct=Ct||document.createElement("div"),Ct.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=Ct.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;a.firstChild;)r.appendChild(a.firstChild)}});function ft(r,a){if(a){var h=r.firstChild;if(h&&h===r.lastChild&&h.nodeType===3){h.nodeValue=a;return}}r.textContent=a}var Nt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tt=["Webkit","ms","Moz","O"];Object.keys(Nt).forEach(function(r){Tt.forEach(function(a){a=a+r.charAt(0).toUpperCase()+r.substring(1),Nt[a]=Nt[r]})});function ot(r,a,h){return a==null||typeof a=="boolean"||a===""?"":h||typeof a!="number"||a===0||Nt.hasOwnProperty(r)&&Nt[r]?(""+a).trim():a+"px"}function Dt(r,a){r=r.style;for(var h in a)if(a.hasOwnProperty(h)){var x=h.indexOf("--")===0,T=ot(h,a[h],x);h==="float"&&(h="cssFloat"),x?r.setProperty(h,T):r[h]=T}}var Bt=k({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ne(r,a){if(a){if(Bt[r]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(t(137,r));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(t(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(t(61))}if(a.style!=null&&typeof a.style!="object")throw Error(t(62))}}function Pe(r,a){if(r.indexOf("-")===-1)return typeof a.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var K=null;function Ee(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Te=null,We=null,Ze=null;function Kt(r){if(r=Ps(r)){if(typeof Te!="function")throw Error(t(280));var a=r.stateNode;a&&(a=yc(a),Te(r.stateNode,r.type,a))}}function rn(r){We?Ze?Ze.push(r):Ze=[r]:We=r}function Jt(){if(We){var r=We,a=Ze;if(Ze=We=null,Kt(r),a)for(r=0;r<a.length;r++)Kt(a[r])}}function fn(r,a){return r(a)}function Xt(){}var On=!1;function wn(r,a,h){if(On)return r(a,h);On=!0;try{return fn(r,a,h)}finally{On=!1,(We!==null||Ze!==null)&&(Xt(),Jt())}}function rr(r,a){var h=r.stateNode;if(h===null)return null;var x=yc(h);if(x===null)return null;h=x[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(r=r.type,x=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!x;break e;default:r=!1}if(r)return null;if(h&&typeof h!="function")throw Error(t(231,a,typeof h));return h}var _a=!1;if(f)try{var Ks={};Object.defineProperty(Ks,"passive",{get:function(){_a=!0}}),window.addEventListener("test",Ks,Ks),window.removeEventListener("test",Ks,Ks)}catch{_a=!1}function Ro(r,a,h,x,T,R,U,Z,$){var _e=Array.prototype.slice.call(arguments,3);try{a.apply(h,_e)}catch(He){this.onError(He)}}var rs=!1,Ss=null,Fr=!1,Sa=null,Uf={onError:function(r){rs=!0,Ss=r}};function Of(r,a,h,x,T,R,U,Z,$){rs=!1,Ss=null,Ro.apply(Uf,arguments)}function kf(r,a,h,x,T,R,U,Z,$){if(Of.apply(this,arguments),rs){if(rs){var _e=Ss;rs=!1,Ss=null}else throw Error(t(198));Fr||(Fr=!0,Sa=_e)}}function H(r){var a=r,h=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(h=a.return),r=a.return;while(r)}return a.tag===3?h:null}function le(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function Se(r){if(H(r)!==r)throw Error(t(188))}function me(r){var a=r.alternate;if(!a){if(a=H(r),a===null)throw Error(t(188));return a!==r?null:r}for(var h=r,x=a;;){var T=h.return;if(T===null)break;var R=T.alternate;if(R===null){if(x=T.return,x!==null){h=x;continue}break}if(T.child===R.child){for(R=T.child;R;){if(R===h)return Se(T),r;if(R===x)return Se(T),a;R=R.sibling}throw Error(t(188))}if(h.return!==x.return)h=T,x=R;else{for(var U=!1,Z=T.child;Z;){if(Z===h){U=!0,h=T,x=R;break}if(Z===x){U=!0,x=T,h=R;break}Z=Z.sibling}if(!U){for(Z=R.child;Z;){if(Z===h){U=!0,h=R,x=T;break}if(Z===x){U=!0,x=R,h=T;break}Z=Z.sibling}if(!U)throw Error(t(189))}}if(h.alternate!==x)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?r:a}function ge(r){return r=me(r),r!==null?nt(r):null}function nt(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var a=nt(r);if(a!==null)return a;r=r.sibling}return null}var ht=e.unstable_scheduleCallback,yt=e.unstable_cancelCallback,bt=e.unstable_shouldYield,kt=e.unstable_requestPaint,ut=e.unstable_now,zt=e.unstable_getCurrentPriorityLevel,gn=e.unstable_ImmediatePriority,kn=e.unstable_UserBlockingPriority,ni=e.unstable_NormalPriority,sr=e.unstable_LowPriority,Qt=e.unstable_IdlePriority,wt=null,Vt=null;function At(r){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(wt,r,void 0,(r.current.flags&128)===128)}catch{}}var vn=Math.clz32?Math.clz32:Br,qn=Math.log,Gn=Math.LN2;function Br(r){return r>>>=0,r===0?32:31-(qn(r)/Gn|0)|0}var yn=64,xn=4194304;function yr(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function ii(r,a){var h=r.pendingLanes;if(h===0)return 0;var x=0,T=r.suspendedLanes,R=r.pingedLanes,U=h&268435455;if(U!==0){var Z=U&~T;Z!==0?x=yr(Z):(R&=U,R!==0&&(x=yr(R)))}else U=h&~T,U!==0?x=yr(U):R!==0&&(x=yr(R));if(x===0)return 0;if(a!==0&&a!==x&&(a&T)===0&&(T=x&-x,R=a&-a,T>=R||T===16&&(R&4194240)!==0))return a;if((x&4)!==0&&(x|=h&16),a=r.entangledLanes,a!==0)for(r=r.entanglements,a&=x;0<a;)h=31-vn(a),T=1<<h,x|=r[h],a&=~T;return x}function Ma(r,a){switch(r){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wa(r,a){for(var h=r.suspendedLanes,x=r.pingedLanes,T=r.expirationTimes,R=r.pendingLanes;0<R;){var U=31-vn(R),Z=1<<U,$=T[U];$===-1?((Z&h)===0||(Z&x)!==0)&&(T[U]=Ma(Z,a)):$<=a&&(r.expiredLanes|=Z),R&=~Z}}function Po(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function xr(){var r=yn;return yn<<=1,(yn&4194240)===0&&(yn=64),r}function zf(r){for(var a=[],h=0;31>h;h++)a.push(r);return a}function Tl(r,a,h){r.pendingLanes|=a,a!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,a=31-vn(a),r[a]=h}function hg(r,a){var h=r.pendingLanes&~a;r.pendingLanes=a,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=a,r.mutableReadLanes&=a,r.entangledLanes&=a,a=r.entanglements;var x=r.eventTimes;for(r=r.expirationTimes;0<h;){var T=31-vn(h),R=1<<T;a[T]=0,x[T]=-1,r[T]=-1,h&=~R}}function Ea(r,a){var h=r.entangledLanes|=a;for(r=r.entanglements;h;){var x=31-vn(h),T=1<<x;T&a|r[x]&a&&(r[x]|=a),h&=~T}}var sn=0;function Ta(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var Al,Ff,bh,Bu,Hu,Lo=!1,Vu=[],ss=null,Yt=null,Ms=null,Io=new Map,Aa=new Map,Js=[],pg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zn(r,a){switch(r){case"focusin":case"focusout":ss=null;break;case"dragenter":case"dragleave":Yt=null;break;case"mouseover":case"mouseout":Ms=null;break;case"pointerover":case"pointerout":Io.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Aa.delete(a.pointerId)}}function No(r,a,h,x,T,R){return r===null||r.nativeEvent!==R?(r={blockedOn:a,domEventName:h,eventSystemFlags:x,nativeEvent:R,targetContainers:[T]},a!==null&&(a=Ps(a),a!==null&&Ff(a)),r):(r.eventSystemFlags|=x,a=r.targetContainers,T!==null&&a.indexOf(T)===-1&&a.push(T),r)}function mg(r,a,h,x,T){switch(a){case"focusin":return ss=No(ss,r,a,h,x,T),!0;case"dragenter":return Yt=No(Yt,r,a,h,x,T),!0;case"mouseover":return Ms=No(Ms,r,a,h,x,T),!0;case"pointerover":var R=T.pointerId;return Io.set(R,No(Io.get(R)||null,r,a,h,x,T)),!0;case"gotpointercapture":return R=T.pointerId,Aa.set(R,No(Aa.get(R)||null,r,a,h,x,T)),!0}return!1}function Gu(r){var a=so(r.target);if(a!==null){var h=H(a);if(h!==null){if(a=h.tag,a===13){if(a=le(h),a!==null){r.blockedOn=a,Hu(r.priority,function(){bh(h)});return}}else if(a===3&&h.stateNode.current.memoizedState.isDehydrated){r.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Wu(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var h=Sr(r.domEventName,r.eventSystemFlags,a[0],r.nativeEvent);if(h===null){h=r.nativeEvent;var x=new h.constructor(h.type,h);K=x,h.target.dispatchEvent(x),K=null}else return a=Ps(h),a!==null&&Ff(a),r.blockedOn=h,!1;a.shift()}return!0}function Cl(r,a,h){Wu(r)&&h.delete(a)}function os(){Lo=!1,ss!==null&&Wu(ss)&&(ss=null),Yt!==null&&Wu(Yt)&&(Yt=null),Ms!==null&&Wu(Ms)&&(Ms=null),Io.forEach(Cl),Aa.forEach(Cl)}function bl(r,a){r.blockedOn===a&&(r.blockedOn=null,Lo||(Lo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,os)))}function Rl(r){function a(T){return bl(T,r)}if(0<Vu.length){bl(Vu[0],r);for(var h=1;h<Vu.length;h++){var x=Vu[h];x.blockedOn===r&&(x.blockedOn=null)}}for(ss!==null&&bl(ss,r),Yt!==null&&bl(Yt,r),Ms!==null&&bl(Ms,r),Io.forEach(a),Aa.forEach(a),h=0;h<Js.length;h++)x=Js[h],x.blockedOn===r&&(x.blockedOn=null);for(;0<Js.length&&(h=Js[0],h.blockedOn===null);)Gu(h),h.blockedOn===null&&Js.shift()}var Ri=L.ReactCurrentBatchConfig,_r=!0;function ju(r,a,h,x){var T=sn,R=Ri.transition;Ri.transition=null;try{sn=1,Xu(r,a,h,x)}finally{sn=T,Ri.transition=R}}function Bf(r,a,h,x){var T=sn,R=Ri.transition;Ri.transition=null;try{sn=4,Xu(r,a,h,x)}finally{sn=T,Ri.transition=R}}function Xu(r,a,h,x){if(_r){var T=Sr(r,a,h,x);if(T===null)dc(r,a,x,Yu,h),Zn(r,x);else if(mg(T,r,a,h,x))x.stopPropagation();else if(Zn(r,x),a&4&&-1<pg.indexOf(r)){for(;T!==null;){var R=Ps(T);if(R!==null&&Al(R),R=Sr(r,a,h,x),R===null&&dc(r,a,x,Yu,h),R===T)break;T=R}T!==null&&x.stopPropagation()}else dc(r,a,x,null,h)}}var Yu=null;function Sr(r,a,h,x){if(Yu=null,r=Ee(x),r=so(r),r!==null)if(a=H(r),a===null)r=null;else if(h=a.tag,h===13){if(r=le(a),r!==null)return r;r=null}else if(h===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null);return Yu=r,null}function Rh(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zt()){case gn:return 1;case kn:return 4;case ni:case sr:return 16;case Qt:return 536870912;default:return 16}default:return 16}}var Hr=null,Hf=null,ji=null;function Pl(){if(ji)return ji;var r,a=Hf,h=a.length,x,T="value"in Hr?Hr.value:Hr.textContent,R=T.length;for(r=0;r<h&&a[r]===T[r];r++);var U=h-r;for(x=1;x<=U&&a[h-x]===T[R-x];x++);return ji=T.slice(r,1<x?1-x:void 0)}function Do(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function ws(){return!0}function qu(){return!1}function Pi(r){function a(h,x,T,R,U){this._reactName=h,this._targetInst=T,this.type=x,this.nativeEvent=R,this.target=U,this.currentTarget=null;for(var Z in r)r.hasOwnProperty(Z)&&(h=r[Z],this[Z]=h?h(R):R[Z]);return this.isDefaultPrevented=(R.defaultPrevented!=null?R.defaultPrevented:R.returnValue===!1)?ws:qu,this.isPropagationStopped=qu,this}return k(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=ws)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=ws)},persist:function(){},isPersistent:ws}),a}var Uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ll=Pi(Uo),Oo=k({},Uo,{view:0,detail:0}),Ca=Pi(Oo),Xi,Mr,wr,ba=k({},Oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==wr&&(wr&&r.type==="mousemove"?(Xi=r.screenX-wr.screenX,Mr=r.screenY-wr.screenY):Mr=Xi=0,wr=r),Xi)},movementY:function(r){return"movementY"in r?r.movementY:Mr}}),Vf=Pi(ba),Es=k({},ba,{dataTransfer:0}),$s=Pi(Es),Zu=k({},Oo,{relatedTarget:0}),Qu=Pi(Zu),Ku=k({},Uo,{animationName:0,elapsedTime:0,pseudoElement:0}),Ph=Pi(Ku),Lh=k({},Uo,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Gf=Pi(Lh),Ju=k({},Uo,{data:0}),Wf=Pi(Ju),Ih={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ra(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=jf[r])?!!a[r]:!1}function eo(){return Ra}var $u=k({},Oo,{key:function(r){if(r.key){var a=Ih[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=Do(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Nh[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eo,charCode:function(r){return r.type==="keypress"?Do(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Do(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),ec=Pi($u),Er=k({},ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),or=Pi(Er),ko=k({},Oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eo}),Ts=Pi(ko),As=k({},Uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),zo=Pi(As),Dh=k({},ba,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Xf=Pi(Dh),Yf=[9,13,27,32],Li=f&&"CompositionEvent"in window,mi=null;f&&"documentMode"in document&&(mi=document.documentMode);var An=f&&"TextEvent"in window&&!mi,Pa=f&&(!Li||mi&&8<mi&&11>=mi),Tr=" ",qf=!1;function Zf(r,a){switch(r){case"keyup":return Yf.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var to=!1;function Uh(r,a){switch(r){case"compositionend":return tc(a);case"keypress":return a.which!==32?null:(qf=!0,Tr);case"textInput":return r=a.data,r===Tr&&qf?null:r;default:return null}}function Il(r,a){if(to)return r==="compositionend"||!Li&&Zf(r,a)?(r=Pl(),ji=Hf=Hr=null,to=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Pa&&a.locale!=="ko"?null:a.data;default:return null}}var La={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nc(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!La[r.type]:a==="textarea"}function Ia(r,a,h,x){rn(x),a=hc(a,"onChange"),0<a.length&&(h=new Ll("onChange","change",null,h,x),r.push({event:h,listeners:a}))}var no=null,Na=null;function Oh(r){ka(r,0)}function Cs(r){var a=zn(r);if(Ae(a))return r}function kh(r,a){if(r==="change")return a}var Da=!1;if(f){var Yi;if(f){var Fo="oninput"in document;if(!Fo){var Bo=document.createElement("div");Bo.setAttribute("oninput","return;"),Fo=typeof Bo.oninput=="function"}Yi=Fo}else Yi=!1;Da=Yi&&(!document.documentMode||9<document.documentMode)}function Vr(){no&&(no.detachEvent("onpropertychange",ic),Na=no=null)}function ic(r){if(r.propertyName==="value"&&Cs(Na)){var a=[];Ia(a,Na,r,Ee(r)),wn(Oh,a)}}function Ua(r,a,h){r==="focusin"?(Vr(),no=a,Na=h,no.attachEvent("onpropertychange",ic)):r==="focusout"&&Vr()}function zh(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Cs(Na)}function Qf(r,a){if(r==="click")return Cs(a)}function Rn(r,a){if(r==="input"||r==="change")return Cs(a)}function rc(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var ar=typeof Object.is=="function"?Object.is:rc;function Ho(r,a){if(ar(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var h=Object.keys(r),x=Object.keys(a);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var T=h[x];if(!d.call(a,T)||!ar(r[T],a[T]))return!1}return!0}function Nl(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function lr(r,a){var h=Nl(r);r=0;for(var x;h;){if(h.nodeType===3){if(x=r+h.textContent.length,r<=a&&x>=a)return{node:h,offset:a-r};r=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Nl(h)}}function Vo(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?Vo(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function Pn(){for(var r=window,a=Oe();a instanceof r.HTMLIFrameElement;){try{var h=typeof a.contentWindow.location.href=="string"}catch{h=!1}if(h)r=a.contentWindow;else break;a=Oe(r.document)}return a}function ri(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}function si(r){var a=Pn(),h=r.focusedElem,x=r.selectionRange;if(a!==h&&h&&h.ownerDocument&&Vo(h.ownerDocument.documentElement,h)){if(x!==null&&ri(h)){if(a=x.start,r=x.end,r===void 0&&(r=a),"selectionStart"in h)h.selectionStart=a,h.selectionEnd=Math.min(r,h.value.length);else if(r=(a=h.ownerDocument||document)&&a.defaultView||window,r.getSelection){r=r.getSelection();var T=h.textContent.length,R=Math.min(x.start,T);x=x.end===void 0?R:Math.min(x.end,T),!r.extend&&R>x&&(T=x,x=R,R=T),T=lr(h,R);var U=lr(h,x);T&&U&&(r.rangeCount!==1||r.anchorNode!==T.node||r.anchorOffset!==T.offset||r.focusNode!==U.node||r.focusOffset!==U.offset)&&(a=a.createRange(),a.setStart(T.node,T.offset),r.removeAllRanges(),R>x?(r.addRange(a),r.extend(U.node,U.offset)):(a.setEnd(U.node,U.offset),r.addRange(a)))}}for(a=[],r=h;r=r.parentNode;)r.nodeType===1&&a.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<a.length;h++)r=a[h],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var sc=f&&"documentMode"in document&&11>=document.documentMode,as=null,Go=null,Dl=null,oi=!1;function oc(r,a,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;oi||as==null||as!==Oe(x)||(x=as,"selectionStart"in x&&ri(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Dl&&Ho(Dl,x)||(Dl=x,x=hc(Go,"onSelect"),0<x.length&&(a=new Ll("onSelect","select",null,a,h),r.push({event:a,listeners:x}),a.target=as)))}function Oa(r,a){var h={};return h[r.toLowerCase()]=a.toLowerCase(),h["Webkit"+r]="webkit"+a,h["Moz"+r]="moz"+a,h}var io={animationend:Oa("Animation","AnimationEnd"),animationiteration:Oa("Animation","AnimationIteration"),animationstart:Oa("Animation","AnimationStart"),transitionend:Oa("Transition","TransitionEnd")},Gr={},Wr={};f&&(Wr=document.createElement("div").style,"AnimationEvent"in window||(delete io.animationend.animation,delete io.animationiteration.animation,delete io.animationstart.animation),"TransitionEvent"in window||delete io.transitionend.transition);function ls(r){if(Gr[r])return Gr[r];if(!io[r])return r;var a=io[r],h;for(h in a)if(a.hasOwnProperty(h)&&h in Wr)return Gr[r]=a[h];return r}var Ul=ls("animationend"),Ol=ls("animationiteration"),Kf=ls("animationstart"),Jf=ls("transitionend"),$f=new Map,ed="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bs(r,a){$f.set(r,a),o(a,[r])}for(var ac=0;ac<ed.length;ac++){var kl=ed[ac],zl=kl.toLowerCase(),Fh=kl[0].toUpperCase()+kl.slice(1);bs(zl,"on"+Fh)}bs(Ul,"onAnimationEnd"),bs(Ol,"onAnimationIteration"),bs(Kf,"onAnimationStart"),bs("dblclick","onDoubleClick"),bs("focusin","onFocus"),bs("focusout","onBlur"),bs(Jf,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ro="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lc=new Set("cancel close invalid load scroll toggle".split(" ").concat(ro));function uc(r,a,h){var x=r.type||"unknown-event";r.currentTarget=h,kf(x,a,void 0,r),r.currentTarget=null}function ka(r,a){a=(a&4)!==0;for(var h=0;h<r.length;h++){var x=r[h],T=x.event;x=x.listeners;e:{var R=void 0;if(a)for(var U=x.length-1;0<=U;U--){var Z=x[U],$=Z.instance,_e=Z.currentTarget;if(Z=Z.listener,$!==R&&T.isPropagationStopped())break e;uc(T,Z,_e),R=$}else for(U=0;U<x.length;U++){if(Z=x[U],$=Z.instance,_e=Z.currentTarget,Z=Z.listener,$!==R&&T.isPropagationStopped())break e;uc(T,Z,_e),R=$}}}if(Fr)throw r=Sa,Fr=!1,Sa=null,r}function _n(r,a){var h=a[Xo];h===void 0&&(h=a[Xo]=new Set);var x=r+"__bubble";h.has(x)||(fc(a,r,2,!1),h.add(x))}function cc(r,a,h){var x=0;a&&(x|=4),fc(h,r,x,a)}var Fl="_reactListening"+Math.random().toString(36).slice(2);function za(r){if(!r[Fl]){r[Fl]=!0,n.forEach(function(h){h!=="selectionchange"&&(lc.has(h)||cc(h,!1,r),cc(h,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[Fl]||(a[Fl]=!0,cc("selectionchange",!1,a))}}function fc(r,a,h,x){switch(Rh(a)){case 1:var T=ju;break;case 4:T=Bf;break;default:T=Xu}h=T.bind(null,a,h,r),T=void 0,!_a||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(T=!0),x?T!==void 0?r.addEventListener(a,h,{capture:!0,passive:T}):r.addEventListener(a,h,!0):T!==void 0?r.addEventListener(a,h,{passive:T}):r.addEventListener(a,h,!1)}function dc(r,a,h,x,T){var R=x;if((a&1)===0&&(a&2)===0&&x!==null)e:for(;;){if(x===null)return;var U=x.tag;if(U===3||U===4){var Z=x.stateNode.containerInfo;if(Z===T||Z.nodeType===8&&Z.parentNode===T)break;if(U===4)for(U=x.return;U!==null;){var $=U.tag;if(($===3||$===4)&&($=U.stateNode.containerInfo,$===T||$.nodeType===8&&$.parentNode===T))return;U=U.return}for(;Z!==null;){if(U=so(Z),U===null)return;if($=U.tag,$===5||$===6){x=R=U;continue e}Z=Z.parentNode}}x=x.return}wn(function(){var _e=R,He=Ee(h),Ge=[];e:{var Be=$f.get(r);if(Be!==void 0){var at=Ll,dt=r;switch(r){case"keypress":if(Do(h)===0)break e;case"keydown":case"keyup":at=ec;break;case"focusin":dt="focus",at=Qu;break;case"focusout":dt="blur",at=Qu;break;case"beforeblur":case"afterblur":at=Qu;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=Vf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=$s;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Ts;break;case Ul:case Ol:case Kf:at=Ph;break;case Jf:at=zo;break;case"scroll":at=Ca;break;case"wheel":at=Xf;break;case"copy":case"cut":case"paste":at=Gf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=or}var gt=(a&4)!==0,Jn=!gt&&r==="scroll",ce=gt?Be!==null?Be+"Capture":null:Be;gt=[];for(var ie=_e,he;ie!==null;){he=ie;var Ye=he.stateNode;if(he.tag===5&&Ye!==null&&(he=Ye,ce!==null&&(Ye=rr(ie,ce),Ye!=null&&gt.push(Fa(ie,Ye,he)))),Jn)break;ie=ie.return}0<gt.length&&(Be=new at(Be,dt,null,h,He),Ge.push({event:Be,listeners:gt}))}}if((a&7)===0){e:{if(Be=r==="mouseover"||r==="pointerover",at=r==="mouseout"||r==="pointerout",Be&&h!==K&&(dt=h.relatedTarget||h.fromElement)&&(so(dt)||dt[ur]))break e;if((at||Be)&&(Be=He.window===He?He:(Be=He.ownerDocument)?Be.defaultView||Be.parentWindow:window,at?(dt=h.relatedTarget||h.toElement,at=_e,dt=dt?so(dt):null,dt!==null&&(Jn=H(dt),dt!==Jn||dt.tag!==5&&dt.tag!==6)&&(dt=null)):(at=null,dt=_e),at!==dt)){if(gt=Vf,Ye="onMouseLeave",ce="onMouseEnter",ie="mouse",(r==="pointerout"||r==="pointerover")&&(gt=or,Ye="onPointerLeave",ce="onPointerEnter",ie="pointer"),Jn=at==null?Be:zn(at),he=dt==null?Be:zn(dt),Be=new gt(Ye,ie+"leave",at,h,He),Be.target=Jn,Be.relatedTarget=he,Ye=null,so(He)===_e&&(gt=new gt(ce,ie+"enter",dt,h,He),gt.target=he,gt.relatedTarget=Jn,Ye=gt),Jn=Ye,at&&dt)t:{for(gt=at,ce=dt,ie=0,he=gt;he;he=Wo(he))ie++;for(he=0,Ye=ce;Ye;Ye=Wo(Ye))he++;for(;0<ie-he;)gt=Wo(gt),ie--;for(;0<he-ie;)ce=Wo(ce),he--;for(;ie--;){if(gt===ce||ce!==null&&gt===ce.alternate)break t;gt=Wo(gt),ce=Wo(ce)}gt=null}else gt=null;at!==null&&Bh(Ge,Be,at,gt,!1),dt!==null&&Jn!==null&&Bh(Ge,Jn,dt,gt,!0)}}e:{if(Be=_e?zn(_e):window,at=Be.nodeName&&Be.nodeName.toLowerCase(),at==="select"||at==="input"&&Be.type==="file")var _t=kh;else if(nc(Be))if(Da)_t=Rn;else{_t=zh;var Rt=Ua}else(at=Be.nodeName)&&at.toLowerCase()==="input"&&(Be.type==="checkbox"||Be.type==="radio")&&(_t=Qf);if(_t&&(_t=_t(r,_e))){Ia(Ge,_t,h,He);break e}Rt&&Rt(r,Be,_e),r==="focusout"&&(Rt=Be._wrapperState)&&Rt.controlled&&Be.type==="number"&&q(Be,"number",Be.value)}switch(Rt=_e?zn(_e):window,r){case"focusin":(nc(Rt)||Rt.contentEditable==="true")&&(as=Rt,Go=_e,Dl=null);break;case"focusout":Dl=Go=as=null;break;case"mousedown":oi=!0;break;case"contextmenu":case"mouseup":case"dragend":oi=!1,oc(Ge,h,He);break;case"selectionchange":if(sc)break;case"keydown":case"keyup":oc(Ge,h,He)}var Pt;if(Li)e:{switch(r){case"compositionstart":var Ot="onCompositionStart";break e;case"compositionend":Ot="onCompositionEnd";break e;case"compositionupdate":Ot="onCompositionUpdate";break e}Ot=void 0}else to?Zf(r,h)&&(Ot="onCompositionEnd"):r==="keydown"&&h.keyCode===229&&(Ot="onCompositionStart");Ot&&(Pa&&h.locale!=="ko"&&(to||Ot!=="onCompositionStart"?Ot==="onCompositionEnd"&&to&&(Pt=Pl()):(Hr=He,Hf="value"in Hr?Hr.value:Hr.textContent,to=!0)),Rt=hc(_e,Ot),0<Rt.length&&(Ot=new Wf(Ot,r,null,h,He),Ge.push({event:Ot,listeners:Rt}),Pt?Ot.data=Pt:(Pt=tc(h),Pt!==null&&(Ot.data=Pt)))),(Pt=An?Uh(r,h):Il(r,h))&&(_e=hc(_e,"onBeforeInput"),0<_e.length&&(He=new Wf("onBeforeInput","beforeinput",null,h,He),Ge.push({event:He,listeners:_e}),He.data=Pt))}ka(Ge,a)})}function Fa(r,a,h){return{instance:r,listener:a,currentTarget:h}}function hc(r,a){for(var h=a+"Capture",x=[];r!==null;){var T=r,R=T.stateNode;T.tag===5&&R!==null&&(T=R,R=rr(r,h),R!=null&&x.unshift(Fa(r,R,T)),R=rr(r,a),R!=null&&x.push(Fa(r,R,T))),r=r.return}return x}function Wo(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Bh(r,a,h,x,T){for(var R=a._reactName,U=[];h!==null&&h!==x;){var Z=h,$=Z.alternate,_e=Z.stateNode;if($!==null&&$===x)break;Z.tag===5&&_e!==null&&(Z=_e,T?($=rr(h,R),$!=null&&U.unshift(Fa(h,$,Z))):T||($=rr(h,R),$!=null&&U.push(Fa(h,$,Z)))),h=h.return}U.length!==0&&r.push({event:a,listeners:U})}var gg=/\r\n?/g,Hh=/\u0000|\uFFFD/g;function td(r){return(typeof r=="string"?r:""+r).replace(gg,`
`).replace(Hh,"")}function Bl(r,a,h){if(a=td(a),td(r)!==a&&h)throw Error(t(425))}function Hl(){}var Ba=null,nd=null;function id(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var rd=typeof setTimeout=="function"?setTimeout:void 0,sd=typeof clearTimeout=="function"?clearTimeout:void 0,pc=typeof Promise=="function"?Promise:void 0,vg=typeof queueMicrotask=="function"?queueMicrotask:typeof pc<"u"?function(r){return pc.resolve(null).then(r).catch(Vh)}:rd;function Vh(r){setTimeout(function(){throw r})}function mc(r,a){var h=a,x=0;do{var T=h.nextSibling;if(r.removeChild(h),T&&T.nodeType===8)if(h=T.data,h==="/$"){if(x===0){r.removeChild(T),Rl(a);return}x--}else h!=="$"&&h!=="$?"&&h!=="$!"||x++;h=T}while(h);Rl(a)}function Rs(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return r}function od(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var h=r.data;if(h==="$"||h==="$!"||h==="$?"){if(a===0)return r;a--}else h==="/$"&&a++}r=r.previousSibling}return null}var jo=Math.random().toString(36).slice(2),Qn="__reactFiber$"+jo,Ha="__reactProps$"+jo,ur="__reactContainer$"+jo,Xo="__reactEvents$"+jo,gc="__reactListeners$"+jo,vc="__reactHandles$"+jo;function so(r){var a=r[Qn];if(a)return a;for(var h=r.parentNode;h;){if(a=h[ur]||h[Qn]){if(h=a.alternate,a.child!==null||h!==null&&h.child!==null)for(r=od(r);r!==null;){if(h=r[Qn])return h;r=od(r)}return a}r=h,h=r.parentNode}return null}function Ps(r){return r=r[Qn]||r[ur],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function zn(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(t(33))}function yc(r){return r[Ha]||null}var ad=[],ai=-1;function Nn(r){return{current:r}}function Sn(r){0>ai||(r.current=ad[ai],ad[ai]=null,ai--)}function dn(r,a){ai++,ad[ai]=r.current,r.current=a}var Ls={},gi=Nn(Ls),Ii=Nn(!1),Is=Ls;function Yo(r,a){var h=r.type.contextTypes;if(!h)return Ls;var x=r.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===a)return x.__reactInternalMemoizedMaskedChildContext;var T={},R;for(R in h)T[R]=a[R];return x&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=a,r.__reactInternalMemoizedMaskedChildContext=T),T}function Si(r){return r=r.childContextTypes,r!=null}function Vl(){Sn(Ii),Sn(gi)}function ld(r,a,h){if(gi.current!==Ls)throw Error(t(168));dn(gi,a),dn(Ii,h)}function Gl(r,a,h){var x=r.stateNode;if(a=a.childContextTypes,typeof x.getChildContext!="function")return h;x=x.getChildContext();for(var T in x)if(!(T in a))throw Error(t(108,Le(r)||"Unknown",T));return k({},h,x)}function qo(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ls,Is=gi.current,dn(gi,r),dn(Ii,Ii.current),!0}function ud(r,a,h){var x=r.stateNode;if(!x)throw Error(t(169));h?(r=Gl(r,a,Is),x.__reactInternalMemoizedMergedChildContext=r,Sn(Ii),Sn(gi),dn(gi,r)):Sn(Ii),dn(Ii,h)}var jr=null,Wl=!1,xc=!1;function jl(r){jr===null?jr=[r]:jr.push(r)}function Gh(r){Wl=!0,jl(r)}function us(){if(!xc&&jr!==null){xc=!0;var r=0,a=sn;try{var h=jr;for(sn=1;r<h.length;r++){var x=h[r];do x=x(!0);while(x!==null)}jr=null,Wl=!1}catch(T){throw jr!==null&&(jr=jr.slice(r+1)),ht(gn,us),T}finally{sn=a,xc=!1}}return null}var Zo=[],qi=0,_c=null,Sc=0,Ni=[],li=0,Qo=null,Qe=1,Ar="";function Ns(r,a){Zo[qi++]=Sc,Zo[qi++]=_c,_c=r,Sc=a}function cd(r,a,h){Ni[li++]=Qe,Ni[li++]=Ar,Ni[li++]=Qo,Qo=r;var x=Qe;r=Ar;var T=32-vn(x)-1;x&=~(1<<T),h+=1;var R=32-vn(a)+T;if(30<R){var U=T-T%5;R=(x&(1<<U)-1).toString(32),x>>=U,T-=U,Qe=1<<32-vn(a)+T|h<<T|x,Ar=R+r}else Qe=1<<R|h<<T|x,Ar=r}function fd(r){r.return!==null&&(Ns(r,1),cd(r,1,0))}function Ds(r){for(;r===_c;)_c=Zo[--qi],Zo[qi]=null,Sc=Zo[--qi],Zo[qi]=null;for(;r===Qo;)Qo=Ni[--li],Ni[li]=null,Ar=Ni[--li],Ni[li]=null,Qe=Ni[--li],Ni[li]=null}var vi=null,Di=null,En=!1,Cr=null;function dd(r,a){var h=ms(5,null,null,0);h.elementType="DELETED",h.stateNode=a,h.return=r,a=r.deletions,a===null?(r.deletions=[h],r.flags|=16):a.push(h)}function hd(r,a){switch(r.tag){case 5:var h=r.type;return a=a.nodeType!==1||h.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(r.stateNode=a,vi=r,Di=Rs(a.firstChild),!0):!1;case 6:return a=r.pendingProps===""||a.nodeType!==3?null:a,a!==null?(r.stateNode=a,vi=r,Di=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(h=Qo!==null?{id:Qe,overflow:Ar}:null,r.memoizedState={dehydrated:a,treeContext:h,retryLane:1073741824},h=ms(18,null,null,0),h.stateNode=a,h.return=r,r.child=h,vi=r,Di=null,!0):!1;default:return!1}}function Mc(r){return(r.mode&1)!==0&&(r.flags&128)===0}function wc(r){if(En){var a=Di;if(a){var h=a;if(!hd(r,a)){if(Mc(r))throw Error(t(418));a=Rs(h.nextSibling);var x=vi;a&&hd(r,a)?dd(x,h):(r.flags=r.flags&-4097|2,En=!1,vi=r)}}else{if(Mc(r))throw Error(t(418));r.flags=r.flags&-4097|2,En=!1,vi=r}}}function Ec(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;vi=r}function Va(r){if(r!==vi)return!1;if(!En)return Ec(r),En=!0,!1;var a;if((a=r.tag!==3)&&!(a=r.tag!==5)&&(a=r.type,a=a!=="head"&&a!=="body"&&!id(r.type,r.memoizedProps)),a&&(a=Di)){if(Mc(r))throw pd(),Error(t(418));for(;a;)dd(r,a),a=Rs(a.nextSibling)}if(Ec(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(t(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8){var h=r.data;if(h==="/$"){if(a===0){Di=Rs(r.nextSibling);break e}a--}else h!=="$"&&h!=="$!"&&h!=="$?"||a++}r=r.nextSibling}Di=null}}else Di=vi?Rs(r.stateNode.nextSibling):null;return!0}function pd(){for(var r=Di;r;)r=Rs(r.nextSibling)}function oo(){Di=vi=null,En=!1}function Ga(r){Cr===null?Cr=[r]:Cr.push(r)}var yg=L.ReactCurrentBatchConfig;function Xr(r,a){if(r&&r.defaultProps){a=k({},a),r=r.defaultProps;for(var h in r)a[h]===void 0&&(a[h]=r[h]);return a}return a}var Xl=Nn(null),Yl=null,Ko=null,Tc=null;function Wa(){Tc=Ko=Yl=null}function ja(r){var a=Xl.current;Sn(Xl),r._currentValue=a}function Xa(r,a,h){for(;r!==null;){var x=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,x!==null&&(x.childLanes|=a)):x!==null&&(x.childLanes&a)!==a&&(x.childLanes|=a),r===h)break;r=r.return}}function Us(r,a){Yl=r,Tc=Ko=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&a)!==0&&(rt=!0),r.firstContext=null)}function Ui(r){var a=r._currentValue;if(Tc!==r)if(r={context:r,memoizedValue:a,next:null},Ko===null){if(Yl===null)throw Error(t(308));Ko=r,Yl.dependencies={lanes:0,firstContext:r}}else Ko=Ko.next=r;return a}var Yr=null;function ql(r){Yr===null?Yr=[r]:Yr.push(r)}function Ac(r,a,h,x){var T=a.interleaved;return T===null?(h.next=h,ql(a)):(h.next=T.next,T.next=h),a.interleaved=h,qr(r,x)}function qr(r,a){r.lanes|=a;var h=r.alternate;for(h!==null&&(h.lanes|=a),h=r,r=r.return;r!==null;)r.childLanes|=a,h=r.alternate,h!==null&&(h.childLanes|=a),h=r,r=r.return;return h.tag===3?h.stateNode:null}var Os=!1;function Zl(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wh(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function br(r,a){return{eventTime:r,lane:a,tag:0,payload:null,callback:null,next:null}}function cs(r,a,h){var x=r.updateQueue;if(x===null)return null;if(x=x.shared,(on&2)!==0){var T=x.pending;return T===null?a.next=a:(a.next=T.next,T.next=a),x.pending=a,qr(r,h)}return T=x.interleaved,T===null?(a.next=a,ql(x)):(a.next=T.next,T.next=a),x.interleaved=a,qr(r,h)}function Cn(r,a,h){if(a=a.updateQueue,a!==null&&(a=a.shared,(h&4194240)!==0)){var x=a.lanes;x&=r.pendingLanes,h|=x,a.lanes=h,Ea(r,h)}}function Gt(r,a){var h=r.updateQueue,x=r.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var T=null,R=null;if(h=h.firstBaseUpdate,h!==null){do{var U={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};R===null?T=R=U:R=R.next=U,h=h.next}while(h!==null);R===null?T=R=a:R=R.next=a}else T=R=a;h={baseState:x.baseState,firstBaseUpdate:T,lastBaseUpdate:R,shared:x.shared,effects:x.effects},r.updateQueue=h;return}r=h.lastBaseUpdate,r===null?h.firstBaseUpdate=a:r.next=a,h.lastBaseUpdate=a}function Ln(r,a,h,x){var T=r.updateQueue;Os=!1;var R=T.firstBaseUpdate,U=T.lastBaseUpdate,Z=T.shared.pending;if(Z!==null){T.shared.pending=null;var $=Z,_e=$.next;$.next=null,U===null?R=_e:U.next=_e,U=$;var He=r.alternate;He!==null&&(He=He.updateQueue,Z=He.lastBaseUpdate,Z!==U&&(Z===null?He.firstBaseUpdate=_e:Z.next=_e,He.lastBaseUpdate=$))}if(R!==null){var Ge=T.baseState;U=0,He=_e=$=null,Z=R;do{var Be=Z.lane,at=Z.eventTime;if((x&Be)===Be){He!==null&&(He=He.next={eventTime:at,lane:0,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null});e:{var dt=r,gt=Z;switch(Be=a,at=h,gt.tag){case 1:if(dt=gt.payload,typeof dt=="function"){Ge=dt.call(at,Ge,Be);break e}Ge=dt;break e;case 3:dt.flags=dt.flags&-65537|128;case 0:if(dt=gt.payload,Be=typeof dt=="function"?dt.call(at,Ge,Be):dt,Be==null)break e;Ge=k({},Ge,Be);break e;case 2:Os=!0}}Z.callback!==null&&Z.lane!==0&&(r.flags|=64,Be=T.effects,Be===null?T.effects=[Z]:Be.push(Z))}else at={eventTime:at,lane:Be,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},He===null?(_e=He=at,$=Ge):He=He.next=at,U|=Be;if(Z=Z.next,Z===null){if(Z=T.shared.pending,Z===null)break;Be=Z,Z=Be.next,Be.next=null,T.lastBaseUpdate=Be,T.shared.pending=null}}while(!0);if(He===null&&($=Ge),T.baseState=$,T.firstBaseUpdate=_e,T.lastBaseUpdate=He,a=T.shared.interleaved,a!==null){T=a;do U|=T.lane,T=T.next;while(T!==a)}else R===null&&(T.shared.lanes=0);nu|=U,r.lanes=U,r.memoizedState=Ge}}function Fn(r,a,h){if(r=a.effects,a.effects=null,r!==null)for(a=0;a<r.length;a++){var x=r[a],T=x.callback;if(T!==null){if(x.callback=null,x=h,typeof T!="function")throw Error(t(191,T));T.call(x)}}}var ui=new s.Component().refs;function Oi(r,a,h,x){a=r.memoizedState,h=h(x,a),h=h==null?a:k({},a,h),r.memoizedState=h,r.lanes===0&&(r.updateQueue.baseState=h)}var ks={isMounted:function(r){return(r=r._reactInternals)?H(r)===r:!1},enqueueSetState:function(r,a,h){r=r._reactInternals;var x=hr(),T=il(r),R=br(x,T);R.payload=a,h!=null&&(R.callback=h),a=cs(r,R,T),a!==null&&(Hs(a,r,T,x),Cn(a,r,T))},enqueueReplaceState:function(r,a,h){r=r._reactInternals;var x=hr(),T=il(r),R=br(x,T);R.tag=1,R.payload=a,h!=null&&(R.callback=h),a=cs(r,R,T),a!==null&&(Hs(a,r,T,x),Cn(a,r,T))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var h=hr(),x=il(r),T=br(h,x);T.tag=2,a!=null&&(T.callback=a),a=cs(r,T,x),a!==null&&(Hs(a,r,x,h),Cn(a,r,x))}};function Wn(r,a,h,x,T,R,U){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(x,R,U):a.prototype&&a.prototype.isPureReactComponent?!Ho(h,x)||!Ho(T,R):!0}function Ya(r,a,h){var x=!1,T=Ls,R=a.contextType;return typeof R=="object"&&R!==null?R=Ui(R):(T=Si(a)?Is:gi.current,x=a.contextTypes,R=(x=x!=null)?Yo(r,T):Ls),a=new a(h,R),r.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=ks,r.stateNode=a,a._reactInternals=r,x&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=T,r.__reactInternalMemoizedMaskedChildContext=R),a}function Jo(r,a,h,x){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(h,x),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(h,x),a.state!==r&&ks.enqueueReplaceState(a,a.state,null)}function qa(r,a,h,x){var T=r.stateNode;T.props=h,T.state=r.memoizedState,T.refs=ui,Zl(r);var R=a.contextType;typeof R=="object"&&R!==null?T.context=Ui(R):(R=Si(a)?Is:gi.current,T.context=Yo(r,R)),T.state=r.memoizedState,R=a.getDerivedStateFromProps,typeof R=="function"&&(Oi(r,a,R,h),T.state=r.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(a=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),a!==T.state&&ks.enqueueReplaceState(T,T.state,null),Ln(r,h,T,x),T.state=r.memoizedState),typeof T.componentDidMount=="function"&&(r.flags|=4194308)}function $o(r,a,h){if(r=h.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var x=h.stateNode}if(!x)throw Error(t(147,r));var T=x,R=""+r;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===R?a.ref:(a=function(U){var Z=T.refs;Z===ui&&(Z=T.refs={}),U===null?delete Z[R]:Z[R]=U},a._stringRef=R,a)}if(typeof r!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,r))}return r}function ao(r,a){throw r=Object.prototype.toString.call(a),Error(t(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r))}function ki(r){var a=r._init;return a(r._payload)}function Cc(r){function a(ce,ie){if(r){var he=ce.deletions;he===null?(ce.deletions=[ie],ce.flags|=16):he.push(ie)}}function h(ce,ie){if(!r)return null;for(;ie!==null;)a(ce,ie),ie=ie.sibling;return null}function x(ce,ie){for(ce=new Map;ie!==null;)ie.key!==null?ce.set(ie.key,ie):ce.set(ie.index,ie),ie=ie.sibling;return ce}function T(ce,ie){return ce=sl(ce,ie),ce.index=0,ce.sibling=null,ce}function R(ce,ie,he){return ce.index=he,r?(he=ce.alternate,he!==null?(he=he.index,he<ie?(ce.flags|=2,ie):he):(ce.flags|=2,ie)):(ce.flags|=1048576,ie)}function U(ce){return r&&ce.alternate===null&&(ce.flags|=2),ce}function Z(ce,ie,he,Ye){return ie===null||ie.tag!==6?(ie=kg(he,ce.mode,Ye),ie.return=ce,ie):(ie=T(ie,he),ie.return=ce,ie)}function $(ce,ie,he,Ye){var _t=he.type;return _t===F?He(ce,ie,he.props.children,Ye,he.key):ie!==null&&(ie.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===ye&&ki(_t)===ie.type)?(Ye=T(ie,he.props),Ye.ref=$o(ce,ie,he),Ye.return=ce,Ye):(Ye=pp(he.type,he.key,he.props,null,ce.mode,Ye),Ye.ref=$o(ce,ie,he),Ye.return=ce,Ye)}function _e(ce,ie,he,Ye){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=zg(he,ce.mode,Ye),ie.return=ce,ie):(ie=T(ie,he.children||[]),ie.return=ce,ie)}function He(ce,ie,he,Ye,_t){return ie===null||ie.tag!==7?(ie=ou(he,ce.mode,Ye,_t),ie.return=ce,ie):(ie=T(ie,he),ie.return=ce,ie)}function Ge(ce,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return ie=kg(""+ie,ce.mode,he),ie.return=ce,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case B:return he=pp(ie.type,ie.key,ie.props,null,ce.mode,he),he.ref=$o(ce,null,ie),he.return=ce,he;case D:return ie=zg(ie,ce.mode,he),ie.return=ce,ie;case ye:var Ye=ie._init;return Ge(ce,Ye(ie._payload),he)}if(z(ie)||ee(ie))return ie=ou(ie,ce.mode,he,null),ie.return=ce,ie;ao(ce,ie)}return null}function Be(ce,ie,he,Ye){var _t=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return _t!==null?null:Z(ce,ie,""+he,Ye);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case B:return he.key===_t?$(ce,ie,he,Ye):null;case D:return he.key===_t?_e(ce,ie,he,Ye):null;case ye:return _t=he._init,Be(ce,ie,_t(he._payload),Ye)}if(z(he)||ee(he))return _t!==null?null:He(ce,ie,he,Ye,null);ao(ce,he)}return null}function at(ce,ie,he,Ye,_t){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number")return ce=ce.get(he)||null,Z(ie,ce,""+Ye,_t);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case B:return ce=ce.get(Ye.key===null?he:Ye.key)||null,$(ie,ce,Ye,_t);case D:return ce=ce.get(Ye.key===null?he:Ye.key)||null,_e(ie,ce,Ye,_t);case ye:var Rt=Ye._init;return at(ce,ie,he,Rt(Ye._payload),_t)}if(z(Ye)||ee(Ye))return ce=ce.get(he)||null,He(ie,ce,Ye,_t,null);ao(ie,Ye)}return null}function dt(ce,ie,he,Ye){for(var _t=null,Rt=null,Pt=ie,Ot=ie=0,Ei=null;Pt!==null&&Ot<he.length;Ot++){Pt.index>Ot?(Ei=Pt,Pt=null):Ei=Pt.sibling;var un=Be(ce,Pt,he[Ot],Ye);if(un===null){Pt===null&&(Pt=Ei);break}r&&Pt&&un.alternate===null&&a(ce,Pt),ie=R(un,ie,Ot),Rt===null?_t=un:Rt.sibling=un,Rt=un,Pt=Ei}if(Ot===he.length)return h(ce,Pt),En&&Ns(ce,Ot),_t;if(Pt===null){for(;Ot<he.length;Ot++)Pt=Ge(ce,he[Ot],Ye),Pt!==null&&(ie=R(Pt,ie,Ot),Rt===null?_t=Pt:Rt.sibling=Pt,Rt=Pt);return En&&Ns(ce,Ot),_t}for(Pt=x(ce,Pt);Ot<he.length;Ot++)Ei=at(Pt,ce,Ot,he[Ot],Ye),Ei!==null&&(r&&Ei.alternate!==null&&Pt.delete(Ei.key===null?Ot:Ei.key),ie=R(Ei,ie,Ot),Rt===null?_t=Ei:Rt.sibling=Ei,Rt=Ei);return r&&Pt.forEach(function(ol){return a(ce,ol)}),En&&Ns(ce,Ot),_t}function gt(ce,ie,he,Ye){var _t=ee(he);if(typeof _t!="function")throw Error(t(150));if(he=_t.call(he),he==null)throw Error(t(151));for(var Rt=_t=null,Pt=ie,Ot=ie=0,Ei=null,un=he.next();Pt!==null&&!un.done;Ot++,un=he.next()){Pt.index>Ot?(Ei=Pt,Pt=null):Ei=Pt.sibling;var ol=Be(ce,Pt,un.value,Ye);if(ol===null){Pt===null&&(Pt=Ei);break}r&&Pt&&ol.alternate===null&&a(ce,Pt),ie=R(ol,ie,Ot),Rt===null?_t=ol:Rt.sibling=ol,Rt=ol,Pt=Ei}if(un.done)return h(ce,Pt),En&&Ns(ce,Ot),_t;if(Pt===null){for(;!un.done;Ot++,un=he.next())un=Ge(ce,un.value,Ye),un!==null&&(ie=R(un,ie,Ot),Rt===null?_t=un:Rt.sibling=un,Rt=un);return En&&Ns(ce,Ot),_t}for(Pt=x(ce,Pt);!un.done;Ot++,un=he.next())un=at(Pt,ce,Ot,un.value,Ye),un!==null&&(r&&un.alternate!==null&&Pt.delete(un.key===null?Ot:un.key),ie=R(un,ie,Ot),Rt===null?_t=un:Rt.sibling=un,Rt=un);return r&&Pt.forEach(function(LE){return a(ce,LE)}),En&&Ns(ce,Ot),_t}function Jn(ce,ie,he,Ye){if(typeof he=="object"&&he!==null&&he.type===F&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case B:e:{for(var _t=he.key,Rt=ie;Rt!==null;){if(Rt.key===_t){if(_t=he.type,_t===F){if(Rt.tag===7){h(ce,Rt.sibling),ie=T(Rt,he.props.children),ie.return=ce,ce=ie;break e}}else if(Rt.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===ye&&ki(_t)===Rt.type){h(ce,Rt.sibling),ie=T(Rt,he.props),ie.ref=$o(ce,Rt,he),ie.return=ce,ce=ie;break e}h(ce,Rt);break}else a(ce,Rt);Rt=Rt.sibling}he.type===F?(ie=ou(he.props.children,ce.mode,Ye,he.key),ie.return=ce,ce=ie):(Ye=pp(he.type,he.key,he.props,null,ce.mode,Ye),Ye.ref=$o(ce,ie,he),Ye.return=ce,ce=Ye)}return U(ce);case D:e:{for(Rt=he.key;ie!==null;){if(ie.key===Rt)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){h(ce,ie.sibling),ie=T(ie,he.children||[]),ie.return=ce,ce=ie;break e}else{h(ce,ie);break}else a(ce,ie);ie=ie.sibling}ie=zg(he,ce.mode,Ye),ie.return=ce,ce=ie}return U(ce);case ye:return Rt=he._init,Jn(ce,ie,Rt(he._payload),Ye)}if(z(he))return dt(ce,ie,he,Ye);if(ee(he))return gt(ce,ie,he,Ye);ao(ce,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,ie!==null&&ie.tag===6?(h(ce,ie.sibling),ie=T(ie,he),ie.return=ce,ce=ie):(h(ce,ie),ie=kg(he,ce.mode,Ye),ie.return=ce,ce=ie),U(ce)):h(ce,ie)}return Jn}var lo=Cc(!0),ea=Cc(!1),uo={},Rr=Nn(uo),Pr=Nn(uo),co=Nn(uo);function Zi(r){if(r===uo)throw Error(t(174));return r}function Za(r,a){switch(dn(co,a),dn(Pr,r),dn(Rr,uo),r=a.nodeType,r){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Ke(null,"");break;default:r=r===8?a.parentNode:a,a=r.namespaceURI||null,r=r.tagName,a=Ke(a,r)}Sn(Rr),dn(Rr,a)}function fs(){Sn(Rr),Sn(Pr),Sn(co)}function bc(r){Zi(co.current);var a=Zi(Rr.current),h=Ke(a,r.type);a!==h&&(dn(Pr,r),dn(Rr,h))}function Qa(r){Pr.current===r&&(Sn(Rr),Sn(Pr))}var Mn=Nn(0);function ci(r){for(var a=r;a!==null;){if(a.tag===13){var h=a.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ds=[];function Qi(){for(var r=0;r<ds.length;r++)ds[r]._workInProgressVersionPrimary=null;ds.length=0}var ta=L.ReactCurrentDispatcher,Mi=L.ReactCurrentBatchConfig,fo=0,Tn=null,Bn=null,fi=null,Zr=!1,Ka=!1,Ja=0,md=0;function Dn(){throw Error(t(321))}function Rc(r,a){if(a===null)return!1;for(var h=0;h<a.length&&h<r.length;h++)if(!ar(r[h],a[h]))return!1;return!0}function Pc(r,a,h,x,T,R){if(fo=R,Tn=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,ta.current=r===null||r.memoizedState===null?c:v,r=h(x,T),Ka){R=0;do{if(Ka=!1,Ja=0,25<=R)throw Error(t(301));R+=1,fi=Bn=null,a.updateQueue=null,ta.current=w,r=h(x,T)}while(Ka)}if(ta.current=l,a=Bn!==null&&Bn.next!==null,fo=0,fi=Bn=Tn=null,Zr=!1,a)throw Error(t(300));return r}function Ql(){var r=Ja!==0;return Ja=0,r}function cr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fi===null?Tn.memoizedState=fi=r:fi=fi.next=r,fi}function Lr(){if(Bn===null){var r=Tn.alternate;r=r!==null?r.memoizedState:null}else r=Bn.next;var a=fi===null?Tn.memoizedState:fi.next;if(a!==null)fi=a,Bn=r;else{if(r===null)throw Error(t(310));Bn=r,r={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},fi===null?Tn.memoizedState=fi=r:fi=fi.next=r}return fi}function Kl(r,a){return typeof a=="function"?a(r):a}function Lc(r){var a=Lr(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=r;var x=Bn,T=x.baseQueue,R=h.pending;if(R!==null){if(T!==null){var U=T.next;T.next=R.next,R.next=U}x.baseQueue=T=R,h.pending=null}if(T!==null){R=T.next,x=x.baseState;var Z=U=null,$=null,_e=R;do{var He=_e.lane;if((fo&He)===He)$!==null&&($=$.next={lane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),x=_e.hasEagerState?_e.eagerState:r(x,_e.action);else{var Ge={lane:He,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null};$===null?(Z=$=Ge,U=x):$=$.next=Ge,Tn.lanes|=He,nu|=He}_e=_e.next}while(_e!==null&&_e!==R);$===null?U=x:$.next=Z,ar(x,a.memoizedState)||(rt=!0),a.memoizedState=x,a.baseState=U,a.baseQueue=$,h.lastRenderedState=x}if(r=h.interleaved,r!==null){T=r;do R=T.lane,Tn.lanes|=R,nu|=R,T=T.next;while(T!==r)}else T===null&&(h.lanes=0);return[a.memoizedState,h.dispatch]}function Ic(r){var a=Lr(),h=a.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=r;var x=h.dispatch,T=h.pending,R=a.memoizedState;if(T!==null){h.pending=null;var U=T=T.next;do R=r(R,U.action),U=U.next;while(U!==T);ar(R,a.memoizedState)||(rt=!0),a.memoizedState=R,a.baseQueue===null&&(a.baseState=R),h.lastRenderedState=R}return[R,x]}function ho(){}function jh(r,a){var h=Tn,x=Lr(),T=a(),R=!ar(x.memoizedState,T);if(R&&(x.memoizedState=T,rt=!0),x=x.queue,eu(zi.bind(null,h,x,r),[r]),x.getSnapshot!==a||R||fi!==null&&fi.memoizedState.tag&1){if(h.flags|=2048,Jl(9,gd.bind(null,h,x,T,a),void 0,null),wi===null)throw Error(t(349));(fo&30)!==0||po(h,a,T)}return T}function po(r,a,h){r.flags|=16384,r={getSnapshot:a,value:h},a=Tn.updateQueue,a===null?(a={lastEffect:null,stores:null},Tn.updateQueue=a,a.stores=[r]):(h=a.stores,h===null?a.stores=[r]:h.push(r))}function gd(r,a,h,x){a.value=h,a.getSnapshot=x,Xh(a)&&vd(r)}function zi(r,a,h){return h(function(){Xh(a)&&vd(r)})}function Xh(r){var a=r.getSnapshot;r=r.value;try{var h=a();return!ar(r,h)}catch{return!0}}function vd(r){var a=qr(r,1);a!==null&&Hs(a,r,1,-1)}function Yh(r){var a=cr();return typeof r=="function"&&(r=r()),a.memoizedState=a.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Kl,lastRenderedState:r},a.queue=r,r=r.dispatch=Jh.bind(null,Tn,r),[a.memoizedState,r]}function Jl(r,a,h,x){return r={tag:r,create:a,destroy:h,deps:x,next:null},a=Tn.updateQueue,a===null?(a={lastEffect:null,stores:null},Tn.updateQueue=a,a.lastEffect=r.next=r):(h=a.lastEffect,h===null?a.lastEffect=r.next=r:(x=h.next,h.next=r,r.next=x,a.lastEffect=r)),r}function yd(){return Lr().memoizedState}function $l(r,a,h,x){var T=cr();Tn.flags|=r,T.memoizedState=Jl(1|a,h,void 0,x===void 0?null:x)}function Nc(r,a,h,x){var T=Lr();x=x===void 0?null:x;var R=void 0;if(Bn!==null){var U=Bn.memoizedState;if(R=U.destroy,x!==null&&Rc(x,U.deps)){T.memoizedState=Jl(a,h,R,x);return}}Tn.flags|=r,T.memoizedState=Jl(1|a,h,R,x)}function fr(r,a){return $l(8390656,8,r,a)}function eu(r,a){return Nc(2048,8,r,a)}function qh(r,a){return Nc(4,2,r,a)}function zs(r,a){return Nc(4,4,r,a)}function tu(r,a){if(typeof a=="function")return r=r(),a(r),function(){a(null)};if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function mo(r,a,h){return h=h!=null?h.concat([r]):null,Nc(4,4,tu.bind(null,a,r),h)}function $a(){}function Dc(r,a){var h=Lr();a=a===void 0?null:a;var x=h.memoizedState;return x!==null&&a!==null&&Rc(a,x[1])?x[0]:(h.memoizedState=[r,a],r)}function Uc(r,a){var h=Lr();a=a===void 0?null:a;var x=h.memoizedState;return x!==null&&a!==null&&Rc(a,x[1])?x[0]:(r=r(),h.memoizedState=[r,a],r)}function Zh(r,a,h){return(fo&21)===0?(r.baseState&&(r.baseState=!1,rt=!0),r.memoizedState=h):(ar(h,a)||(h=xr(),Tn.lanes|=h,nu|=h,r.baseState=!0),a)}function Qh(r,a){var h=sn;sn=h!==0&&4>h?h:4,r(!0);var x=Mi.transition;Mi.transition={};try{r(!1),a()}finally{sn=h,Mi.transition=x}}function xd(){return Lr().memoizedState}function Kh(r,a,h){var x=il(r);if(h={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null},Oc(r))$h(a,h);else if(h=Ac(r,a,h,x),h!==null){var T=hr();Hs(h,r,x,T),ep(h,a,x)}}function Jh(r,a,h){var x=il(r),T={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null};if(Oc(r))$h(a,T);else{var R=r.alternate;if(r.lanes===0&&(R===null||R.lanes===0)&&(R=a.lastRenderedReducer,R!==null))try{var U=a.lastRenderedState,Z=R(U,h);if(T.hasEagerState=!0,T.eagerState=Z,ar(Z,U)){var $=a.interleaved;$===null?(T.next=T,ql(a)):(T.next=$.next,$.next=T),a.interleaved=T;return}}catch{}finally{}h=Ac(r,a,T,x),h!==null&&(T=hr(),Hs(h,r,x,T),ep(h,a,x))}}function Oc(r){var a=r.alternate;return r===Tn||a!==null&&a===Tn}function $h(r,a){Ka=Zr=!0;var h=r.pending;h===null?a.next=a:(a.next=h.next,h.next=a),r.pending=a}function ep(r,a,h){if((h&4194240)!==0){var x=a.lanes;x&=r.pendingLanes,h|=x,a.lanes=h,Ea(r,h)}}var l={readContext:Ui,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},c={readContext:Ui,useCallback:function(r,a){return cr().memoizedState=[r,a===void 0?null:a],r},useContext:Ui,useEffect:fr,useImperativeHandle:function(r,a,h){return h=h!=null?h.concat([r]):null,$l(4194308,4,tu.bind(null,a,r),h)},useLayoutEffect:function(r,a){return $l(4194308,4,r,a)},useInsertionEffect:function(r,a){return $l(4,2,r,a)},useMemo:function(r,a){var h=cr();return a=a===void 0?null:a,r=r(),h.memoizedState=[r,a],r},useReducer:function(r,a,h){var x=cr();return a=h!==void 0?h(a):a,x.memoizedState=x.baseState=a,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:a},x.queue=r,r=r.dispatch=Kh.bind(null,Tn,r),[x.memoizedState,r]},useRef:function(r){var a=cr();return r={current:r},a.memoizedState=r},useState:Yh,useDebugValue:$a,useDeferredValue:function(r){return cr().memoizedState=r},useTransition:function(){var r=Yh(!1),a=r[0];return r=Qh.bind(null,r[1]),cr().memoizedState=r,[a,r]},useMutableSource:function(){},useSyncExternalStore:function(r,a,h){var x=Tn,T=cr();if(En){if(h===void 0)throw Error(t(407));h=h()}else{if(h=a(),wi===null)throw Error(t(349));(fo&30)!==0||po(x,a,h)}T.memoizedState=h;var R={value:h,getSnapshot:a};return T.queue=R,fr(zi.bind(null,x,R,r),[r]),x.flags|=2048,Jl(9,gd.bind(null,x,R,h,a),void 0,null),h},useId:function(){var r=cr(),a=wi.identifierPrefix;if(En){var h=Ar,x=Qe;h=(x&~(1<<32-vn(x)-1)).toString(32)+h,a=":"+a+"R"+h,h=Ja++,0<h&&(a+="H"+h.toString(32)),a+=":"}else h=md++,a=":"+a+"r"+h.toString(32)+":";return r.memoizedState=a},unstable_isNewReconciler:!1},v={readContext:Ui,useCallback:Dc,useContext:Ui,useEffect:eu,useImperativeHandle:mo,useInsertionEffect:qh,useLayoutEffect:zs,useMemo:Uc,useReducer:Lc,useRef:yd,useState:function(){return Lc(Kl)},useDebugValue:$a,useDeferredValue:function(r){var a=Lr();return Zh(a,Bn.memoizedState,r)},useTransition:function(){var r=Lc(Kl)[0],a=Lr().memoizedState;return[r,a]},useMutableSource:ho,useSyncExternalStore:jh,useId:xd,unstable_isNewReconciler:!1},w={readContext:Ui,useCallback:Dc,useContext:Ui,useEffect:eu,useImperativeHandle:mo,useInsertionEffect:qh,useLayoutEffect:zs,useMemo:Uc,useReducer:Ic,useRef:yd,useState:function(){return Ic(Kl)},useDebugValue:$a,useDeferredValue:function(r){var a=Lr();return Bn===null?a.memoizedState=r:Zh(a,Bn.memoizedState,r)},useTransition:function(){var r=Ic(Kl)[0],a=Lr().memoizedState;return[r,a]},useMutableSource:ho,useSyncExternalStore:jh,useId:xd,unstable_isNewReconciler:!1};function C(r,a){try{var h="",x=a;do h+=Re(x),x=x.return;while(x);var T=h}catch(R){T=`
Error generating stack: `+R.message+`
`+R.stack}return{value:r,source:a,stack:T,digest:null}}function I(r,a,h){return{value:r,source:null,stack:h??null,digest:a??null}}function Y(r,a){try{console.error(a.value)}catch(h){setTimeout(function(){throw h})}}var re=typeof WeakMap=="function"?WeakMap:Map;function be(r,a,h){h=br(-1,h),h.tag=3,h.payload={element:null};var x=a.value;return h.callback=function(){lp||(lp=!0,Rg=x),Y(r,a)},h}function je(r,a,h){h=br(-1,h),h.tag=3;var x=r.type.getDerivedStateFromError;if(typeof x=="function"){var T=a.value;h.payload=function(){return x(T)},h.callback=function(){Y(r,a)}}var R=r.stateNode;return R!==null&&typeof R.componentDidCatch=="function"&&(h.callback=function(){Y(r,a),typeof x!="function"&&(tl===null?tl=new Set([this]):tl.add(this));var U=a.stack;this.componentDidCatch(a.value,{componentStack:U!==null?U:""})}),h}function lt(r,a,h){var x=r.pingCache;if(x===null){x=r.pingCache=new re;var T=new Set;x.set(a,T)}else T=x.get(a),T===void 0&&(T=new Set,x.set(a,T));T.has(h)||(T.add(h),r=_E.bind(null,r,a,h),a.then(r,r))}function Ft(r){do{var a;if((a=r.tag===13)&&(a=r.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return r;r=r.return}while(r!==null);return null}function Et(r,a,h,x,T){return(r.mode&1)===0?(r===a?r.flags|=65536:(r.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(a=br(-1,1),a.tag=2,cs(h,a,1))),h.lanes|=1),r):(r.flags|=65536,r.lanes=T,r)}var hn=L.ReactCurrentOwner,rt=!1;function ln(r,a,h,x){a.child=r===null?ea(a,null,h,x):lo(a,r.child,h,x)}function dr(r,a,h,x,T){h=h.render;var R=a.ref;return Us(a,T),x=Pc(r,a,h,x,R,T),h=Ql(),r!==null&&!rt?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~T,na(r,a,T)):(En&&h&&fd(a),a.flags|=1,ln(r,a,x,T),a.child)}function pe(r,a,h,x,T){if(r===null){var R=h.type;return typeof R=="function"&&!Og(R)&&R.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(a.tag=15,a.type=R,oe(r,a,R,x,T)):(r=pp(h.type,null,x,a,a.mode,T),r.ref=a.ref,r.return=a,a.child=r)}if(R=r.child,(r.lanes&T)===0){var U=R.memoizedProps;if(h=h.compare,h=h!==null?h:Ho,h(U,x)&&r.ref===a.ref)return na(r,a,T)}return a.flags|=1,r=sl(R,x),r.ref=a.ref,r.return=a,a.child=r}function oe(r,a,h,x,T){if(r!==null){var R=r.memoizedProps;if(Ho(R,x)&&r.ref===a.ref)if(rt=!1,a.pendingProps=x=R,(r.lanes&T)!==0)(r.flags&131072)!==0&&(rt=!0);else return a.lanes=r.lanes,na(r,a,T)}return mt(r,a,h,x,T)}function we(r,a,h){var x=a.pendingProps,T=x.children,R=r!==null?r.memoizedState:null;if(x.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},dn(zc,Qr),Qr|=h;else{if((h&1073741824)===0)return r=R!==null?R.baseLanes|h:h,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:r,cachePool:null,transitions:null},a.updateQueue=null,dn(zc,Qr),Qr|=r,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=R!==null?R.baseLanes:h,dn(zc,Qr),Qr|=x}else R!==null?(x=R.baseLanes|h,a.memoizedState=null):x=h,dn(zc,Qr),Qr|=x;return ln(r,a,T,h),a.child}function it(r,a){var h=a.ref;(r===null&&h!==null||r!==null&&r.ref!==h)&&(a.flags|=512,a.flags|=2097152)}function mt(r,a,h,x,T){var R=Si(h)?Is:gi.current;return R=Yo(a,R),Us(a,T),h=Pc(r,a,h,x,R,T),x=Ql(),r!==null&&!rt?(a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~T,na(r,a,T)):(En&&x&&fd(a),a.flags|=1,ln(r,a,h,T),a.child)}function Ht(r,a,h,x,T){if(Si(h)){var R=!0;qo(a)}else R=!1;if(Us(a,T),a.stateNode===null)ip(r,a),Ya(a,h,x),qa(a,h,x,T),x=!0;else if(r===null){var U=a.stateNode,Z=a.memoizedProps;U.props=Z;var $=U.context,_e=h.contextType;typeof _e=="object"&&_e!==null?_e=Ui(_e):(_e=Si(h)?Is:gi.current,_e=Yo(a,_e));var He=h.getDerivedStateFromProps,Ge=typeof He=="function"||typeof U.getSnapshotBeforeUpdate=="function";Ge||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(Z!==x||$!==_e)&&Jo(a,U,x,_e),Os=!1;var Be=a.memoizedState;U.state=Be,Ln(a,x,U,T),$=a.memoizedState,Z!==x||Be!==$||Ii.current||Os?(typeof He=="function"&&(Oi(a,h,He,x),$=a.memoizedState),(Z=Os||Wn(a,h,Z,x,Be,$,_e))?(Ge||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(a.flags|=4194308)):(typeof U.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=x,a.memoizedState=$),U.props=x,U.state=$,U.context=_e,x=Z):(typeof U.componentDidMount=="function"&&(a.flags|=4194308),x=!1)}else{U=a.stateNode,Wh(r,a),Z=a.memoizedProps,_e=a.type===a.elementType?Z:Xr(a.type,Z),U.props=_e,Ge=a.pendingProps,Be=U.context,$=h.contextType,typeof $=="object"&&$!==null?$=Ui($):($=Si(h)?Is:gi.current,$=Yo(a,$));var at=h.getDerivedStateFromProps;(He=typeof at=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(Z!==Ge||Be!==$)&&Jo(a,U,x,$),Os=!1,Be=a.memoizedState,U.state=Be,Ln(a,x,U,T);var dt=a.memoizedState;Z!==Ge||Be!==dt||Ii.current||Os?(typeof at=="function"&&(Oi(a,h,at,x),dt=a.memoizedState),(_e=Os||Wn(a,h,_e,x,Be,dt,$)||!1)?(He||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(x,dt,$),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(x,dt,$)),typeof U.componentDidUpdate=="function"&&(a.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof U.componentDidUpdate!="function"||Z===r.memoizedProps&&Be===r.memoizedState||(a.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Z===r.memoizedProps&&Be===r.memoizedState||(a.flags|=1024),a.memoizedProps=x,a.memoizedState=dt),U.props=x,U.state=dt,U.context=$,x=_e):(typeof U.componentDidUpdate!="function"||Z===r.memoizedProps&&Be===r.memoizedState||(a.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||Z===r.memoizedProps&&Be===r.memoizedState||(a.flags|=1024),x=!1)}return Ut(r,a,h,x,R,T)}function Ut(r,a,h,x,T,R){it(r,a);var U=(a.flags&128)!==0;if(!x&&!U)return T&&ud(a,h,!1),na(r,a,R);x=a.stateNode,hn.current=a;var Z=U&&typeof h.getDerivedStateFromError!="function"?null:x.render();return a.flags|=1,r!==null&&U?(a.child=lo(a,r.child,null,R),a.child=lo(a,null,Z,R)):ln(r,a,Z,R),a.memoizedState=x.state,T&&ud(a,h,!0),a.child}function tn(r){var a=r.stateNode;a.pendingContext?ld(r,a.pendingContext,a.pendingContext!==a.context):a.context&&ld(r,a.context,!1),Za(r,a.containerInfo)}function Kn(r,a,h,x,T){return oo(),Ga(T),a.flags|=256,ln(r,a,h,x),a.child}var en={dehydrated:null,treeContext:null,retryLane:0};function hs(r){return{baseLanes:r,cachePool:null,transitions:null}}function tp(r,a,h){var x=a.pendingProps,T=Mn.current,R=!1,U=(a.flags&128)!==0,Z;if((Z=U)||(Z=r!==null&&r.memoizedState===null?!1:(T&2)!==0),Z?(R=!0,a.flags&=-129):(r===null||r.memoizedState!==null)&&(T|=1),dn(Mn,T&1),r===null)return wc(a),r=a.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((a.mode&1)===0?a.lanes=1:r.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(U=x.children,r=x.fallback,R?(x=a.mode,R=a.child,U={mode:"hidden",children:U},(x&1)===0&&R!==null?(R.childLanes=0,R.pendingProps=U):R=mp(U,x,0,null),r=ou(r,x,h,null),R.return=a,r.return=a,R.sibling=r,a.child=R,a.child.memoizedState=hs(h),a.memoizedState=en,r):xg(a,U));if(T=r.memoizedState,T!==null&&(Z=T.dehydrated,Z!==null))return lE(r,a,U,x,Z,T,h);if(R){R=x.fallback,U=a.mode,T=r.child,Z=T.sibling;var $={mode:"hidden",children:x.children};return(U&1)===0&&a.child!==T?(x=a.child,x.childLanes=0,x.pendingProps=$,a.deletions=null):(x=sl(T,$),x.subtreeFlags=T.subtreeFlags&14680064),Z!==null?R=sl(Z,R):(R=ou(R,U,h,null),R.flags|=2),R.return=a,x.return=a,x.sibling=R,a.child=x,x=R,R=a.child,U=r.child.memoizedState,U=U===null?hs(h):{baseLanes:U.baseLanes|h,cachePool:null,transitions:U.transitions},R.memoizedState=U,R.childLanes=r.childLanes&~h,a.memoizedState=en,x}return R=r.child,r=R.sibling,x=sl(R,{mode:"visible",children:x.children}),(a.mode&1)===0&&(x.lanes=h),x.return=a,x.sibling=null,r!==null&&(h=a.deletions,h===null?(a.deletions=[r],a.flags|=16):h.push(r)),a.child=x,a.memoizedState=null,x}function xg(r,a){return a=mp({mode:"visible",children:a},r.mode,0,null),a.return=r,r.child=a}function np(r,a,h,x){return x!==null&&Ga(x),lo(a,r.child,null,h),r=xg(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function lE(r,a,h,x,T,R,U){if(h)return a.flags&256?(a.flags&=-257,x=I(Error(t(422))),np(r,a,U,x)):a.memoizedState!==null?(a.child=r.child,a.flags|=128,null):(R=x.fallback,T=a.mode,x=mp({mode:"visible",children:x.children},T,0,null),R=ou(R,T,U,null),R.flags|=2,x.return=a,R.return=a,x.sibling=R,a.child=x,(a.mode&1)!==0&&lo(a,r.child,null,U),a.child.memoizedState=hs(U),a.memoizedState=en,R);if((a.mode&1)===0)return np(r,a,U,null);if(T.data==="$!"){if(x=T.nextSibling&&T.nextSibling.dataset,x)var Z=x.dgst;return x=Z,R=Error(t(419)),x=I(R,x,void 0),np(r,a,U,x)}if(Z=(U&r.childLanes)!==0,rt||Z){if(x=wi,x!==null){switch(U&-U){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(x.suspendedLanes|U))!==0?0:T,T!==0&&T!==R.retryLane&&(R.retryLane=T,qr(r,T),Hs(x,r,T,-1))}return Ug(),x=I(Error(t(421))),np(r,a,U,x)}return T.data==="$?"?(a.flags|=128,a.child=r.child,a=SE.bind(null,r),T._reactRetry=a,null):(r=R.treeContext,Di=Rs(T.nextSibling),vi=a,En=!0,Cr=null,r!==null&&(Ni[li++]=Qe,Ni[li++]=Ar,Ni[li++]=Qo,Qe=r.id,Ar=r.overflow,Qo=a),a=xg(a,x.children),a.flags|=4096,a)}function Zy(r,a,h){r.lanes|=a;var x=r.alternate;x!==null&&(x.lanes|=a),Xa(r.return,a,h)}function _g(r,a,h,x,T){var R=r.memoizedState;R===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:T}:(R.isBackwards=a,R.rendering=null,R.renderingStartTime=0,R.last=x,R.tail=h,R.tailMode=T)}function Qy(r,a,h){var x=a.pendingProps,T=x.revealOrder,R=x.tail;if(ln(r,a,x.children,h),x=Mn.current,(x&2)!==0)x=x&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Zy(r,h,a);else if(r.tag===19)Zy(r,h,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}x&=1}if(dn(Mn,x),(a.mode&1)===0)a.memoizedState=null;else switch(T){case"forwards":for(h=a.child,T=null;h!==null;)r=h.alternate,r!==null&&ci(r)===null&&(T=h),h=h.sibling;h=T,h===null?(T=a.child,a.child=null):(T=h.sibling,h.sibling=null),_g(a,!1,T,h,R);break;case"backwards":for(h=null,T=a.child,a.child=null;T!==null;){if(r=T.alternate,r!==null&&ci(r)===null){a.child=T;break}r=T.sibling,T.sibling=h,h=T,T=r}_g(a,!0,h,null,R);break;case"together":_g(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function ip(r,a){(a.mode&1)===0&&r!==null&&(r.alternate=null,a.alternate=null,a.flags|=2)}function na(r,a,h){if(r!==null&&(a.dependencies=r.dependencies),nu|=a.lanes,(h&a.childLanes)===0)return null;if(r!==null&&a.child!==r.child)throw Error(t(153));if(a.child!==null){for(r=a.child,h=sl(r,r.pendingProps),a.child=h,h.return=a;r.sibling!==null;)r=r.sibling,h=h.sibling=sl(r,r.pendingProps),h.return=a;h.sibling=null}return a.child}function uE(r,a,h){switch(a.tag){case 3:tn(a),oo();break;case 5:bc(a);break;case 1:Si(a.type)&&qo(a);break;case 4:Za(a,a.stateNode.containerInfo);break;case 10:var x=a.type._context,T=a.memoizedProps.value;dn(Xl,x._currentValue),x._currentValue=T;break;case 13:if(x=a.memoizedState,x!==null)return x.dehydrated!==null?(dn(Mn,Mn.current&1),a.flags|=128,null):(h&a.child.childLanes)!==0?tp(r,a,h):(dn(Mn,Mn.current&1),r=na(r,a,h),r!==null?r.sibling:null);dn(Mn,Mn.current&1);break;case 19:if(x=(h&a.childLanes)!==0,(r.flags&128)!==0){if(x)return Qy(r,a,h);a.flags|=128}if(T=a.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),dn(Mn,Mn.current),x)break;return null;case 22:case 23:return a.lanes=0,we(r,a,h)}return na(r,a,h)}var Ky,Sg,Jy,$y;Ky=function(r,a){for(var h=a.child;h!==null;){if(h.tag===5||h.tag===6)r.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Sg=function(){},Jy=function(r,a,h,x){var T=r.memoizedProps;if(T!==x){r=a.stateNode,Zi(Rr.current);var R=null;switch(h){case"input":T=De(r,T),x=De(r,x),R=[];break;case"select":T=k({},T,{value:void 0}),x=k({},x,{value:void 0}),R=[];break;case"textarea":T=Ie(r,T),x=Ie(r,x),R=[];break;default:typeof T.onClick!="function"&&typeof x.onClick=="function"&&(r.onclick=Hl)}ne(h,x);var U;h=null;for(_e in T)if(!x.hasOwnProperty(_e)&&T.hasOwnProperty(_e)&&T[_e]!=null)if(_e==="style"){var Z=T[_e];for(U in Z)Z.hasOwnProperty(U)&&(h||(h={}),h[U]="")}else _e!=="dangerouslySetInnerHTML"&&_e!=="children"&&_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&_e!=="autoFocus"&&(i.hasOwnProperty(_e)?R||(R=[]):(R=R||[]).push(_e,null));for(_e in x){var $=x[_e];if(Z=T!=null?T[_e]:void 0,x.hasOwnProperty(_e)&&$!==Z&&($!=null||Z!=null))if(_e==="style")if(Z){for(U in Z)!Z.hasOwnProperty(U)||$&&$.hasOwnProperty(U)||(h||(h={}),h[U]="");for(U in $)$.hasOwnProperty(U)&&Z[U]!==$[U]&&(h||(h={}),h[U]=$[U])}else h||(R||(R=[]),R.push(_e,h)),h=$;else _e==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,Z=Z?Z.__html:void 0,$!=null&&Z!==$&&(R=R||[]).push(_e,$)):_e==="children"?typeof $!="string"&&typeof $!="number"||(R=R||[]).push(_e,""+$):_e!=="suppressContentEditableWarning"&&_e!=="suppressHydrationWarning"&&(i.hasOwnProperty(_e)?($!=null&&_e==="onScroll"&&_n("scroll",r),R||Z===$||(R=[])):(R=R||[]).push(_e,$))}h&&(R=R||[]).push("style",h);var _e=R;(a.updateQueue=_e)&&(a.flags|=4)}},$y=function(r,a,h,x){h!==x&&(a.flags|=4)};function _d(r,a){if(!En)switch(r.tailMode){case"hidden":a=r.tail;for(var h=null;a!==null;)a.alternate!==null&&(h=a),a=a.sibling;h===null?r.tail=null:h.sibling=null;break;case"collapsed":h=r.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:x.sibling=null}}function Ki(r){var a=r.alternate!==null&&r.alternate.child===r.child,h=0,x=0;if(a)for(var T=r.child;T!==null;)h|=T.lanes|T.childLanes,x|=T.subtreeFlags&14680064,x|=T.flags&14680064,T.return=r,T=T.sibling;else for(T=r.child;T!==null;)h|=T.lanes|T.childLanes,x|=T.subtreeFlags,x|=T.flags,T.return=r,T=T.sibling;return r.subtreeFlags|=x,r.childLanes=h,a}function cE(r,a,h){var x=a.pendingProps;switch(Ds(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ki(a),null;case 1:return Si(a.type)&&Vl(),Ki(a),null;case 3:return x=a.stateNode,fs(),Sn(Ii),Sn(gi),Qi(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(r===null||r.child===null)&&(Va(a)?a.flags|=4:r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Cr!==null&&(Ig(Cr),Cr=null))),Sg(r,a),Ki(a),null;case 5:Qa(a);var T=Zi(co.current);if(h=a.type,r!==null&&a.stateNode!=null)Jy(r,a,h,x,T),r.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!x){if(a.stateNode===null)throw Error(t(166));return Ki(a),null}if(r=Zi(Rr.current),Va(a)){x=a.stateNode,h=a.type;var R=a.memoizedProps;switch(x[Qn]=a,x[Ha]=R,r=(a.mode&1)!==0,h){case"dialog":_n("cancel",x),_n("close",x);break;case"iframe":case"object":case"embed":_n("load",x);break;case"video":case"audio":for(T=0;T<ro.length;T++)_n(ro[T],x);break;case"source":_n("error",x);break;case"img":case"image":case"link":_n("error",x),_n("load",x);break;case"details":_n("toggle",x);break;case"input":Xe(x,R),_n("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!R.multiple},_n("invalid",x);break;case"textarea":ze(x,R),_n("invalid",x)}ne(h,R),T=null;for(var U in R)if(R.hasOwnProperty(U)){var Z=R[U];U==="children"?typeof Z=="string"?x.textContent!==Z&&(R.suppressHydrationWarning!==!0&&Bl(x.textContent,Z,r),T=["children",Z]):typeof Z=="number"&&x.textContent!==""+Z&&(R.suppressHydrationWarning!==!0&&Bl(x.textContent,Z,r),T=["children",""+Z]):i.hasOwnProperty(U)&&Z!=null&&U==="onScroll"&&_n("scroll",x)}switch(h){case"input":Mt(x),$e(x,R,!0);break;case"textarea":Mt(x),vt(x);break;case"select":case"option":break;default:typeof R.onClick=="function"&&(x.onclick=Hl)}x=T,a.updateQueue=x,x!==null&&(a.flags|=4)}else{U=T.nodeType===9?T:T.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Je(h)),r==="http://www.w3.org/1999/xhtml"?h==="script"?(r=U.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof x.is=="string"?r=U.createElement(h,{is:x.is}):(r=U.createElement(h),h==="select"&&(U=r,x.multiple?U.multiple=!0:x.size&&(U.size=x.size))):r=U.createElementNS(r,h),r[Qn]=a,r[Ha]=x,Ky(r,a,!1,!1),a.stateNode=r;e:{switch(U=Pe(h,x),h){case"dialog":_n("cancel",r),_n("close",r),T=x;break;case"iframe":case"object":case"embed":_n("load",r),T=x;break;case"video":case"audio":for(T=0;T<ro.length;T++)_n(ro[T],r);T=x;break;case"source":_n("error",r),T=x;break;case"img":case"image":case"link":_n("error",r),_n("load",r),T=x;break;case"details":_n("toggle",r),T=x;break;case"input":Xe(r,x),T=De(r,x),_n("invalid",r);break;case"option":T=x;break;case"select":r._wrapperState={wasMultiple:!!x.multiple},T=k({},x,{value:void 0}),_n("invalid",r);break;case"textarea":ze(r,x),T=Ie(r,x),_n("invalid",r);break;default:T=x}ne(h,T),Z=T;for(R in Z)if(Z.hasOwnProperty(R)){var $=Z[R];R==="style"?Dt(r,$):R==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&qe(r,$)):R==="children"?typeof $=="string"?(h!=="textarea"||$!=="")&&ft(r,$):typeof $=="number"&&ft(r,""+$):R!=="suppressContentEditableWarning"&&R!=="suppressHydrationWarning"&&R!=="autoFocus"&&(i.hasOwnProperty(R)?$!=null&&R==="onScroll"&&_n("scroll",r):$!=null&&b(r,R,$,U))}switch(h){case"input":Mt(r),$e(r,x,!1);break;case"textarea":Mt(r),vt(r);break;case"option":x.value!=null&&r.setAttribute("value",""+tt(x.value));break;case"select":r.multiple=!!x.multiple,R=x.value,R!=null?de(r,!!x.multiple,R,!1):x.defaultValue!=null&&de(r,!!x.multiple,x.defaultValue,!0);break;default:typeof T.onClick=="function"&&(r.onclick=Hl)}switch(h){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Ki(a),null;case 6:if(r&&a.stateNode!=null)$y(r,a,r.memoizedProps,x);else{if(typeof x!="string"&&a.stateNode===null)throw Error(t(166));if(h=Zi(co.current),Zi(Rr.current),Va(a)){if(x=a.stateNode,h=a.memoizedProps,x[Qn]=a,(R=x.nodeValue!==h)&&(r=vi,r!==null))switch(r.tag){case 3:Bl(x.nodeValue,h,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Bl(x.nodeValue,h,(r.mode&1)!==0)}R&&(a.flags|=4)}else x=(h.nodeType===9?h:h.ownerDocument).createTextNode(x),x[Qn]=a,a.stateNode=x}return Ki(a),null;case 13:if(Sn(Mn),x=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(En&&Di!==null&&(a.mode&1)!==0&&(a.flags&128)===0)pd(),oo(),a.flags|=98560,R=!1;else if(R=Va(a),x!==null&&x.dehydrated!==null){if(r===null){if(!R)throw Error(t(318));if(R=a.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(t(317));R[Qn]=a}else oo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ki(a),R=!1}else Cr!==null&&(Ig(Cr),Cr=null),R=!0;if(!R)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=h,a):(x=x!==null,x!==(r!==null&&r.memoizedState!==null)&&x&&(a.child.flags|=8192,(a.mode&1)!==0&&(r===null||(Mn.current&1)!==0?yi===0&&(yi=3):Ug())),a.updateQueue!==null&&(a.flags|=4),Ki(a),null);case 4:return fs(),Sg(r,a),r===null&&za(a.stateNode.containerInfo),Ki(a),null;case 10:return ja(a.type._context),Ki(a),null;case 17:return Si(a.type)&&Vl(),Ki(a),null;case 19:if(Sn(Mn),R=a.memoizedState,R===null)return Ki(a),null;if(x=(a.flags&128)!==0,U=R.rendering,U===null)if(x)_d(R,!1);else{if(yi!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(U=ci(r),U!==null){for(a.flags|=128,_d(R,!1),x=U.updateQueue,x!==null&&(a.updateQueue=x,a.flags|=4),a.subtreeFlags=0,x=h,h=a.child;h!==null;)R=h,r=x,R.flags&=14680066,U=R.alternate,U===null?(R.childLanes=0,R.lanes=r,R.child=null,R.subtreeFlags=0,R.memoizedProps=null,R.memoizedState=null,R.updateQueue=null,R.dependencies=null,R.stateNode=null):(R.childLanes=U.childLanes,R.lanes=U.lanes,R.child=U.child,R.subtreeFlags=0,R.deletions=null,R.memoizedProps=U.memoizedProps,R.memoizedState=U.memoizedState,R.updateQueue=U.updateQueue,R.type=U.type,r=U.dependencies,R.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),h=h.sibling;return dn(Mn,Mn.current&1|2),a.child}r=r.sibling}R.tail!==null&&ut()>Fc&&(a.flags|=128,x=!0,_d(R,!1),a.lanes=4194304)}else{if(!x)if(r=ci(U),r!==null){if(a.flags|=128,x=!0,h=r.updateQueue,h!==null&&(a.updateQueue=h,a.flags|=4),_d(R,!0),R.tail===null&&R.tailMode==="hidden"&&!U.alternate&&!En)return Ki(a),null}else 2*ut()-R.renderingStartTime>Fc&&h!==1073741824&&(a.flags|=128,x=!0,_d(R,!1),a.lanes=4194304);R.isBackwards?(U.sibling=a.child,a.child=U):(h=R.last,h!==null?h.sibling=U:a.child=U,R.last=U)}return R.tail!==null?(a=R.tail,R.rendering=a,R.tail=a.sibling,R.renderingStartTime=ut(),a.sibling=null,h=Mn.current,dn(Mn,x?h&1|2:h&1),a):(Ki(a),null);case 22:case 23:return Dg(),x=a.memoizedState!==null,r!==null&&r.memoizedState!==null!==x&&(a.flags|=8192),x&&(a.mode&1)!==0?(Qr&1073741824)!==0&&(Ki(a),a.subtreeFlags&6&&(a.flags|=8192)):Ki(a),null;case 24:return null;case 25:return null}throw Error(t(156,a.tag))}function fE(r,a){switch(Ds(a),a.tag){case 1:return Si(a.type)&&Vl(),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return fs(),Sn(Ii),Sn(gi),Qi(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 5:return Qa(a),null;case 13:if(Sn(Mn),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(t(340));oo()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return Sn(Mn),null;case 4:return fs(),null;case 10:return ja(a.type._context),null;case 22:case 23:return Dg(),null;case 24:return null;default:return null}}var rp=!1,Ji=!1,dE=typeof WeakSet=="function"?WeakSet:Set,ct=null;function kc(r,a){var h=r.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(x){jn(r,a,x)}else h.current=null}function Mg(r,a,h){try{h()}catch(x){jn(r,a,x)}}var ex=!1;function hE(r,a){if(Ba=_r,r=Pn(),ri(r)){if("selectionStart"in r)var h={start:r.selectionStart,end:r.selectionEnd};else e:{h=(h=r.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var T=x.anchorOffset,R=x.focusNode;x=x.focusOffset;try{h.nodeType,R.nodeType}catch{h=null;break e}var U=0,Z=-1,$=-1,_e=0,He=0,Ge=r,Be=null;t:for(;;){for(var at;Ge!==h||T!==0&&Ge.nodeType!==3||(Z=U+T),Ge!==R||x!==0&&Ge.nodeType!==3||($=U+x),Ge.nodeType===3&&(U+=Ge.nodeValue.length),(at=Ge.firstChild)!==null;)Be=Ge,Ge=at;for(;;){if(Ge===r)break t;if(Be===h&&++_e===T&&(Z=U),Be===R&&++He===x&&($=U),(at=Ge.nextSibling)!==null)break;Ge=Be,Be=Ge.parentNode}Ge=at}h=Z===-1||$===-1?null:{start:Z,end:$}}else h=null}h=h||{start:0,end:0}}else h=null;for(nd={focusedElem:r,selectionRange:h},_r=!1,ct=a;ct!==null;)if(a=ct,r=a.child,(a.subtreeFlags&1028)!==0&&r!==null)r.return=a,ct=r;else for(;ct!==null;){a=ct;try{var dt=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(dt!==null){var gt=dt.memoizedProps,Jn=dt.memoizedState,ce=a.stateNode,ie=ce.getSnapshotBeforeUpdate(a.elementType===a.type?gt:Xr(a.type,gt),Jn);ce.__reactInternalSnapshotBeforeUpdate=ie}break;case 3:var he=a.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ye){jn(a,a.return,Ye)}if(r=a.sibling,r!==null){r.return=a.return,ct=r;break}ct=a.return}return dt=ex,ex=!1,dt}function Sd(r,a,h){var x=a.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var T=x=x.next;do{if((T.tag&r)===r){var R=T.destroy;T.destroy=void 0,R!==void 0&&Mg(a,h,R)}T=T.next}while(T!==x)}}function sp(r,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var h=a=a.next;do{if((h.tag&r)===r){var x=h.create;h.destroy=x()}h=h.next}while(h!==a)}}function wg(r){var a=r.ref;if(a!==null){var h=r.stateNode;switch(r.tag){case 5:r=h;break;default:r=h}typeof a=="function"?a(r):a.current=r}}function tx(r){var a=r.alternate;a!==null&&(r.alternate=null,tx(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&(delete a[Qn],delete a[Ha],delete a[Xo],delete a[gc],delete a[vc])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function nx(r){return r.tag===5||r.tag===3||r.tag===4}function ix(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||nx(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Eg(r,a,h){var x=r.tag;if(x===5||x===6)r=r.stateNode,a?h.nodeType===8?h.parentNode.insertBefore(r,a):h.insertBefore(r,a):(h.nodeType===8?(a=h.parentNode,a.insertBefore(r,h)):(a=h,a.appendChild(r)),h=h._reactRootContainer,h!=null||a.onclick!==null||(a.onclick=Hl));else if(x!==4&&(r=r.child,r!==null))for(Eg(r,a,h),r=r.sibling;r!==null;)Eg(r,a,h),r=r.sibling}function Tg(r,a,h){var x=r.tag;if(x===5||x===6)r=r.stateNode,a?h.insertBefore(r,a):h.appendChild(r);else if(x!==4&&(r=r.child,r!==null))for(Tg(r,a,h),r=r.sibling;r!==null;)Tg(r,a,h),r=r.sibling}var Fi=null,Fs=!1;function el(r,a,h){for(h=h.child;h!==null;)rx(r,a,h),h=h.sibling}function rx(r,a,h){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(wt,h)}catch{}switch(h.tag){case 5:Ji||kc(h,a);case 6:var x=Fi,T=Fs;Fi=null,el(r,a,h),Fi=x,Fs=T,Fi!==null&&(Fs?(r=Fi,h=h.stateNode,r.nodeType===8?r.parentNode.removeChild(h):r.removeChild(h)):Fi.removeChild(h.stateNode));break;case 18:Fi!==null&&(Fs?(r=Fi,h=h.stateNode,r.nodeType===8?mc(r.parentNode,h):r.nodeType===1&&mc(r,h),Rl(r)):mc(Fi,h.stateNode));break;case 4:x=Fi,T=Fs,Fi=h.stateNode.containerInfo,Fs=!0,el(r,a,h),Fi=x,Fs=T;break;case 0:case 11:case 14:case 15:if(!Ji&&(x=h.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){T=x=x.next;do{var R=T,U=R.destroy;R=R.tag,U!==void 0&&((R&2)!==0||(R&4)!==0)&&Mg(h,a,U),T=T.next}while(T!==x)}el(r,a,h);break;case 1:if(!Ji&&(kc(h,a),x=h.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=h.memoizedProps,x.state=h.memoizedState,x.componentWillUnmount()}catch(Z){jn(h,a,Z)}el(r,a,h);break;case 21:el(r,a,h);break;case 22:h.mode&1?(Ji=(x=Ji)||h.memoizedState!==null,el(r,a,h),Ji=x):el(r,a,h);break;default:el(r,a,h)}}function sx(r){var a=r.updateQueue;if(a!==null){r.updateQueue=null;var h=r.stateNode;h===null&&(h=r.stateNode=new dE),a.forEach(function(x){var T=ME.bind(null,r,x);h.has(x)||(h.add(x),x.then(T,T))})}}function Bs(r,a){var h=a.deletions;if(h!==null)for(var x=0;x<h.length;x++){var T=h[x];try{var R=r,U=a,Z=U;e:for(;Z!==null;){switch(Z.tag){case 5:Fi=Z.stateNode,Fs=!1;break e;case 3:Fi=Z.stateNode.containerInfo,Fs=!0;break e;case 4:Fi=Z.stateNode.containerInfo,Fs=!0;break e}Z=Z.return}if(Fi===null)throw Error(t(160));rx(R,U,T),Fi=null,Fs=!1;var $=T.alternate;$!==null&&($.return=null),T.return=null}catch(_e){jn(T,a,_e)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)ox(a,r),a=a.sibling}function ox(r,a){var h=r.alternate,x=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Bs(a,r),go(r),x&4){try{Sd(3,r,r.return),sp(3,r)}catch(gt){jn(r,r.return,gt)}try{Sd(5,r,r.return)}catch(gt){jn(r,r.return,gt)}}break;case 1:Bs(a,r),go(r),x&512&&h!==null&&kc(h,h.return);break;case 5:if(Bs(a,r),go(r),x&512&&h!==null&&kc(h,h.return),r.flags&32){var T=r.stateNode;try{ft(T,"")}catch(gt){jn(r,r.return,gt)}}if(x&4&&(T=r.stateNode,T!=null)){var R=r.memoizedProps,U=h!==null?h.memoizedProps:R,Z=r.type,$=r.updateQueue;if(r.updateQueue=null,$!==null)try{Z==="input"&&R.type==="radio"&&R.name!=null&&xe(T,R),Pe(Z,U);var _e=Pe(Z,R);for(U=0;U<$.length;U+=2){var He=$[U],Ge=$[U+1];He==="style"?Dt(T,Ge):He==="dangerouslySetInnerHTML"?qe(T,Ge):He==="children"?ft(T,Ge):b(T,He,Ge,_e)}switch(Z){case"input":Fe(T,R);break;case"textarea":Ue(T,R);break;case"select":var Be=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!R.multiple;var at=R.value;at!=null?de(T,!!R.multiple,at,!1):Be!==!!R.multiple&&(R.defaultValue!=null?de(T,!!R.multiple,R.defaultValue,!0):de(T,!!R.multiple,R.multiple?[]:"",!1))}T[Ha]=R}catch(gt){jn(r,r.return,gt)}}break;case 6:if(Bs(a,r),go(r),x&4){if(r.stateNode===null)throw Error(t(162));T=r.stateNode,R=r.memoizedProps;try{T.nodeValue=R}catch(gt){jn(r,r.return,gt)}}break;case 3:if(Bs(a,r),go(r),x&4&&h!==null&&h.memoizedState.isDehydrated)try{Rl(a.containerInfo)}catch(gt){jn(r,r.return,gt)}break;case 4:Bs(a,r),go(r);break;case 13:Bs(a,r),go(r),T=r.child,T.flags&8192&&(R=T.memoizedState!==null,T.stateNode.isHidden=R,!R||T.alternate!==null&&T.alternate.memoizedState!==null||(bg=ut())),x&4&&sx(r);break;case 22:if(He=h!==null&&h.memoizedState!==null,r.mode&1?(Ji=(_e=Ji)||He,Bs(a,r),Ji=_e):Bs(a,r),go(r),x&8192){if(_e=r.memoizedState!==null,(r.stateNode.isHidden=_e)&&!He&&(r.mode&1)!==0)for(ct=r,He=r.child;He!==null;){for(Ge=ct=He;ct!==null;){switch(Be=ct,at=Be.child,Be.tag){case 0:case 11:case 14:case 15:Sd(4,Be,Be.return);break;case 1:kc(Be,Be.return);var dt=Be.stateNode;if(typeof dt.componentWillUnmount=="function"){x=Be,h=Be.return;try{a=x,dt.props=a.memoizedProps,dt.state=a.memoizedState,dt.componentWillUnmount()}catch(gt){jn(x,h,gt)}}break;case 5:kc(Be,Be.return);break;case 22:if(Be.memoizedState!==null){ux(Ge);continue}}at!==null?(at.return=Be,ct=at):ux(Ge)}He=He.sibling}e:for(He=null,Ge=r;;){if(Ge.tag===5){if(He===null){He=Ge;try{T=Ge.stateNode,_e?(R=T.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none"):(Z=Ge.stateNode,$=Ge.memoizedProps.style,U=$!=null&&$.hasOwnProperty("display")?$.display:null,Z.style.display=ot("display",U))}catch(gt){jn(r,r.return,gt)}}}else if(Ge.tag===6){if(He===null)try{Ge.stateNode.nodeValue=_e?"":Ge.memoizedProps}catch(gt){jn(r,r.return,gt)}}else if((Ge.tag!==22&&Ge.tag!==23||Ge.memoizedState===null||Ge===r)&&Ge.child!==null){Ge.child.return=Ge,Ge=Ge.child;continue}if(Ge===r)break e;for(;Ge.sibling===null;){if(Ge.return===null||Ge.return===r)break e;He===Ge&&(He=null),Ge=Ge.return}He===Ge&&(He=null),Ge.sibling.return=Ge.return,Ge=Ge.sibling}}break;case 19:Bs(a,r),go(r),x&4&&sx(r);break;case 21:break;default:Bs(a,r),go(r)}}function go(r){var a=r.flags;if(a&2){try{e:{for(var h=r.return;h!==null;){if(nx(h)){var x=h;break e}h=h.return}throw Error(t(160))}switch(x.tag){case 5:var T=x.stateNode;x.flags&32&&(ft(T,""),x.flags&=-33);var R=ix(r);Tg(r,R,T);break;case 3:case 4:var U=x.stateNode.containerInfo,Z=ix(r);Eg(r,Z,U);break;default:throw Error(t(161))}}catch($){jn(r,r.return,$)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function pE(r,a,h){ct=r,ax(r)}function ax(r,a,h){for(var x=(r.mode&1)!==0;ct!==null;){var T=ct,R=T.child;if(T.tag===22&&x){var U=T.memoizedState!==null||rp;if(!U){var Z=T.alternate,$=Z!==null&&Z.memoizedState!==null||Ji;Z=rp;var _e=Ji;if(rp=U,(Ji=$)&&!_e)for(ct=T;ct!==null;)U=ct,$=U.child,U.tag===22&&U.memoizedState!==null?cx(T):$!==null?($.return=U,ct=$):cx(T);for(;R!==null;)ct=R,ax(R),R=R.sibling;ct=T,rp=Z,Ji=_e}lx(r)}else(T.subtreeFlags&8772)!==0&&R!==null?(R.return=T,ct=R):lx(r)}}function lx(r){for(;ct!==null;){var a=ct;if((a.flags&8772)!==0){var h=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Ji||sp(5,a);break;case 1:var x=a.stateNode;if(a.flags&4&&!Ji)if(h===null)x.componentDidMount();else{var T=a.elementType===a.type?h.memoizedProps:Xr(a.type,h.memoizedProps);x.componentDidUpdate(T,h.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var R=a.updateQueue;R!==null&&Fn(a,R,x);break;case 3:var U=a.updateQueue;if(U!==null){if(h=null,a.child!==null)switch(a.child.tag){case 5:h=a.child.stateNode;break;case 1:h=a.child.stateNode}Fn(a,U,h)}break;case 5:var Z=a.stateNode;if(h===null&&a.flags&4){h=Z;var $=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&h.focus();break;case"img":$.src&&(h.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var _e=a.alternate;if(_e!==null){var He=_e.memoizedState;if(He!==null){var Ge=He.dehydrated;Ge!==null&&Rl(Ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ji||a.flags&512&&wg(a)}catch(Be){jn(a,a.return,Be)}}if(a===r){ct=null;break}if(h=a.sibling,h!==null){h.return=a.return,ct=h;break}ct=a.return}}function ux(r){for(;ct!==null;){var a=ct;if(a===r){ct=null;break}var h=a.sibling;if(h!==null){h.return=a.return,ct=h;break}ct=a.return}}function cx(r){for(;ct!==null;){var a=ct;try{switch(a.tag){case 0:case 11:case 15:var h=a.return;try{sp(4,a)}catch($){jn(a,h,$)}break;case 1:var x=a.stateNode;if(typeof x.componentDidMount=="function"){var T=a.return;try{x.componentDidMount()}catch($){jn(a,T,$)}}var R=a.return;try{wg(a)}catch($){jn(a,R,$)}break;case 5:var U=a.return;try{wg(a)}catch($){jn(a,U,$)}}}catch($){jn(a,a.return,$)}if(a===r){ct=null;break}var Z=a.sibling;if(Z!==null){Z.return=a.return,ct=Z;break}ct=a.return}}var mE=Math.ceil,op=L.ReactCurrentDispatcher,Ag=L.ReactCurrentOwner,ps=L.ReactCurrentBatchConfig,on=0,wi=null,di=null,Bi=0,Qr=0,zc=Nn(0),yi=0,Md=null,nu=0,ap=0,Cg=0,wd=null,Ir=null,bg=0,Fc=1/0,ia=null,lp=!1,Rg=null,tl=null,up=!1,nl=null,cp=0,Ed=0,Pg=null,fp=-1,dp=0;function hr(){return(on&6)!==0?ut():fp!==-1?fp:fp=ut()}function il(r){return(r.mode&1)===0?1:(on&2)!==0&&Bi!==0?Bi&-Bi:yg.transition!==null?(dp===0&&(dp=xr()),dp):(r=sn,r!==0||(r=window.event,r=r===void 0?16:Rh(r.type)),r)}function Hs(r,a,h,x){if(50<Ed)throw Ed=0,Pg=null,Error(t(185));Tl(r,h,x),((on&2)===0||r!==wi)&&(r===wi&&((on&2)===0&&(ap|=h),yi===4&&rl(r,Bi)),Nr(r,x),h===1&&on===0&&(a.mode&1)===0&&(Fc=ut()+500,Wl&&us()))}function Nr(r,a){var h=r.callbackNode;wa(r,a);var x=ii(r,r===wi?Bi:0);if(x===0)h!==null&&yt(h),r.callbackNode=null,r.callbackPriority=0;else if(a=x&-x,r.callbackPriority!==a){if(h!=null&&yt(h),a===1)r.tag===0?Gh(dx.bind(null,r)):jl(dx.bind(null,r)),vg(function(){(on&6)===0&&us()}),h=null;else{switch(Ta(x)){case 1:h=gn;break;case 4:h=kn;break;case 16:h=ni;break;case 536870912:h=Qt;break;default:h=ni}h=_x(h,fx.bind(null,r))}r.callbackPriority=a,r.callbackNode=h}}function fx(r,a){if(fp=-1,dp=0,(on&6)!==0)throw Error(t(327));var h=r.callbackNode;if(Bc()&&r.callbackNode!==h)return null;var x=ii(r,r===wi?Bi:0);if(x===0)return null;if((x&30)!==0||(x&r.expiredLanes)!==0||a)a=hp(r,x);else{a=x;var T=on;on|=2;var R=px();(wi!==r||Bi!==a)&&(ia=null,Fc=ut()+500,ru(r,a));do try{yE();break}catch(Z){hx(r,Z)}while(!0);Wa(),op.current=R,on=T,di!==null?a=0:(wi=null,Bi=0,a=yi)}if(a!==0){if(a===2&&(T=Po(r),T!==0&&(x=T,a=Lg(r,T))),a===1)throw h=Md,ru(r,0),rl(r,x),Nr(r,ut()),h;if(a===6)rl(r,x);else{if(T=r.current.alternate,(x&30)===0&&!gE(T)&&(a=hp(r,x),a===2&&(R=Po(r),R!==0&&(x=R,a=Lg(r,R))),a===1))throw h=Md,ru(r,0),rl(r,x),Nr(r,ut()),h;switch(r.finishedWork=T,r.finishedLanes=x,a){case 0:case 1:throw Error(t(345));case 2:su(r,Ir,ia);break;case 3:if(rl(r,x),(x&130023424)===x&&(a=bg+500-ut(),10<a)){if(ii(r,0)!==0)break;if(T=r.suspendedLanes,(T&x)!==x){hr(),r.pingedLanes|=r.suspendedLanes&T;break}r.timeoutHandle=rd(su.bind(null,r,Ir,ia),a);break}su(r,Ir,ia);break;case 4:if(rl(r,x),(x&4194240)===x)break;for(a=r.eventTimes,T=-1;0<x;){var U=31-vn(x);R=1<<U,U=a[U],U>T&&(T=U),x&=~R}if(x=T,x=ut()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*mE(x/1960))-x,10<x){r.timeoutHandle=rd(su.bind(null,r,Ir,ia),x);break}su(r,Ir,ia);break;case 5:su(r,Ir,ia);break;default:throw Error(t(329))}}}return Nr(r,ut()),r.callbackNode===h?fx.bind(null,r):null}function Lg(r,a){var h=wd;return r.current.memoizedState.isDehydrated&&(ru(r,a).flags|=256),r=hp(r,a),r!==2&&(a=Ir,Ir=h,a!==null&&Ig(a)),r}function Ig(r){Ir===null?Ir=r:Ir.push.apply(Ir,r)}function gE(r){for(var a=r;;){if(a.flags&16384){var h=a.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var x=0;x<h.length;x++){var T=h[x],R=T.getSnapshot;T=T.value;try{if(!ar(R(),T))return!1}catch{return!1}}}if(h=a.child,a.subtreeFlags&16384&&h!==null)h.return=a,a=h;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function rl(r,a){for(a&=~Cg,a&=~ap,r.suspendedLanes|=a,r.pingedLanes&=~a,r=r.expirationTimes;0<a;){var h=31-vn(a),x=1<<h;r[h]=-1,a&=~x}}function dx(r){if((on&6)!==0)throw Error(t(327));Bc();var a=ii(r,0);if((a&1)===0)return Nr(r,ut()),null;var h=hp(r,a);if(r.tag!==0&&h===2){var x=Po(r);x!==0&&(a=x,h=Lg(r,x))}if(h===1)throw h=Md,ru(r,0),rl(r,a),Nr(r,ut()),h;if(h===6)throw Error(t(345));return r.finishedWork=r.current.alternate,r.finishedLanes=a,su(r,Ir,ia),Nr(r,ut()),null}function Ng(r,a){var h=on;on|=1;try{return r(a)}finally{on=h,on===0&&(Fc=ut()+500,Wl&&us())}}function iu(r){nl!==null&&nl.tag===0&&(on&6)===0&&Bc();var a=on;on|=1;var h=ps.transition,x=sn;try{if(ps.transition=null,sn=1,r)return r()}finally{sn=x,ps.transition=h,on=a,(on&6)===0&&us()}}function Dg(){Qr=zc.current,Sn(zc)}function ru(r,a){r.finishedWork=null,r.finishedLanes=0;var h=r.timeoutHandle;if(h!==-1&&(r.timeoutHandle=-1,sd(h)),di!==null)for(h=di.return;h!==null;){var x=h;switch(Ds(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Vl();break;case 3:fs(),Sn(Ii),Sn(gi),Qi();break;case 5:Qa(x);break;case 4:fs();break;case 13:Sn(Mn);break;case 19:Sn(Mn);break;case 10:ja(x.type._context);break;case 22:case 23:Dg()}h=h.return}if(wi=r,di=r=sl(r.current,null),Bi=Qr=a,yi=0,Md=null,Cg=ap=nu=0,Ir=wd=null,Yr!==null){for(a=0;a<Yr.length;a++)if(h=Yr[a],x=h.interleaved,x!==null){h.interleaved=null;var T=x.next,R=h.pending;if(R!==null){var U=R.next;R.next=T,x.next=U}h.pending=x}Yr=null}return r}function hx(r,a){do{var h=di;try{if(Wa(),ta.current=l,Zr){for(var x=Tn.memoizedState;x!==null;){var T=x.queue;T!==null&&(T.pending=null),x=x.next}Zr=!1}if(fo=0,fi=Bn=Tn=null,Ka=!1,Ja=0,Ag.current=null,h===null||h.return===null){yi=1,Md=a,di=null;break}e:{var R=r,U=h.return,Z=h,$=a;if(a=Bi,Z.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var _e=$,He=Z,Ge=He.tag;if((He.mode&1)===0&&(Ge===0||Ge===11||Ge===15)){var Be=He.alternate;Be?(He.updateQueue=Be.updateQueue,He.memoizedState=Be.memoizedState,He.lanes=Be.lanes):(He.updateQueue=null,He.memoizedState=null)}var at=Ft(U);if(at!==null){at.flags&=-257,Et(at,U,Z,R,a),at.mode&1&&lt(R,_e,a),a=at,$=_e;var dt=a.updateQueue;if(dt===null){var gt=new Set;gt.add($),a.updateQueue=gt}else dt.add($);break e}else{if((a&1)===0){lt(R,_e,a),Ug();break e}$=Error(t(426))}}else if(En&&Z.mode&1){var Jn=Ft(U);if(Jn!==null){(Jn.flags&65536)===0&&(Jn.flags|=256),Et(Jn,U,Z,R,a),Ga(C($,Z));break e}}R=$=C($,Z),yi!==4&&(yi=2),wd===null?wd=[R]:wd.push(R),R=U;do{switch(R.tag){case 3:R.flags|=65536,a&=-a,R.lanes|=a;var ce=be(R,$,a);Gt(R,ce);break e;case 1:Z=$;var ie=R.type,he=R.stateNode;if((R.flags&128)===0&&(typeof ie.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(tl===null||!tl.has(he)))){R.flags|=65536,a&=-a,R.lanes|=a;var Ye=je(R,Z,a);Gt(R,Ye);break e}}R=R.return}while(R!==null)}gx(h)}catch(_t){a=_t,di===h&&h!==null&&(di=h=h.return);continue}break}while(!0)}function px(){var r=op.current;return op.current=l,r===null?l:r}function Ug(){(yi===0||yi===3||yi===2)&&(yi=4),wi===null||(nu&268435455)===0&&(ap&268435455)===0||rl(wi,Bi)}function hp(r,a){var h=on;on|=2;var x=px();(wi!==r||Bi!==a)&&(ia=null,ru(r,a));do try{vE();break}catch(T){hx(r,T)}while(!0);if(Wa(),on=h,op.current=x,di!==null)throw Error(t(261));return wi=null,Bi=0,yi}function vE(){for(;di!==null;)mx(di)}function yE(){for(;di!==null&&!bt();)mx(di)}function mx(r){var a=xx(r.alternate,r,Qr);r.memoizedProps=r.pendingProps,a===null?gx(r):di=a,Ag.current=null}function gx(r){var a=r;do{var h=a.alternate;if(r=a.return,(a.flags&32768)===0){if(h=cE(h,a,Qr),h!==null){di=h;return}}else{if(h=fE(h,a),h!==null){h.flags&=32767,di=h;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{yi=6,di=null;return}}if(a=a.sibling,a!==null){di=a;return}di=a=r}while(a!==null);yi===0&&(yi=5)}function su(r,a,h){var x=sn,T=ps.transition;try{ps.transition=null,sn=1,xE(r,a,h,x)}finally{ps.transition=T,sn=x}return null}function xE(r,a,h,x){do Bc();while(nl!==null);if((on&6)!==0)throw Error(t(327));h=r.finishedWork;var T=r.finishedLanes;if(h===null)return null;if(r.finishedWork=null,r.finishedLanes=0,h===r.current)throw Error(t(177));r.callbackNode=null,r.callbackPriority=0;var R=h.lanes|h.childLanes;if(hg(r,R),r===wi&&(di=wi=null,Bi=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||up||(up=!0,_x(ni,function(){return Bc(),null})),R=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||R){R=ps.transition,ps.transition=null;var U=sn;sn=1;var Z=on;on|=4,Ag.current=null,hE(r,h),ox(h,r),si(nd),_r=!!Ba,nd=Ba=null,r.current=h,pE(h),kt(),on=Z,sn=U,ps.transition=R}else r.current=h;if(up&&(up=!1,nl=r,cp=T),R=r.pendingLanes,R===0&&(tl=null),At(h.stateNode),Nr(r,ut()),a!==null)for(x=r.onRecoverableError,h=0;h<a.length;h++)T=a[h],x(T.value,{componentStack:T.stack,digest:T.digest});if(lp)throw lp=!1,r=Rg,Rg=null,r;return(cp&1)!==0&&r.tag!==0&&Bc(),R=r.pendingLanes,(R&1)!==0?r===Pg?Ed++:(Ed=0,Pg=r):Ed=0,us(),null}function Bc(){if(nl!==null){var r=Ta(cp),a=ps.transition,h=sn;try{if(ps.transition=null,sn=16>r?16:r,nl===null)var x=!1;else{if(r=nl,nl=null,cp=0,(on&6)!==0)throw Error(t(331));var T=on;for(on|=4,ct=r.current;ct!==null;){var R=ct,U=R.child;if((ct.flags&16)!==0){var Z=R.deletions;if(Z!==null){for(var $=0;$<Z.length;$++){var _e=Z[$];for(ct=_e;ct!==null;){var He=ct;switch(He.tag){case 0:case 11:case 15:Sd(8,He,R)}var Ge=He.child;if(Ge!==null)Ge.return=He,ct=Ge;else for(;ct!==null;){He=ct;var Be=He.sibling,at=He.return;if(tx(He),He===_e){ct=null;break}if(Be!==null){Be.return=at,ct=Be;break}ct=at}}}var dt=R.alternate;if(dt!==null){var gt=dt.child;if(gt!==null){dt.child=null;do{var Jn=gt.sibling;gt.sibling=null,gt=Jn}while(gt!==null)}}ct=R}}if((R.subtreeFlags&2064)!==0&&U!==null)U.return=R,ct=U;else e:for(;ct!==null;){if(R=ct,(R.flags&2048)!==0)switch(R.tag){case 0:case 11:case 15:Sd(9,R,R.return)}var ce=R.sibling;if(ce!==null){ce.return=R.return,ct=ce;break e}ct=R.return}}var ie=r.current;for(ct=ie;ct!==null;){U=ct;var he=U.child;if((U.subtreeFlags&2064)!==0&&he!==null)he.return=U,ct=he;else e:for(U=ie;ct!==null;){if(Z=ct,(Z.flags&2048)!==0)try{switch(Z.tag){case 0:case 11:case 15:sp(9,Z)}}catch(_t){jn(Z,Z.return,_t)}if(Z===U){ct=null;break e}var Ye=Z.sibling;if(Ye!==null){Ye.return=Z.return,ct=Ye;break e}ct=Z.return}}if(on=T,us(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(wt,r)}catch{}x=!0}return x}finally{sn=h,ps.transition=a}}return!1}function vx(r,a,h){a=C(h,a),a=be(r,a,1),r=cs(r,a,1),a=hr(),r!==null&&(Tl(r,1,a),Nr(r,a))}function jn(r,a,h){if(r.tag===3)vx(r,r,h);else for(;a!==null;){if(a.tag===3){vx(a,r,h);break}else if(a.tag===1){var x=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(tl===null||!tl.has(x))){r=C(h,r),r=je(a,r,1),a=cs(a,r,1),r=hr(),a!==null&&(Tl(a,1,r),Nr(a,r));break}}a=a.return}}function _E(r,a,h){var x=r.pingCache;x!==null&&x.delete(a),a=hr(),r.pingedLanes|=r.suspendedLanes&h,wi===r&&(Bi&h)===h&&(yi===4||yi===3&&(Bi&130023424)===Bi&&500>ut()-bg?ru(r,0):Cg|=h),Nr(r,a)}function yx(r,a){a===0&&((r.mode&1)===0?a=1:(a=xn,xn<<=1,(xn&130023424)===0&&(xn=4194304)));var h=hr();r=qr(r,a),r!==null&&(Tl(r,a,h),Nr(r,h))}function SE(r){var a=r.memoizedState,h=0;a!==null&&(h=a.retryLane),yx(r,h)}function ME(r,a){var h=0;switch(r.tag){case 13:var x=r.stateNode,T=r.memoizedState;T!==null&&(h=T.retryLane);break;case 19:x=r.stateNode;break;default:throw Error(t(314))}x!==null&&x.delete(a),yx(r,h)}var xx;xx=function(r,a,h){if(r!==null)if(r.memoizedProps!==a.pendingProps||Ii.current)rt=!0;else{if((r.lanes&h)===0&&(a.flags&128)===0)return rt=!1,uE(r,a,h);rt=(r.flags&131072)!==0}else rt=!1,En&&(a.flags&1048576)!==0&&cd(a,Sc,a.index);switch(a.lanes=0,a.tag){case 2:var x=a.type;ip(r,a),r=a.pendingProps;var T=Yo(a,gi.current);Us(a,h),T=Pc(null,a,x,r,T,h);var R=Ql();return a.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,Si(x)?(R=!0,qo(a)):R=!1,a.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Zl(a),T.updater=ks,a.stateNode=T,T._reactInternals=a,qa(a,x,r,h),a=Ut(null,a,x,!0,R,h)):(a.tag=0,En&&R&&fd(a),ln(null,a,T,h),a=a.child),a;case 16:x=a.elementType;e:{switch(ip(r,a),r=a.pendingProps,T=x._init,x=T(x._payload),a.type=x,T=a.tag=EE(x),r=Xr(x,r),T){case 0:a=mt(null,a,x,r,h);break e;case 1:a=Ht(null,a,x,r,h);break e;case 11:a=dr(null,a,x,r,h);break e;case 14:a=pe(null,a,x,Xr(x.type,r),h);break e}throw Error(t(306,x,""))}return a;case 0:return x=a.type,T=a.pendingProps,T=a.elementType===x?T:Xr(x,T),mt(r,a,x,T,h);case 1:return x=a.type,T=a.pendingProps,T=a.elementType===x?T:Xr(x,T),Ht(r,a,x,T,h);case 3:e:{if(tn(a),r===null)throw Error(t(387));x=a.pendingProps,R=a.memoizedState,T=R.element,Wh(r,a),Ln(a,x,null,h);var U=a.memoizedState;if(x=U.element,R.isDehydrated)if(R={element:x,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},a.updateQueue.baseState=R,a.memoizedState=R,a.flags&256){T=C(Error(t(423)),a),a=Kn(r,a,x,h,T);break e}else if(x!==T){T=C(Error(t(424)),a),a=Kn(r,a,x,h,T);break e}else for(Di=Rs(a.stateNode.containerInfo.firstChild),vi=a,En=!0,Cr=null,h=ea(a,null,x,h),a.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(oo(),x===T){a=na(r,a,h);break e}ln(r,a,x,h)}a=a.child}return a;case 5:return bc(a),r===null&&wc(a),x=a.type,T=a.pendingProps,R=r!==null?r.memoizedProps:null,U=T.children,id(x,T)?U=null:R!==null&&id(x,R)&&(a.flags|=32),it(r,a),ln(r,a,U,h),a.child;case 6:return r===null&&wc(a),null;case 13:return tp(r,a,h);case 4:return Za(a,a.stateNode.containerInfo),x=a.pendingProps,r===null?a.child=lo(a,null,x,h):ln(r,a,x,h),a.child;case 11:return x=a.type,T=a.pendingProps,T=a.elementType===x?T:Xr(x,T),dr(r,a,x,T,h);case 7:return ln(r,a,a.pendingProps,h),a.child;case 8:return ln(r,a,a.pendingProps.children,h),a.child;case 12:return ln(r,a,a.pendingProps.children,h),a.child;case 10:e:{if(x=a.type._context,T=a.pendingProps,R=a.memoizedProps,U=T.value,dn(Xl,x._currentValue),x._currentValue=U,R!==null)if(ar(R.value,U)){if(R.children===T.children&&!Ii.current){a=na(r,a,h);break e}}else for(R=a.child,R!==null&&(R.return=a);R!==null;){var Z=R.dependencies;if(Z!==null){U=R.child;for(var $=Z.firstContext;$!==null;){if($.context===x){if(R.tag===1){$=br(-1,h&-h),$.tag=2;var _e=R.updateQueue;if(_e!==null){_e=_e.shared;var He=_e.pending;He===null?$.next=$:($.next=He.next,He.next=$),_e.pending=$}}R.lanes|=h,$=R.alternate,$!==null&&($.lanes|=h),Xa(R.return,h,a),Z.lanes|=h;break}$=$.next}}else if(R.tag===10)U=R.type===a.type?null:R.child;else if(R.tag===18){if(U=R.return,U===null)throw Error(t(341));U.lanes|=h,Z=U.alternate,Z!==null&&(Z.lanes|=h),Xa(U,h,a),U=R.sibling}else U=R.child;if(U!==null)U.return=R;else for(U=R;U!==null;){if(U===a){U=null;break}if(R=U.sibling,R!==null){R.return=U.return,U=R;break}U=U.return}R=U}ln(r,a,T.children,h),a=a.child}return a;case 9:return T=a.type,x=a.pendingProps.children,Us(a,h),T=Ui(T),x=x(T),a.flags|=1,ln(r,a,x,h),a.child;case 14:return x=a.type,T=Xr(x,a.pendingProps),T=Xr(x.type,T),pe(r,a,x,T,h);case 15:return oe(r,a,a.type,a.pendingProps,h);case 17:return x=a.type,T=a.pendingProps,T=a.elementType===x?T:Xr(x,T),ip(r,a),a.tag=1,Si(x)?(r=!0,qo(a)):r=!1,Us(a,h),Ya(a,x,T),qa(a,x,T,h),Ut(null,a,x,!0,r,h);case 19:return Qy(r,a,h);case 22:return we(r,a,h)}throw Error(t(156,a.tag))};function _x(r,a){return ht(r,a)}function wE(r,a,h,x){this.tag=r,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(r,a,h,x){return new wE(r,a,h,x)}function Og(r){return r=r.prototype,!(!r||!r.isReactComponent)}function EE(r){if(typeof r=="function")return Og(r)?1:0;if(r!=null){if(r=r.$$typeof,r===te)return 11;if(r===fe)return 14}return 2}function sl(r,a){var h=r.alternate;return h===null?(h=ms(r.tag,a,r.key,r.mode),h.elementType=r.elementType,h.type=r.type,h.stateNode=r.stateNode,h.alternate=r,r.alternate=h):(h.pendingProps=a,h.type=r.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=r.flags&14680064,h.childLanes=r.childLanes,h.lanes=r.lanes,h.child=r.child,h.memoizedProps=r.memoizedProps,h.memoizedState=r.memoizedState,h.updateQueue=r.updateQueue,a=r.dependencies,h.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},h.sibling=r.sibling,h.index=r.index,h.ref=r.ref,h}function pp(r,a,h,x,T,R){var U=2;if(x=r,typeof r=="function")Og(r)&&(U=1);else if(typeof r=="string")U=5;else e:switch(r){case F:return ou(h.children,T,R,a);case j:U=8,T|=8;break;case O:return r=ms(12,h,a,T|2),r.elementType=O,r.lanes=R,r;case Q:return r=ms(13,h,a,T),r.elementType=Q,r.lanes=R,r;case ue:return r=ms(19,h,a,T),r.elementType=ue,r.lanes=R,r;case Me:return mp(h,T,R,a);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case N:U=10;break e;case X:U=9;break e;case te:U=11;break e;case fe:U=14;break e;case ye:U=16,x=null;break e}throw Error(t(130,r==null?r:typeof r,""))}return a=ms(U,h,a,T),a.elementType=r,a.type=x,a.lanes=R,a}function ou(r,a,h,x){return r=ms(7,r,x,a),r.lanes=h,r}function mp(r,a,h,x){return r=ms(22,r,x,a),r.elementType=Me,r.lanes=h,r.stateNode={isHidden:!1},r}function kg(r,a,h){return r=ms(6,r,null,a),r.lanes=h,r}function zg(r,a,h){return a=ms(4,r.children!==null?r.children:[],r.key,a),a.lanes=h,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}function TE(r,a,h,x,T){this.tag=a,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zf(0),this.expirationTimes=zf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zf(0),this.identifierPrefix=x,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function Fg(r,a,h,x,T,R,U,Z,$){return r=new TE(r,a,h,Z,$),a===1?(a=1,R===!0&&(a|=8)):a=0,R=ms(3,null,null,a),r.current=R,R.stateNode=r,R.memoizedState={element:x,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Zl(R),r}function AE(r,a,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:D,key:x==null?null:""+x,children:r,containerInfo:a,implementation:h}}function Sx(r){if(!r)return Ls;r=r._reactInternals;e:{if(H(r)!==r||r.tag!==1)throw Error(t(170));var a=r;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(Si(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(t(171))}if(r.tag===1){var h=r.type;if(Si(h))return Gl(r,h,a)}return a}function Mx(r,a,h,x,T,R,U,Z,$){return r=Fg(h,x,!0,r,T,R,U,Z,$),r.context=Sx(null),h=r.current,x=hr(),T=il(h),R=br(x,T),R.callback=a??null,cs(h,R,T),r.current.lanes=T,Tl(r,T,x),Nr(r,x),r}function gp(r,a,h,x){var T=a.current,R=hr(),U=il(T);return h=Sx(h),a.context===null?a.context=h:a.pendingContext=h,a=br(R,U),a.payload={element:r},x=x===void 0?null:x,x!==null&&(a.callback=x),r=cs(T,a,U),r!==null&&(Hs(r,T,U,R),Cn(r,T,U)),U}function vp(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function wx(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var h=r.retryLane;r.retryLane=h!==0&&h<a?h:a}}function Bg(r,a){wx(r,a),(r=r.alternate)&&wx(r,a)}function CE(){return null}var Ex=typeof reportError=="function"?reportError:function(r){console.error(r)};function Hg(r){this._internalRoot=r}yp.prototype.render=Hg.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(t(409));gp(r,a,null,null)},yp.prototype.unmount=Hg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;iu(function(){gp(null,r,null,null)}),a[ur]=null}};function yp(r){this._internalRoot=r}yp.prototype.unstable_scheduleHydration=function(r){if(r){var a=Bu();r={blockedOn:null,target:r,priority:a};for(var h=0;h<Js.length&&a!==0&&a<Js[h].priority;h++);Js.splice(h,0,r),h===0&&Gu(r)}};function Vg(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function xp(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Tx(){}function bE(r,a,h,x,T){if(T){if(typeof x=="function"){var R=x;x=function(){var _e=vp(U);R.call(_e)}}var U=Mx(a,x,r,0,null,!1,!1,"",Tx);return r._reactRootContainer=U,r[ur]=U.current,za(r.nodeType===8?r.parentNode:r),iu(),U}for(;T=r.lastChild;)r.removeChild(T);if(typeof x=="function"){var Z=x;x=function(){var _e=vp($);Z.call(_e)}}var $=Fg(r,0,!1,null,null,!1,!1,"",Tx);return r._reactRootContainer=$,r[ur]=$.current,za(r.nodeType===8?r.parentNode:r),iu(function(){gp(a,$,h,x)}),$}function _p(r,a,h,x,T){var R=h._reactRootContainer;if(R){var U=R;if(typeof T=="function"){var Z=T;T=function(){var $=vp(U);Z.call($)}}gp(a,U,r,T)}else U=bE(h,a,r,T,x);return vp(U)}Al=function(r){switch(r.tag){case 3:var a=r.stateNode;if(a.current.memoizedState.isDehydrated){var h=yr(a.pendingLanes);h!==0&&(Ea(a,h|1),Nr(a,ut()),(on&6)===0&&(Fc=ut()+500,us()))}break;case 13:iu(function(){var x=qr(r,1);if(x!==null){var T=hr();Hs(x,r,1,T)}}),Bg(r,1)}},Ff=function(r){if(r.tag===13){var a=qr(r,134217728);if(a!==null){var h=hr();Hs(a,r,134217728,h)}Bg(r,134217728)}},bh=function(r){if(r.tag===13){var a=il(r),h=qr(r,a);if(h!==null){var x=hr();Hs(h,r,a,x)}Bg(r,a)}},Bu=function(){return sn},Hu=function(r,a){var h=sn;try{return sn=r,a()}finally{sn=h}},Te=function(r,a,h){switch(a){case"input":if(Fe(r,h),a=h.name,h.type==="radio"&&a!=null){for(h=r;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<h.length;a++){var x=h[a];if(x!==r&&x.form===r.form){var T=yc(x);if(!T)throw Error(t(90));Ae(x),Fe(x,T)}}}break;case"textarea":Ue(r,h);break;case"select":a=h.value,a!=null&&de(r,!!h.multiple,a,!1)}},fn=Ng,Xt=iu;var RE={usingClientEntryPoint:!1,Events:[Ps,zn,yc,rn,Jt,Ng]},Td={findFiberByHostInstance:so,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},PE={bundleType:Td.bundleType,version:Td.version,rendererPackageName:Td.rendererPackageName,rendererConfig:Td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:L.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=ge(r),r===null?null:r.stateNode},findFiberByHostInstance:Td.findFiberByHostInstance||CE,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sp.isDisabled&&Sp.supportsFiber)try{wt=Sp.inject(PE),Vt=Sp}catch{}}return Dr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RE,Dr.createPortal=function(r,a){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vg(a))throw Error(t(200));return AE(r,a,null,h)},Dr.createRoot=function(r,a){if(!Vg(r))throw Error(t(299));var h=!1,x="",T=Ex;return a!=null&&(a.unstable_strictMode===!0&&(h=!0),a.identifierPrefix!==void 0&&(x=a.identifierPrefix),a.onRecoverableError!==void 0&&(T=a.onRecoverableError)),a=Fg(r,1,!1,null,null,h,!1,x,T),r[ur]=a.current,za(r.nodeType===8?r.parentNode:r),new Hg(a)},Dr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(t(188)):(r=Object.keys(r).join(","),Error(t(268,r)));return r=ge(a),r=r===null?null:r.stateNode,r},Dr.flushSync=function(r){return iu(r)},Dr.hydrate=function(r,a,h){if(!xp(a))throw Error(t(200));return _p(null,r,a,!0,h)},Dr.hydrateRoot=function(r,a,h){if(!Vg(r))throw Error(t(405));var x=h!=null&&h.hydratedSources||null,T=!1,R="",U=Ex;if(h!=null&&(h.unstable_strictMode===!0&&(T=!0),h.identifierPrefix!==void 0&&(R=h.identifierPrefix),h.onRecoverableError!==void 0&&(U=h.onRecoverableError)),a=Mx(a,null,r,1,h??null,T,!1,R,U),r[ur]=a.current,za(r),x)for(r=0;r<x.length;r++)h=x[r],T=h._getVersion,T=T(h._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[h,T]:a.mutableSourceEagerHydrationData.push(h,T);return new yp(a)},Dr.render=function(r,a,h){if(!xp(a))throw Error(t(200));return _p(null,r,a,!1,h)},Dr.unmountComponentAtNode=function(r){if(!xp(r))throw Error(t(40));return r._reactRootContainer?(iu(function(){_p(null,null,r,!1,function(){r._reactRootContainer=null,r[ur]=null})}),!0):!1},Dr.unstable_batchedUpdates=Ng,Dr.unstable_renderSubtreeIntoContainer=function(r,a,h,x){if(!xp(h))throw Error(t(200));if(r==null||r._reactInternals===void 0)throw Error(t(38));return _p(r,a,h,!1,x)},Dr.version="18.2.0-next-9e3b772b8-20220608",Dr}var Nx;function zE(){if(Nx)return jg.exports;Nx=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),jg.exports=kE(),jg.exports}var Dx;function FE(){if(Dx)return Mp;Dx=1;var s=zE();return Mp.createRoot=s.createRoot,Mp.hydrateRoot=s.hydrateRoot,Mp}var BE=FE();const HE=Bm(BE),St=5,Or=5,aS=["#F59E0B","#EC4899","#3B82F6","#10B981"],Xs={primary:"#4F46E5",gridLine:"#CBD5E1",voxelDefault:aS[0],voxelOutline:"#000000",background:"#F0F9FF"},VE=[];/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const bf="164",xu={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},_u={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},lS=0,lv=1,uS=2,GE=3,cS=0,Hm=1,Gd=2,js=3,ma=0,nr=1,_o=2,pa=0,bu=1,uv=2,cv=3,fv=4,fS=5,gl=100,dS=101,hS=102,pS=103,mS=104,gS=200,vS=201,yS=202,xS=203,Lm=204,Im=205,_S=206,SS=207,MS=208,wS=209,ES=210,TS=211,AS=212,CS=213,bS=214,RS=0,PS=1,LS=2,qd=3,IS=4,NS=5,DS=6,US=7,vh=0,OS=1,kS=2,Eo=0,zS=1,FS=2,BS=3,ey=4,HS=5,VS=6,GS=7,dv="attached",WS="detached",Vm=300,ga=301,xl=302,Zd=303,Qd=304,Rf=306,Kd=1e3,xs=1001,Jd=1002,Ai=1003,ty=1004,WE=1004,mf=1005,jE=1005,pi=1006,Wd=1007,XE=1007,Mo=1008,YE=1008,Ao=1009,jS=1010,XS=1011,ny=1012,iy=1013,Du=1014,_s=1015,yh=1016,ry=1017,sy=1018,Pf=1020,YS=35902,qS=1021,ZS=1022,kr=1023,QS=1024,KS=1025,Ru=1026,Mf=1027,oy=1028,ay=1029,JS=1030,ly=1031,uy=1033,Mm=33776,wm=33777,Em=33778,Tm=33779,hv=35840,pv=35841,mv=35842,gv=35843,vv=36196,yv=37492,xv=37496,_v=37808,Sv=37809,Mv=37810,wv=37811,Ev=37812,Tv=37813,Av=37814,Cv=37815,bv=37816,Rv=37817,Pv=37818,Lv=37819,Iv=37820,Nv=37821,Am=36492,Dv=36494,Uv=36495,$S=36283,Ov=36284,kv=36285,zv=36286,eM=2200,tM=2201,nM=2202,$d=2300,eh=2301,Cm=2302,Eu=2400,Tu=2401,th=2402,Gm=2500,cy=2501,qE=0,ZE=1,QE=2,iM=3200,rM=3201,Sl=0,sM=1,fa="",vs="srgb",ya="srgb-linear",Wm="display-p3",xh="display-p3-linear",nh="linear",bn="srgb",ih="rec709",rh="p3",KE=0,Su=7680,JE=7681,$E=7682,eT=7683,tT=34055,nT=34056,iT=5386,rT=512,sT=513,oT=514,aT=515,lT=516,uT=517,cT=518,Fv=519,oM=512,aM=513,lM=514,fy=515,uM=516,cM=517,fM=518,dM=519,sh=35044,fT=35048,dT=35040,hT=35045,pT=35049,mT=35041,gT=35046,vT=35050,yT=35042,xT="100",Bv="300 es",wo=2e3,oh=2001;let xa=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const o=i.indexOf(t);o!==-1&&i.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let o=0,u=i.length;o<u;o++)i[o].call(this,e);e.target=null}}};const $i=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Ux=1234567;const Pu=Math.PI/180,wf=180/Math.PI;function ts(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return($i[s&255]+$i[s>>8&255]+$i[s>>16&255]+$i[s>>24&255]+"-"+$i[e&255]+$i[e>>8&255]+"-"+$i[e>>16&15|64]+$i[e>>24&255]+"-"+$i[t&63|128]+$i[t>>8&255]+"-"+$i[t>>16&255]+$i[t>>24&255]+$i[n&255]+$i[n>>8&255]+$i[n>>16&255]+$i[n>>24&255]).toLowerCase()}function Yn(s,e,t){return Math.max(e,Math.min(t,s))}function dy(s,e){return(s%e+e)%e}function _T(s,e,t,n,i){return n+(s-e)*(i-n)/(t-e)}function ST(s,e,t){return s!==e?(t-s)/(e-s):0}function jd(s,e,t){return(1-t)*s+t*e}function MT(s,e,t,n){return jd(s,e,1-Math.exp(-t*n))}function wT(s,e=1){return e-Math.abs(dy(s,e*2)-e)}function ET(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function TT(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function AT(s,e){return s+Math.floor(Math.random()*(e-s+1))}function CT(s,e){return s+Math.random()*(e-s)}function bT(s){return s*(.5-Math.random())}function RT(s){s!==void 0&&(Ux=s);let e=Ux+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function PT(s){return s*Pu}function LT(s){return s*wf}function IT(s){return(s&s-1)===0&&s!==0}function NT(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function DT(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function UT(s,e,t,n,i){const o=Math.cos,u=Math.sin,f=o(t/2),d=u(t/2),p=o((e+n)/2),m=u((e+n)/2),g=o((e-n)/2),y=u((e-n)/2),_=o((n-e)/2),M=u((n-e)/2);switch(i){case"XYX":s.set(f*m,d*g,d*y,f*p);break;case"YZY":s.set(d*y,f*m,d*g,f*p);break;case"ZXZ":s.set(d*g,d*y,f*m,f*p);break;case"XZX":s.set(f*m,d*M,d*_,f*p);break;case"YXY":s.set(d*_,f*m,d*M,f*p);break;case"ZYZ":s.set(d*M,d*_,f*m,f*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function gr(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function jt(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const hy={DEG2RAD:Pu,RAD2DEG:wf,generateUUID:ts,clamp:Yn,euclideanModulo:dy,mapLinear:_T,inverseLerp:ST,lerp:jd,damp:MT,pingpong:wT,smoothstep:ET,smootherstep:TT,randInt:AT,randFloat:CT,randFloatSpread:bT,seededRandom:RT,degToRad:PT,radToDeg:LT,isPowerOfTwo:IT,ceilPowerOfTwo:NT,floorPowerOfTwo:DT,setQuaternionFromProperEuler:UT,normalize:jt,denormalize:gr};class Ne{constructor(e=0,t=0){Ne.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Yn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),o=this.x-e.x,u=this.y-e.y;return this.x=o*n-u*i+e.x,this.y=o*i+u*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Wt{constructor(e,t,n,i,o,u,f,d,p){Wt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,o,u,f,d,p)}set(e,t,n,i,o,u,f,d,p){const m=this.elements;return m[0]=e,m[1]=i,m[2]=f,m[3]=t,m[4]=o,m[5]=d,m[6]=n,m[7]=u,m[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,o=this.elements,u=n[0],f=n[3],d=n[6],p=n[1],m=n[4],g=n[7],y=n[2],_=n[5],M=n[8],A=i[0],E=i[3],S=i[6],P=i[1],b=i[4],L=i[7],B=i[2],D=i[5],F=i[8];return o[0]=u*A+f*P+d*B,o[3]=u*E+f*b+d*D,o[6]=u*S+f*L+d*F,o[1]=p*A+m*P+g*B,o[4]=p*E+m*b+g*D,o[7]=p*S+m*L+g*F,o[2]=y*A+_*P+M*B,o[5]=y*E+_*b+M*D,o[8]=y*S+_*L+M*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],o=e[3],u=e[4],f=e[5],d=e[6],p=e[7],m=e[8];return t*u*m-t*f*p-n*o*m+n*f*d+i*o*p-i*u*d}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],o=e[3],u=e[4],f=e[5],d=e[6],p=e[7],m=e[8],g=m*u-f*p,y=f*d-m*o,_=p*o-u*d,M=t*g+n*y+i*_;if(M===0)return this.set(0,0,0,0,0,0,0,0,0);const A=1/M;return e[0]=g*A,e[1]=(i*p-m*n)*A,e[2]=(f*n-i*u)*A,e[3]=y*A,e[4]=(m*t-i*d)*A,e[5]=(i*o-f*t)*A,e[6]=_*A,e[7]=(n*d-p*t)*A,e[8]=(u*t-n*o)*A,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,o,u,f){const d=Math.cos(o),p=Math.sin(o);return this.set(n*d,n*p,-n*(d*u+p*f)+u+e,-i*p,i*d,-i*(-p*u+d*f)+f+t,0,0,1),this}scale(e,t){return this.premultiply(qg.makeScale(e,t)),this}rotate(e){return this.premultiply(qg.makeRotation(-e)),this}translate(e,t){return this.premultiply(qg.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const qg=new Wt;function hM(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const OT={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function gf(s,e){return new OT[s](e)}function ah(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function pM(){const s=ah("canvas");return s.style.display="block",s}const Ox={};function mM(s){s in Ox||(Ox[s]=!0,console.warn(s))}const kx=new Wt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),zx=new Wt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),wp={[ya]:{transfer:nh,primaries:ih,toReference:s=>s,fromReference:s=>s},[vs]:{transfer:bn,primaries:ih,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[xh]:{transfer:nh,primaries:rh,toReference:s=>s.applyMatrix3(zx),fromReference:s=>s.applyMatrix3(kx)},[Wm]:{transfer:bn,primaries:rh,toReference:s=>s.convertSRGBToLinear().applyMatrix3(zx),fromReference:s=>s.applyMatrix3(kx).convertLinearToSRGB()}},kT=new Set([ya,xh]),pn={enabled:!0,_workingColorSpace:ya,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!kT.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,t){if(this.enabled===!1||e===t||!e||!t)return s;const n=wp[e].toReference,i=wp[t].fromReference;return i(n(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return wp[s].primaries},getTransfer:function(s){return s===fa?nh:wp[s].transfer}};function Sf(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Zg(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let Hc;class gM{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Hc===void 0&&(Hc=ah("canvas")),Hc.width=e.width,Hc.height=e.height;const n=Hc.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Hc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ah("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),o=i.data;for(let u=0;u<o.length;u++)o[u]=Sf(o[u]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Sf(t[n]/255)*255):t[n]=Sf(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let zT=0;class Au{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:zT++}),this.uuid=ts(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let o;if(Array.isArray(i)){o=[];for(let u=0,f=i.length;u<f;u++)i[u].isDataTexture?o.push(Qg(i[u].image)):o.push(Qg(i[u]))}else o=Qg(i);n.url=o}return t||(e.images[this.uuid]=n),n}}function Qg(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?gM.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let FT=0;class Vn extends xa{constructor(e=Vn.DEFAULT_IMAGE,t=Vn.DEFAULT_MAPPING,n=xs,i=xs,o=pi,u=Mo,f=kr,d=Ao,p=Vn.DEFAULT_ANISOTROPY,m=fa){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:FT++}),this.uuid=ts(),this.name="",this.source=new Au(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=o,this.minFilter=u,this.anisotropy=p,this.format=f,this.internalFormat=null,this.type=d,this.offset=new Ne(0,0),this.repeat=new Ne(1,1),this.center=new Ne(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Wt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Vm)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Kd:e.x=e.x-Math.floor(e.x);break;case xs:e.x=e.x<0?0:1;break;case Jd:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Kd:e.y=e.y-Math.floor(e.y);break;case xs:e.y=e.y<0?0:1;break;case Jd:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Vn.DEFAULT_IMAGE=null;Vn.DEFAULT_MAPPING=Vm;Vn.DEFAULT_ANISOTROPY=1;class nn{constructor(e=0,t=0,n=0,i=1){nn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,o=this.w,u=e.elements;return this.x=u[0]*t+u[4]*n+u[8]*i+u[12]*o,this.y=u[1]*t+u[5]*n+u[9]*i+u[13]*o,this.z=u[2]*t+u[6]*n+u[10]*i+u[14]*o,this.w=u[3]*t+u[7]*n+u[11]*i+u[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,o;const d=e.elements,p=d[0],m=d[4],g=d[8],y=d[1],_=d[5],M=d[9],A=d[2],E=d[6],S=d[10];if(Math.abs(m-y)<.01&&Math.abs(g-A)<.01&&Math.abs(M-E)<.01){if(Math.abs(m+y)<.1&&Math.abs(g+A)<.1&&Math.abs(M+E)<.1&&Math.abs(p+_+S-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const b=(p+1)/2,L=(_+1)/2,B=(S+1)/2,D=(m+y)/4,F=(g+A)/4,j=(M+E)/4;return b>L&&b>B?b<.01?(n=0,i=.707106781,o=.707106781):(n=Math.sqrt(b),i=D/n,o=F/n):L>B?L<.01?(n=.707106781,i=0,o=.707106781):(i=Math.sqrt(L),n=D/i,o=j/i):B<.01?(n=.707106781,i=.707106781,o=0):(o=Math.sqrt(B),n=F/o,i=j/o),this.set(n,i,o,t),this}let P=Math.sqrt((E-M)*(E-M)+(g-A)*(g-A)+(y-m)*(y-m));return Math.abs(P)<.001&&(P=1),this.x=(E-M)/P,this.y=(g-A)/P,this.z=(y-m)/P,this.w=Math.acos((p+_+S-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class vM extends xa{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new nn(0,0,e,t),this.scissorTest=!1,this.viewport=new nn(0,0,e,t);const i={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:pi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const o=new Vn(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);o.flipY=!1,o.generateMipmaps=n.generateMipmaps,o.internalFormat=n.internalFormat,this.textures=[];const u=n.count;for(let f=0;f<u;f++)this.textures[f]=o.clone(),this.textures[f].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,o=this.textures.length;i<o;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Au(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class qs extends vM{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class jm extends Vn{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ai,this.minFilter=Ai,this.wrapR=xs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class BT extends qs{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new jm(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class py extends Vn{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ai,this.minFilter=Ai,this.wrapR=xs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class HT extends qs{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new py(null,e,t,n),this.texture.isRenderTargetTexture=!0}}class ir{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,o,u,f){let d=n[i+0],p=n[i+1],m=n[i+2],g=n[i+3];const y=o[u+0],_=o[u+1],M=o[u+2],A=o[u+3];if(f===0){e[t+0]=d,e[t+1]=p,e[t+2]=m,e[t+3]=g;return}if(f===1){e[t+0]=y,e[t+1]=_,e[t+2]=M,e[t+3]=A;return}if(g!==A||d!==y||p!==_||m!==M){let E=1-f;const S=d*y+p*_+m*M+g*A,P=S>=0?1:-1,b=1-S*S;if(b>Number.EPSILON){const B=Math.sqrt(b),D=Math.atan2(B,S*P);E=Math.sin(E*D)/B,f=Math.sin(f*D)/B}const L=f*P;if(d=d*E+y*L,p=p*E+_*L,m=m*E+M*L,g=g*E+A*L,E===1-f){const B=1/Math.sqrt(d*d+p*p+m*m+g*g);d*=B,p*=B,m*=B,g*=B}}e[t]=d,e[t+1]=p,e[t+2]=m,e[t+3]=g}static multiplyQuaternionsFlat(e,t,n,i,o,u){const f=n[i],d=n[i+1],p=n[i+2],m=n[i+3],g=o[u],y=o[u+1],_=o[u+2],M=o[u+3];return e[t]=f*M+m*g+d*_-p*y,e[t+1]=d*M+m*y+p*g-f*_,e[t+2]=p*M+m*_+f*y-d*g,e[t+3]=m*M-f*g-d*y-p*_,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,o=e._z,u=e._order,f=Math.cos,d=Math.sin,p=f(n/2),m=f(i/2),g=f(o/2),y=d(n/2),_=d(i/2),M=d(o/2);switch(u){case"XYZ":this._x=y*m*g+p*_*M,this._y=p*_*g-y*m*M,this._z=p*m*M+y*_*g,this._w=p*m*g-y*_*M;break;case"YXZ":this._x=y*m*g+p*_*M,this._y=p*_*g-y*m*M,this._z=p*m*M-y*_*g,this._w=p*m*g+y*_*M;break;case"ZXY":this._x=y*m*g-p*_*M,this._y=p*_*g+y*m*M,this._z=p*m*M+y*_*g,this._w=p*m*g-y*_*M;break;case"ZYX":this._x=y*m*g-p*_*M,this._y=p*_*g+y*m*M,this._z=p*m*M-y*_*g,this._w=p*m*g+y*_*M;break;case"YZX":this._x=y*m*g+p*_*M,this._y=p*_*g+y*m*M,this._z=p*m*M-y*_*g,this._w=p*m*g-y*_*M;break;case"XZY":this._x=y*m*g-p*_*M,this._y=p*_*g-y*m*M,this._z=p*m*M+y*_*g,this._w=p*m*g+y*_*M;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],o=t[8],u=t[1],f=t[5],d=t[9],p=t[2],m=t[6],g=t[10],y=n+f+g;if(y>0){const _=.5/Math.sqrt(y+1);this._w=.25/_,this._x=(m-d)*_,this._y=(o-p)*_,this._z=(u-i)*_}else if(n>f&&n>g){const _=2*Math.sqrt(1+n-f-g);this._w=(m-d)/_,this._x=.25*_,this._y=(i+u)/_,this._z=(o+p)/_}else if(f>g){const _=2*Math.sqrt(1+f-n-g);this._w=(o-p)/_,this._x=(i+u)/_,this._y=.25*_,this._z=(d+m)/_}else{const _=2*Math.sqrt(1+g-n-f);this._w=(u-i)/_,this._x=(o+p)/_,this._y=(d+m)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Yn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,o=e._z,u=e._w,f=t._x,d=t._y,p=t._z,m=t._w;return this._x=n*m+u*f+i*p-o*d,this._y=i*m+u*d+o*f-n*p,this._z=o*m+u*p+n*d-i*f,this._w=u*m-n*f-i*d-o*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const n=this._x,i=this._y,o=this._z,u=this._w;let f=u*e._w+n*e._x+i*e._y+o*e._z;if(f<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,f=-f):this.copy(e),f>=1)return this._w=u,this._x=n,this._y=i,this._z=o,this;const d=1-f*f;if(d<=Number.EPSILON){const _=1-t;return this._w=_*u+t*this._w,this._x=_*n+t*this._x,this._y=_*i+t*this._y,this._z=_*o+t*this._z,this.normalize(),this}const p=Math.sqrt(d),m=Math.atan2(p,f),g=Math.sin((1-t)*m)/p,y=Math.sin(t*m)/p;return this._w=u*g+this._w*y,this._x=n*g+this._x*y,this._y=i*g+this._y*y,this._z=o*g+this._z*y,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),o=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),o*Math.sin(t),o*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class G{constructor(e=0,t=0,n=0){G.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Fx.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Fx.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*i,this.y=o[1]*t+o[4]*n+o[7]*i,this.z=o[2]*t+o[5]*n+o[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,o=e.elements,u=1/(o[3]*t+o[7]*n+o[11]*i+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*i+o[12])*u,this.y=(o[1]*t+o[5]*n+o[9]*i+o[13])*u,this.z=(o[2]*t+o[6]*n+o[10]*i+o[14])*u,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,o=e.x,u=e.y,f=e.z,d=e.w,p=2*(u*i-f*n),m=2*(f*t-o*i),g=2*(o*n-u*t);return this.x=t+d*p+u*g-f*m,this.y=n+d*m+f*p-o*g,this.z=i+d*g+o*m-u*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i,this.y=o[1]*t+o[5]*n+o[9]*i,this.z=o[2]*t+o[6]*n+o[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,o=e.z,u=t.x,f=t.y,d=t.z;return this.x=i*d-o*f,this.y=o*u-n*d,this.z=n*f-i*u,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Kg.copy(this).projectOnVector(e),this.sub(Kg)}reflect(e){return this.sub(Kg.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Yn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Kg=new G,Fx=new ir;class Ci{constructor(e=new G(1/0,1/0,1/0),t=new G(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Vs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Vs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Vs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const o=n.getAttribute("position");if(t===!0&&o!==void 0&&e.isInstancedMesh!==!0)for(let u=0,f=o.count;u<f;u++)e.isMesh===!0?e.getVertexPosition(u,Vs):Vs.fromBufferAttribute(o,u),Vs.applyMatrix4(e.matrixWorld),this.expandByPoint(Vs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Ep.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Ep.copy(n.boundingBox)),Ep.applyMatrix4(e.matrixWorld),this.union(Ep)}const i=e.children;for(let o=0,u=i.length;o<u;o++)this.expandByObject(i[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Vs),Vs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Cd),Tp.subVectors(this.max,Cd),Vc.subVectors(e.a,Cd),Gc.subVectors(e.b,Cd),Wc.subVectors(e.c,Cd),al.subVectors(Gc,Vc),ll.subVectors(Wc,Gc),au.subVectors(Vc,Wc);let t=[0,-al.z,al.y,0,-ll.z,ll.y,0,-au.z,au.y,al.z,0,-al.x,ll.z,0,-ll.x,au.z,0,-au.x,-al.y,al.x,0,-ll.y,ll.x,0,-au.y,au.x,0];return!Jg(t,Vc,Gc,Wc,Tp)||(t=[1,0,0,0,1,0,0,0,1],!Jg(t,Vc,Gc,Wc,Tp))?!1:(Ap.crossVectors(al,ll),t=[Ap.x,Ap.y,Ap.z],Jg(t,Vc,Gc,Wc,Tp))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Vs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Vs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ra[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ra[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ra[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ra[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ra[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ra[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ra[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ra[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ra),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ra=[new G,new G,new G,new G,new G,new G,new G,new G],Vs=new G,Ep=new Ci,Vc=new G,Gc=new G,Wc=new G,al=new G,ll=new G,au=new G,Cd=new G,Tp=new G,Ap=new G,lu=new G;function Jg(s,e,t,n,i){for(let o=0,u=s.length-3;o<=u;o+=3){lu.fromArray(s,o);const f=i.x*Math.abs(lu.x)+i.y*Math.abs(lu.y)+i.z*Math.abs(lu.z),d=e.dot(lu),p=t.dot(lu),m=n.dot(lu);if(Math.max(-Math.max(d,p,m),Math.min(d,p,m))>f)return!1}return!0}const VT=new Ci,bd=new G,$g=new G;class bi{constructor(e=new G,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):VT.setFromPoints(e).getCenter(n);let i=0;for(let o=0,u=e.length;o<u;o++)i=Math.max(i,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;bd.subVectors(e,this.center);const t=bd.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(bd,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):($g.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(bd.copy(e.center).add($g)),this.expandByPoint(bd.copy(e.center).sub($g))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const sa=new G,e0=new G,Cp=new G,ul=new G,t0=new G,bp=new G,n0=new G;class Ou{constructor(e=new G,t=new G(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,sa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=sa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(sa.copy(this.origin).addScaledVector(this.direction,t),sa.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){e0.copy(e).add(t).multiplyScalar(.5),Cp.copy(t).sub(e).normalize(),ul.copy(this.origin).sub(e0);const o=e.distanceTo(t)*.5,u=-this.direction.dot(Cp),f=ul.dot(this.direction),d=-ul.dot(Cp),p=ul.lengthSq(),m=Math.abs(1-u*u);let g,y,_,M;if(m>0)if(g=u*d-f,y=u*f-d,M=o*m,g>=0)if(y>=-M)if(y<=M){const A=1/m;g*=A,y*=A,_=g*(g+u*y+2*f)+y*(u*g+y+2*d)+p}else y=o,g=Math.max(0,-(u*y+f)),_=-g*g+y*(y+2*d)+p;else y=-o,g=Math.max(0,-(u*y+f)),_=-g*g+y*(y+2*d)+p;else y<=-M?(g=Math.max(0,-(-u*o+f)),y=g>0?-o:Math.min(Math.max(-o,-d),o),_=-g*g+y*(y+2*d)+p):y<=M?(g=0,y=Math.min(Math.max(-o,-d),o),_=y*(y+2*d)+p):(g=Math.max(0,-(u*o+f)),y=g>0?o:Math.min(Math.max(-o,-d),o),_=-g*g+y*(y+2*d)+p);else y=u>0?-o:o,g=Math.max(0,-(u*y+f)),_=-g*g+y*(y+2*d)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,g),i&&i.copy(e0).addScaledVector(Cp,y),_}intersectSphere(e,t){sa.subVectors(e.center,this.origin);const n=sa.dot(this.direction),i=sa.dot(sa)-n*n,o=e.radius*e.radius;if(i>o)return null;const u=Math.sqrt(o-i),f=n-u,d=n+u;return d<0?null:f<0?this.at(d,t):this.at(f,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,o,u,f,d;const p=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,y=this.origin;return p>=0?(n=(e.min.x-y.x)*p,i=(e.max.x-y.x)*p):(n=(e.max.x-y.x)*p,i=(e.min.x-y.x)*p),m>=0?(o=(e.min.y-y.y)*m,u=(e.max.y-y.y)*m):(o=(e.max.y-y.y)*m,u=(e.min.y-y.y)*m),n>u||o>i||((o>n||isNaN(n))&&(n=o),(u<i||isNaN(i))&&(i=u),g>=0?(f=(e.min.z-y.z)*g,d=(e.max.z-y.z)*g):(f=(e.max.z-y.z)*g,d=(e.min.z-y.z)*g),n>d||f>i)||((f>n||n!==n)&&(n=f),(d<i||i!==i)&&(i=d),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,sa)!==null}intersectTriangle(e,t,n,i,o){t0.subVectors(t,e),bp.subVectors(n,e),n0.crossVectors(t0,bp);let u=this.direction.dot(n0),f;if(u>0){if(i)return null;f=1}else if(u<0)f=-1,u=-u;else return null;ul.subVectors(this.origin,e);const d=f*this.direction.dot(bp.crossVectors(ul,bp));if(d<0)return null;const p=f*this.direction.dot(t0.cross(ul));if(p<0||d+p>u)return null;const m=-f*ul.dot(n0);return m<0?null:this.at(m/u,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class It{constructor(e,t,n,i,o,u,f,d,p,m,g,y,_,M,A,E){It.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,o,u,f,d,p,m,g,y,_,M,A,E)}set(e,t,n,i,o,u,f,d,p,m,g,y,_,M,A,E){const S=this.elements;return S[0]=e,S[4]=t,S[8]=n,S[12]=i,S[1]=o,S[5]=u,S[9]=f,S[13]=d,S[2]=p,S[6]=m,S[10]=g,S[14]=y,S[3]=_,S[7]=M,S[11]=A,S[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new It().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/jc.setFromMatrixColumn(e,0).length(),o=1/jc.setFromMatrixColumn(e,1).length(),u=1/jc.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,o=e.z,u=Math.cos(n),f=Math.sin(n),d=Math.cos(i),p=Math.sin(i),m=Math.cos(o),g=Math.sin(o);if(e.order==="XYZ"){const y=u*m,_=u*g,M=f*m,A=f*g;t[0]=d*m,t[4]=-d*g,t[8]=p,t[1]=_+M*p,t[5]=y-A*p,t[9]=-f*d,t[2]=A-y*p,t[6]=M+_*p,t[10]=u*d}else if(e.order==="YXZ"){const y=d*m,_=d*g,M=p*m,A=p*g;t[0]=y+A*f,t[4]=M*f-_,t[8]=u*p,t[1]=u*g,t[5]=u*m,t[9]=-f,t[2]=_*f-M,t[6]=A+y*f,t[10]=u*d}else if(e.order==="ZXY"){const y=d*m,_=d*g,M=p*m,A=p*g;t[0]=y-A*f,t[4]=-u*g,t[8]=M+_*f,t[1]=_+M*f,t[5]=u*m,t[9]=A-y*f,t[2]=-u*p,t[6]=f,t[10]=u*d}else if(e.order==="ZYX"){const y=u*m,_=u*g,M=f*m,A=f*g;t[0]=d*m,t[4]=M*p-_,t[8]=y*p+A,t[1]=d*g,t[5]=A*p+y,t[9]=_*p-M,t[2]=-p,t[6]=f*d,t[10]=u*d}else if(e.order==="YZX"){const y=u*d,_=u*p,M=f*d,A=f*p;t[0]=d*m,t[4]=A-y*g,t[8]=M*g+_,t[1]=g,t[5]=u*m,t[9]=-f*m,t[2]=-p*m,t[6]=_*g+M,t[10]=y-A*g}else if(e.order==="XZY"){const y=u*d,_=u*p,M=f*d,A=f*p;t[0]=d*m,t[4]=-g,t[8]=p*m,t[1]=y*g+A,t[5]=u*m,t[9]=_*g-M,t[2]=M*g-_,t[6]=f*m,t[10]=A*g+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(GT,e,WT)}lookAt(e,t,n){const i=this.elements;return Kr.subVectors(e,t),Kr.lengthSq()===0&&(Kr.z=1),Kr.normalize(),cl.crossVectors(n,Kr),cl.lengthSq()===0&&(Math.abs(n.z)===1?Kr.x+=1e-4:Kr.z+=1e-4,Kr.normalize(),cl.crossVectors(n,Kr)),cl.normalize(),Rp.crossVectors(Kr,cl),i[0]=cl.x,i[4]=Rp.x,i[8]=Kr.x,i[1]=cl.y,i[5]=Rp.y,i[9]=Kr.y,i[2]=cl.z,i[6]=Rp.z,i[10]=Kr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,o=this.elements,u=n[0],f=n[4],d=n[8],p=n[12],m=n[1],g=n[5],y=n[9],_=n[13],M=n[2],A=n[6],E=n[10],S=n[14],P=n[3],b=n[7],L=n[11],B=n[15],D=i[0],F=i[4],j=i[8],O=i[12],N=i[1],X=i[5],te=i[9],Q=i[13],ue=i[2],fe=i[6],ye=i[10],Me=i[14],W=i[3],ee=i[7],k=i[11],J=i[15];return o[0]=u*D+f*N+d*ue+p*W,o[4]=u*F+f*X+d*fe+p*ee,o[8]=u*j+f*te+d*ye+p*k,o[12]=u*O+f*Q+d*Me+p*J,o[1]=m*D+g*N+y*ue+_*W,o[5]=m*F+g*X+y*fe+_*ee,o[9]=m*j+g*te+y*ye+_*k,o[13]=m*O+g*Q+y*Me+_*J,o[2]=M*D+A*N+E*ue+S*W,o[6]=M*F+A*X+E*fe+S*ee,o[10]=M*j+A*te+E*ye+S*k,o[14]=M*O+A*Q+E*Me+S*J,o[3]=P*D+b*N+L*ue+B*W,o[7]=P*F+b*X+L*fe+B*ee,o[11]=P*j+b*te+L*ye+B*k,o[15]=P*O+b*Q+L*Me+B*J,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],o=e[12],u=e[1],f=e[5],d=e[9],p=e[13],m=e[2],g=e[6],y=e[10],_=e[14],M=e[3],A=e[7],E=e[11],S=e[15];return M*(+o*d*g-i*p*g-o*f*y+n*p*y+i*f*_-n*d*_)+A*(+t*d*_-t*p*y+o*u*y-i*u*_+i*p*m-o*d*m)+E*(+t*p*g-t*f*_-o*u*g+n*u*_+o*f*m-n*p*m)+S*(-i*f*m-t*d*g+t*f*y+i*u*g-n*u*y+n*d*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],o=e[3],u=e[4],f=e[5],d=e[6],p=e[7],m=e[8],g=e[9],y=e[10],_=e[11],M=e[12],A=e[13],E=e[14],S=e[15],P=g*E*p-A*y*p+A*d*_-f*E*_-g*d*S+f*y*S,b=M*y*p-m*E*p-M*d*_+u*E*_+m*d*S-u*y*S,L=m*A*p-M*g*p+M*f*_-u*A*_-m*f*S+u*g*S,B=M*g*d-m*A*d-M*f*y+u*A*y+m*f*E-u*g*E,D=t*P+n*b+i*L+o*B;if(D===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const F=1/D;return e[0]=P*F,e[1]=(A*y*o-g*E*o-A*i*_+n*E*_+g*i*S-n*y*S)*F,e[2]=(f*E*o-A*d*o+A*i*p-n*E*p-f*i*S+n*d*S)*F,e[3]=(g*d*o-f*y*o-g*i*p+n*y*p+f*i*_-n*d*_)*F,e[4]=b*F,e[5]=(m*E*o-M*y*o+M*i*_-t*E*_-m*i*S+t*y*S)*F,e[6]=(M*d*o-u*E*o-M*i*p+t*E*p+u*i*S-t*d*S)*F,e[7]=(u*y*o-m*d*o+m*i*p-t*y*p-u*i*_+t*d*_)*F,e[8]=L*F,e[9]=(M*g*o-m*A*o-M*n*_+t*A*_+m*n*S-t*g*S)*F,e[10]=(u*A*o-M*f*o+M*n*p-t*A*p-u*n*S+t*f*S)*F,e[11]=(m*f*o-u*g*o-m*n*p+t*g*p+u*n*_-t*f*_)*F,e[12]=B*F,e[13]=(m*A*i-M*g*i+M*n*y-t*A*y-m*n*E+t*g*E)*F,e[14]=(M*f*i-u*A*i-M*n*d+t*A*d+u*n*E-t*f*E)*F,e[15]=(u*g*i-m*f*i+m*n*d-t*g*d-u*n*y+t*f*y)*F,this}scale(e){const t=this.elements,n=e.x,i=e.y,o=e.z;return t[0]*=n,t[4]*=i,t[8]*=o,t[1]*=n,t[5]*=i,t[9]*=o,t[2]*=n,t[6]*=i,t[10]*=o,t[3]*=n,t[7]*=i,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),o=1-n,u=e.x,f=e.y,d=e.z,p=o*u,m=o*f;return this.set(p*u+n,p*f-i*d,p*d+i*f,0,p*f+i*d,m*f+n,m*d-i*u,0,p*d-i*f,m*d+i*u,o*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,o,u){return this.set(1,n,o,0,e,1,u,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,o=t._x,u=t._y,f=t._z,d=t._w,p=o+o,m=u+u,g=f+f,y=o*p,_=o*m,M=o*g,A=u*m,E=u*g,S=f*g,P=d*p,b=d*m,L=d*g,B=n.x,D=n.y,F=n.z;return i[0]=(1-(A+S))*B,i[1]=(_+L)*B,i[2]=(M-b)*B,i[3]=0,i[4]=(_-L)*D,i[5]=(1-(y+S))*D,i[6]=(E+P)*D,i[7]=0,i[8]=(M+b)*F,i[9]=(E-P)*F,i[10]=(1-(y+A))*F,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let o=jc.set(i[0],i[1],i[2]).length();const u=jc.set(i[4],i[5],i[6]).length(),f=jc.set(i[8],i[9],i[10]).length();this.determinant()<0&&(o=-o),e.x=i[12],e.y=i[13],e.z=i[14],Gs.copy(this);const p=1/o,m=1/u,g=1/f;return Gs.elements[0]*=p,Gs.elements[1]*=p,Gs.elements[2]*=p,Gs.elements[4]*=m,Gs.elements[5]*=m,Gs.elements[6]*=m,Gs.elements[8]*=g,Gs.elements[9]*=g,Gs.elements[10]*=g,t.setFromRotationMatrix(Gs),n.x=o,n.y=u,n.z=f,this}makePerspective(e,t,n,i,o,u,f=wo){const d=this.elements,p=2*o/(t-e),m=2*o/(n-i),g=(t+e)/(t-e),y=(n+i)/(n-i);let _,M;if(f===wo)_=-(u+o)/(u-o),M=-2*u*o/(u-o);else if(f===oh)_=-u/(u-o),M=-u*o/(u-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);return d[0]=p,d[4]=0,d[8]=g,d[12]=0,d[1]=0,d[5]=m,d[9]=y,d[13]=0,d[2]=0,d[6]=0,d[10]=_,d[14]=M,d[3]=0,d[7]=0,d[11]=-1,d[15]=0,this}makeOrthographic(e,t,n,i,o,u,f=wo){const d=this.elements,p=1/(t-e),m=1/(n-i),g=1/(u-o),y=(t+e)*p,_=(n+i)*m;let M,A;if(f===wo)M=(u+o)*g,A=-2*g;else if(f===oh)M=o*g,A=-1*g;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);return d[0]=2*p,d[4]=0,d[8]=0,d[12]=-y,d[1]=0,d[5]=2*m,d[9]=0,d[13]=-_,d[2]=0,d[6]=0,d[10]=A,d[14]=-M,d[3]=0,d[7]=0,d[11]=0,d[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const jc=new G,Gs=new It,GT=new G(0,0,0),WT=new G(1,1,1),cl=new G,Rp=new G,Kr=new G,Bx=new It,Hx=new ir;class ns{constructor(e=0,t=0,n=0,i=ns.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,o=i[0],u=i[4],f=i[8],d=i[1],p=i[5],m=i[9],g=i[2],y=i[6],_=i[10];switch(t){case"XYZ":this._y=Math.asin(Yn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,_),this._z=Math.atan2(-u,o)):(this._x=Math.atan2(y,p),this._z=0);break;case"YXZ":this._x=Math.asin(-Yn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(f,_),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-g,o),this._z=0);break;case"ZXY":this._x=Math.asin(Yn(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-g,_),this._z=Math.atan2(-u,p)):(this._y=0,this._z=Math.atan2(d,o));break;case"ZYX":this._y=Math.asin(-Yn(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(y,_),this._z=Math.atan2(d,o)):(this._x=0,this._z=Math.atan2(-u,p));break;case"YZX":this._z=Math.asin(Yn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,p),this._y=Math.atan2(-g,o)):(this._x=0,this._y=Math.atan2(f,_));break;case"XZY":this._z=Math.asin(-Yn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(y,p),this._y=Math.atan2(f,o)):(this._x=Math.atan2(-m,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Bx.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Bx,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Hx.setFromEuler(this),this.setFromQuaternion(Hx,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ns.DEFAULT_ORDER="XYZ";let Lu=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},jT=0;const Vx=new G,Xc=new ir,oa=new It,Pp=new G,Rd=new G,XT=new G,YT=new ir,Gx=new G(1,0,0),Wx=new G(0,1,0),jx=new G(0,0,1),Xx={type:"added"},qT={type:"removed"},Yc={type:"childadded",child:null},i0={type:"childremoved",child:null};class cn extends xa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:jT++}),this.uuid=ts(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=cn.DEFAULT_UP.clone();const e=new G,t=new ns,n=new ir,i=new G(1,1,1);function o(){n.setFromEuler(t,!1)}function u(){t.setFromQuaternion(n,void 0,!1)}t._onChange(o),n._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new It},normalMatrix:{value:new Wt}}),this.matrix=new It,this.matrixWorld=new It,this.matrixAutoUpdate=cn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=cn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Lu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Xc.setFromAxisAngle(e,t),this.quaternion.multiply(Xc),this}rotateOnWorldAxis(e,t){return Xc.setFromAxisAngle(e,t),this.quaternion.premultiply(Xc),this}rotateX(e){return this.rotateOnAxis(Gx,e)}rotateY(e){return this.rotateOnAxis(Wx,e)}rotateZ(e){return this.rotateOnAxis(jx,e)}translateOnAxis(e,t){return Vx.copy(e).applyQuaternion(this.quaternion),this.position.add(Vx.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Gx,e)}translateY(e){return this.translateOnAxis(Wx,e)}translateZ(e){return this.translateOnAxis(jx,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(oa.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Pp.copy(e):Pp.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Rd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?oa.lookAt(Rd,Pp,this.up):oa.lookAt(Pp,Rd,this.up),this.quaternion.setFromRotationMatrix(oa),i&&(oa.extractRotation(i.matrixWorld),Xc.setFromRotationMatrix(oa),this.quaternion.premultiply(Xc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Xx),Yc.child=e,this.dispatchEvent(Yc),Yc.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(qT),i0.child=e,this.dispatchEvent(i0),i0.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),oa.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),oa.multiply(e.parent.matrixWorld)),e.applyMatrix4(oa),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Xx),Yc.child=e,this.dispatchEvent(Yc),Yc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const u=this.children[n].getObjectByProperty(e,t);if(u!==void 0)return u}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let o=0,u=i.length;o<u;o++)i[o].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rd,e,XT),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rd,YT,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++){const o=t[n];(o.matrixWorldAutoUpdate===!0||e===!0)&&o.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const i=this.children;for(let o=0,u=i.length;o<u;o++){const f=i[o];f.matrixWorldAutoUpdate===!0&&f.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(f=>({boxInitialized:f.boxInitialized,boxMin:f.box.min.toArray(),boxMax:f.box.max.toArray(),sphereInitialized:f.sphereInitialized,sphereRadius:f.sphere.radius,sphereCenter:f.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function o(f,d){return f[d.uuid]===void 0&&(f[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=o(e.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const d=f.shapes;if(Array.isArray(d))for(let p=0,m=d.length;p<m;p++){const g=d[p];o(e.shapes,g)}else o(e.shapes,d)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let d=0,p=this.material.length;d<p;d++)f.push(o(e.materials,this.material[d]));i.material=f}else i.material=o(e.materials,this.material);if(this.children.length>0){i.children=[];for(let f=0;f<this.children.length;f++)i.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let f=0;f<this.animations.length;f++){const d=this.animations[f];i.animations.push(o(e.animations,d))}}if(t){const f=u(e.geometries),d=u(e.materials),p=u(e.textures),m=u(e.images),g=u(e.shapes),y=u(e.skeletons),_=u(e.animations),M=u(e.nodes);f.length>0&&(n.geometries=f),d.length>0&&(n.materials=d),p.length>0&&(n.textures=p),m.length>0&&(n.images=m),g.length>0&&(n.shapes=g),y.length>0&&(n.skeletons=y),_.length>0&&(n.animations=_),M.length>0&&(n.nodes=M)}return n.object=i,n;function u(f){const d=[];for(const p in f){const m=f[p];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}cn.DEFAULT_UP=new G(0,1,0);cn.DEFAULT_MATRIX_AUTO_UPDATE=!0;cn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ws=new G,aa=new G,r0=new G,la=new G,qc=new G,Zc=new G,Yx=new G,s0=new G,o0=new G,a0=new G;class $r{constructor(e=new G,t=new G,n=new G){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),Ws.subVectors(e,t),i.cross(Ws);const o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}static getBarycoord(e,t,n,i,o){Ws.subVectors(i,t),aa.subVectors(n,t),r0.subVectors(e,t);const u=Ws.dot(Ws),f=Ws.dot(aa),d=Ws.dot(r0),p=aa.dot(aa),m=aa.dot(r0),g=u*p-f*f;if(g===0)return o.set(0,0,0),null;const y=1/g,_=(p*d-f*m)*y,M=(u*m-f*d)*y;return o.set(1-_-M,M,_)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,la)===null?!1:la.x>=0&&la.y>=0&&la.x+la.y<=1}static getInterpolation(e,t,n,i,o,u,f,d){return this.getBarycoord(e,t,n,i,la)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(o,la.x),d.addScaledVector(u,la.y),d.addScaledVector(f,la.z),d)}static isFrontFacing(e,t,n,i){return Ws.subVectors(n,t),aa.subVectors(e,t),Ws.cross(aa).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ws.subVectors(this.c,this.b),aa.subVectors(this.a,this.b),Ws.cross(aa).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return $r.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return $r.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,o){return $r.getInterpolation(e,this.a,this.b,this.c,t,n,i,o)}containsPoint(e){return $r.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return $r.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,o=this.c;let u,f;qc.subVectors(i,n),Zc.subVectors(o,n),s0.subVectors(e,n);const d=qc.dot(s0),p=Zc.dot(s0);if(d<=0&&p<=0)return t.copy(n);o0.subVectors(e,i);const m=qc.dot(o0),g=Zc.dot(o0);if(m>=0&&g<=m)return t.copy(i);const y=d*g-m*p;if(y<=0&&d>=0&&m<=0)return u=d/(d-m),t.copy(n).addScaledVector(qc,u);a0.subVectors(e,o);const _=qc.dot(a0),M=Zc.dot(a0);if(M>=0&&_<=M)return t.copy(o);const A=_*p-d*M;if(A<=0&&p>=0&&M<=0)return f=p/(p-M),t.copy(n).addScaledVector(Zc,f);const E=m*M-_*g;if(E<=0&&g-m>=0&&_-M>=0)return Yx.subVectors(o,i),f=(g-m)/(g-m+(_-M)),t.copy(i).addScaledVector(Yx,f);const S=1/(E+A+y);return u=A*S,f=y*S,t.copy(n).addScaledVector(qc,u).addScaledVector(Zc,f)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const yM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},fl={h:0,s:0,l:0},Lp={h:0,s:0,l:0};function l0(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class st{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=vs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,pn.toWorkingColorSpace(this,t),this}setRGB(e,t,n,i=pn.workingColorSpace){return this.r=e,this.g=t,this.b=n,pn.toWorkingColorSpace(this,i),this}setHSL(e,t,n,i=pn.workingColorSpace){if(e=dy(e,1),t=Yn(t,0,1),n=Yn(n,0,1),t===0)this.r=this.g=this.b=n;else{const o=n<=.5?n*(1+t):n+t-n*t,u=2*n-o;this.r=l0(u,o,e+1/3),this.g=l0(u,o,e),this.b=l0(u,o,e-1/3)}return pn.toWorkingColorSpace(this,i),this}setStyle(e,t=vs){function n(o){o!==void 0&&parseFloat(o)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let o;const u=i[1],f=i[2];switch(u){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return n(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,t);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return n(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,t);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return n(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const o=i[1],u=o.length;if(u===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,t);if(u===6)return this.setHex(parseInt(o,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=vs){const n=yM[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Sf(e.r),this.g=Sf(e.g),this.b=Sf(e.b),this}copyLinearToSRGB(e){return this.r=Zg(e.r),this.g=Zg(e.g),this.b=Zg(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=vs){return pn.fromWorkingColorSpace(er.copy(this),e),Math.round(Yn(er.r*255,0,255))*65536+Math.round(Yn(er.g*255,0,255))*256+Math.round(Yn(er.b*255,0,255))}getHexString(e=vs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=pn.workingColorSpace){pn.fromWorkingColorSpace(er.copy(this),t);const n=er.r,i=er.g,o=er.b,u=Math.max(n,i,o),f=Math.min(n,i,o);let d,p;const m=(f+u)/2;if(f===u)d=0,p=0;else{const g=u-f;switch(p=m<=.5?g/(u+f):g/(2-u-f),u){case n:d=(i-o)/g+(i<o?6:0);break;case i:d=(o-n)/g+2;break;case o:d=(n-i)/g+4;break}d/=6}return e.h=d,e.s=p,e.l=m,e}getRGB(e,t=pn.workingColorSpace){return pn.fromWorkingColorSpace(er.copy(this),t),e.r=er.r,e.g=er.g,e.b=er.b,e}getStyle(e=vs){pn.fromWorkingColorSpace(er.copy(this),e);const t=er.r,n=er.g,i=er.b;return e!==vs?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(fl),this.setHSL(fl.h+e,fl.s+t,fl.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(fl),e.getHSL(Lp);const n=jd(fl.h,Lp.h,t),i=jd(fl.s,Lp.s,t),o=jd(fl.l,Lp.l,t);return this.setHSL(n,i,o),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,o=e.elements;return this.r=o[0]*t+o[3]*n+o[6]*i,this.g=o[1]*t+o[4]*n+o[7]*i,this.b=o[2]*t+o[5]*n+o[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const er=new st;st.NAMES=yM;let ZT=0;class Wi extends xa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ZT++}),this.uuid=ts(),this.name="",this.type="Material",this.blending=bu,this.side=ma,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Lm,this.blendDst=Im,this.blendEquation=gl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new st(0,0,0),this.blendAlpha=0,this.depthFunc=qd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Fv,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Su,this.stencilZFail=Su,this.stencilZPass=Su,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==bu&&(n.blending=this.blending),this.side!==ma&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Lm&&(n.blendSrc=this.blendSrc),this.blendDst!==Im&&(n.blendDst=this.blendDst),this.blendEquation!==gl&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==qd&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Fv&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Su&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Su&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Su&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(o){const u=[];for(const f in o){const d=o[f];delete d.metadata,u.push(d)}return u}if(t){const o=i(e.textures),u=i(e.images);o.length>0&&(n.textures=o),u.length>0&&(n.images=u)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let o=0;o!==i;++o)n[o]=t[o].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ml extends Wi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const da=QT();function QT(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),i=new Uint32Array(512);for(let d=0;d<256;++d){const p=d-127;p<-27?(n[d]=0,n[d|256]=32768,i[d]=24,i[d|256]=24):p<-14?(n[d]=1024>>-p-14,n[d|256]=1024>>-p-14|32768,i[d]=-p-1,i[d|256]=-p-1):p<=15?(n[d]=p+15<<10,n[d|256]=p+15<<10|32768,i[d]=13,i[d|256]=13):p<128?(n[d]=31744,n[d|256]=64512,i[d]=24,i[d|256]=24):(n[d]=31744,n[d|256]=64512,i[d]=13,i[d|256]=13)}const o=new Uint32Array(2048),u=new Uint32Array(64),f=new Uint32Array(64);for(let d=1;d<1024;++d){let p=d<<13,m=0;for(;(p&8388608)===0;)p<<=1,m-=8388608;p&=-8388609,m+=947912704,o[d]=p|m}for(let d=1024;d<2048;++d)o[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)u[d]=d<<23;u[31]=1199570944,u[32]=2147483648;for(let d=33;d<63;++d)u[d]=2147483648+(d-32<<23);u[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(f[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:o,exponentTable:u,offsetTable:f}}function Ur(s){Math.abs(s)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),s=Yn(s,-65504,65504),da.floatView[0]=s;const e=da.uint32View[0],t=e>>23&511;return da.baseTable[t]+((e&8388607)>>da.shiftTable[t])}function Hd(s){const e=s>>10;return da.uint32View[0]=da.mantissaTable[da.offsetTable[e]+(s&1023)]+da.exponentTable[e],da.floatView[0]}const KT={toHalfFloat:Ur,fromHalfFloat:Hd},hi=new G,Ip=new Ne;class mn{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=sh,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=_s,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return mM("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,o=this.itemSize;i<o;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Ip.fromBufferAttribute(this,t),Ip.applyMatrix3(e),this.setXY(t,Ip.x,Ip.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)hi.fromBufferAttribute(this,t),hi.applyMatrix3(e),this.setXYZ(t,hi.x,hi.y,hi.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)hi.fromBufferAttribute(this,t),hi.applyMatrix4(e),this.setXYZ(t,hi.x,hi.y,hi.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)hi.fromBufferAttribute(this,t),hi.applyNormalMatrix(e),this.setXYZ(t,hi.x,hi.y,hi.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)hi.fromBufferAttribute(this,t),hi.transformDirection(e),this.setXYZ(t,hi.x,hi.y,hi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=gr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=jt(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=gr(t,this.array)),t}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=gr(t,this.array)),t}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=gr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=gr(t,this.array)),t}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array),i=jt(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,o){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array),i=jt(i,this.array),o=jt(o,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==sh&&(e.usage=this.usage),e}}class JT extends mn{constructor(e,t,n){super(new Int8Array(e),t,n)}}class $T extends mn{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class eA extends mn{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class tA extends mn{constructor(e,t,n){super(new Int16Array(e),t,n)}}class my extends mn{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class nA extends mn{constructor(e,t,n){super(new Int32Array(e),t,n)}}class gy extends mn{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class iA extends mn{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Hd(this.array[e*this.itemSize]);return this.normalized&&(t=gr(t,this.array)),t}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize]=Ur(t),this}getY(e){let t=Hd(this.array[e*this.itemSize+1]);return this.normalized&&(t=gr(t,this.array)),t}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+1]=Ur(t),this}getZ(e){let t=Hd(this.array[e*this.itemSize+2]);return this.normalized&&(t=gr(t,this.array)),t}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+2]=Ur(t),this}getW(e){let t=Hd(this.array[e*this.itemSize+3]);return this.normalized&&(t=gr(t,this.array)),t}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.array[e*this.itemSize+3]=Ur(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array)),this.array[e+0]=Ur(t),this.array[e+1]=Ur(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array),i=jt(i,this.array)),this.array[e+0]=Ur(t),this.array[e+1]=Ur(n),this.array[e+2]=Ur(i),this}setXYZW(e,t,n,i,o){return e*=this.itemSize,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array),i=jt(i,this.array),o=jt(o,this.array)),this.array[e+0]=Ur(t),this.array[e+1]=Ur(n),this.array[e+2]=Ur(i),this.array[e+3]=Ur(o),this}}class pt extends mn{constructor(e,t,n){super(new Float32Array(e),t,n)}}let rA=0;const gs=new It,u0=new cn,Qc=new G,Jr=new Ci,Pd=new Ci,Ti=new G;class Zt extends xa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rA++}),this.uuid=ts(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(hM(e)?gy:my)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const o=new Wt().getNormalMatrix(e);n.applyNormalMatrix(o),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return gs.makeRotationFromQuaternion(e),this.applyMatrix4(gs),this}rotateX(e){return gs.makeRotationX(e),this.applyMatrix4(gs),this}rotateY(e){return gs.makeRotationY(e),this.applyMatrix4(gs),this}rotateZ(e){return gs.makeRotationZ(e),this.applyMatrix4(gs),this}translate(e,t,n){return gs.makeTranslation(e,t,n),this.applyMatrix4(gs),this}scale(e,t,n){return gs.makeScale(e,t,n),this.applyMatrix4(gs),this}lookAt(e){return u0.lookAt(e),u0.updateMatrix(),this.applyMatrix4(u0.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qc).negate(),this.translate(Qc.x,Qc.y,Qc.z),this}setFromPoints(e){const t=[];for(let n=0,i=e.length;n<i;n++){const o=e[n];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new pt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ci);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new G(-1/0,-1/0,-1/0),new G(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const o=t[n];Jr.setFromBufferAttribute(o),this.morphTargetsRelative?(Ti.addVectors(this.boundingBox.min,Jr.min),this.boundingBox.expandByPoint(Ti),Ti.addVectors(this.boundingBox.max,Jr.max),this.boundingBox.expandByPoint(Ti)):(this.boundingBox.expandByPoint(Jr.min),this.boundingBox.expandByPoint(Jr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new G,1/0);return}if(e){const n=this.boundingSphere.center;if(Jr.setFromBufferAttribute(e),t)for(let o=0,u=t.length;o<u;o++){const f=t[o];Pd.setFromBufferAttribute(f),this.morphTargetsRelative?(Ti.addVectors(Jr.min,Pd.min),Jr.expandByPoint(Ti),Ti.addVectors(Jr.max,Pd.max),Jr.expandByPoint(Ti)):(Jr.expandByPoint(Pd.min),Jr.expandByPoint(Pd.max))}Jr.getCenter(n);let i=0;for(let o=0,u=e.count;o<u;o++)Ti.fromBufferAttribute(e,o),i=Math.max(i,n.distanceToSquared(Ti));if(t)for(let o=0,u=t.length;o<u;o++){const f=t[o],d=this.morphTargetsRelative;for(let p=0,m=f.count;p<m;p++)Ti.fromBufferAttribute(f,p),d&&(Qc.fromBufferAttribute(e,p),Ti.add(Qc)),i=Math.max(i,n.distanceToSquared(Ti))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,o=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new mn(new Float32Array(4*n.count),4));const u=this.getAttribute("tangent"),f=[],d=[];for(let j=0;j<n.count;j++)f[j]=new G,d[j]=new G;const p=new G,m=new G,g=new G,y=new Ne,_=new Ne,M=new Ne,A=new G,E=new G;function S(j,O,N){p.fromBufferAttribute(n,j),m.fromBufferAttribute(n,O),g.fromBufferAttribute(n,N),y.fromBufferAttribute(o,j),_.fromBufferAttribute(o,O),M.fromBufferAttribute(o,N),m.sub(p),g.sub(p),_.sub(y),M.sub(y);const X=1/(_.x*M.y-M.x*_.y);isFinite(X)&&(A.copy(m).multiplyScalar(M.y).addScaledVector(g,-_.y).multiplyScalar(X),E.copy(g).multiplyScalar(_.x).addScaledVector(m,-M.x).multiplyScalar(X),f[j].add(A),f[O].add(A),f[N].add(A),d[j].add(E),d[O].add(E),d[N].add(E))}let P=this.groups;P.length===0&&(P=[{start:0,count:e.count}]);for(let j=0,O=P.length;j<O;++j){const N=P[j],X=N.start,te=N.count;for(let Q=X,ue=X+te;Q<ue;Q+=3)S(e.getX(Q+0),e.getX(Q+1),e.getX(Q+2))}const b=new G,L=new G,B=new G,D=new G;function F(j){B.fromBufferAttribute(i,j),D.copy(B);const O=f[j];b.copy(O),b.sub(B.multiplyScalar(B.dot(O))).normalize(),L.crossVectors(D,O);const X=L.dot(d[j])<0?-1:1;u.setXYZW(j,b.x,b.y,b.z,X)}for(let j=0,O=P.length;j<O;++j){const N=P[j],X=N.start,te=N.count;for(let Q=X,ue=X+te;Q<ue;Q+=3)F(e.getX(Q+0)),F(e.getX(Q+1)),F(e.getX(Q+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new mn(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let y=0,_=n.count;y<_;y++)n.setXYZ(y,0,0,0);const i=new G,o=new G,u=new G,f=new G,d=new G,p=new G,m=new G,g=new G;if(e)for(let y=0,_=e.count;y<_;y+=3){const M=e.getX(y+0),A=e.getX(y+1),E=e.getX(y+2);i.fromBufferAttribute(t,M),o.fromBufferAttribute(t,A),u.fromBufferAttribute(t,E),m.subVectors(u,o),g.subVectors(i,o),m.cross(g),f.fromBufferAttribute(n,M),d.fromBufferAttribute(n,A),p.fromBufferAttribute(n,E),f.add(m),d.add(m),p.add(m),n.setXYZ(M,f.x,f.y,f.z),n.setXYZ(A,d.x,d.y,d.z),n.setXYZ(E,p.x,p.y,p.z)}else for(let y=0,_=t.count;y<_;y+=3)i.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),u.fromBufferAttribute(t,y+2),m.subVectors(u,o),g.subVectors(i,o),m.cross(g),n.setXYZ(y+0,m.x,m.y,m.z),n.setXYZ(y+1,m.x,m.y,m.z),n.setXYZ(y+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Ti.fromBufferAttribute(e,t),Ti.normalize(),e.setXYZ(t,Ti.x,Ti.y,Ti.z)}toNonIndexed(){function e(f,d){const p=f.array,m=f.itemSize,g=f.normalized,y=new p.constructor(d.length*m);let _=0,M=0;for(let A=0,E=d.length;A<E;A++){f.isInterleavedBufferAttribute?_=d[A]*f.data.stride+f.offset:_=d[A]*m;for(let S=0;S<m;S++)y[M++]=p[_++]}return new mn(y,m,g)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Zt,n=this.index.array,i=this.attributes;for(const f in i){const d=i[f],p=e(d,n);t.setAttribute(f,p)}const o=this.morphAttributes;for(const f in o){const d=[],p=o[f];for(let m=0,g=p.length;m<g;m++){const y=p[m],_=e(y,n);d.push(_)}t.morphAttributes[f]=d}t.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let f=0,d=u.length;f<d;f++){const p=u[f];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const p=n[d];e.data.attributes[d]=p.toJSON(e.data)}const i={};let o=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],m=[];for(let g=0,y=p.length;g<y;g++){const _=p[g];m.push(_.toJSON(e.data))}m.length>0&&(i[d]=m,o=!0)}o&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(e.data.groups=JSON.parse(JSON.stringify(u)));const f=this.boundingSphere;return f!==null&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone(t));const i=e.attributes;for(const p in i){const m=i[p];this.setAttribute(p,m.clone(t))}const o=e.morphAttributes;for(const p in o){const m=[],g=o[p];for(let y=0,_=g.length;y<_;y++)m.push(g[y].clone(t));this.morphAttributes[p]=m}this.morphTargetsRelative=e.morphTargetsRelative;const u=e.groups;for(let p=0,m=u.length;p<m;p++){const g=u[p];this.addGroup(g.start,g.count,g.materialIndex)}const f=e.boundingBox;f!==null&&(this.boundingBox=f.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const qx=new It,uu=new Ou,Np=new bi,Zx=new G,Kc=new G,Jc=new G,$c=new G,c0=new G,Dp=new G,Up=new Ne,Op=new Ne,kp=new Ne,Qx=new G,Kx=new G,Jx=new G,zp=new G,Fp=new G;class ti extends cn{constructor(e=new Zt,t=new Ml){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=i.length;o<u;o++){const f=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,o=n.morphAttributes.position,u=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const f=this.morphTargetInfluences;if(o&&f){Dp.set(0,0,0);for(let d=0,p=o.length;d<p;d++){const m=f[d],g=o[d];m!==0&&(c0.fromBufferAttribute(g,e),u?Dp.addScaledVector(c0,m):Dp.addScaledVector(c0.sub(t),m))}t.add(Dp)}return t}raycast(e,t){const n=this.geometry,i=this.material,o=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Np.copy(n.boundingSphere),Np.applyMatrix4(o),uu.copy(e.ray).recast(e.near),!(Np.containsPoint(uu.origin)===!1&&(uu.intersectSphere(Np,Zx)===null||uu.origin.distanceToSquared(Zx)>(e.far-e.near)**2))&&(qx.copy(o).invert(),uu.copy(e.ray).applyMatrix4(qx),!(n.boundingBox!==null&&uu.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,uu)))}_computeIntersections(e,t,n){let i;const o=this.geometry,u=this.material,f=o.index,d=o.attributes.position,p=o.attributes.uv,m=o.attributes.uv1,g=o.attributes.normal,y=o.groups,_=o.drawRange;if(f!==null)if(Array.isArray(u))for(let M=0,A=y.length;M<A;M++){const E=y[M],S=u[E.materialIndex],P=Math.max(E.start,_.start),b=Math.min(f.count,Math.min(E.start+E.count,_.start+_.count));for(let L=P,B=b;L<B;L+=3){const D=f.getX(L),F=f.getX(L+1),j=f.getX(L+2);i=Bp(this,S,e,n,p,m,g,D,F,j),i&&(i.faceIndex=Math.floor(L/3),i.face.materialIndex=E.materialIndex,t.push(i))}}else{const M=Math.max(0,_.start),A=Math.min(f.count,_.start+_.count);for(let E=M,S=A;E<S;E+=3){const P=f.getX(E),b=f.getX(E+1),L=f.getX(E+2);i=Bp(this,u,e,n,p,m,g,P,b,L),i&&(i.faceIndex=Math.floor(E/3),t.push(i))}}else if(d!==void 0)if(Array.isArray(u))for(let M=0,A=y.length;M<A;M++){const E=y[M],S=u[E.materialIndex],P=Math.max(E.start,_.start),b=Math.min(d.count,Math.min(E.start+E.count,_.start+_.count));for(let L=P,B=b;L<B;L+=3){const D=L,F=L+1,j=L+2;i=Bp(this,S,e,n,p,m,g,D,F,j),i&&(i.faceIndex=Math.floor(L/3),i.face.materialIndex=E.materialIndex,t.push(i))}}else{const M=Math.max(0,_.start),A=Math.min(d.count,_.start+_.count);for(let E=M,S=A;E<S;E+=3){const P=E,b=E+1,L=E+2;i=Bp(this,u,e,n,p,m,g,P,b,L),i&&(i.faceIndex=Math.floor(E/3),t.push(i))}}}}function sA(s,e,t,n,i,o,u,f){let d;if(e.side===nr?d=n.intersectTriangle(u,o,i,!0,f):d=n.intersectTriangle(i,o,u,e.side===ma,f),d===null)return null;Fp.copy(f),Fp.applyMatrix4(s.matrixWorld);const p=t.ray.origin.distanceTo(Fp);return p<t.near||p>t.far?null:{distance:p,point:Fp.clone(),object:s}}function Bp(s,e,t,n,i,o,u,f,d,p){s.getVertexPosition(f,Kc),s.getVertexPosition(d,Jc),s.getVertexPosition(p,$c);const m=sA(s,e,t,n,Kc,Jc,$c,zp);if(m){i&&(Up.fromBufferAttribute(i,f),Op.fromBufferAttribute(i,d),kp.fromBufferAttribute(i,p),m.uv=$r.getInterpolation(zp,Kc,Jc,$c,Up,Op,kp,new Ne)),o&&(Up.fromBufferAttribute(o,f),Op.fromBufferAttribute(o,d),kp.fromBufferAttribute(o,p),m.uv1=$r.getInterpolation(zp,Kc,Jc,$c,Up,Op,kp,new Ne)),u&&(Qx.fromBufferAttribute(u,f),Kx.fromBufferAttribute(u,d),Jx.fromBufferAttribute(u,p),m.normal=$r.getInterpolation(zp,Kc,Jc,$c,Qx,Kx,Jx,new G),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const g={a:f,b:d,c:p,normal:new G,materialIndex:0};$r.getNormal(Kc,Jc,$c,g.normal),m.face=g}return m}class ku extends Zt{constructor(e=1,t=1,n=1,i=1,o=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:o,depthSegments:u};const f=this;i=Math.floor(i),o=Math.floor(o),u=Math.floor(u);const d=[],p=[],m=[],g=[];let y=0,_=0;M("z","y","x",-1,-1,n,t,e,u,o,0),M("z","y","x",1,-1,n,t,-e,u,o,1),M("x","z","y",1,1,e,n,t,i,u,2),M("x","z","y",1,-1,e,n,-t,i,u,3),M("x","y","z",1,-1,e,t,n,i,o,4),M("x","y","z",-1,-1,e,t,-n,i,o,5),this.setIndex(d),this.setAttribute("position",new pt(p,3)),this.setAttribute("normal",new pt(m,3)),this.setAttribute("uv",new pt(g,2));function M(A,E,S,P,b,L,B,D,F,j,O){const N=L/F,X=B/j,te=L/2,Q=B/2,ue=D/2,fe=F+1,ye=j+1;let Me=0,W=0;const ee=new G;for(let k=0;k<ye;k++){const J=k*X-Q;for(let Ce=0;Ce<fe;Ce++){const Ve=Ce*N-te;ee[A]=Ve*P,ee[E]=J*b,ee[S]=ue,p.push(ee.x,ee.y,ee.z),ee[A]=0,ee[E]=0,ee[S]=D>0?1:-1,m.push(ee.x,ee.y,ee.z),g.push(Ce/F),g.push(1-k/j),Me+=1}}for(let k=0;k<j;k++)for(let J=0;J<F;J++){const Ce=y+J+fe*k,Ve=y+J+fe*(k+1),se=y+(J+1)+fe*(k+1),Re=y+(J+1)+fe*k;d.push(Ce,Ve,Re),d.push(Ve,se,Re),W+=6}f.addGroup(_,W,O),_+=W,y+=Me}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ku(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ef(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const i=s[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function mr(s){const e={};for(let t=0;t<s.length;t++){const n=Ef(s[t]);for(const i in n)e[i]=n[i]}return e}function oA(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function xM(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:pn.workingColorSpace}const lh={clone:Ef,merge:mr};var aA=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,lA=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class is extends Wi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=aA,this.fragmentShader=lA,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ef(e.uniforms),this.uniformsGroups=oA(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const u=this.uniforms[i].value;u&&u.isTexture?t.uniforms[i]={type:"t",value:u.toJSON(e).uuid}:u&&u.isColor?t.uniforms[i]={type:"c",value:u.getHex()}:u&&u.isVector2?t.uniforms[i]={type:"v2",value:u.toArray()}:u&&u.isVector3?t.uniforms[i]={type:"v3",value:u.toArray()}:u&&u.isVector4?t.uniforms[i]={type:"v4",value:u.toArray()}:u&&u.isMatrix3?t.uniforms[i]={type:"m3",value:u.toArray()}:u&&u.isMatrix4?t.uniforms[i]={type:"m4",value:u.toArray()}:t.uniforms[i]={value:u}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class _h extends cn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new It,this.projectionMatrix=new It,this.projectionMatrixInverse=new It,this.coordinateSystem=wo}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const dl=new G,$x=new Ne,e_=new Ne;class ei extends _h{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=wf*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Pu*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return wf*2*Math.atan(Math.tan(Pu*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){dl.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(dl.x,dl.y).multiplyScalar(-e/dl.z),dl.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(dl.x,dl.y).multiplyScalar(-e/dl.z)}getViewSize(e,t){return this.getViewBounds(e,$x,e_),t.subVectors(e_,$x)}setViewOffset(e,t,n,i,o,u){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=o,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Pu*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,o=-.5*i;const u=this.view;if(this.view!==null&&this.view.enabled){const d=u.fullWidth,p=u.fullHeight;o+=u.offsetX*i/d,t-=u.offsetY*n/p,i*=u.width/d,n*=u.height/p}const f=this.filmOffset;f!==0&&(o+=e*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+i,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const ef=-90,tf=1;class _M extends cn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new ei(ef,tf,e,t);i.layers=this.layers,this.add(i);const o=new ei(ef,tf,e,t);o.layers=this.layers,this.add(o);const u=new ei(ef,tf,e,t);u.layers=this.layers,this.add(u);const f=new ei(ef,tf,e,t);f.layers=this.layers,this.add(f);const d=new ei(ef,tf,e,t);d.layers=this.layers,this.add(d);const p=new ei(ef,tf,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,o,u,f,d]=t;for(const p of t)this.remove(p);if(e===wo)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),u.up.set(0,0,1),u.lookAt(0,-1,0),f.up.set(0,1,0),f.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===oh)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),u.up.set(0,0,-1),u.lookAt(0,-1,0),f.up.set(0,-1,0),f.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[o,u,f,d,p,m]=this.children,g=e.getRenderTarget(),y=e.getActiveCubeFace(),_=e.getActiveMipmapLevel(),M=e.xr.enabled;e.xr.enabled=!1;const A=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,o),e.setRenderTarget(n,1,i),e.render(t,u),e.setRenderTarget(n,2,i),e.render(t,f),e.setRenderTarget(n,3,i),e.render(t,d),e.setRenderTarget(n,4,i),e.render(t,p),n.texture.generateMipmaps=A,e.setRenderTarget(n,5,i),e.render(t,m),e.setRenderTarget(g,y,_),e.xr.enabled=M,n.texture.needsPMREMUpdate=!0}}class Sh extends Vn{constructor(e,t,n,i,o,u,f,d,p,m){e=e!==void 0?e:[],t=t!==void 0?t:ga,super(e,t,n,i,o,u,f,d,p,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class SM extends qs{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Sh(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:pi}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ku(5,5,5),o=new is({name:"CubemapFromEquirect",uniforms:Ef(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:nr,blending:pa});o.uniforms.tEquirect.value=t;const u=new ti(i,o),f=t.minFilter;return t.minFilter===Mo&&(t.minFilter=pi),new _M(1,10,this).update(e,u),t.minFilter=f,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,n,i){const o=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,n,i);e.setRenderTarget(o)}}const f0=new G,uA=new G,cA=new Wt;class xo{constructor(e=new G(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=f0.subVectors(n,t).cross(uA.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(f0),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/i;return o<0||o>1?null:t.copy(e.start).addScaledVector(n,o)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||cA.getNormalMatrix(e),i=this.coplanarPoint(f0).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const cu=new bi,Hp=new G;class Mh{constructor(e=new xo,t=new xo,n=new xo,i=new xo,o=new xo,u=new xo){this.planes=[e,t,n,i,o,u]}set(e,t,n,i,o,u){const f=this.planes;return f[0].copy(e),f[1].copy(t),f[2].copy(n),f[3].copy(i),f[4].copy(o),f[5].copy(u),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=wo){const n=this.planes,i=e.elements,o=i[0],u=i[1],f=i[2],d=i[3],p=i[4],m=i[5],g=i[6],y=i[7],_=i[8],M=i[9],A=i[10],E=i[11],S=i[12],P=i[13],b=i[14],L=i[15];if(n[0].setComponents(d-o,y-p,E-_,L-S).normalize(),n[1].setComponents(d+o,y+p,E+_,L+S).normalize(),n[2].setComponents(d+u,y+m,E+M,L+P).normalize(),n[3].setComponents(d-u,y-m,E-M,L-P).normalize(),n[4].setComponents(d-f,y-g,E-A,L-b).normalize(),t===wo)n[5].setComponents(d+f,y+g,E+A,L+b).normalize();else if(t===oh)n[5].setComponents(f,g,A,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),cu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),cu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(cu)}intersectsSprite(e){return cu.center.set(0,0,0),cu.radius=.7071067811865476,cu.applyMatrix4(e.matrixWorld),this.intersectsSphere(cu)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(Hp.x=i.normal.x>0?e.max.x:e.min.x,Hp.y=i.normal.y>0?e.max.y:e.min.y,Hp.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Hp)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function MM(){let s=null,e=!1,t=null,n=null;function i(o,u){t(o,u),n=s.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(i),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){s=o}}}function fA(s){const e=new WeakMap;function t(f,d){const p=f.array,m=f.usage,g=p.byteLength,y=s.createBuffer();s.bindBuffer(d,y),s.bufferData(d,p,m),f.onUploadCallback();let _;if(p instanceof Float32Array)_=s.FLOAT;else if(p instanceof Uint16Array)f.isFloat16BufferAttribute?_=s.HALF_FLOAT:_=s.UNSIGNED_SHORT;else if(p instanceof Int16Array)_=s.SHORT;else if(p instanceof Uint32Array)_=s.UNSIGNED_INT;else if(p instanceof Int32Array)_=s.INT;else if(p instanceof Int8Array)_=s.BYTE;else if(p instanceof Uint8Array)_=s.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)_=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:y,type:_,bytesPerElement:p.BYTES_PER_ELEMENT,version:f.version,size:g}}function n(f,d,p){const m=d.array,g=d._updateRange,y=d.updateRanges;if(s.bindBuffer(p,f),g.count===-1&&y.length===0&&s.bufferSubData(p,0,m),y.length!==0){for(let _=0,M=y.length;_<M;_++){const A=y[_];s.bufferSubData(p,A.start*m.BYTES_PER_ELEMENT,m,A.start,A.count)}d.clearUpdateRanges()}g.count!==-1&&(s.bufferSubData(p,g.offset*m.BYTES_PER_ELEMENT,m,g.offset,g.count),g.count=-1),d.onUploadCallback()}function i(f){return f.isInterleavedBufferAttribute&&(f=f.data),e.get(f)}function o(f){f.isInterleavedBufferAttribute&&(f=f.data);const d=e.get(f);d&&(s.deleteBuffer(d.buffer),e.delete(f))}function u(f,d){if(f.isGLBufferAttribute){const m=e.get(f);(!m||m.version<f.version)&&e.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);const p=e.get(f);if(p===void 0)e.set(f,t(f,d));else if(p.version<f.version){if(p.size!==f.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,f,d),p.version=f.version}}return{get:i,remove:o,update:u}}class Lf extends Zt{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const o=e/2,u=t/2,f=Math.floor(n),d=Math.floor(i),p=f+1,m=d+1,g=e/f,y=t/d,_=[],M=[],A=[],E=[];for(let S=0;S<m;S++){const P=S*y-u;for(let b=0;b<p;b++){const L=b*g-o;M.push(L,-P,0),A.push(0,0,1),E.push(b/f),E.push(1-S/d)}}for(let S=0;S<d;S++)for(let P=0;P<f;P++){const b=P+p*S,L=P+p*(S+1),B=P+1+p*(S+1),D=P+1+p*S;_.push(b,L,D),_.push(L,B,D)}this.setIndex(_),this.setAttribute("position",new pt(M,3)),this.setAttribute("normal",new pt(A,3)),this.setAttribute("uv",new pt(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lf(e.width,e.height,e.widthSegments,e.heightSegments)}}var dA=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,hA=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,pA=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,mA=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,gA=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,vA=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,yA=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,xA=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,_A=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,SA=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,MA=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,wA=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,EA=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,TA=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,AA=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,CA=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,bA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,RA=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,PA=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,LA=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,IA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,NA=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,DA=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,UA=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,OA=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,kA=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,zA=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,FA=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,BA=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,HA=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,VA="gl_FragColor = linearToOutputTexel( gl_FragColor );",GA=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,WA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,jA=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,XA=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,YA=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,qA=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,ZA=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,QA=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,KA=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,JA=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,$A=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,e2=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,t2=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,n2=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,i2=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,r2=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,s2=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,o2=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,a2=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,l2=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,u2=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,c2=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,f2=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,d2=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,h2=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,p2=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,m2=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,g2=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,v2=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,y2=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,x2=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,_2=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,S2=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,M2=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,w2=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,E2=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,T2=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,A2=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,C2=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,b2=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,R2=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,P2=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,L2=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,I2=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,N2=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,D2=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,U2=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,O2=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,k2=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,z2=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,F2=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,B2=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,H2=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,V2=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,G2=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,W2=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,j2=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,X2=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Y2=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,q2=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Z2=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Q2=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,K2=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,J2=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,$2=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,eC=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,tC=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,nC=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,iC=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,rC=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,sC=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,oC=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,aC=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,lC=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uC=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,cC=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const fC=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,dC=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hC=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,pC=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,mC=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,gC=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vC=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,yC=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,xC=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,_C=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,SC=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,MC=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,wC=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,EC=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,TC=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,AC=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CC=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bC=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RC=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,PC=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,LC=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,IC=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,NC=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,DC=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UC=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,OC=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kC=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zC=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FC=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,BC=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,HC=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VC=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,GC=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,WC=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,qt={alphahash_fragment:dA,alphahash_pars_fragment:hA,alphamap_fragment:pA,alphamap_pars_fragment:mA,alphatest_fragment:gA,alphatest_pars_fragment:vA,aomap_fragment:yA,aomap_pars_fragment:xA,batching_pars_vertex:_A,batching_vertex:SA,begin_vertex:MA,beginnormal_vertex:wA,bsdfs:EA,iridescence_fragment:TA,bumpmap_pars_fragment:AA,clipping_planes_fragment:CA,clipping_planes_pars_fragment:bA,clipping_planes_pars_vertex:RA,clipping_planes_vertex:PA,color_fragment:LA,color_pars_fragment:IA,color_pars_vertex:NA,color_vertex:DA,common:UA,cube_uv_reflection_fragment:OA,defaultnormal_vertex:kA,displacementmap_pars_vertex:zA,displacementmap_vertex:FA,emissivemap_fragment:BA,emissivemap_pars_fragment:HA,colorspace_fragment:VA,colorspace_pars_fragment:GA,envmap_fragment:WA,envmap_common_pars_fragment:jA,envmap_pars_fragment:XA,envmap_pars_vertex:YA,envmap_physical_pars_fragment:r2,envmap_vertex:qA,fog_vertex:ZA,fog_pars_vertex:QA,fog_fragment:KA,fog_pars_fragment:JA,gradientmap_pars_fragment:$A,lightmap_pars_fragment:e2,lights_lambert_fragment:t2,lights_lambert_pars_fragment:n2,lights_pars_begin:i2,lights_toon_fragment:s2,lights_toon_pars_fragment:o2,lights_phong_fragment:a2,lights_phong_pars_fragment:l2,lights_physical_fragment:u2,lights_physical_pars_fragment:c2,lights_fragment_begin:f2,lights_fragment_maps:d2,lights_fragment_end:h2,logdepthbuf_fragment:p2,logdepthbuf_pars_fragment:m2,logdepthbuf_pars_vertex:g2,logdepthbuf_vertex:v2,map_fragment:y2,map_pars_fragment:x2,map_particle_fragment:_2,map_particle_pars_fragment:S2,metalnessmap_fragment:M2,metalnessmap_pars_fragment:w2,morphinstance_vertex:E2,morphcolor_vertex:T2,morphnormal_vertex:A2,morphtarget_pars_vertex:C2,morphtarget_vertex:b2,normal_fragment_begin:R2,normal_fragment_maps:P2,normal_pars_fragment:L2,normal_pars_vertex:I2,normal_vertex:N2,normalmap_pars_fragment:D2,clearcoat_normal_fragment_begin:U2,clearcoat_normal_fragment_maps:O2,clearcoat_pars_fragment:k2,iridescence_pars_fragment:z2,opaque_fragment:F2,packing:B2,premultiplied_alpha_fragment:H2,project_vertex:V2,dithering_fragment:G2,dithering_pars_fragment:W2,roughnessmap_fragment:j2,roughnessmap_pars_fragment:X2,shadowmap_pars_fragment:Y2,shadowmap_pars_vertex:q2,shadowmap_vertex:Z2,shadowmask_pars_fragment:Q2,skinbase_vertex:K2,skinning_pars_vertex:J2,skinning_vertex:$2,skinnormal_vertex:eC,specularmap_fragment:tC,specularmap_pars_fragment:nC,tonemapping_fragment:iC,tonemapping_pars_fragment:rC,transmission_fragment:sC,transmission_pars_fragment:oC,uv_pars_fragment:aC,uv_pars_vertex:lC,uv_vertex:uC,worldpos_vertex:cC,background_vert:fC,background_frag:dC,backgroundCube_vert:hC,backgroundCube_frag:pC,cube_vert:mC,cube_frag:gC,depth_vert:vC,depth_frag:yC,distanceRGBA_vert:xC,distanceRGBA_frag:_C,equirect_vert:SC,equirect_frag:MC,linedashed_vert:wC,linedashed_frag:EC,meshbasic_vert:TC,meshbasic_frag:AC,meshlambert_vert:CC,meshlambert_frag:bC,meshmatcap_vert:RC,meshmatcap_frag:PC,meshnormal_vert:LC,meshnormal_frag:IC,meshphong_vert:NC,meshphong_frag:DC,meshphysical_vert:UC,meshphysical_frag:OC,meshtoon_vert:kC,meshtoon_frag:zC,points_vert:FC,points_frag:BC,shadow_vert:HC,shadow_frag:VC,sprite_vert:GC,sprite_frag:WC},et={common:{diffuse:{value:new st(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Wt},alphaMap:{value:null},alphaMapTransform:{value:new Wt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Wt}},envmap:{envMap:{value:null},envMapRotation:{value:new Wt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Wt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Wt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Wt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Wt},normalScale:{value:new Ne(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Wt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Wt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Wt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Wt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new st(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new st(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Wt},alphaTest:{value:0},uvTransform:{value:new Wt}},sprite:{diffuse:{value:new st(16777215)},opacity:{value:1},center:{value:new Ne(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Wt},alphaMap:{value:null},alphaMapTransform:{value:new Wt},alphaTest:{value:0}}},Ys={basic:{uniforms:mr([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.fog]),vertexShader:qt.meshbasic_vert,fragmentShader:qt.meshbasic_frag},lambert:{uniforms:mr([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.fog,et.lights,{emissive:{value:new st(0)}}]),vertexShader:qt.meshlambert_vert,fragmentShader:qt.meshlambert_frag},phong:{uniforms:mr([et.common,et.specularmap,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.fog,et.lights,{emissive:{value:new st(0)},specular:{value:new st(1118481)},shininess:{value:30}}]),vertexShader:qt.meshphong_vert,fragmentShader:qt.meshphong_frag},standard:{uniforms:mr([et.common,et.envmap,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.roughnessmap,et.metalnessmap,et.fog,et.lights,{emissive:{value:new st(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:qt.meshphysical_vert,fragmentShader:qt.meshphysical_frag},toon:{uniforms:mr([et.common,et.aomap,et.lightmap,et.emissivemap,et.bumpmap,et.normalmap,et.displacementmap,et.gradientmap,et.fog,et.lights,{emissive:{value:new st(0)}}]),vertexShader:qt.meshtoon_vert,fragmentShader:qt.meshtoon_frag},matcap:{uniforms:mr([et.common,et.bumpmap,et.normalmap,et.displacementmap,et.fog,{matcap:{value:null}}]),vertexShader:qt.meshmatcap_vert,fragmentShader:qt.meshmatcap_frag},points:{uniforms:mr([et.points,et.fog]),vertexShader:qt.points_vert,fragmentShader:qt.points_frag},dashed:{uniforms:mr([et.common,et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:qt.linedashed_vert,fragmentShader:qt.linedashed_frag},depth:{uniforms:mr([et.common,et.displacementmap]),vertexShader:qt.depth_vert,fragmentShader:qt.depth_frag},normal:{uniforms:mr([et.common,et.bumpmap,et.normalmap,et.displacementmap,{opacity:{value:1}}]),vertexShader:qt.meshnormal_vert,fragmentShader:qt.meshnormal_frag},sprite:{uniforms:mr([et.sprite,et.fog]),vertexShader:qt.sprite_vert,fragmentShader:qt.sprite_frag},background:{uniforms:{uvTransform:{value:new Wt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:qt.background_vert,fragmentShader:qt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Wt}},vertexShader:qt.backgroundCube_vert,fragmentShader:qt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:qt.cube_vert,fragmentShader:qt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:qt.equirect_vert,fragmentShader:qt.equirect_frag},distanceRGBA:{uniforms:mr([et.common,et.displacementmap,{referencePosition:{value:new G},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:qt.distanceRGBA_vert,fragmentShader:qt.distanceRGBA_frag},shadow:{uniforms:mr([et.lights,et.fog,{color:{value:new st(0)},opacity:{value:1}}]),vertexShader:qt.shadow_vert,fragmentShader:qt.shadow_frag}};Ys.physical={uniforms:mr([Ys.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Wt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Wt},clearcoatNormalScale:{value:new Ne(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Wt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Wt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Wt},sheen:{value:0},sheenColor:{value:new st(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Wt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Wt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Wt},transmissionSamplerSize:{value:new Ne},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Wt},attenuationDistance:{value:0},attenuationColor:{value:new st(0)},specularColor:{value:new st(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Wt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Wt},anisotropyVector:{value:new Ne},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Wt}}]),vertexShader:qt.meshphysical_vert,fragmentShader:qt.meshphysical_frag};const Vp={r:0,b:0,g:0},fu=new ns,jC=new It;function XC(s,e,t,n,i,o,u){const f=new st(0);let d=o===!0?0:1,p,m,g=null,y=0,_=null;function M(P){let b=P.isScene===!0?P.background:null;return b&&b.isTexture&&(b=(P.backgroundBlurriness>0?t:e).get(b)),b}function A(P){let b=!1;const L=M(P);L===null?S(f,d):L&&L.isColor&&(S(L,1),b=!0);const B=s.xr.getEnvironmentBlendMode();B==="additive"?n.buffers.color.setClear(0,0,0,1,u):B==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,u),(s.autoClear||b)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil)}function E(P,b){const L=M(b);L&&(L.isCubeTexture||L.mapping===Rf)?(m===void 0&&(m=new ti(new ku(1,1,1),new is({name:"BackgroundCubeMaterial",uniforms:Ef(Ys.backgroundCube.uniforms),vertexShader:Ys.backgroundCube.vertexShader,fragmentShader:Ys.backgroundCube.fragmentShader,side:nr,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(B,D,F){this.matrixWorld.copyPosition(F.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(m)),fu.copy(b.backgroundRotation),fu.x*=-1,fu.y*=-1,fu.z*=-1,L.isCubeTexture&&L.isRenderTargetTexture===!1&&(fu.y*=-1,fu.z*=-1),m.material.uniforms.envMap.value=L,m.material.uniforms.flipEnvMap.value=L.isCubeTexture&&L.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=b.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(jC.makeRotationFromEuler(fu)),m.material.toneMapped=pn.getTransfer(L.colorSpace)!==bn,(g!==L||y!==L.version||_!==s.toneMapping)&&(m.material.needsUpdate=!0,g=L,y=L.version,_=s.toneMapping),m.layers.enableAll(),P.unshift(m,m.geometry,m.material,0,0,null)):L&&L.isTexture&&(p===void 0&&(p=new ti(new Lf(2,2),new is({name:"BackgroundMaterial",uniforms:Ef(Ys.background.uniforms),vertexShader:Ys.background.vertexShader,fragmentShader:Ys.background.fragmentShader,side:ma,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(p)),p.material.uniforms.t2D.value=L,p.material.uniforms.backgroundIntensity.value=b.backgroundIntensity,p.material.toneMapped=pn.getTransfer(L.colorSpace)!==bn,L.matrixAutoUpdate===!0&&L.updateMatrix(),p.material.uniforms.uvTransform.value.copy(L.matrix),(g!==L||y!==L.version||_!==s.toneMapping)&&(p.material.needsUpdate=!0,g=L,y=L.version,_=s.toneMapping),p.layers.enableAll(),P.unshift(p,p.geometry,p.material,0,0,null))}function S(P,b){P.getRGB(Vp,xM(s)),n.buffers.color.setClear(Vp.r,Vp.g,Vp.b,b,u)}return{getClearColor:function(){return f},setClearColor:function(P,b=1){f.set(P),d=b,S(f,d)},getClearAlpha:function(){return d},setClearAlpha:function(P){d=P,S(f,d)},render:A,addToRenderList:E}}function YC(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},i=y(null);let o=i,u=!1;function f(N,X,te,Q,ue){let fe=!1;const ye=g(Q,te,X);o!==ye&&(o=ye,p(o.object)),fe=_(N,Q,te,ue),fe&&M(N,Q,te,ue),ue!==null&&e.update(ue,s.ELEMENT_ARRAY_BUFFER),(fe||u)&&(u=!1,L(N,X,te,Q),ue!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(ue).buffer))}function d(){return s.createVertexArray()}function p(N){return s.bindVertexArray(N)}function m(N){return s.deleteVertexArray(N)}function g(N,X,te){const Q=te.wireframe===!0;let ue=n[N.id];ue===void 0&&(ue={},n[N.id]=ue);let fe=ue[X.id];fe===void 0&&(fe={},ue[X.id]=fe);let ye=fe[Q];return ye===void 0&&(ye=y(d()),fe[Q]=ye),ye}function y(N){const X=[],te=[],Q=[];for(let ue=0;ue<t;ue++)X[ue]=0,te[ue]=0,Q[ue]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:X,enabledAttributes:te,attributeDivisors:Q,object:N,attributes:{},index:null}}function _(N,X,te,Q){const ue=o.attributes,fe=X.attributes;let ye=0;const Me=te.getAttributes();for(const W in Me)if(Me[W].location>=0){const k=ue[W];let J=fe[W];if(J===void 0&&(W==="instanceMatrix"&&N.instanceMatrix&&(J=N.instanceMatrix),W==="instanceColor"&&N.instanceColor&&(J=N.instanceColor)),k===void 0||k.attribute!==J||J&&k.data!==J.data)return!0;ye++}return o.attributesNum!==ye||o.index!==Q}function M(N,X,te,Q){const ue={},fe=X.attributes;let ye=0;const Me=te.getAttributes();for(const W in Me)if(Me[W].location>=0){let k=fe[W];k===void 0&&(W==="instanceMatrix"&&N.instanceMatrix&&(k=N.instanceMatrix),W==="instanceColor"&&N.instanceColor&&(k=N.instanceColor));const J={};J.attribute=k,k&&k.data&&(J.data=k.data),ue[W]=J,ye++}o.attributes=ue,o.attributesNum=ye,o.index=Q}function A(){const N=o.newAttributes;for(let X=0,te=N.length;X<te;X++)N[X]=0}function E(N){S(N,0)}function S(N,X){const te=o.newAttributes,Q=o.enabledAttributes,ue=o.attributeDivisors;te[N]=1,Q[N]===0&&(s.enableVertexAttribArray(N),Q[N]=1),ue[N]!==X&&(s.vertexAttribDivisor(N,X),ue[N]=X)}function P(){const N=o.newAttributes,X=o.enabledAttributes;for(let te=0,Q=X.length;te<Q;te++)X[te]!==N[te]&&(s.disableVertexAttribArray(te),X[te]=0)}function b(N,X,te,Q,ue,fe,ye){ye===!0?s.vertexAttribIPointer(N,X,te,ue,fe):s.vertexAttribPointer(N,X,te,Q,ue,fe)}function L(N,X,te,Q){A();const ue=Q.attributes,fe=te.getAttributes(),ye=X.defaultAttributeValues;for(const Me in fe){const W=fe[Me];if(W.location>=0){let ee=ue[Me];if(ee===void 0&&(Me==="instanceMatrix"&&N.instanceMatrix&&(ee=N.instanceMatrix),Me==="instanceColor"&&N.instanceColor&&(ee=N.instanceColor)),ee!==void 0){const k=ee.normalized,J=ee.itemSize,Ce=e.get(ee);if(Ce===void 0)continue;const Ve=Ce.buffer,se=Ce.type,Re=Ce.bytesPerElement,ke=se===s.INT||se===s.UNSIGNED_INT||ee.gpuType===iy;if(ee.isInterleavedBufferAttribute){const Le=ee.data,tt=Le.stride,xt=ee.offset;if(Le.isInstancedInterleavedBuffer){for(let ae=0;ae<W.locationSize;ae++)S(W.location+ae,Le.meshPerAttribute);N.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=Le.meshPerAttribute*Le.count)}else for(let ae=0;ae<W.locationSize;ae++)E(W.location+ae);s.bindBuffer(s.ARRAY_BUFFER,Ve);for(let ae=0;ae<W.locationSize;ae++)b(W.location+ae,J/W.locationSize,se,k,tt*Re,(xt+J/W.locationSize*ae)*Re,ke)}else{if(ee.isInstancedBufferAttribute){for(let Le=0;Le<W.locationSize;Le++)S(W.location+Le,ee.meshPerAttribute);N.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Le=0;Le<W.locationSize;Le++)E(W.location+Le);s.bindBuffer(s.ARRAY_BUFFER,Ve);for(let Le=0;Le<W.locationSize;Le++)b(W.location+Le,J/W.locationSize,se,k,J*Re,J/W.locationSize*Le*Re,ke)}}else if(ye!==void 0){const k=ye[Me];if(k!==void 0)switch(k.length){case 2:s.vertexAttrib2fv(W.location,k);break;case 3:s.vertexAttrib3fv(W.location,k);break;case 4:s.vertexAttrib4fv(W.location,k);break;default:s.vertexAttrib1fv(W.location,k)}}}}P()}function B(){j();for(const N in n){const X=n[N];for(const te in X){const Q=X[te];for(const ue in Q)m(Q[ue].object),delete Q[ue];delete X[te]}delete n[N]}}function D(N){if(n[N.id]===void 0)return;const X=n[N.id];for(const te in X){const Q=X[te];for(const ue in Q)m(Q[ue].object),delete Q[ue];delete X[te]}delete n[N.id]}function F(N){for(const X in n){const te=n[X];if(te[N.id]===void 0)continue;const Q=te[N.id];for(const ue in Q)m(Q[ue].object),delete Q[ue];delete te[N.id]}}function j(){O(),u=!0,o!==i&&(o=i,p(o.object))}function O(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:f,reset:j,resetDefaultState:O,dispose:B,releaseStatesOfGeometry:D,releaseStatesOfProgram:F,initAttributes:A,enableAttribute:E,disableUnusedAttributes:P}}function qC(s,e,t){let n;function i(p){n=p}function o(p,m){s.drawArrays(n,p,m),t.update(m,n,1)}function u(p,m,g){g!==0&&(s.drawArraysInstanced(n,p,m,g),t.update(m,n,g))}function f(p,m,g){if(g===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let _=0;_<g;_++)this.render(p[_],m[_]);else{y.multiDrawArraysWEBGL(n,p,0,m,0,g);let _=0;for(let M=0;M<g;M++)_+=m[M];t.update(_,n,1)}}function d(p,m,g,y){if(g===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let M=0;M<p.length;M++)u(p[M],m[M],y[M]);else{_.multiDrawArraysInstancedWEBGL(n,p,0,m,0,y,0,g);let M=0;for(let A=0;A<g;A++)M+=m[A];for(let A=0;A<y.length;A++)t.update(M,n,y[A])}}this.setMode=i,this.render=o,this.renderInstances=u,this.renderMultiDraw=f,this.renderMultiDrawInstances=d}function ZC(s,e,t,n){let i;function o(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const D=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function u(D){return!(D!==kr&&n.convert(D)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function f(D){const F=D===yh&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(D!==Ao&&n.convert(D)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&D!==_s&&!F)}function d(D){if(D==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";D="mediump"}return D==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const m=d(p);m!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",m,"instead."),p=m);const g=t.logarithmicDepthBuffer===!0,y=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),_=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),M=s.getParameter(s.MAX_TEXTURE_SIZE),A=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),E=s.getParameter(s.MAX_VERTEX_ATTRIBS),S=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),P=s.getParameter(s.MAX_VARYING_VECTORS),b=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),L=_>0,B=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:d,textureFormatReadable:u,textureTypeReadable:f,precision:p,logarithmicDepthBuffer:g,maxTextures:y,maxVertexTextures:_,maxTextureSize:M,maxCubemapSize:A,maxAttributes:E,maxVertexUniforms:S,maxVaryings:P,maxFragmentUniforms:b,vertexTextures:L,maxSamples:B}}function QC(s){const e=this;let t=null,n=0,i=!1,o=!1;const u=new xo,f=new Wt,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(g,y){const _=g.length!==0||y||n!==0||i;return i=y,n=g.length,_},this.beginShadows=function(){o=!0,m(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(g,y){t=m(g,y,0)},this.setState=function(g,y,_){const M=g.clippingPlanes,A=g.clipIntersection,E=g.clipShadows,S=s.get(g);if(!i||M===null||M.length===0||o&&!E)o?m(null):p();else{const P=o?0:n,b=P*4;let L=S.clippingState||null;d.value=L,L=m(M,y,b,_);for(let B=0;B!==b;++B)L[B]=t[B];S.clippingState=L,this.numIntersection=A?this.numPlanes:0,this.numPlanes+=P}};function p(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(g,y,_,M){const A=g!==null?g.length:0;let E=null;if(A!==0){if(E=d.value,M!==!0||E===null){const S=_+A*4,P=y.matrixWorldInverse;f.getNormalMatrix(P),(E===null||E.length<S)&&(E=new Float32Array(S));for(let b=0,L=_;b!==A;++b,L+=4)u.copy(g[b]).applyMatrix4(P,f),u.normal.toArray(E,L),E[L+3]=u.constant}d.value=E,d.needsUpdate=!0}return e.numPlanes=A,e.numIntersection=0,E}}function KC(s){let e=new WeakMap;function t(u,f){return f===Zd?u.mapping=ga:f===Qd&&(u.mapping=xl),u}function n(u){if(u&&u.isTexture){const f=u.mapping;if(f===Zd||f===Qd)if(e.has(u)){const d=e.get(u).texture;return t(d,u.mapping)}else{const d=u.image;if(d&&d.height>0){const p=new SM(d.height);return p.fromEquirectangularTexture(s,u),e.set(u,p),u.addEventListener("dispose",i),t(p.texture,u.mapping)}else return null}}return u}function i(u){const f=u.target;f.removeEventListener("dispose",i);const d=e.get(f);d!==void 0&&(e.delete(f),d.dispose())}function o(){e=new WeakMap}return{get:n,dispose:o}}class vl extends _h{constructor(e=-1,t=1,n=1,i=-1,o=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=o,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,o,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=o,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let o=n-e,u=n+e,f=i+t,d=i-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,u=o+p*this.view.width,f-=m*this.view.offsetY,d=f-m*this.view.height}this.projectionMatrix.makeOrthographic(o,u,f,d,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const vf=4,t_=[.125,.215,.35,.446,.526,.582],wu=20,d0=new vl,n_=new st;let h0=null,p0=0,m0=0,g0=!1;const Mu=(1+Math.sqrt(5))/2,nf=1/Mu,i_=[new G(-Mu,nf,0),new G(Mu,nf,0),new G(-nf,0,Mu),new G(nf,0,Mu),new G(0,Mu,-nf),new G(0,Mu,nf),new G(-1,1,-1),new G(1,1,-1),new G(-1,1,1),new G(1,1,1)];class Hv{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,i=100){h0=this._renderer.getRenderTarget(),p0=this._renderer.getActiveCubeFace(),m0=this._renderer.getActiveMipmapLevel(),g0=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,i,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=o_(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=s_(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(h0,p0,m0),this._renderer.xr.enabled=g0,e.scissorTest=!1,Gp(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ga||e.mapping===xl?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),h0=this._renderer.getRenderTarget(),p0=this._renderer.getActiveCubeFace(),m0=this._renderer.getActiveMipmapLevel(),g0=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:pi,minFilter:pi,generateMipmaps:!1,type:yh,format:kr,colorSpace:ya,depthBuffer:!1},i=r_(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=r_(e,t,n);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=JC(o)),this._blurMaterial=$C(o,e,t)}return i}_compileMaterial(e){const t=new ti(this._lodPlanes[0],e);this._renderer.compile(t,d0)}_sceneToCubeUV(e,t,n,i){const f=new ei(90,1,t,n),d=[1,-1,1,1,1,1],p=[1,1,1,-1,-1,-1],m=this._renderer,g=m.autoClear,y=m.toneMapping;m.getClearColor(n_),m.toneMapping=Eo,m.autoClear=!1;const _=new Ml({name:"PMREM.Background",side:nr,depthWrite:!1,depthTest:!1}),M=new ti(new ku,_);let A=!1;const E=e.background;E?E.isColor&&(_.color.copy(E),e.background=null,A=!0):(_.color.copy(n_),A=!0);for(let S=0;S<6;S++){const P=S%3;P===0?(f.up.set(0,d[S],0),f.lookAt(p[S],0,0)):P===1?(f.up.set(0,0,d[S]),f.lookAt(0,p[S],0)):(f.up.set(0,d[S],0),f.lookAt(0,0,p[S]));const b=this._cubeSize;Gp(i,P*b,S>2?b:0,b,b),m.setRenderTarget(i),A&&m.render(M,f),m.render(e,f)}M.geometry.dispose(),M.material.dispose(),m.toneMapping=y,m.autoClear=g,e.background=E}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===ga||e.mapping===xl;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=o_()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=s_());const o=i?this._cubemapMaterial:this._equirectMaterial,u=new ti(this._lodPlanes[0],o),f=o.uniforms;f.envMap.value=e;const d=this._cubeSize;Gp(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(u,d0)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let o=1;o<i;o++){const u=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),f=i_[(i-o-1)%i_.length];this._blur(e,o-1,o,u,f)}t.autoClear=n}_blur(e,t,n,i,o){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,n,i,"latitudinal",o),this._halfBlur(u,e,n,n,i,"longitudinal",o)}_halfBlur(e,t,n,i,o,u,f){const d=this._renderer,p=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,g=new ti(this._lodPlanes[i],p),y=p.uniforms,_=this._sizeLods[n]-1,M=isFinite(o)?Math.PI/(2*_):2*Math.PI/(2*wu-1),A=o/M,E=isFinite(o)?1+Math.floor(m*A):wu;E>wu&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${wu}`);const S=[];let P=0;for(let F=0;F<wu;++F){const j=F/A,O=Math.exp(-j*j/2);S.push(O),F===0?P+=O:F<E&&(P+=2*O)}for(let F=0;F<S.length;F++)S[F]=S[F]/P;y.envMap.value=e.texture,y.samples.value=E,y.weights.value=S,y.latitudinal.value=u==="latitudinal",f&&(y.poleAxis.value=f);const{_lodMax:b}=this;y.dTheta.value=M,y.mipInt.value=b-n;const L=this._sizeLods[i],B=3*L*(i>b-vf?i-b+vf:0),D=4*(this._cubeSize-L);Gp(t,B,D,3*L,2*L),d.setRenderTarget(t),d.render(g,d0)}}function JC(s){const e=[],t=[],n=[];let i=s;const o=s-vf+1+t_.length;for(let u=0;u<o;u++){const f=Math.pow(2,i);t.push(f);let d=1/f;u>s-vf?d=t_[u-s+vf-1]:u===0&&(d=0),n.push(d);const p=1/(f-2),m=-p,g=1+p,y=[m,m,g,m,g,g,m,m,g,g,m,g],_=6,M=6,A=3,E=2,S=1,P=new Float32Array(A*M*_),b=new Float32Array(E*M*_),L=new Float32Array(S*M*_);for(let D=0;D<_;D++){const F=D%3*2/3-1,j=D>2?0:-1,O=[F,j,0,F+2/3,j,0,F+2/3,j+1,0,F,j,0,F+2/3,j+1,0,F,j+1,0];P.set(O,A*M*D),b.set(y,E*M*D);const N=[D,D,D,D,D,D];L.set(N,S*M*D)}const B=new Zt;B.setAttribute("position",new mn(P,A)),B.setAttribute("uv",new mn(b,E)),B.setAttribute("faceIndex",new mn(L,S)),e.push(B),i>vf&&i--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function r_(s,e,t){const n=new qs(s,e,t);return n.texture.mapping=Rf,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Gp(s,e,t,n,i){s.viewport.set(e,t,n,i),s.scissor.set(e,t,n,i)}function $C(s,e,t){const n=new Float32Array(wu),i=new G(0,1,0);return new is({name:"SphericalGaussianBlur",defines:{n:wu,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:vy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:pa,depthTest:!1,depthWrite:!1})}function s_(){return new is({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:vy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:pa,depthTest:!1,depthWrite:!1})}function o_(){return new is({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:vy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:pa,depthTest:!1,depthWrite:!1})}function vy(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function eb(s){let e=new WeakMap,t=null;function n(f){if(f&&f.isTexture){const d=f.mapping,p=d===Zd||d===Qd,m=d===ga||d===xl;if(p||m){let g=e.get(f);const y=g!==void 0?g.texture.pmremVersion:0;if(f.isRenderTargetTexture&&f.pmremVersion!==y)return t===null&&(t=new Hv(s)),g=p?t.fromEquirectangular(f,g):t.fromCubemap(f,g),g.texture.pmremVersion=f.pmremVersion,e.set(f,g),g.texture;if(g!==void 0)return g.texture;{const _=f.image;return p&&_&&_.height>0||m&&_&&i(_)?(t===null&&(t=new Hv(s)),g=p?t.fromEquirectangular(f):t.fromCubemap(f),g.texture.pmremVersion=f.pmremVersion,e.set(f,g),f.addEventListener("dispose",o),g.texture):null}}}return f}function i(f){let d=0;const p=6;for(let m=0;m<p;m++)f[m]!==void 0&&d++;return d===p}function o(f){const d=f.target;d.removeEventListener("dispose",o);const p=e.get(d);p!==void 0&&(e.delete(d),p.dispose())}function u(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:u}}function tb(s){const e={};function t(n){if(e[n]!==void 0)return e[n];let i;switch(n){case"WEBGL_depth_texture":i=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=s.getExtension(n)}return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function nb(s,e,t,n){const i={},o=new WeakMap;function u(g){const y=g.target;y.index!==null&&e.remove(y.index);for(const M in y.attributes)e.remove(y.attributes[M]);for(const M in y.morphAttributes){const A=y.morphAttributes[M];for(let E=0,S=A.length;E<S;E++)e.remove(A[E])}y.removeEventListener("dispose",u),delete i[y.id];const _=o.get(y);_&&(e.remove(_),o.delete(y)),n.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function f(g,y){return i[y.id]===!0||(y.addEventListener("dispose",u),i[y.id]=!0,t.memory.geometries++),y}function d(g){const y=g.attributes;for(const M in y)e.update(y[M],s.ARRAY_BUFFER);const _=g.morphAttributes;for(const M in _){const A=_[M];for(let E=0,S=A.length;E<S;E++)e.update(A[E],s.ARRAY_BUFFER)}}function p(g){const y=[],_=g.index,M=g.attributes.position;let A=0;if(_!==null){const P=_.array;A=_.version;for(let b=0,L=P.length;b<L;b+=3){const B=P[b+0],D=P[b+1],F=P[b+2];y.push(B,D,D,F,F,B)}}else if(M!==void 0){const P=M.array;A=M.version;for(let b=0,L=P.length/3-1;b<L;b+=3){const B=b+0,D=b+1,F=b+2;y.push(B,D,D,F,F,B)}}else return;const E=new(hM(y)?gy:my)(y,1);E.version=A;const S=o.get(g);S&&e.remove(S),o.set(g,E)}function m(g){const y=o.get(g);if(y){const _=g.index;_!==null&&y.version<_.version&&p(g)}else p(g);return o.get(g)}return{get:f,update:d,getWireframeAttribute:m}}function ib(s,e,t){let n;function i(y){n=y}let o,u;function f(y){o=y.type,u=y.bytesPerElement}function d(y,_){s.drawElements(n,_,o,y*u),t.update(_,n,1)}function p(y,_,M){M!==0&&(s.drawElementsInstanced(n,_,o,y*u,M),t.update(_,n,M))}function m(y,_,M){if(M===0)return;const A=e.get("WEBGL_multi_draw");if(A===null)for(let E=0;E<M;E++)this.render(y[E]/u,_[E]);else{A.multiDrawElementsWEBGL(n,_,0,o,y,0,M);let E=0;for(let S=0;S<M;S++)E+=_[S];t.update(E,n,1)}}function g(y,_,M,A){if(M===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let S=0;S<y.length;S++)p(y[S]/u,_[S],A[S]);else{E.multiDrawElementsInstancedWEBGL(n,_,0,o,y,0,A,0,M);let S=0;for(let P=0;P<M;P++)S+=_[P];for(let P=0;P<A.length;P++)t.update(S,n,A[P])}}this.setMode=i,this.setIndex=f,this.render=d,this.renderInstances=p,this.renderMultiDraw=m,this.renderMultiDrawInstances=g}function rb(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(o,u,f){switch(t.calls++,u){case s.TRIANGLES:t.triangles+=f*(o/3);break;case s.LINES:t.lines+=f*(o/2);break;case s.LINE_STRIP:t.lines+=f*(o-1);break;case s.LINE_LOOP:t.lines+=f*o;break;case s.POINTS:t.points+=f*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function sb(s,e,t){const n=new WeakMap,i=new nn;function o(u,f,d){const p=u.morphTargetInfluences,m=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,g=m!==void 0?m.length:0;let y=n.get(f);if(y===void 0||y.count!==g){let N=function(){j.dispose(),n.delete(f),f.removeEventListener("dispose",N)};var _=N;y!==void 0&&y.texture.dispose();const M=f.morphAttributes.position!==void 0,A=f.morphAttributes.normal!==void 0,E=f.morphAttributes.color!==void 0,S=f.morphAttributes.position||[],P=f.morphAttributes.normal||[],b=f.morphAttributes.color||[];let L=0;M===!0&&(L=1),A===!0&&(L=2),E===!0&&(L=3);let B=f.attributes.position.count*L,D=1;B>e.maxTextureSize&&(D=Math.ceil(B/e.maxTextureSize),B=e.maxTextureSize);const F=new Float32Array(B*D*4*g),j=new jm(F,B,D,g);j.type=_s,j.needsUpdate=!0;const O=L*4;for(let X=0;X<g;X++){const te=S[X],Q=P[X],ue=b[X],fe=B*D*4*X;for(let ye=0;ye<te.count;ye++){const Me=ye*O;M===!0&&(i.fromBufferAttribute(te,ye),F[fe+Me+0]=i.x,F[fe+Me+1]=i.y,F[fe+Me+2]=i.z,F[fe+Me+3]=0),A===!0&&(i.fromBufferAttribute(Q,ye),F[fe+Me+4]=i.x,F[fe+Me+5]=i.y,F[fe+Me+6]=i.z,F[fe+Me+7]=0),E===!0&&(i.fromBufferAttribute(ue,ye),F[fe+Me+8]=i.x,F[fe+Me+9]=i.y,F[fe+Me+10]=i.z,F[fe+Me+11]=ue.itemSize===4?i.w:1)}}y={count:g,texture:j,size:new Ne(B,D)},n.set(f,y),f.addEventListener("dispose",N)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)d.getUniforms().setValue(s,"morphTexture",u.morphTexture,t);else{let M=0;for(let E=0;E<p.length;E++)M+=p[E];const A=f.morphTargetsRelative?1:1-M;d.getUniforms().setValue(s,"morphTargetBaseInfluence",A),d.getUniforms().setValue(s,"morphTargetInfluences",p)}d.getUniforms().setValue(s,"morphTargetsTexture",y.texture,t),d.getUniforms().setValue(s,"morphTargetsTextureSize",y.size)}return{update:o}}function ob(s,e,t,n){let i=new WeakMap;function o(d){const p=n.render.frame,m=d.geometry,g=e.get(d,m);if(i.get(g)!==p&&(e.update(g),i.set(g,p)),d.isInstancedMesh&&(d.hasEventListener("dispose",f)===!1&&d.addEventListener("dispose",f),i.get(d)!==p&&(t.update(d.instanceMatrix,s.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,s.ARRAY_BUFFER),i.set(d,p))),d.isSkinnedMesh){const y=d.skeleton;i.get(y)!==p&&(y.update(),i.set(y,p))}return g}function u(){i=new WeakMap}function f(d){const p=d.target;p.removeEventListener("dispose",f),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:o,dispose:u}}class yy extends Vn{constructor(e,t,n,i,o,u,f,d,p,m){if(m=m!==void 0?m:Ru,m!==Ru&&m!==Mf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&m===Ru&&(n=Du),n===void 0&&m===Mf&&(n=Pf),super(null,i,o,u,f,d,m,n,p),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=f!==void 0?f:Ai,this.minFilter=d!==void 0?d:Ai,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const wM=new Vn,EM=new yy(1,1);EM.compareFunction=fy;const TM=new jm,AM=new py,CM=new Sh,a_=[],l_=[],u_=new Float32Array(16),c_=new Float32Array(9),f_=new Float32Array(4);function If(s,e,t){const n=s[0];if(n<=0||n>0)return s;const i=e*t;let o=a_[i];if(o===void 0&&(o=new Float32Array(i),a_[i]=o),e!==0){n.toArray(o,0);for(let u=1,f=0;u!==e;++u)f+=t,s[u].toArray(o,f)}return o}function xi(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function _i(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function Xm(s,e){let t=l_[e];t===void 0&&(t=new Int32Array(e),l_[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function ab(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function lb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xi(t,e))return;s.uniform2fv(this.addr,e),_i(t,e)}}function ub(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(xi(t,e))return;s.uniform3fv(this.addr,e),_i(t,e)}}function cb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xi(t,e))return;s.uniform4fv(this.addr,e),_i(t,e)}}function fb(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(xi(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),_i(t,e)}else{if(xi(t,n))return;f_.set(n),s.uniformMatrix2fv(this.addr,!1,f_),_i(t,n)}}function db(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(xi(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),_i(t,e)}else{if(xi(t,n))return;c_.set(n),s.uniformMatrix3fv(this.addr,!1,c_),_i(t,n)}}function hb(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(xi(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),_i(t,e)}else{if(xi(t,n))return;u_.set(n),s.uniformMatrix4fv(this.addr,!1,u_),_i(t,n)}}function pb(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function mb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xi(t,e))return;s.uniform2iv(this.addr,e),_i(t,e)}}function gb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(xi(t,e))return;s.uniform3iv(this.addr,e),_i(t,e)}}function vb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xi(t,e))return;s.uniform4iv(this.addr,e),_i(t,e)}}function yb(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function xb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(xi(t,e))return;s.uniform2uiv(this.addr,e),_i(t,e)}}function _b(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(xi(t,e))return;s.uniform3uiv(this.addr,e),_i(t,e)}}function Sb(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(xi(t,e))return;s.uniform4uiv(this.addr,e),_i(t,e)}}function Mb(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i);const o=this.type===s.SAMPLER_2D_SHADOW?EM:wM;t.setTexture2D(e||o,i)}function wb(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||AM,i)}function Eb(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||CM,i)}function Tb(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||TM,i)}function Ab(s){switch(s){case 5126:return ab;case 35664:return lb;case 35665:return ub;case 35666:return cb;case 35674:return fb;case 35675:return db;case 35676:return hb;case 5124:case 35670:return pb;case 35667:case 35671:return mb;case 35668:case 35672:return gb;case 35669:case 35673:return vb;case 5125:return yb;case 36294:return xb;case 36295:return _b;case 36296:return Sb;case 35678:case 36198:case 36298:case 36306:case 35682:return Mb;case 35679:case 36299:case 36307:return wb;case 35680:case 36300:case 36308:case 36293:return Eb;case 36289:case 36303:case 36311:case 36292:return Tb}}function Cb(s,e){s.uniform1fv(this.addr,e)}function bb(s,e){const t=If(e,this.size,2);s.uniform2fv(this.addr,t)}function Rb(s,e){const t=If(e,this.size,3);s.uniform3fv(this.addr,t)}function Pb(s,e){const t=If(e,this.size,4);s.uniform4fv(this.addr,t)}function Lb(s,e){const t=If(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function Ib(s,e){const t=If(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function Nb(s,e){const t=If(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function Db(s,e){s.uniform1iv(this.addr,e)}function Ub(s,e){s.uniform2iv(this.addr,e)}function Ob(s,e){s.uniform3iv(this.addr,e)}function kb(s,e){s.uniform4iv(this.addr,e)}function zb(s,e){s.uniform1uiv(this.addr,e)}function Fb(s,e){s.uniform2uiv(this.addr,e)}function Bb(s,e){s.uniform3uiv(this.addr,e)}function Hb(s,e){s.uniform4uiv(this.addr,e)}function Vb(s,e,t){const n=this.cache,i=e.length,o=Xm(t,i);xi(n,o)||(s.uniform1iv(this.addr,o),_i(n,o));for(let u=0;u!==i;++u)t.setTexture2D(e[u]||wM,o[u])}function Gb(s,e,t){const n=this.cache,i=e.length,o=Xm(t,i);xi(n,o)||(s.uniform1iv(this.addr,o),_i(n,o));for(let u=0;u!==i;++u)t.setTexture3D(e[u]||AM,o[u])}function Wb(s,e,t){const n=this.cache,i=e.length,o=Xm(t,i);xi(n,o)||(s.uniform1iv(this.addr,o),_i(n,o));for(let u=0;u!==i;++u)t.setTextureCube(e[u]||CM,o[u])}function jb(s,e,t){const n=this.cache,i=e.length,o=Xm(t,i);xi(n,o)||(s.uniform1iv(this.addr,o),_i(n,o));for(let u=0;u!==i;++u)t.setTexture2DArray(e[u]||TM,o[u])}function Xb(s){switch(s){case 5126:return Cb;case 35664:return bb;case 35665:return Rb;case 35666:return Pb;case 35674:return Lb;case 35675:return Ib;case 35676:return Nb;case 5124:case 35670:return Db;case 35667:case 35671:return Ub;case 35668:case 35672:return Ob;case 35669:case 35673:return kb;case 5125:return zb;case 36294:return Fb;case 36295:return Bb;case 36296:return Hb;case 35678:case 36198:case 36298:case 36306:case 35682:return Vb;case 35679:case 36299:case 36307:return Gb;case 35680:case 36300:case 36308:case 36293:return Wb;case 36289:case 36303:case 36311:case 36292:return jb}}class Yb{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=Ab(t.type)}}class qb{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Xb(t.type)}}class Zb{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let o=0,u=i.length;o!==u;++o){const f=i[o];f.setValue(e,t[f.id],n)}}}const v0=/(\w+)(\])?(\[|\.)?/g;function d_(s,e){s.seq.push(e),s.map[e.id]=e}function Qb(s,e,t){const n=s.name,i=n.length;for(v0.lastIndex=0;;){const o=v0.exec(n),u=v0.lastIndex;let f=o[1];const d=o[2]==="]",p=o[3];if(d&&(f=f|0),p===void 0||p==="["&&u+2===i){d_(t,p===void 0?new Yb(f,s,e):new qb(f,s,e));break}else{let g=t.map[f];g===void 0&&(g=new Zb(f),d_(t,g)),t=g}}}class bm{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const o=e.getActiveUniform(t,i),u=e.getUniformLocation(t,o.name);Qb(o,u,this)}}setValue(e,t,n,i){const o=this.map[t];o!==void 0&&o.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let o=0,u=t.length;o!==u;++o){const f=t[o],d=n[f.id];d.needsUpdate!==!1&&f.setValue(e,d.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,o=e.length;i!==o;++i){const u=e[i];u.id in t&&n.push(u)}return n}}function h_(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const Kb=37297;let Jb=0;function $b(s,e){const t=s.split(`
`),n=[],i=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let u=i;u<o;u++){const f=u+1;n.push(`${f===e?">":" "} ${f}: ${t[u]}`)}return n.join(`
`)}function eR(s){const e=pn.getPrimaries(pn.workingColorSpace),t=pn.getPrimaries(s);let n;switch(e===t?n="":e===rh&&t===ih?n="LinearDisplayP3ToLinearSRGB":e===ih&&t===rh&&(n="LinearSRGBToLinearDisplayP3"),s){case ya:case xh:return[n,"LinearTransferOETF"];case vs:case Wm:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[n,"LinearTransferOETF"]}}function p_(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),i=s.getShaderInfoLog(e).trim();if(n&&i==="")return"";const o=/ERROR: 0:(\d+)/.exec(i);if(o){const u=parseInt(o[1]);return t.toUpperCase()+`

`+i+`

`+$b(s.getShaderSource(e),u)}else return i}function tR(s,e){const t=eR(e);return`vec4 ${s}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function nR(s,e){let t;switch(e){case zS:t="Linear";break;case FS:t="Reinhard";break;case BS:t="OptimizedCineon";break;case ey:t="ACESFilmic";break;case VS:t="AgX";break;case GS:t="Neutral";break;case HS:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function iR(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Vd).join(`
`)}function rR(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function sR(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const o=s.getActiveAttrib(e,i),u=o.name;let f=1;o.type===s.FLOAT_MAT2&&(f=2),o.type===s.FLOAT_MAT3&&(f=3),o.type===s.FLOAT_MAT4&&(f=4),t[u]={type:o.type,location:s.getAttribLocation(e,u),locationSize:f}}return t}function Vd(s){return s!==""}function m_(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function g_(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const oR=/^[ \t]*#include +<([\w\d./]+)>/gm;function Vv(s){return s.replace(oR,lR)}const aR=new Map;function lR(s,e){let t=qt[e];if(t===void 0){const n=aR.get(e);if(n!==void 0)t=qt[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return Vv(t)}const uR=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function v_(s){return s.replace(uR,cR)}function cR(s,e,t,n){let i="";for(let o=parseInt(e);o<parseInt(t);o++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function y_(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function fR(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===Hm?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===Gd?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===js&&(e="SHADOWMAP_TYPE_VSM"),e}function dR(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case ga:case xl:e="ENVMAP_TYPE_CUBE";break;case Rf:e="ENVMAP_TYPE_CUBE_UV";break}return e}function hR(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case xl:e="ENVMAP_MODE_REFRACTION";break}return e}function pR(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case vh:e="ENVMAP_BLENDING_MULTIPLY";break;case OS:e="ENVMAP_BLENDING_MIX";break;case kS:e="ENVMAP_BLENDING_ADD";break}return e}function mR(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function gR(s,e,t,n){const i=s.getContext(),o=t.defines;let u=t.vertexShader,f=t.fragmentShader;const d=fR(t),p=dR(t),m=hR(t),g=pR(t),y=mR(t),_=iR(t),M=rR(o),A=i.createProgram();let E,S,P=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Vd).join(`
`),E.length>0&&(E+=`
`),S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M].filter(Vd).join(`
`),S.length>0&&(S+=`
`)):(E=[y_(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Vd).join(`
`),S=[y_(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,M,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+m:"",t.envMap?"#define "+g:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==Eo?"#define TONE_MAPPING":"",t.toneMapping!==Eo?qt.tonemapping_pars_fragment:"",t.toneMapping!==Eo?nR("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",qt.colorspace_pars_fragment,tR("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Vd).join(`
`)),u=Vv(u),u=m_(u,t),u=g_(u,t),f=Vv(f),f=m_(f,t),f=g_(f,t),u=v_(u),f=v_(f),t.isRawShaderMaterial!==!0&&(P=`#version 300 es
`,E=[_,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,S=["#define varying in",t.glslVersion===Bv?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Bv?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const b=P+E+u,L=P+S+f,B=h_(i,i.VERTEX_SHADER,b),D=h_(i,i.FRAGMENT_SHADER,L);i.attachShader(A,B),i.attachShader(A,D),t.index0AttributeName!==void 0?i.bindAttribLocation(A,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(A,0,"position"),i.linkProgram(A);function F(X){if(s.debug.checkShaderErrors){const te=i.getProgramInfoLog(A).trim(),Q=i.getShaderInfoLog(B).trim(),ue=i.getShaderInfoLog(D).trim();let fe=!0,ye=!0;if(i.getProgramParameter(A,i.LINK_STATUS)===!1)if(fe=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(i,A,B,D);else{const Me=p_(i,B,"vertex"),W=p_(i,D,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(A,i.VALIDATE_STATUS)+`

Material Name: `+X.name+`
Material Type: `+X.type+`

Program Info Log: `+te+`
`+Me+`
`+W)}else te!==""?console.warn("THREE.WebGLProgram: Program Info Log:",te):(Q===""||ue==="")&&(ye=!1);ye&&(X.diagnostics={runnable:fe,programLog:te,vertexShader:{log:Q,prefix:E},fragmentShader:{log:ue,prefix:S}})}i.deleteShader(B),i.deleteShader(D),j=new bm(i,A),O=sR(i,A)}let j;this.getUniforms=function(){return j===void 0&&F(this),j};let O;this.getAttributes=function(){return O===void 0&&F(this),O};let N=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return N===!1&&(N=i.getProgramParameter(A,Kb)),N},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(A),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Jb++,this.cacheKey=e,this.usedTimes=1,this.program=A,this.vertexShader=B,this.fragmentShader=D,this}let vR=0;class yR{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),o=this._getShaderStage(n),u=this._getShaderCacheForMaterial(e);return u.has(i)===!1&&(u.add(i),i.usedTimes++),u.has(o)===!1&&(u.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new xR(e),t.set(e,n)),n}}class xR{constructor(e){this.id=vR++,this.code=e,this.usedTimes=0}}function _R(s,e,t,n,i,o,u){const f=new Lu,d=new yR,p=new Set,m=[],g=i.logarithmicDepthBuffer,y=i.vertexTextures;let _=i.precision;const M={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function A(O){return p.add(O),O===0?"uv":`uv${O}`}function E(O,N,X,te,Q){const ue=te.fog,fe=Q.geometry,ye=O.isMeshStandardMaterial?te.environment:null,Me=(O.isMeshStandardMaterial?t:e).get(O.envMap||ye),W=Me&&Me.mapping===Rf?Me.image.height:null,ee=M[O.type];O.precision!==null&&(_=i.getMaxPrecision(O.precision),_!==O.precision&&console.warn("THREE.WebGLProgram.getParameters:",O.precision,"not supported, using",_,"instead."));const k=fe.morphAttributes.position||fe.morphAttributes.normal||fe.morphAttributes.color,J=k!==void 0?k.length:0;let Ce=0;fe.morphAttributes.position!==void 0&&(Ce=1),fe.morphAttributes.normal!==void 0&&(Ce=2),fe.morphAttributes.color!==void 0&&(Ce=3);let Ve,se,Re,ke;if(ee){const Xt=Ys[ee];Ve=Xt.vertexShader,se=Xt.fragmentShader}else Ve=O.vertexShader,se=O.fragmentShader,d.update(O),Re=d.getVertexShaderID(O),ke=d.getFragmentShaderID(O);const Le=s.getRenderTarget(),tt=Q.isInstancedMesh===!0,xt=Q.isBatchedMesh===!0,ae=!!O.map,Mt=!!O.matcap,Ae=!!Me,Oe=!!O.aoMap,De=!!O.lightMap,Xe=!!O.bumpMap,xe=!!O.normalMap,Fe=!!O.displacementMap,$e=!!O.emissiveMap,q=!!O.metalnessMap,z=!!O.roughnessMap,de=O.anisotropy>0,Ie=O.clearcoat>0,ze=O.dispersion>0,Ue=O.iridescence>0,vt=O.sheen>0,Je=O.transmission>0,Ke=de&&!!O.anisotropyMap,Ct=Ie&&!!O.clearcoatMap,qe=Ie&&!!O.clearcoatNormalMap,ft=Ie&&!!O.clearcoatRoughnessMap,Nt=Ue&&!!O.iridescenceMap,Tt=Ue&&!!O.iridescenceThicknessMap,ot=vt&&!!O.sheenColorMap,Dt=vt&&!!O.sheenRoughnessMap,Bt=!!O.specularMap,ne=!!O.specularColorMap,Pe=!!O.specularIntensityMap,K=Je&&!!O.transmissionMap,Ee=Je&&!!O.thicknessMap,Te=!!O.gradientMap,We=!!O.alphaMap,Ze=O.alphaTest>0,Kt=!!O.alphaHash,rn=!!O.extensions;let Jt=Eo;O.toneMapped&&(Le===null||Le.isXRRenderTarget===!0)&&(Jt=s.toneMapping);const fn={shaderID:ee,shaderType:O.type,shaderName:O.name,vertexShader:Ve,fragmentShader:se,defines:O.defines,customVertexShaderID:Re,customFragmentShaderID:ke,isRawShaderMaterial:O.isRawShaderMaterial===!0,glslVersion:O.glslVersion,precision:_,batching:xt,instancing:tt,instancingColor:tt&&Q.instanceColor!==null,instancingMorph:tt&&Q.morphTexture!==null,supportsVertexTextures:y,outputColorSpace:Le===null?s.outputColorSpace:Le.isXRRenderTarget===!0?Le.texture.colorSpace:ya,alphaToCoverage:!!O.alphaToCoverage,map:ae,matcap:Mt,envMap:Ae,envMapMode:Ae&&Me.mapping,envMapCubeUVHeight:W,aoMap:Oe,lightMap:De,bumpMap:Xe,normalMap:xe,displacementMap:y&&Fe,emissiveMap:$e,normalMapObjectSpace:xe&&O.normalMapType===sM,normalMapTangentSpace:xe&&O.normalMapType===Sl,metalnessMap:q,roughnessMap:z,anisotropy:de,anisotropyMap:Ke,clearcoat:Ie,clearcoatMap:Ct,clearcoatNormalMap:qe,clearcoatRoughnessMap:ft,dispersion:ze,iridescence:Ue,iridescenceMap:Nt,iridescenceThicknessMap:Tt,sheen:vt,sheenColorMap:ot,sheenRoughnessMap:Dt,specularMap:Bt,specularColorMap:ne,specularIntensityMap:Pe,transmission:Je,transmissionMap:K,thicknessMap:Ee,gradientMap:Te,opaque:O.transparent===!1&&O.blending===bu&&O.alphaToCoverage===!1,alphaMap:We,alphaTest:Ze,alphaHash:Kt,combine:O.combine,mapUv:ae&&A(O.map.channel),aoMapUv:Oe&&A(O.aoMap.channel),lightMapUv:De&&A(O.lightMap.channel),bumpMapUv:Xe&&A(O.bumpMap.channel),normalMapUv:xe&&A(O.normalMap.channel),displacementMapUv:Fe&&A(O.displacementMap.channel),emissiveMapUv:$e&&A(O.emissiveMap.channel),metalnessMapUv:q&&A(O.metalnessMap.channel),roughnessMapUv:z&&A(O.roughnessMap.channel),anisotropyMapUv:Ke&&A(O.anisotropyMap.channel),clearcoatMapUv:Ct&&A(O.clearcoatMap.channel),clearcoatNormalMapUv:qe&&A(O.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ft&&A(O.clearcoatRoughnessMap.channel),iridescenceMapUv:Nt&&A(O.iridescenceMap.channel),iridescenceThicknessMapUv:Tt&&A(O.iridescenceThicknessMap.channel),sheenColorMapUv:ot&&A(O.sheenColorMap.channel),sheenRoughnessMapUv:Dt&&A(O.sheenRoughnessMap.channel),specularMapUv:Bt&&A(O.specularMap.channel),specularColorMapUv:ne&&A(O.specularColorMap.channel),specularIntensityMapUv:Pe&&A(O.specularIntensityMap.channel),transmissionMapUv:K&&A(O.transmissionMap.channel),thicknessMapUv:Ee&&A(O.thicknessMap.channel),alphaMapUv:We&&A(O.alphaMap.channel),vertexTangents:!!fe.attributes.tangent&&(xe||de),vertexColors:O.vertexColors,vertexAlphas:O.vertexColors===!0&&!!fe.attributes.color&&fe.attributes.color.itemSize===4,pointsUvs:Q.isPoints===!0&&!!fe.attributes.uv&&(ae||We),fog:!!ue,useFog:O.fog===!0,fogExp2:!!ue&&ue.isFogExp2,flatShading:O.flatShading===!0,sizeAttenuation:O.sizeAttenuation===!0,logarithmicDepthBuffer:g,skinning:Q.isSkinnedMesh===!0,morphTargets:fe.morphAttributes.position!==void 0,morphNormals:fe.morphAttributes.normal!==void 0,morphColors:fe.morphAttributes.color!==void 0,morphTargetsCount:J,morphTextureStride:Ce,numDirLights:N.directional.length,numPointLights:N.point.length,numSpotLights:N.spot.length,numSpotLightMaps:N.spotLightMap.length,numRectAreaLights:N.rectArea.length,numHemiLights:N.hemi.length,numDirLightShadows:N.directionalShadowMap.length,numPointLightShadows:N.pointShadowMap.length,numSpotLightShadows:N.spotShadowMap.length,numSpotLightShadowsWithMaps:N.numSpotLightShadowsWithMaps,numLightProbes:N.numLightProbes,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:O.dithering,shadowMapEnabled:s.shadowMap.enabled&&X.length>0,shadowMapType:s.shadowMap.type,toneMapping:Jt,useLegacyLights:s._useLegacyLights,decodeVideoTexture:ae&&O.map.isVideoTexture===!0&&pn.getTransfer(O.map.colorSpace)===bn,premultipliedAlpha:O.premultipliedAlpha,doubleSided:O.side===_o,flipSided:O.side===nr,useDepthPacking:O.depthPacking>=0,depthPacking:O.depthPacking||0,index0AttributeName:O.index0AttributeName,extensionClipCullDistance:rn&&O.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:rn&&O.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:O.customProgramCacheKey()};return fn.vertexUv1s=p.has(1),fn.vertexUv2s=p.has(2),fn.vertexUv3s=p.has(3),p.clear(),fn}function S(O){const N=[];if(O.shaderID?N.push(O.shaderID):(N.push(O.customVertexShaderID),N.push(O.customFragmentShaderID)),O.defines!==void 0)for(const X in O.defines)N.push(X),N.push(O.defines[X]);return O.isRawShaderMaterial===!1&&(P(N,O),b(N,O),N.push(s.outputColorSpace)),N.push(O.customProgramCacheKey),N.join()}function P(O,N){O.push(N.precision),O.push(N.outputColorSpace),O.push(N.envMapMode),O.push(N.envMapCubeUVHeight),O.push(N.mapUv),O.push(N.alphaMapUv),O.push(N.lightMapUv),O.push(N.aoMapUv),O.push(N.bumpMapUv),O.push(N.normalMapUv),O.push(N.displacementMapUv),O.push(N.emissiveMapUv),O.push(N.metalnessMapUv),O.push(N.roughnessMapUv),O.push(N.anisotropyMapUv),O.push(N.clearcoatMapUv),O.push(N.clearcoatNormalMapUv),O.push(N.clearcoatRoughnessMapUv),O.push(N.iridescenceMapUv),O.push(N.iridescenceThicknessMapUv),O.push(N.sheenColorMapUv),O.push(N.sheenRoughnessMapUv),O.push(N.specularMapUv),O.push(N.specularColorMapUv),O.push(N.specularIntensityMapUv),O.push(N.transmissionMapUv),O.push(N.thicknessMapUv),O.push(N.combine),O.push(N.fogExp2),O.push(N.sizeAttenuation),O.push(N.morphTargetsCount),O.push(N.morphAttributeCount),O.push(N.numDirLights),O.push(N.numPointLights),O.push(N.numSpotLights),O.push(N.numSpotLightMaps),O.push(N.numHemiLights),O.push(N.numRectAreaLights),O.push(N.numDirLightShadows),O.push(N.numPointLightShadows),O.push(N.numSpotLightShadows),O.push(N.numSpotLightShadowsWithMaps),O.push(N.numLightProbes),O.push(N.shadowMapType),O.push(N.toneMapping),O.push(N.numClippingPlanes),O.push(N.numClipIntersection),O.push(N.depthPacking)}function b(O,N){f.disableAll(),N.supportsVertexTextures&&f.enable(0),N.instancing&&f.enable(1),N.instancingColor&&f.enable(2),N.instancingMorph&&f.enable(3),N.matcap&&f.enable(4),N.envMap&&f.enable(5),N.normalMapObjectSpace&&f.enable(6),N.normalMapTangentSpace&&f.enable(7),N.clearcoat&&f.enable(8),N.iridescence&&f.enable(9),N.alphaTest&&f.enable(10),N.vertexColors&&f.enable(11),N.vertexAlphas&&f.enable(12),N.vertexUv1s&&f.enable(13),N.vertexUv2s&&f.enable(14),N.vertexUv3s&&f.enable(15),N.vertexTangents&&f.enable(16),N.anisotropy&&f.enable(17),N.alphaHash&&f.enable(18),N.batching&&f.enable(19),N.dispersion&&f.enable(20),O.push(f.mask),f.disableAll(),N.fog&&f.enable(0),N.useFog&&f.enable(1),N.flatShading&&f.enable(2),N.logarithmicDepthBuffer&&f.enable(3),N.skinning&&f.enable(4),N.morphTargets&&f.enable(5),N.morphNormals&&f.enable(6),N.morphColors&&f.enable(7),N.premultipliedAlpha&&f.enable(8),N.shadowMapEnabled&&f.enable(9),N.useLegacyLights&&f.enable(10),N.doubleSided&&f.enable(11),N.flipSided&&f.enable(12),N.useDepthPacking&&f.enable(13),N.dithering&&f.enable(14),N.transmission&&f.enable(15),N.sheen&&f.enable(16),N.opaque&&f.enable(17),N.pointsUvs&&f.enable(18),N.decodeVideoTexture&&f.enable(19),N.alphaToCoverage&&f.enable(20),O.push(f.mask)}function L(O){const N=M[O.type];let X;if(N){const te=Ys[N];X=lh.clone(te.uniforms)}else X=O.uniforms;return X}function B(O,N){let X;for(let te=0,Q=m.length;te<Q;te++){const ue=m[te];if(ue.cacheKey===N){X=ue,++X.usedTimes;break}}return X===void 0&&(X=new gR(s,N,O,o),m.push(X)),X}function D(O){if(--O.usedTimes===0){const N=m.indexOf(O);m[N]=m[m.length-1],m.pop(),O.destroy()}}function F(O){d.remove(O)}function j(){d.dispose()}return{getParameters:E,getProgramCacheKey:S,getUniforms:L,acquireProgram:B,releaseProgram:D,releaseShaderCache:F,programs:m,dispose:j}}function SR(){let s=new WeakMap;function e(o){let u=s.get(o);return u===void 0&&(u={},s.set(o,u)),u}function t(o){s.delete(o)}function n(o,u,f){s.get(o)[u]=f}function i(){s=new WeakMap}return{get:e,remove:t,update:n,dispose:i}}function MR(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function x_(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function __(){const s=[];let e=0;const t=[],n=[],i=[];function o(){e=0,t.length=0,n.length=0,i.length=0}function u(g,y,_,M,A,E){let S=s[e];return S===void 0?(S={id:g.id,object:g,geometry:y,material:_,groupOrder:M,renderOrder:g.renderOrder,z:A,group:E},s[e]=S):(S.id=g.id,S.object=g,S.geometry=y,S.material=_,S.groupOrder=M,S.renderOrder=g.renderOrder,S.z=A,S.group=E),e++,S}function f(g,y,_,M,A,E){const S=u(g,y,_,M,A,E);_.transmission>0?n.push(S):_.transparent===!0?i.push(S):t.push(S)}function d(g,y,_,M,A,E){const S=u(g,y,_,M,A,E);_.transmission>0?n.unshift(S):_.transparent===!0?i.unshift(S):t.unshift(S)}function p(g,y){t.length>1&&t.sort(g||MR),n.length>1&&n.sort(y||x_),i.length>1&&i.sort(y||x_)}function m(){for(let g=e,y=s.length;g<y;g++){const _=s[g];if(_.id===null)break;_.id=null,_.object=null,_.geometry=null,_.material=null,_.group=null}}return{opaque:t,transmissive:n,transparent:i,init:o,push:f,unshift:d,finish:m,sort:p}}function wR(){let s=new WeakMap;function e(n,i){const o=s.get(n);let u;return o===void 0?(u=new __,s.set(n,[u])):i>=o.length?(u=new __,o.push(u)):u=o[i],u}function t(){s=new WeakMap}return{get:e,dispose:t}}function ER(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new G,color:new st};break;case"SpotLight":t={position:new G,direction:new G,color:new st,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new G,color:new st,distance:0,decay:0};break;case"HemisphereLight":t={direction:new G,skyColor:new st,groundColor:new st};break;case"RectAreaLight":t={color:new st,position:new G,halfWidth:new G,halfHeight:new G};break}return s[e.id]=t,t}}}function TR(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ne};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ne};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ne,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let AR=0;function CR(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function bR(s){const e=new ER,t=TR(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new G);const i=new G,o=new It,u=new It;function f(p,m){let g=0,y=0,_=0;for(let X=0;X<9;X++)n.probe[X].set(0,0,0);let M=0,A=0,E=0,S=0,P=0,b=0,L=0,B=0,D=0,F=0,j=0;p.sort(CR);const O=m===!0?Math.PI:1;for(let X=0,te=p.length;X<te;X++){const Q=p[X],ue=Q.color,fe=Q.intensity,ye=Q.distance,Me=Q.shadow&&Q.shadow.map?Q.shadow.map.texture:null;if(Q.isAmbientLight)g+=ue.r*fe*O,y+=ue.g*fe*O,_+=ue.b*fe*O;else if(Q.isLightProbe){for(let W=0;W<9;W++)n.probe[W].addScaledVector(Q.sh.coefficients[W],fe);j++}else if(Q.isDirectionalLight){const W=e.get(Q);if(W.color.copy(Q.color).multiplyScalar(Q.intensity*O),Q.castShadow){const ee=Q.shadow,k=t.get(Q);k.shadowBias=ee.bias,k.shadowNormalBias=ee.normalBias,k.shadowRadius=ee.radius,k.shadowMapSize=ee.mapSize,n.directionalShadow[M]=k,n.directionalShadowMap[M]=Me,n.directionalShadowMatrix[M]=Q.shadow.matrix,b++}n.directional[M]=W,M++}else if(Q.isSpotLight){const W=e.get(Q);W.position.setFromMatrixPosition(Q.matrixWorld),W.color.copy(ue).multiplyScalar(fe*O),W.distance=ye,W.coneCos=Math.cos(Q.angle),W.penumbraCos=Math.cos(Q.angle*(1-Q.penumbra)),W.decay=Q.decay,n.spot[E]=W;const ee=Q.shadow;if(Q.map&&(n.spotLightMap[D]=Q.map,D++,ee.updateMatrices(Q),Q.castShadow&&F++),n.spotLightMatrix[E]=ee.matrix,Q.castShadow){const k=t.get(Q);k.shadowBias=ee.bias,k.shadowNormalBias=ee.normalBias,k.shadowRadius=ee.radius,k.shadowMapSize=ee.mapSize,n.spotShadow[E]=k,n.spotShadowMap[E]=Me,B++}E++}else if(Q.isRectAreaLight){const W=e.get(Q);W.color.copy(ue).multiplyScalar(fe),W.halfWidth.set(Q.width*.5,0,0),W.halfHeight.set(0,Q.height*.5,0),n.rectArea[S]=W,S++}else if(Q.isPointLight){const W=e.get(Q);if(W.color.copy(Q.color).multiplyScalar(Q.intensity*O),W.distance=Q.distance,W.decay=Q.decay,Q.castShadow){const ee=Q.shadow,k=t.get(Q);k.shadowBias=ee.bias,k.shadowNormalBias=ee.normalBias,k.shadowRadius=ee.radius,k.shadowMapSize=ee.mapSize,k.shadowCameraNear=ee.camera.near,k.shadowCameraFar=ee.camera.far,n.pointShadow[A]=k,n.pointShadowMap[A]=Me,n.pointShadowMatrix[A]=Q.shadow.matrix,L++}n.point[A]=W,A++}else if(Q.isHemisphereLight){const W=e.get(Q);W.skyColor.copy(Q.color).multiplyScalar(fe*O),W.groundColor.copy(Q.groundColor).multiplyScalar(fe*O),n.hemi[P]=W,P++}}S>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=et.LTC_FLOAT_1,n.rectAreaLTC2=et.LTC_FLOAT_2):(n.rectAreaLTC1=et.LTC_HALF_1,n.rectAreaLTC2=et.LTC_HALF_2)),n.ambient[0]=g,n.ambient[1]=y,n.ambient[2]=_;const N=n.hash;(N.directionalLength!==M||N.pointLength!==A||N.spotLength!==E||N.rectAreaLength!==S||N.hemiLength!==P||N.numDirectionalShadows!==b||N.numPointShadows!==L||N.numSpotShadows!==B||N.numSpotMaps!==D||N.numLightProbes!==j)&&(n.directional.length=M,n.spot.length=E,n.rectArea.length=S,n.point.length=A,n.hemi.length=P,n.directionalShadow.length=b,n.directionalShadowMap.length=b,n.pointShadow.length=L,n.pointShadowMap.length=L,n.spotShadow.length=B,n.spotShadowMap.length=B,n.directionalShadowMatrix.length=b,n.pointShadowMatrix.length=L,n.spotLightMatrix.length=B+D-F,n.spotLightMap.length=D,n.numSpotLightShadowsWithMaps=F,n.numLightProbes=j,N.directionalLength=M,N.pointLength=A,N.spotLength=E,N.rectAreaLength=S,N.hemiLength=P,N.numDirectionalShadows=b,N.numPointShadows=L,N.numSpotShadows=B,N.numSpotMaps=D,N.numLightProbes=j,n.version=AR++)}function d(p,m){let g=0,y=0,_=0,M=0,A=0;const E=m.matrixWorldInverse;for(let S=0,P=p.length;S<P;S++){const b=p[S];if(b.isDirectionalLight){const L=n.directional[g];L.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),L.direction.sub(i),L.direction.transformDirection(E),g++}else if(b.isSpotLight){const L=n.spot[_];L.position.setFromMatrixPosition(b.matrixWorld),L.position.applyMatrix4(E),L.direction.setFromMatrixPosition(b.matrixWorld),i.setFromMatrixPosition(b.target.matrixWorld),L.direction.sub(i),L.direction.transformDirection(E),_++}else if(b.isRectAreaLight){const L=n.rectArea[M];L.position.setFromMatrixPosition(b.matrixWorld),L.position.applyMatrix4(E),u.identity(),o.copy(b.matrixWorld),o.premultiply(E),u.extractRotation(o),L.halfWidth.set(b.width*.5,0,0),L.halfHeight.set(0,b.height*.5,0),L.halfWidth.applyMatrix4(u),L.halfHeight.applyMatrix4(u),M++}else if(b.isPointLight){const L=n.point[y];L.position.setFromMatrixPosition(b.matrixWorld),L.position.applyMatrix4(E),y++}else if(b.isHemisphereLight){const L=n.hemi[A];L.direction.setFromMatrixPosition(b.matrixWorld),L.direction.transformDirection(E),A++}}}return{setup:f,setupView:d,state:n}}function S_(s){const e=new bR(s),t=[],n=[];function i(m){p.camera=m,t.length=0,n.length=0}function o(m){t.push(m)}function u(m){n.push(m)}function f(m){e.setup(t,m)}function d(m){e.setupView(t,m)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:p,setupLights:f,setupLightsView:d,pushLight:o,pushShadow:u}}function RR(s){let e=new WeakMap;function t(i,o=0){const u=e.get(i);let f;return u===void 0?(f=new S_(s),e.set(i,[f])):o>=u.length?(f=new S_(s),u.push(f)):f=u[o],f}function n(){e=new WeakMap}return{get:t,dispose:n}}class xy extends Wi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=iM,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class _y extends Wi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const PR=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,LR=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function IR(s,e,t){let n=new Mh;const i=new Ne,o=new Ne,u=new nn,f=new xy({depthPacking:rM}),d=new _y,p={},m=t.maxTextureSize,g={[ma]:nr,[nr]:ma,[_o]:_o},y=new is({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ne},radius:{value:4}},vertexShader:PR,fragmentShader:LR}),_=y.clone();_.defines.HORIZONTAL_PASS=1;const M=new Zt;M.setAttribute("position",new mn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const A=new ti(M,y),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Hm;let S=this.type;this.render=function(D,F,j){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||D.length===0)return;const O=s.getRenderTarget(),N=s.getActiveCubeFace(),X=s.getActiveMipmapLevel(),te=s.state;te.setBlending(pa),te.buffers.color.setClear(1,1,1,1),te.buffers.depth.setTest(!0),te.setScissorTest(!1);const Q=S!==js&&this.type===js,ue=S===js&&this.type!==js;for(let fe=0,ye=D.length;fe<ye;fe++){const Me=D[fe],W=Me.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",Me,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;i.copy(W.mapSize);const ee=W.getFrameExtents();if(i.multiply(ee),o.copy(W.mapSize),(i.x>m||i.y>m)&&(i.x>m&&(o.x=Math.floor(m/ee.x),i.x=o.x*ee.x,W.mapSize.x=o.x),i.y>m&&(o.y=Math.floor(m/ee.y),i.y=o.y*ee.y,W.mapSize.y=o.y)),W.map===null||Q===!0||ue===!0){const J=this.type!==js?{minFilter:Ai,magFilter:Ai}:{};W.map!==null&&W.map.dispose(),W.map=new qs(i.x,i.y,J),W.map.texture.name=Me.name+".shadowMap",W.camera.updateProjectionMatrix()}s.setRenderTarget(W.map),s.clear();const k=W.getViewportCount();for(let J=0;J<k;J++){const Ce=W.getViewport(J);u.set(o.x*Ce.x,o.y*Ce.y,o.x*Ce.z,o.y*Ce.w),te.viewport(u),W.updateMatrices(Me,J),n=W.getFrustum(),L(F,j,W.camera,Me,this.type)}W.isPointLightShadow!==!0&&this.type===js&&P(W,j),W.needsUpdate=!1}S=this.type,E.needsUpdate=!1,s.setRenderTarget(O,N,X)};function P(D,F){const j=e.update(A);y.defines.VSM_SAMPLES!==D.blurSamples&&(y.defines.VSM_SAMPLES=D.blurSamples,_.defines.VSM_SAMPLES=D.blurSamples,y.needsUpdate=!0,_.needsUpdate=!0),D.mapPass===null&&(D.mapPass=new qs(i.x,i.y)),y.uniforms.shadow_pass.value=D.map.texture,y.uniforms.resolution.value=D.mapSize,y.uniforms.radius.value=D.radius,s.setRenderTarget(D.mapPass),s.clear(),s.renderBufferDirect(F,null,j,y,A,null),_.uniforms.shadow_pass.value=D.mapPass.texture,_.uniforms.resolution.value=D.mapSize,_.uniforms.radius.value=D.radius,s.setRenderTarget(D.map),s.clear(),s.renderBufferDirect(F,null,j,_,A,null)}function b(D,F,j,O){let N=null;const X=j.isPointLight===!0?D.customDistanceMaterial:D.customDepthMaterial;if(X!==void 0)N=X;else if(N=j.isPointLight===!0?d:f,s.localClippingEnabled&&F.clipShadows===!0&&Array.isArray(F.clippingPlanes)&&F.clippingPlanes.length!==0||F.displacementMap&&F.displacementScale!==0||F.alphaMap&&F.alphaTest>0||F.map&&F.alphaTest>0){const te=N.uuid,Q=F.uuid;let ue=p[te];ue===void 0&&(ue={},p[te]=ue);let fe=ue[Q];fe===void 0&&(fe=N.clone(),ue[Q]=fe,F.addEventListener("dispose",B)),N=fe}if(N.visible=F.visible,N.wireframe=F.wireframe,O===js?N.side=F.shadowSide!==null?F.shadowSide:F.side:N.side=F.shadowSide!==null?F.shadowSide:g[F.side],N.alphaMap=F.alphaMap,N.alphaTest=F.alphaTest,N.map=F.map,N.clipShadows=F.clipShadows,N.clippingPlanes=F.clippingPlanes,N.clipIntersection=F.clipIntersection,N.displacementMap=F.displacementMap,N.displacementScale=F.displacementScale,N.displacementBias=F.displacementBias,N.wireframeLinewidth=F.wireframeLinewidth,N.linewidth=F.linewidth,j.isPointLight===!0&&N.isMeshDistanceMaterial===!0){const te=s.properties.get(N);te.light=j}return N}function L(D,F,j,O,N){if(D.visible===!1)return;if(D.layers.test(F.layers)&&(D.isMesh||D.isLine||D.isPoints)&&(D.castShadow||D.receiveShadow&&N===js)&&(!D.frustumCulled||n.intersectsObject(D))){D.modelViewMatrix.multiplyMatrices(j.matrixWorldInverse,D.matrixWorld);const Q=e.update(D),ue=D.material;if(Array.isArray(ue)){const fe=Q.groups;for(let ye=0,Me=fe.length;ye<Me;ye++){const W=fe[ye],ee=ue[W.materialIndex];if(ee&&ee.visible){const k=b(D,ee,O,N);D.onBeforeShadow(s,D,F,j,Q,k,W),s.renderBufferDirect(j,null,Q,k,D,W),D.onAfterShadow(s,D,F,j,Q,k,W)}}}else if(ue.visible){const fe=b(D,ue,O,N);D.onBeforeShadow(s,D,F,j,Q,fe,null),s.renderBufferDirect(j,null,Q,fe,D,null),D.onAfterShadow(s,D,F,j,Q,fe,null)}}const te=D.children;for(let Q=0,ue=te.length;Q<ue;Q++)L(te[Q],F,j,O,N)}function B(D){D.target.removeEventListener("dispose",B);for(const j in p){const O=p[j],N=D.target.uuid;N in O&&(O[N].dispose(),delete O[N])}}}function NR(s){function e(){let K=!1;const Ee=new nn;let Te=null;const We=new nn(0,0,0,0);return{setMask:function(Ze){Te!==Ze&&!K&&(s.colorMask(Ze,Ze,Ze,Ze),Te=Ze)},setLocked:function(Ze){K=Ze},setClear:function(Ze,Kt,rn,Jt,fn){fn===!0&&(Ze*=Jt,Kt*=Jt,rn*=Jt),Ee.set(Ze,Kt,rn,Jt),We.equals(Ee)===!1&&(s.clearColor(Ze,Kt,rn,Jt),We.copy(Ee))},reset:function(){K=!1,Te=null,We.set(-1,0,0,0)}}}function t(){let K=!1,Ee=null,Te=null,We=null;return{setTest:function(Ze){Ze?ke(s.DEPTH_TEST):Le(s.DEPTH_TEST)},setMask:function(Ze){Ee!==Ze&&!K&&(s.depthMask(Ze),Ee=Ze)},setFunc:function(Ze){if(Te!==Ze){switch(Ze){case RS:s.depthFunc(s.NEVER);break;case PS:s.depthFunc(s.ALWAYS);break;case LS:s.depthFunc(s.LESS);break;case qd:s.depthFunc(s.LEQUAL);break;case IS:s.depthFunc(s.EQUAL);break;case NS:s.depthFunc(s.GEQUAL);break;case DS:s.depthFunc(s.GREATER);break;case US:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Te=Ze}},setLocked:function(Ze){K=Ze},setClear:function(Ze){We!==Ze&&(s.clearDepth(Ze),We=Ze)},reset:function(){K=!1,Ee=null,Te=null,We=null}}}function n(){let K=!1,Ee=null,Te=null,We=null,Ze=null,Kt=null,rn=null,Jt=null,fn=null;return{setTest:function(Xt){K||(Xt?ke(s.STENCIL_TEST):Le(s.STENCIL_TEST))},setMask:function(Xt){Ee!==Xt&&!K&&(s.stencilMask(Xt),Ee=Xt)},setFunc:function(Xt,On,wn){(Te!==Xt||We!==On||Ze!==wn)&&(s.stencilFunc(Xt,On,wn),Te=Xt,We=On,Ze=wn)},setOp:function(Xt,On,wn){(Kt!==Xt||rn!==On||Jt!==wn)&&(s.stencilOp(Xt,On,wn),Kt=Xt,rn=On,Jt=wn)},setLocked:function(Xt){K=Xt},setClear:function(Xt){fn!==Xt&&(s.clearStencil(Xt),fn=Xt)},reset:function(){K=!1,Ee=null,Te=null,We=null,Ze=null,Kt=null,rn=null,Jt=null,fn=null}}}const i=new e,o=new t,u=new n,f=new WeakMap,d=new WeakMap;let p={},m={},g=new WeakMap,y=[],_=null,M=!1,A=null,E=null,S=null,P=null,b=null,L=null,B=null,D=new st(0,0,0),F=0,j=!1,O=null,N=null,X=null,te=null,Q=null;const ue=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let fe=!1,ye=0;const Me=s.getParameter(s.VERSION);Me.indexOf("WebGL")!==-1?(ye=parseFloat(/^WebGL (\d)/.exec(Me)[1]),fe=ye>=1):Me.indexOf("OpenGL ES")!==-1&&(ye=parseFloat(/^OpenGL ES (\d)/.exec(Me)[1]),fe=ye>=2);let W=null,ee={};const k=s.getParameter(s.SCISSOR_BOX),J=s.getParameter(s.VIEWPORT),Ce=new nn().fromArray(k),Ve=new nn().fromArray(J);function se(K,Ee,Te,We){const Ze=new Uint8Array(4),Kt=s.createTexture();s.bindTexture(K,Kt),s.texParameteri(K,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(K,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let rn=0;rn<Te;rn++)K===s.TEXTURE_3D||K===s.TEXTURE_2D_ARRAY?s.texImage3D(Ee,0,s.RGBA,1,1,We,0,s.RGBA,s.UNSIGNED_BYTE,Ze):s.texImage2D(Ee+rn,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,Ze);return Kt}const Re={};Re[s.TEXTURE_2D]=se(s.TEXTURE_2D,s.TEXTURE_2D,1),Re[s.TEXTURE_CUBE_MAP]=se(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),Re[s.TEXTURE_2D_ARRAY]=se(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),Re[s.TEXTURE_3D]=se(s.TEXTURE_3D,s.TEXTURE_3D,1,1),i.setClear(0,0,0,1),o.setClear(1),u.setClear(0),ke(s.DEPTH_TEST),o.setFunc(qd),Xe(!1),xe(lv),ke(s.CULL_FACE),Oe(pa);function ke(K){p[K]!==!0&&(s.enable(K),p[K]=!0)}function Le(K){p[K]!==!1&&(s.disable(K),p[K]=!1)}function tt(K,Ee){return m[K]!==Ee?(s.bindFramebuffer(K,Ee),m[K]=Ee,K===s.DRAW_FRAMEBUFFER&&(m[s.FRAMEBUFFER]=Ee),K===s.FRAMEBUFFER&&(m[s.DRAW_FRAMEBUFFER]=Ee),!0):!1}function xt(K,Ee){let Te=y,We=!1;if(K){Te=g.get(Ee),Te===void 0&&(Te=[],g.set(Ee,Te));const Ze=K.textures;if(Te.length!==Ze.length||Te[0]!==s.COLOR_ATTACHMENT0){for(let Kt=0,rn=Ze.length;Kt<rn;Kt++)Te[Kt]=s.COLOR_ATTACHMENT0+Kt;Te.length=Ze.length,We=!0}}else Te[0]!==s.BACK&&(Te[0]=s.BACK,We=!0);We&&s.drawBuffers(Te)}function ae(K){return _!==K?(s.useProgram(K),_=K,!0):!1}const Mt={[gl]:s.FUNC_ADD,[dS]:s.FUNC_SUBTRACT,[hS]:s.FUNC_REVERSE_SUBTRACT};Mt[pS]=s.MIN,Mt[mS]=s.MAX;const Ae={[gS]:s.ZERO,[vS]:s.ONE,[yS]:s.SRC_COLOR,[Lm]:s.SRC_ALPHA,[ES]:s.SRC_ALPHA_SATURATE,[MS]:s.DST_COLOR,[_S]:s.DST_ALPHA,[xS]:s.ONE_MINUS_SRC_COLOR,[Im]:s.ONE_MINUS_SRC_ALPHA,[wS]:s.ONE_MINUS_DST_COLOR,[SS]:s.ONE_MINUS_DST_ALPHA,[TS]:s.CONSTANT_COLOR,[AS]:s.ONE_MINUS_CONSTANT_COLOR,[CS]:s.CONSTANT_ALPHA,[bS]:s.ONE_MINUS_CONSTANT_ALPHA};function Oe(K,Ee,Te,We,Ze,Kt,rn,Jt,fn,Xt){if(K===pa){M===!0&&(Le(s.BLEND),M=!1);return}if(M===!1&&(ke(s.BLEND),M=!0),K!==fS){if(K!==A||Xt!==j){if((E!==gl||b!==gl)&&(s.blendEquation(s.FUNC_ADD),E=gl,b=gl),Xt)switch(K){case bu:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case uv:s.blendFunc(s.ONE,s.ONE);break;case cv:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case fv:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",K);break}else switch(K){case bu:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case uv:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case cv:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case fv:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",K);break}S=null,P=null,L=null,B=null,D.set(0,0,0),F=0,A=K,j=Xt}return}Ze=Ze||Ee,Kt=Kt||Te,rn=rn||We,(Ee!==E||Ze!==b)&&(s.blendEquationSeparate(Mt[Ee],Mt[Ze]),E=Ee,b=Ze),(Te!==S||We!==P||Kt!==L||rn!==B)&&(s.blendFuncSeparate(Ae[Te],Ae[We],Ae[Kt],Ae[rn]),S=Te,P=We,L=Kt,B=rn),(Jt.equals(D)===!1||fn!==F)&&(s.blendColor(Jt.r,Jt.g,Jt.b,fn),D.copy(Jt),F=fn),A=K,j=!1}function De(K,Ee){K.side===_o?Le(s.CULL_FACE):ke(s.CULL_FACE);let Te=K.side===nr;Ee&&(Te=!Te),Xe(Te),K.blending===bu&&K.transparent===!1?Oe(pa):Oe(K.blending,K.blendEquation,K.blendSrc,K.blendDst,K.blendEquationAlpha,K.blendSrcAlpha,K.blendDstAlpha,K.blendColor,K.blendAlpha,K.premultipliedAlpha),o.setFunc(K.depthFunc),o.setTest(K.depthTest),o.setMask(K.depthWrite),i.setMask(K.colorWrite);const We=K.stencilWrite;u.setTest(We),We&&(u.setMask(K.stencilWriteMask),u.setFunc(K.stencilFunc,K.stencilRef,K.stencilFuncMask),u.setOp(K.stencilFail,K.stencilZFail,K.stencilZPass)),$e(K.polygonOffset,K.polygonOffsetFactor,K.polygonOffsetUnits),K.alphaToCoverage===!0?ke(s.SAMPLE_ALPHA_TO_COVERAGE):Le(s.SAMPLE_ALPHA_TO_COVERAGE)}function Xe(K){O!==K&&(K?s.frontFace(s.CW):s.frontFace(s.CCW),O=K)}function xe(K){K!==lS?(ke(s.CULL_FACE),K!==N&&(K===lv?s.cullFace(s.BACK):K===uS?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):Le(s.CULL_FACE),N=K}function Fe(K){K!==X&&(fe&&s.lineWidth(K),X=K)}function $e(K,Ee,Te){K?(ke(s.POLYGON_OFFSET_FILL),(te!==Ee||Q!==Te)&&(s.polygonOffset(Ee,Te),te=Ee,Q=Te)):Le(s.POLYGON_OFFSET_FILL)}function q(K){K?ke(s.SCISSOR_TEST):Le(s.SCISSOR_TEST)}function z(K){K===void 0&&(K=s.TEXTURE0+ue-1),W!==K&&(s.activeTexture(K),W=K)}function de(K,Ee,Te){Te===void 0&&(W===null?Te=s.TEXTURE0+ue-1:Te=W);let We=ee[Te];We===void 0&&(We={type:void 0,texture:void 0},ee[Te]=We),(We.type!==K||We.texture!==Ee)&&(W!==Te&&(s.activeTexture(Te),W=Te),s.bindTexture(K,Ee||Re[K]),We.type=K,We.texture=Ee)}function Ie(){const K=ee[W];K!==void 0&&K.type!==void 0&&(s.bindTexture(K.type,null),K.type=void 0,K.texture=void 0)}function ze(){try{s.compressedTexImage2D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Ue(){try{s.compressedTexImage3D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function vt(){try{s.texSubImage2D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Je(){try{s.texSubImage3D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Ke(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Ct(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function qe(){try{s.texStorage2D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function ft(){try{s.texStorage3D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Nt(){try{s.texImage2D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Tt(){try{s.texImage3D.apply(s,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function ot(K){Ce.equals(K)===!1&&(s.scissor(K.x,K.y,K.z,K.w),Ce.copy(K))}function Dt(K){Ve.equals(K)===!1&&(s.viewport(K.x,K.y,K.z,K.w),Ve.copy(K))}function Bt(K,Ee){let Te=d.get(Ee);Te===void 0&&(Te=new WeakMap,d.set(Ee,Te));let We=Te.get(K);We===void 0&&(We=s.getUniformBlockIndex(Ee,K.name),Te.set(K,We))}function ne(K,Ee){const We=d.get(Ee).get(K);f.get(Ee)!==We&&(s.uniformBlockBinding(Ee,We,K.__bindingPointIndex),f.set(Ee,We))}function Pe(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),p={},W=null,ee={},m={},g=new WeakMap,y=[],_=null,M=!1,A=null,E=null,S=null,P=null,b=null,L=null,B=null,D=new st(0,0,0),F=0,j=!1,O=null,N=null,X=null,te=null,Q=null,Ce.set(0,0,s.canvas.width,s.canvas.height),Ve.set(0,0,s.canvas.width,s.canvas.height),i.reset(),o.reset(),u.reset()}return{buffers:{color:i,depth:o,stencil:u},enable:ke,disable:Le,bindFramebuffer:tt,drawBuffers:xt,useProgram:ae,setBlending:Oe,setMaterial:De,setFlipSided:Xe,setCullFace:xe,setLineWidth:Fe,setPolygonOffset:$e,setScissorTest:q,activeTexture:z,bindTexture:de,unbindTexture:Ie,compressedTexImage2D:ze,compressedTexImage3D:Ue,texImage2D:Nt,texImage3D:Tt,updateUBOMapping:Bt,uniformBlockBinding:ne,texStorage2D:qe,texStorage3D:ft,texSubImage2D:vt,texSubImage3D:Je,compressedTexSubImage2D:Ke,compressedTexSubImage3D:Ct,scissor:ot,viewport:Dt,reset:Pe}}function DR(s,e,t,n,i,o,u){const f=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Ne,m=new WeakMap;let g;const y=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(q,z){return _?new OffscreenCanvas(q,z):ah("canvas")}function A(q,z,de){let Ie=1;const ze=$e(q);if((ze.width>de||ze.height>de)&&(Ie=de/Math.max(ze.width,ze.height)),Ie<1)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap||typeof VideoFrame<"u"&&q instanceof VideoFrame){const Ue=Math.floor(Ie*ze.width),vt=Math.floor(Ie*ze.height);g===void 0&&(g=M(Ue,vt));const Je=z?M(Ue,vt):g;return Je.width=Ue,Je.height=vt,Je.getContext("2d").drawImage(q,0,0,Ue,vt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ze.width+"x"+ze.height+") to ("+Ue+"x"+vt+")."),Je}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ze.width+"x"+ze.height+")."),q;return q}function E(q){return q.generateMipmaps&&q.minFilter!==Ai&&q.minFilter!==pi}function S(q){s.generateMipmap(q)}function P(q,z,de,Ie,ze=!1){if(q!==null){if(s[q]!==void 0)return s[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let Ue=z;if(z===s.RED&&(de===s.FLOAT&&(Ue=s.R32F),de===s.HALF_FLOAT&&(Ue=s.R16F),de===s.UNSIGNED_BYTE&&(Ue=s.R8)),z===s.RED_INTEGER&&(de===s.UNSIGNED_BYTE&&(Ue=s.R8UI),de===s.UNSIGNED_SHORT&&(Ue=s.R16UI),de===s.UNSIGNED_INT&&(Ue=s.R32UI),de===s.BYTE&&(Ue=s.R8I),de===s.SHORT&&(Ue=s.R16I),de===s.INT&&(Ue=s.R32I)),z===s.RG&&(de===s.FLOAT&&(Ue=s.RG32F),de===s.HALF_FLOAT&&(Ue=s.RG16F),de===s.UNSIGNED_BYTE&&(Ue=s.RG8)),z===s.RG_INTEGER&&(de===s.UNSIGNED_BYTE&&(Ue=s.RG8UI),de===s.UNSIGNED_SHORT&&(Ue=s.RG16UI),de===s.UNSIGNED_INT&&(Ue=s.RG32UI),de===s.BYTE&&(Ue=s.RG8I),de===s.SHORT&&(Ue=s.RG16I),de===s.INT&&(Ue=s.RG32I)),z===s.RGB&&de===s.UNSIGNED_INT_5_9_9_9_REV&&(Ue=s.RGB9_E5),z===s.RGBA){const vt=ze?nh:pn.getTransfer(Ie);de===s.FLOAT&&(Ue=s.RGBA32F),de===s.HALF_FLOAT&&(Ue=s.RGBA16F),de===s.UNSIGNED_BYTE&&(Ue=vt===bn?s.SRGB8_ALPHA8:s.RGBA8),de===s.UNSIGNED_SHORT_4_4_4_4&&(Ue=s.RGBA4),de===s.UNSIGNED_SHORT_5_5_5_1&&(Ue=s.RGB5_A1)}return(Ue===s.R16F||Ue===s.R32F||Ue===s.RG16F||Ue===s.RG32F||Ue===s.RGBA16F||Ue===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ue}function b(q,z){return E(q)===!0||q.isFramebufferTexture&&q.minFilter!==Ai&&q.minFilter!==pi?Math.log2(Math.max(z.width,z.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?z.mipmaps.length:1}function L(q){const z=q.target;z.removeEventListener("dispose",L),D(z),z.isVideoTexture&&m.delete(z)}function B(q){const z=q.target;z.removeEventListener("dispose",B),j(z)}function D(q){const z=n.get(q);if(z.__webglInit===void 0)return;const de=q.source,Ie=y.get(de);if(Ie){const ze=Ie[z.__cacheKey];ze.usedTimes--,ze.usedTimes===0&&F(q),Object.keys(Ie).length===0&&y.delete(de)}n.remove(q)}function F(q){const z=n.get(q);s.deleteTexture(z.__webglTexture);const de=q.source,Ie=y.get(de);delete Ie[z.__cacheKey],u.memory.textures--}function j(q){const z=n.get(q);if(q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let Ie=0;Ie<6;Ie++){if(Array.isArray(z.__webglFramebuffer[Ie]))for(let ze=0;ze<z.__webglFramebuffer[Ie].length;ze++)s.deleteFramebuffer(z.__webglFramebuffer[Ie][ze]);else s.deleteFramebuffer(z.__webglFramebuffer[Ie]);z.__webglDepthbuffer&&s.deleteRenderbuffer(z.__webglDepthbuffer[Ie])}else{if(Array.isArray(z.__webglFramebuffer))for(let Ie=0;Ie<z.__webglFramebuffer.length;Ie++)s.deleteFramebuffer(z.__webglFramebuffer[Ie]);else s.deleteFramebuffer(z.__webglFramebuffer);if(z.__webglDepthbuffer&&s.deleteRenderbuffer(z.__webglDepthbuffer),z.__webglMultisampledFramebuffer&&s.deleteFramebuffer(z.__webglMultisampledFramebuffer),z.__webglColorRenderbuffer)for(let Ie=0;Ie<z.__webglColorRenderbuffer.length;Ie++)z.__webglColorRenderbuffer[Ie]&&s.deleteRenderbuffer(z.__webglColorRenderbuffer[Ie]);z.__webglDepthRenderbuffer&&s.deleteRenderbuffer(z.__webglDepthRenderbuffer)}const de=q.textures;for(let Ie=0,ze=de.length;Ie<ze;Ie++){const Ue=n.get(de[Ie]);Ue.__webglTexture&&(s.deleteTexture(Ue.__webglTexture),u.memory.textures--),n.remove(de[Ie])}n.remove(q)}let O=0;function N(){O=0}function X(){const q=O;return q>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+i.maxTextures),O+=1,q}function te(q){const z=[];return z.push(q.wrapS),z.push(q.wrapT),z.push(q.wrapR||0),z.push(q.magFilter),z.push(q.minFilter),z.push(q.anisotropy),z.push(q.internalFormat),z.push(q.format),z.push(q.type),z.push(q.generateMipmaps),z.push(q.premultiplyAlpha),z.push(q.flipY),z.push(q.unpackAlignment),z.push(q.colorSpace),z.join()}function Q(q,z){const de=n.get(q);if(q.isVideoTexture&&xe(q),q.isRenderTargetTexture===!1&&q.version>0&&de.__version!==q.version){const Ie=q.image;if(Ie===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ie.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ce(de,q,z);return}}t.bindTexture(s.TEXTURE_2D,de.__webglTexture,s.TEXTURE0+z)}function ue(q,z){const de=n.get(q);if(q.version>0&&de.__version!==q.version){Ce(de,q,z);return}t.bindTexture(s.TEXTURE_2D_ARRAY,de.__webglTexture,s.TEXTURE0+z)}function fe(q,z){const de=n.get(q);if(q.version>0&&de.__version!==q.version){Ce(de,q,z);return}t.bindTexture(s.TEXTURE_3D,de.__webglTexture,s.TEXTURE0+z)}function ye(q,z){const de=n.get(q);if(q.version>0&&de.__version!==q.version){Ve(de,q,z);return}t.bindTexture(s.TEXTURE_CUBE_MAP,de.__webglTexture,s.TEXTURE0+z)}const Me={[Kd]:s.REPEAT,[xs]:s.CLAMP_TO_EDGE,[Jd]:s.MIRRORED_REPEAT},W={[Ai]:s.NEAREST,[ty]:s.NEAREST_MIPMAP_NEAREST,[mf]:s.NEAREST_MIPMAP_LINEAR,[pi]:s.LINEAR,[Wd]:s.LINEAR_MIPMAP_NEAREST,[Mo]:s.LINEAR_MIPMAP_LINEAR},ee={[oM]:s.NEVER,[dM]:s.ALWAYS,[aM]:s.LESS,[fy]:s.LEQUAL,[lM]:s.EQUAL,[fM]:s.GEQUAL,[uM]:s.GREATER,[cM]:s.NOTEQUAL};function k(q,z){if(z.type===_s&&e.has("OES_texture_float_linear")===!1&&(z.magFilter===pi||z.magFilter===Wd||z.magFilter===mf||z.magFilter===Mo||z.minFilter===pi||z.minFilter===Wd||z.minFilter===mf||z.minFilter===Mo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(q,s.TEXTURE_WRAP_S,Me[z.wrapS]),s.texParameteri(q,s.TEXTURE_WRAP_T,Me[z.wrapT]),(q===s.TEXTURE_3D||q===s.TEXTURE_2D_ARRAY)&&s.texParameteri(q,s.TEXTURE_WRAP_R,Me[z.wrapR]),s.texParameteri(q,s.TEXTURE_MAG_FILTER,W[z.magFilter]),s.texParameteri(q,s.TEXTURE_MIN_FILTER,W[z.minFilter]),z.compareFunction&&(s.texParameteri(q,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(q,s.TEXTURE_COMPARE_FUNC,ee[z.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(z.magFilter===Ai||z.minFilter!==mf&&z.minFilter!==Mo||z.type===_s&&e.has("OES_texture_float_linear")===!1)return;if(z.anisotropy>1||n.get(z).__currentAnisotropy){const de=e.get("EXT_texture_filter_anisotropic");s.texParameterf(q,de.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(z.anisotropy,i.getMaxAnisotropy())),n.get(z).__currentAnisotropy=z.anisotropy}}}function J(q,z){let de=!1;q.__webglInit===void 0&&(q.__webglInit=!0,z.addEventListener("dispose",L));const Ie=z.source;let ze=y.get(Ie);ze===void 0&&(ze={},y.set(Ie,ze));const Ue=te(z);if(Ue!==q.__cacheKey){ze[Ue]===void 0&&(ze[Ue]={texture:s.createTexture(),usedTimes:0},u.memory.textures++,de=!0),ze[Ue].usedTimes++;const vt=ze[q.__cacheKey];vt!==void 0&&(ze[q.__cacheKey].usedTimes--,vt.usedTimes===0&&F(z)),q.__cacheKey=Ue,q.__webglTexture=ze[Ue].texture}return de}function Ce(q,z,de){let Ie=s.TEXTURE_2D;(z.isDataArrayTexture||z.isCompressedArrayTexture)&&(Ie=s.TEXTURE_2D_ARRAY),z.isData3DTexture&&(Ie=s.TEXTURE_3D);const ze=J(q,z),Ue=z.source;t.bindTexture(Ie,q.__webglTexture,s.TEXTURE0+de);const vt=n.get(Ue);if(Ue.version!==vt.__version||ze===!0){t.activeTexture(s.TEXTURE0+de);const Je=pn.getPrimaries(pn.workingColorSpace),Ke=z.colorSpace===fa?null:pn.getPrimaries(z.colorSpace),Ct=z.colorSpace===fa||Je===Ke?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,z.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,z.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ct);let qe=A(z.image,!1,i.maxTextureSize);qe=Fe(z,qe);const ft=o.convert(z.format,z.colorSpace),Nt=o.convert(z.type);let Tt=P(z.internalFormat,ft,Nt,z.colorSpace,z.isVideoTexture);k(Ie,z);let ot;const Dt=z.mipmaps,Bt=z.isVideoTexture!==!0,ne=vt.__version===void 0||ze===!0,Pe=Ue.dataReady,K=b(z,qe);if(z.isDepthTexture)Tt=s.DEPTH_COMPONENT16,z.type===_s?Tt=s.DEPTH_COMPONENT32F:z.type===Du?Tt=s.DEPTH_COMPONENT24:z.type===Pf&&(Tt=s.DEPTH24_STENCIL8),ne&&(Bt?t.texStorage2D(s.TEXTURE_2D,1,Tt,qe.width,qe.height):t.texImage2D(s.TEXTURE_2D,0,Tt,qe.width,qe.height,0,ft,Nt,null));else if(z.isDataTexture)if(Dt.length>0){Bt&&ne&&t.texStorage2D(s.TEXTURE_2D,K,Tt,Dt[0].width,Dt[0].height);for(let Ee=0,Te=Dt.length;Ee<Te;Ee++)ot=Dt[Ee],Bt?Pe&&t.texSubImage2D(s.TEXTURE_2D,Ee,0,0,ot.width,ot.height,ft,Nt,ot.data):t.texImage2D(s.TEXTURE_2D,Ee,Tt,ot.width,ot.height,0,ft,Nt,ot.data);z.generateMipmaps=!1}else Bt?(ne&&t.texStorage2D(s.TEXTURE_2D,K,Tt,qe.width,qe.height),Pe&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,qe.width,qe.height,ft,Nt,qe.data)):t.texImage2D(s.TEXTURE_2D,0,Tt,qe.width,qe.height,0,ft,Nt,qe.data);else if(z.isCompressedTexture)if(z.isCompressedArrayTexture){Bt&&ne&&t.texStorage3D(s.TEXTURE_2D_ARRAY,K,Tt,Dt[0].width,Dt[0].height,qe.depth);for(let Ee=0,Te=Dt.length;Ee<Te;Ee++)ot=Dt[Ee],z.format!==kr?ft!==null?Bt?Pe&&t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,Ee,0,0,0,ot.width,ot.height,qe.depth,ft,ot.data,0,0):t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,Ee,Tt,ot.width,ot.height,qe.depth,0,ot.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Bt?Pe&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,Ee,0,0,0,ot.width,ot.height,qe.depth,ft,Nt,ot.data):t.texImage3D(s.TEXTURE_2D_ARRAY,Ee,Tt,ot.width,ot.height,qe.depth,0,ft,Nt,ot.data)}else{Bt&&ne&&t.texStorage2D(s.TEXTURE_2D,K,Tt,Dt[0].width,Dt[0].height);for(let Ee=0,Te=Dt.length;Ee<Te;Ee++)ot=Dt[Ee],z.format!==kr?ft!==null?Bt?Pe&&t.compressedTexSubImage2D(s.TEXTURE_2D,Ee,0,0,ot.width,ot.height,ft,ot.data):t.compressedTexImage2D(s.TEXTURE_2D,Ee,Tt,ot.width,ot.height,0,ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Bt?Pe&&t.texSubImage2D(s.TEXTURE_2D,Ee,0,0,ot.width,ot.height,ft,Nt,ot.data):t.texImage2D(s.TEXTURE_2D,Ee,Tt,ot.width,ot.height,0,ft,Nt,ot.data)}else if(z.isDataArrayTexture)Bt?(ne&&t.texStorage3D(s.TEXTURE_2D_ARRAY,K,Tt,qe.width,qe.height,qe.depth),Pe&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,qe.width,qe.height,qe.depth,ft,Nt,qe.data)):t.texImage3D(s.TEXTURE_2D_ARRAY,0,Tt,qe.width,qe.height,qe.depth,0,ft,Nt,qe.data);else if(z.isData3DTexture)Bt?(ne&&t.texStorage3D(s.TEXTURE_3D,K,Tt,qe.width,qe.height,qe.depth),Pe&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,qe.width,qe.height,qe.depth,ft,Nt,qe.data)):t.texImage3D(s.TEXTURE_3D,0,Tt,qe.width,qe.height,qe.depth,0,ft,Nt,qe.data);else if(z.isFramebufferTexture){if(ne)if(Bt)t.texStorage2D(s.TEXTURE_2D,K,Tt,qe.width,qe.height);else{let Ee=qe.width,Te=qe.height;for(let We=0;We<K;We++)t.texImage2D(s.TEXTURE_2D,We,Tt,Ee,Te,0,ft,Nt,null),Ee>>=1,Te>>=1}}else if(Dt.length>0){if(Bt&&ne){const Ee=$e(Dt[0]);t.texStorage2D(s.TEXTURE_2D,K,Tt,Ee.width,Ee.height)}for(let Ee=0,Te=Dt.length;Ee<Te;Ee++)ot=Dt[Ee],Bt?Pe&&t.texSubImage2D(s.TEXTURE_2D,Ee,0,0,ft,Nt,ot):t.texImage2D(s.TEXTURE_2D,Ee,Tt,ft,Nt,ot);z.generateMipmaps=!1}else if(Bt){if(ne){const Ee=$e(qe);t.texStorage2D(s.TEXTURE_2D,K,Tt,Ee.width,Ee.height)}Pe&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,ft,Nt,qe)}else t.texImage2D(s.TEXTURE_2D,0,Tt,ft,Nt,qe);E(z)&&S(Ie),vt.__version=Ue.version,z.onUpdate&&z.onUpdate(z)}q.__version=z.version}function Ve(q,z,de){if(z.image.length!==6)return;const Ie=J(q,z),ze=z.source;t.bindTexture(s.TEXTURE_CUBE_MAP,q.__webglTexture,s.TEXTURE0+de);const Ue=n.get(ze);if(ze.version!==Ue.__version||Ie===!0){t.activeTexture(s.TEXTURE0+de);const vt=pn.getPrimaries(pn.workingColorSpace),Je=z.colorSpace===fa?null:pn.getPrimaries(z.colorSpace),Ke=z.colorSpace===fa||vt===Je?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,z.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,z.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,z.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ke);const Ct=z.isCompressedTexture||z.image[0].isCompressedTexture,qe=z.image[0]&&z.image[0].isDataTexture,ft=[];for(let Te=0;Te<6;Te++)!Ct&&!qe?ft[Te]=A(z.image[Te],!0,i.maxCubemapSize):ft[Te]=qe?z.image[Te].image:z.image[Te],ft[Te]=Fe(z,ft[Te]);const Nt=ft[0],Tt=o.convert(z.format,z.colorSpace),ot=o.convert(z.type),Dt=P(z.internalFormat,Tt,ot,z.colorSpace),Bt=z.isVideoTexture!==!0,ne=Ue.__version===void 0||Ie===!0,Pe=ze.dataReady;let K=b(z,Nt);k(s.TEXTURE_CUBE_MAP,z);let Ee;if(Ct){Bt&&ne&&t.texStorage2D(s.TEXTURE_CUBE_MAP,K,Dt,Nt.width,Nt.height);for(let Te=0;Te<6;Te++){Ee=ft[Te].mipmaps;for(let We=0;We<Ee.length;We++){const Ze=Ee[We];z.format!==kr?Tt!==null?Bt?Pe&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We,0,0,Ze.width,Ze.height,Tt,Ze.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We,Dt,Ze.width,Ze.height,0,Ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Bt?Pe&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We,0,0,Ze.width,Ze.height,Tt,ot,Ze.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We,Dt,Ze.width,Ze.height,0,Tt,ot,Ze.data)}}}else{if(Ee=z.mipmaps,Bt&&ne){Ee.length>0&&K++;const Te=$e(ft[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,K,Dt,Te.width,Te.height)}for(let Te=0;Te<6;Te++)if(qe){Bt?Pe&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,ft[Te].width,ft[Te].height,Tt,ot,ft[Te].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Dt,ft[Te].width,ft[Te].height,0,Tt,ot,ft[Te].data);for(let We=0;We<Ee.length;We++){const Kt=Ee[We].image[Te].image;Bt?Pe&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We+1,0,0,Kt.width,Kt.height,Tt,ot,Kt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We+1,Dt,Kt.width,Kt.height,0,Tt,ot,Kt.data)}}else{Bt?Pe&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,Tt,ot,ft[Te]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Dt,Tt,ot,ft[Te]);for(let We=0;We<Ee.length;We++){const Ze=Ee[We];Bt?Pe&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We+1,0,0,Tt,ot,Ze.image[Te]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Te,We+1,Dt,Tt,ot,Ze.image[Te])}}}E(z)&&S(s.TEXTURE_CUBE_MAP),Ue.__version=ze.version,z.onUpdate&&z.onUpdate(z)}q.__version=z.version}function se(q,z,de,Ie,ze,Ue){const vt=o.convert(de.format,de.colorSpace),Je=o.convert(de.type),Ke=P(de.internalFormat,vt,Je,de.colorSpace);if(!n.get(z).__hasExternalTextures){const qe=Math.max(1,z.width>>Ue),ft=Math.max(1,z.height>>Ue);ze===s.TEXTURE_3D||ze===s.TEXTURE_2D_ARRAY?t.texImage3D(ze,Ue,Ke,qe,ft,z.depth,0,vt,Je,null):t.texImage2D(ze,Ue,Ke,qe,ft,0,vt,Je,null)}t.bindFramebuffer(s.FRAMEBUFFER,q),Xe(z)?f.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Ie,ze,n.get(de).__webglTexture,0,De(z)):(ze===s.TEXTURE_2D||ze>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&ze<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Ie,ze,n.get(de).__webglTexture,Ue),t.bindFramebuffer(s.FRAMEBUFFER,null)}function Re(q,z,de){if(s.bindRenderbuffer(s.RENDERBUFFER,q),z.depthBuffer&&!z.stencilBuffer){let Ie=s.DEPTH_COMPONENT24;if(de||Xe(z)){const ze=z.depthTexture;ze&&ze.isDepthTexture&&(ze.type===_s?Ie=s.DEPTH_COMPONENT32F:ze.type===Du&&(Ie=s.DEPTH_COMPONENT24));const Ue=De(z);Xe(z)?f.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ue,Ie,z.width,z.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,Ue,Ie,z.width,z.height)}else s.renderbufferStorage(s.RENDERBUFFER,Ie,z.width,z.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,q)}else if(z.depthBuffer&&z.stencilBuffer){const Ie=De(z);de&&Xe(z)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Ie,s.DEPTH24_STENCIL8,z.width,z.height):Xe(z)?f.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ie,s.DEPTH24_STENCIL8,z.width,z.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,z.width,z.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,q)}else{const Ie=z.textures;for(let ze=0;ze<Ie.length;ze++){const Ue=Ie[ze],vt=o.convert(Ue.format,Ue.colorSpace),Je=o.convert(Ue.type),Ke=P(Ue.internalFormat,vt,Je,Ue.colorSpace),Ct=De(z);de&&Xe(z)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Ct,Ke,z.width,z.height):Xe(z)?f.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ct,Ke,z.width,z.height):s.renderbufferStorage(s.RENDERBUFFER,Ke,z.width,z.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function ke(q,z){if(z&&z.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,q),!(z.depthTexture&&z.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(z.depthTexture).__webglTexture||z.depthTexture.image.width!==z.width||z.depthTexture.image.height!==z.height)&&(z.depthTexture.image.width=z.width,z.depthTexture.image.height=z.height,z.depthTexture.needsUpdate=!0),Q(z.depthTexture,0);const Ie=n.get(z.depthTexture).__webglTexture,ze=De(z);if(z.depthTexture.format===Ru)Xe(z)?f.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Ie,0,ze):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Ie,0);else if(z.depthTexture.format===Mf)Xe(z)?f.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Ie,0,ze):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Ie,0);else throw new Error("Unknown depthTexture format")}function Le(q){const z=n.get(q),de=q.isWebGLCubeRenderTarget===!0;if(q.depthTexture&&!z.__autoAllocateDepthBuffer){if(de)throw new Error("target.depthTexture not supported in Cube render targets");ke(z.__webglFramebuffer,q)}else if(de){z.__webglDepthbuffer=[];for(let Ie=0;Ie<6;Ie++)t.bindFramebuffer(s.FRAMEBUFFER,z.__webglFramebuffer[Ie]),z.__webglDepthbuffer[Ie]=s.createRenderbuffer(),Re(z.__webglDepthbuffer[Ie],q,!1)}else t.bindFramebuffer(s.FRAMEBUFFER,z.__webglFramebuffer),z.__webglDepthbuffer=s.createRenderbuffer(),Re(z.__webglDepthbuffer,q,!1);t.bindFramebuffer(s.FRAMEBUFFER,null)}function tt(q,z,de){const Ie=n.get(q);z!==void 0&&se(Ie.__webglFramebuffer,q,q.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),de!==void 0&&Le(q)}function xt(q){const z=q.texture,de=n.get(q),Ie=n.get(z);q.addEventListener("dispose",B);const ze=q.textures,Ue=q.isWebGLCubeRenderTarget===!0,vt=ze.length>1;if(vt||(Ie.__webglTexture===void 0&&(Ie.__webglTexture=s.createTexture()),Ie.__version=z.version,u.memory.textures++),Ue){de.__webglFramebuffer=[];for(let Je=0;Je<6;Je++)if(z.mipmaps&&z.mipmaps.length>0){de.__webglFramebuffer[Je]=[];for(let Ke=0;Ke<z.mipmaps.length;Ke++)de.__webglFramebuffer[Je][Ke]=s.createFramebuffer()}else de.__webglFramebuffer[Je]=s.createFramebuffer()}else{if(z.mipmaps&&z.mipmaps.length>0){de.__webglFramebuffer=[];for(let Je=0;Je<z.mipmaps.length;Je++)de.__webglFramebuffer[Je]=s.createFramebuffer()}else de.__webglFramebuffer=s.createFramebuffer();if(vt)for(let Je=0,Ke=ze.length;Je<Ke;Je++){const Ct=n.get(ze[Je]);Ct.__webglTexture===void 0&&(Ct.__webglTexture=s.createTexture(),u.memory.textures++)}if(q.samples>0&&Xe(q)===!1){de.__webglMultisampledFramebuffer=s.createFramebuffer(),de.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,de.__webglMultisampledFramebuffer);for(let Je=0;Je<ze.length;Je++){const Ke=ze[Je];de.__webglColorRenderbuffer[Je]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,de.__webglColorRenderbuffer[Je]);const Ct=o.convert(Ke.format,Ke.colorSpace),qe=o.convert(Ke.type),ft=P(Ke.internalFormat,Ct,qe,Ke.colorSpace,q.isXRRenderTarget===!0),Nt=De(q);s.renderbufferStorageMultisample(s.RENDERBUFFER,Nt,ft,q.width,q.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Je,s.RENDERBUFFER,de.__webglColorRenderbuffer[Je])}s.bindRenderbuffer(s.RENDERBUFFER,null),q.depthBuffer&&(de.__webglDepthRenderbuffer=s.createRenderbuffer(),Re(de.__webglDepthRenderbuffer,q,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Ue){t.bindTexture(s.TEXTURE_CUBE_MAP,Ie.__webglTexture),k(s.TEXTURE_CUBE_MAP,z);for(let Je=0;Je<6;Je++)if(z.mipmaps&&z.mipmaps.length>0)for(let Ke=0;Ke<z.mipmaps.length;Ke++)se(de.__webglFramebuffer[Je][Ke],q,z,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Je,Ke);else se(de.__webglFramebuffer[Je],q,z,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0);E(z)&&S(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(vt){for(let Je=0,Ke=ze.length;Je<Ke;Je++){const Ct=ze[Je],qe=n.get(Ct);t.bindTexture(s.TEXTURE_2D,qe.__webglTexture),k(s.TEXTURE_2D,Ct),se(de.__webglFramebuffer,q,Ct,s.COLOR_ATTACHMENT0+Je,s.TEXTURE_2D,0),E(Ct)&&S(s.TEXTURE_2D)}t.unbindTexture()}else{let Je=s.TEXTURE_2D;if((q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(Je=q.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(Je,Ie.__webglTexture),k(Je,z),z.mipmaps&&z.mipmaps.length>0)for(let Ke=0;Ke<z.mipmaps.length;Ke++)se(de.__webglFramebuffer[Ke],q,z,s.COLOR_ATTACHMENT0,Je,Ke);else se(de.__webglFramebuffer,q,z,s.COLOR_ATTACHMENT0,Je,0);E(z)&&S(Je),t.unbindTexture()}q.depthBuffer&&Le(q)}function ae(q){const z=q.textures;for(let de=0,Ie=z.length;de<Ie;de++){const ze=z[de];if(E(ze)){const Ue=q.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,vt=n.get(ze).__webglTexture;t.bindTexture(Ue,vt),S(Ue),t.unbindTexture()}}}const Mt=[],Ae=[];function Oe(q){if(q.samples>0){if(Xe(q)===!1){const z=q.textures,de=q.width,Ie=q.height;let ze=s.COLOR_BUFFER_BIT;const Ue=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,vt=n.get(q),Je=z.length>1;if(Je)for(let Ke=0;Ke<z.length;Ke++)t.bindFramebuffer(s.FRAMEBUFFER,vt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ke,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,vt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ke,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,vt.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,vt.__webglFramebuffer);for(let Ke=0;Ke<z.length;Ke++){if(q.resolveDepthBuffer&&(q.depthBuffer&&(ze|=s.DEPTH_BUFFER_BIT),q.stencilBuffer&&q.resolveStencilBuffer&&(ze|=s.STENCIL_BUFFER_BIT)),Je){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,vt.__webglColorRenderbuffer[Ke]);const Ct=n.get(z[Ke]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,Ct,0)}s.blitFramebuffer(0,0,de,Ie,0,0,de,Ie,ze,s.NEAREST),d===!0&&(Mt.length=0,Ae.length=0,Mt.push(s.COLOR_ATTACHMENT0+Ke),q.depthBuffer&&q.resolveDepthBuffer===!1&&(Mt.push(Ue),Ae.push(Ue),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,Ae)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Mt))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),Je)for(let Ke=0;Ke<z.length;Ke++){t.bindFramebuffer(s.FRAMEBUFFER,vt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ke,s.RENDERBUFFER,vt.__webglColorRenderbuffer[Ke]);const Ct=n.get(z[Ke]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,vt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+Ke,s.TEXTURE_2D,Ct,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,vt.__webglMultisampledFramebuffer)}else if(q.depthBuffer&&q.resolveDepthBuffer===!1&&d){const z=q.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[z])}}}function De(q){return Math.min(i.maxSamples,q.samples)}function Xe(q){const z=n.get(q);return q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&z.__useRenderToTexture!==!1}function xe(q){const z=u.render.frame;m.get(q)!==z&&(m.set(q,z),q.update())}function Fe(q,z){const de=q.colorSpace,Ie=q.format,ze=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||de!==ya&&de!==fa&&(pn.getTransfer(de)===bn?(Ie!==kr||ze!==Ao)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",de)),z}function $e(q){return typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement?(p.width=q.naturalWidth||q.width,p.height=q.naturalHeight||q.height):typeof VideoFrame<"u"&&q instanceof VideoFrame?(p.width=q.displayWidth,p.height=q.displayHeight):(p.width=q.width,p.height=q.height),p}this.allocateTextureUnit=X,this.resetTextureUnits=N,this.setTexture2D=Q,this.setTexture2DArray=ue,this.setTexture3D=fe,this.setTextureCube=ye,this.rebindTextures=tt,this.setupRenderTarget=xt,this.updateRenderTargetMipmap=ae,this.updateMultisampleRenderTarget=Oe,this.setupDepthRenderbuffer=Le,this.setupFrameBufferTexture=se,this.useMultisampledRTT=Xe}function bM(s,e){function t(n,i=fa){let o;const u=pn.getTransfer(i);if(n===Ao)return s.UNSIGNED_BYTE;if(n===ry)return s.UNSIGNED_SHORT_4_4_4_4;if(n===sy)return s.UNSIGNED_SHORT_5_5_5_1;if(n===YS)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===jS)return s.BYTE;if(n===XS)return s.SHORT;if(n===ny)return s.UNSIGNED_SHORT;if(n===iy)return s.INT;if(n===Du)return s.UNSIGNED_INT;if(n===_s)return s.FLOAT;if(n===yh)return s.HALF_FLOAT;if(n===qS)return s.ALPHA;if(n===ZS)return s.RGB;if(n===kr)return s.RGBA;if(n===QS)return s.LUMINANCE;if(n===KS)return s.LUMINANCE_ALPHA;if(n===Ru)return s.DEPTH_COMPONENT;if(n===Mf)return s.DEPTH_STENCIL;if(n===oy)return s.RED;if(n===ay)return s.RED_INTEGER;if(n===JS)return s.RG;if(n===ly)return s.RG_INTEGER;if(n===uy)return s.RGBA_INTEGER;if(n===Mm||n===wm||n===Em||n===Tm)if(u===bn)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(n===Mm)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===wm)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Em)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Tm)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(n===Mm)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===wm)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Em)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Tm)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===hv||n===pv||n===mv||n===gv)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(n===hv)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===pv)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===mv)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===gv)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===vv||n===yv||n===xv)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(n===vv||n===yv)return u===bn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(n===xv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===_v||n===Sv||n===Mv||n===wv||n===Ev||n===Tv||n===Av||n===Cv||n===bv||n===Rv||n===Pv||n===Lv||n===Iv||n===Nv)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(n===_v)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Sv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Mv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===wv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Ev)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Tv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Av)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Cv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===bv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Rv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Pv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Lv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Iv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Nv)return u===bn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Am||n===Dv||n===Uv)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(n===Am)return u===bn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Dv)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Uv)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===$S||n===Ov||n===kv||n===zv)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(n===Am)return o.COMPRESSED_RED_RGTC1_EXT;if(n===Ov)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===kv)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===zv)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Pf?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}class RM extends ei{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class yf extends cn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const UR={type:"move"};class y0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new yf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new yf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new G,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new G),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new yf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new G,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new G),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,o=null,u=null;const f=this._targetRay,d=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){u=!0;for(const A of e.hand.values()){const E=t.getJointPose(A,n),S=this._getHandJoint(p,A);E!==null&&(S.matrix.fromArray(E.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.matrixWorldNeedsUpdate=!0,S.jointRadius=E.radius),S.visible=E!==null}const m=p.joints["index-finger-tip"],g=p.joints["thumb-tip"],y=m.position.distanceTo(g.position),_=.02,M=.005;p.inputState.pinching&&y>_+M?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&y<=_-M&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(o=t.getPose(e.gripSpace,n),o!==null&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,o.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(o.linearVelocity)):d.hasLinearVelocity=!1,o.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(o.angularVelocity)):d.hasAngularVelocity=!1));f!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&o!==null&&(i=o),i!==null&&(f.matrix.fromArray(i.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,i.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(i.linearVelocity)):f.hasLinearVelocity=!1,i.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(i.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(UR)))}return f!==null&&(f.visible=i!==null),d!==null&&(d.visible=o!==null),p!==null&&(p.visible=u!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new yf;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}const OR=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,kR=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class zR{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){const i=new Vn,o=e.properties.get(i);o.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}render(e,t){if(this.texture!==null){if(this.mesh===null){const n=t.cameras[0].viewport,i=new is({vertexShader:OR,fragmentShader:kR,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new ti(new Lf(20,20),i)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}}class FR extends xa{constructor(e,t){super();const n=this;let i=null,o=1,u=null,f="local-floor",d=1,p=null,m=null,g=null,y=null,_=null,M=null;const A=new zR,E=t.getContextAttributes();let S=null,P=null;const b=[],L=[],B=new Ne;let D=null;const F=new ei;F.layers.enable(1),F.viewport=new nn;const j=new ei;j.layers.enable(2),j.viewport=new nn;const O=[F,j],N=new RM;N.layers.enable(1),N.layers.enable(2);let X=null,te=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(se){let Re=b[se];return Re===void 0&&(Re=new y0,b[se]=Re),Re.getTargetRaySpace()},this.getControllerGrip=function(se){let Re=b[se];return Re===void 0&&(Re=new y0,b[se]=Re),Re.getGripSpace()},this.getHand=function(se){let Re=b[se];return Re===void 0&&(Re=new y0,b[se]=Re),Re.getHandSpace()};function Q(se){const Re=L.indexOf(se.inputSource);if(Re===-1)return;const ke=b[Re];ke!==void 0&&(ke.update(se.inputSource,se.frame,p||u),ke.dispatchEvent({type:se.type,data:se.inputSource}))}function ue(){i.removeEventListener("select",Q),i.removeEventListener("selectstart",Q),i.removeEventListener("selectend",Q),i.removeEventListener("squeeze",Q),i.removeEventListener("squeezestart",Q),i.removeEventListener("squeezeend",Q),i.removeEventListener("end",ue),i.removeEventListener("inputsourceschange",fe);for(let se=0;se<b.length;se++){const Re=L[se];Re!==null&&(L[se]=null,b[se].disconnect(Re))}X=null,te=null,A.reset(),e.setRenderTarget(S),_=null,y=null,g=null,i=null,P=null,Ve.stop(),n.isPresenting=!1,e.setPixelRatio(D),e.setSize(B.width,B.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(se){o=se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(se){f=se,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||u},this.setReferenceSpace=function(se){p=se},this.getBaseLayer=function(){return y!==null?y:_},this.getBinding=function(){return g},this.getFrame=function(){return M},this.getSession=function(){return i},this.setSession=async function(se){if(i=se,i!==null){if(S=e.getRenderTarget(),i.addEventListener("select",Q),i.addEventListener("selectstart",Q),i.addEventListener("selectend",Q),i.addEventListener("squeeze",Q),i.addEventListener("squeezestart",Q),i.addEventListener("squeezeend",Q),i.addEventListener("end",ue),i.addEventListener("inputsourceschange",fe),E.xrCompatible!==!0&&await t.makeXRCompatible(),D=e.getPixelRatio(),e.getSize(B),i.renderState.layers===void 0){const Re={antialias:E.antialias,alpha:!0,depth:E.depth,stencil:E.stencil,framebufferScaleFactor:o};_=new XRWebGLLayer(i,t,Re),i.updateRenderState({baseLayer:_}),e.setPixelRatio(1),e.setSize(_.framebufferWidth,_.framebufferHeight,!1),P=new qs(_.framebufferWidth,_.framebufferHeight,{format:kr,type:Ao,colorSpace:e.outputColorSpace,stencilBuffer:E.stencil})}else{let Re=null,ke=null,Le=null;E.depth&&(Le=E.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Re=E.stencil?Mf:Ru,ke=E.stencil?Pf:Du);const tt={colorFormat:t.RGBA8,depthFormat:Le,scaleFactor:o};g=new XRWebGLBinding(i,t),y=g.createProjectionLayer(tt),i.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),P=new qs(y.textureWidth,y.textureHeight,{format:kr,type:Ao,depthTexture:new yy(y.textureWidth,y.textureHeight,ke,void 0,void 0,void 0,void 0,void 0,void 0,Re),stencilBuffer:E.stencil,colorSpace:e.outputColorSpace,samples:E.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1})}P.isXRRenderTarget=!0,this.setFoveation(d),p=null,u=await i.requestReferenceSpace(f),Ve.setContext(i),Ve.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function fe(se){for(let Re=0;Re<se.removed.length;Re++){const ke=se.removed[Re],Le=L.indexOf(ke);Le>=0&&(L[Le]=null,b[Le].disconnect(ke))}for(let Re=0;Re<se.added.length;Re++){const ke=se.added[Re];let Le=L.indexOf(ke);if(Le===-1){for(let xt=0;xt<b.length;xt++)if(xt>=L.length){L.push(ke),Le=xt;break}else if(L[xt]===null){L[xt]=ke,Le=xt;break}if(Le===-1)break}const tt=b[Le];tt&&tt.connect(ke)}}const ye=new G,Me=new G;function W(se,Re,ke){ye.setFromMatrixPosition(Re.matrixWorld),Me.setFromMatrixPosition(ke.matrixWorld);const Le=ye.distanceTo(Me),tt=Re.projectionMatrix.elements,xt=ke.projectionMatrix.elements,ae=tt[14]/(tt[10]-1),Mt=tt[14]/(tt[10]+1),Ae=(tt[9]+1)/tt[5],Oe=(tt[9]-1)/tt[5],De=(tt[8]-1)/tt[0],Xe=(xt[8]+1)/xt[0],xe=ae*De,Fe=ae*Xe,$e=Le/(-De+Xe),q=$e*-De;Re.matrixWorld.decompose(se.position,se.quaternion,se.scale),se.translateX(q),se.translateZ($e),se.matrixWorld.compose(se.position,se.quaternion,se.scale),se.matrixWorldInverse.copy(se.matrixWorld).invert();const z=ae+$e,de=Mt+$e,Ie=xe-q,ze=Fe+(Le-q),Ue=Ae*Mt/de*z,vt=Oe*Mt/de*z;se.projectionMatrix.makePerspective(Ie,ze,Ue,vt,z,de),se.projectionMatrixInverse.copy(se.projectionMatrix).invert()}function ee(se,Re){Re===null?se.matrixWorld.copy(se.matrix):se.matrixWorld.multiplyMatrices(Re.matrixWorld,se.matrix),se.matrixWorldInverse.copy(se.matrixWorld).invert()}this.updateCamera=function(se){if(i===null)return;A.texture!==null&&(se.near=A.depthNear,se.far=A.depthFar),N.near=j.near=F.near=se.near,N.far=j.far=F.far=se.far,(X!==N.near||te!==N.far)&&(i.updateRenderState({depthNear:N.near,depthFar:N.far}),X=N.near,te=N.far,F.near=X,F.far=te,j.near=X,j.far=te,F.updateProjectionMatrix(),j.updateProjectionMatrix(),se.updateProjectionMatrix());const Re=se.parent,ke=N.cameras;ee(N,Re);for(let Le=0;Le<ke.length;Le++)ee(ke[Le],Re);ke.length===2?W(N,F,j):N.projectionMatrix.copy(F.projectionMatrix),k(se,N,Re)};function k(se,Re,ke){ke===null?se.matrix.copy(Re.matrixWorld):(se.matrix.copy(ke.matrixWorld),se.matrix.invert(),se.matrix.multiply(Re.matrixWorld)),se.matrix.decompose(se.position,se.quaternion,se.scale),se.updateMatrixWorld(!0),se.projectionMatrix.copy(Re.projectionMatrix),se.projectionMatrixInverse.copy(Re.projectionMatrixInverse),se.isPerspectiveCamera&&(se.fov=wf*2*Math.atan(1/se.projectionMatrix.elements[5]),se.zoom=1)}this.getCamera=function(){return N},this.getFoveation=function(){if(!(y===null&&_===null))return d},this.setFoveation=function(se){d=se,y!==null&&(y.fixedFoveation=se),_!==null&&_.fixedFoveation!==void 0&&(_.fixedFoveation=se)},this.hasDepthSensing=function(){return A.texture!==null};let J=null;function Ce(se,Re){if(m=Re.getViewerPose(p||u),M=Re,m!==null){const ke=m.views;_!==null&&(e.setRenderTargetFramebuffer(P,_.framebuffer),e.setRenderTarget(P));let Le=!1;ke.length!==N.cameras.length&&(N.cameras.length=0,Le=!0);for(let xt=0;xt<ke.length;xt++){const ae=ke[xt];let Mt=null;if(_!==null)Mt=_.getViewport(ae);else{const Oe=g.getViewSubImage(y,ae);Mt=Oe.viewport,xt===0&&(e.setRenderTargetTextures(P,Oe.colorTexture,y.ignoreDepthValues?void 0:Oe.depthStencilTexture),e.setRenderTarget(P))}let Ae=O[xt];Ae===void 0&&(Ae=new ei,Ae.layers.enable(xt),Ae.viewport=new nn,O[xt]=Ae),Ae.matrix.fromArray(ae.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.quaternion,Ae.scale),Ae.projectionMatrix.fromArray(ae.projectionMatrix),Ae.projectionMatrixInverse.copy(Ae.projectionMatrix).invert(),Ae.viewport.set(Mt.x,Mt.y,Mt.width,Mt.height),xt===0&&(N.matrix.copy(Ae.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale)),Le===!0&&N.cameras.push(Ae)}const tt=i.enabledFeatures;if(tt&&tt.includes("depth-sensing")){const xt=g.getDepthInformation(ke[0]);xt&&xt.isValid&&xt.texture&&A.init(e,xt,i.renderState)}}for(let ke=0;ke<b.length;ke++){const Le=L[ke],tt=b[ke];Le!==null&&tt!==void 0&&tt.update(Le,Re,p||u)}A.render(e,N),J&&J(se,Re),Re.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Re}),M=null}const Ve=new MM;Ve.setAnimationLoop(Ce),this.setAnimationLoop=function(se){J=se},this.dispose=function(){}}}const du=new ns,BR=new It;function HR(s,e){function t(E,S){E.matrixAutoUpdate===!0&&E.updateMatrix(),S.value.copy(E.matrix)}function n(E,S){S.color.getRGB(E.fogColor.value,xM(s)),S.isFog?(E.fogNear.value=S.near,E.fogFar.value=S.far):S.isFogExp2&&(E.fogDensity.value=S.density)}function i(E,S,P,b,L){S.isMeshBasicMaterial||S.isMeshLambertMaterial?o(E,S):S.isMeshToonMaterial?(o(E,S),g(E,S)):S.isMeshPhongMaterial?(o(E,S),m(E,S)):S.isMeshStandardMaterial?(o(E,S),y(E,S),S.isMeshPhysicalMaterial&&_(E,S,L)):S.isMeshMatcapMaterial?(o(E,S),M(E,S)):S.isMeshDepthMaterial?o(E,S):S.isMeshDistanceMaterial?(o(E,S),A(E,S)):S.isMeshNormalMaterial?o(E,S):S.isLineBasicMaterial?(u(E,S),S.isLineDashedMaterial&&f(E,S)):S.isPointsMaterial?d(E,S,P,b):S.isSpriteMaterial?p(E,S):S.isShadowMaterial?(E.color.value.copy(S.color),E.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}function o(E,S){E.opacity.value=S.opacity,S.color&&E.diffuse.value.copy(S.color),S.emissive&&E.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(E.map.value=S.map,t(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.bumpMap&&(E.bumpMap.value=S.bumpMap,t(S.bumpMap,E.bumpMapTransform),E.bumpScale.value=S.bumpScale,S.side===nr&&(E.bumpScale.value*=-1)),S.normalMap&&(E.normalMap.value=S.normalMap,t(S.normalMap,E.normalMapTransform),E.normalScale.value.copy(S.normalScale),S.side===nr&&E.normalScale.value.negate()),S.displacementMap&&(E.displacementMap.value=S.displacementMap,t(S.displacementMap,E.displacementMapTransform),E.displacementScale.value=S.displacementScale,E.displacementBias.value=S.displacementBias),S.emissiveMap&&(E.emissiveMap.value=S.emissiveMap,t(S.emissiveMap,E.emissiveMapTransform)),S.specularMap&&(E.specularMap.value=S.specularMap,t(S.specularMap,E.specularMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest);const P=e.get(S),b=P.envMap,L=P.envMapRotation;if(b&&(E.envMap.value=b,du.copy(L),du.x*=-1,du.y*=-1,du.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(du.y*=-1,du.z*=-1),E.envMapRotation.value.setFromMatrix4(BR.makeRotationFromEuler(du)),E.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=S.reflectivity,E.ior.value=S.ior,E.refractionRatio.value=S.refractionRatio),S.lightMap){E.lightMap.value=S.lightMap;const B=s._useLegacyLights===!0?Math.PI:1;E.lightMapIntensity.value=S.lightMapIntensity*B,t(S.lightMap,E.lightMapTransform)}S.aoMap&&(E.aoMap.value=S.aoMap,E.aoMapIntensity.value=S.aoMapIntensity,t(S.aoMap,E.aoMapTransform))}function u(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,S.map&&(E.map.value=S.map,t(S.map,E.mapTransform))}function f(E,S){E.dashSize.value=S.dashSize,E.totalSize.value=S.dashSize+S.gapSize,E.scale.value=S.scale}function d(E,S,P,b){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.size.value=S.size*P,E.scale.value=b*.5,S.map&&(E.map.value=S.map,t(S.map,E.uvTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function p(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.rotation.value=S.rotation,S.map&&(E.map.value=S.map,t(S.map,E.mapTransform)),S.alphaMap&&(E.alphaMap.value=S.alphaMap,t(S.alphaMap,E.alphaMapTransform)),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest)}function m(E,S){E.specular.value.copy(S.specular),E.shininess.value=Math.max(S.shininess,1e-4)}function g(E,S){S.gradientMap&&(E.gradientMap.value=S.gradientMap)}function y(E,S){E.metalness.value=S.metalness,S.metalnessMap&&(E.metalnessMap.value=S.metalnessMap,t(S.metalnessMap,E.metalnessMapTransform)),E.roughness.value=S.roughness,S.roughnessMap&&(E.roughnessMap.value=S.roughnessMap,t(S.roughnessMap,E.roughnessMapTransform)),S.envMap&&(E.envMapIntensity.value=S.envMapIntensity)}function _(E,S,P){E.ior.value=S.ior,S.sheen>0&&(E.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),E.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(E.sheenColorMap.value=S.sheenColorMap,t(S.sheenColorMap,E.sheenColorMapTransform)),S.sheenRoughnessMap&&(E.sheenRoughnessMap.value=S.sheenRoughnessMap,t(S.sheenRoughnessMap,E.sheenRoughnessMapTransform))),S.clearcoat>0&&(E.clearcoat.value=S.clearcoat,E.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(E.clearcoatMap.value=S.clearcoatMap,t(S.clearcoatMap,E.clearcoatMapTransform)),S.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap,t(S.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),S.clearcoatNormalMap&&(E.clearcoatNormalMap.value=S.clearcoatNormalMap,t(S.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),S.side===nr&&E.clearcoatNormalScale.value.negate())),S.dispersion>0&&(E.dispersion.value=S.dispersion),S.iridescence>0&&(E.iridescence.value=S.iridescence,E.iridescenceIOR.value=S.iridescenceIOR,E.iridescenceThicknessMinimum.value=S.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=S.iridescenceThicknessRange[1],S.iridescenceMap&&(E.iridescenceMap.value=S.iridescenceMap,t(S.iridescenceMap,E.iridescenceMapTransform)),S.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=S.iridescenceThicknessMap,t(S.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),S.transmission>0&&(E.transmission.value=S.transmission,E.transmissionSamplerMap.value=P.texture,E.transmissionSamplerSize.value.set(P.width,P.height),S.transmissionMap&&(E.transmissionMap.value=S.transmissionMap,t(S.transmissionMap,E.transmissionMapTransform)),E.thickness.value=S.thickness,S.thicknessMap&&(E.thicknessMap.value=S.thicknessMap,t(S.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=S.attenuationDistance,E.attenuationColor.value.copy(S.attenuationColor)),S.anisotropy>0&&(E.anisotropyVector.value.set(S.anisotropy*Math.cos(S.anisotropyRotation),S.anisotropy*Math.sin(S.anisotropyRotation)),S.anisotropyMap&&(E.anisotropyMap.value=S.anisotropyMap,t(S.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=S.specularIntensity,E.specularColor.value.copy(S.specularColor),S.specularColorMap&&(E.specularColorMap.value=S.specularColorMap,t(S.specularColorMap,E.specularColorMapTransform)),S.specularIntensityMap&&(E.specularIntensityMap.value=S.specularIntensityMap,t(S.specularIntensityMap,E.specularIntensityMapTransform))}function M(E,S){S.matcap&&(E.matcap.value=S.matcap)}function A(E,S){const P=e.get(S).light;E.referencePosition.value.setFromMatrixPosition(P.matrixWorld),E.nearDistance.value=P.shadow.camera.near,E.farDistance.value=P.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function VR(s,e,t,n){let i={},o={},u=[];const f=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function d(P,b){const L=b.program;n.uniformBlockBinding(P,L)}function p(P,b){let L=i[P.id];L===void 0&&(M(P),L=m(P),i[P.id]=L,P.addEventListener("dispose",E));const B=b.program;n.updateUBOMapping(P,B);const D=e.render.frame;o[P.id]!==D&&(y(P),o[P.id]=D)}function m(P){const b=g();P.__bindingPointIndex=b;const L=s.createBuffer(),B=P.__size,D=P.usage;return s.bindBuffer(s.UNIFORM_BUFFER,L),s.bufferData(s.UNIFORM_BUFFER,B,D),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,b,L),L}function g(){for(let P=0;P<f;P++)if(u.indexOf(P)===-1)return u.push(P),P;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(P){const b=i[P.id],L=P.uniforms,B=P.__cache;s.bindBuffer(s.UNIFORM_BUFFER,b);for(let D=0,F=L.length;D<F;D++){const j=Array.isArray(L[D])?L[D]:[L[D]];for(let O=0,N=j.length;O<N;O++){const X=j[O];if(_(X,D,O,B)===!0){const te=X.__offset,Q=Array.isArray(X.value)?X.value:[X.value];let ue=0;for(let fe=0;fe<Q.length;fe++){const ye=Q[fe],Me=A(ye);typeof ye=="number"||typeof ye=="boolean"?(X.__data[0]=ye,s.bufferSubData(s.UNIFORM_BUFFER,te+ue,X.__data)):ye.isMatrix3?(X.__data[0]=ye.elements[0],X.__data[1]=ye.elements[1],X.__data[2]=ye.elements[2],X.__data[3]=0,X.__data[4]=ye.elements[3],X.__data[5]=ye.elements[4],X.__data[6]=ye.elements[5],X.__data[7]=0,X.__data[8]=ye.elements[6],X.__data[9]=ye.elements[7],X.__data[10]=ye.elements[8],X.__data[11]=0):(ye.toArray(X.__data,ue),ue+=Me.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,te,X.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function _(P,b,L,B){const D=P.value,F=b+"_"+L;if(B[F]===void 0)return typeof D=="number"||typeof D=="boolean"?B[F]=D:B[F]=D.clone(),!0;{const j=B[F];if(typeof D=="number"||typeof D=="boolean"){if(j!==D)return B[F]=D,!0}else if(j.equals(D)===!1)return j.copy(D),!0}return!1}function M(P){const b=P.uniforms;let L=0;const B=16;for(let F=0,j=b.length;F<j;F++){const O=Array.isArray(b[F])?b[F]:[b[F]];for(let N=0,X=O.length;N<X;N++){const te=O[N],Q=Array.isArray(te.value)?te.value:[te.value];for(let ue=0,fe=Q.length;ue<fe;ue++){const ye=Q[ue],Me=A(ye),W=L%B;W!==0&&B-W<Me.boundary&&(L+=B-W),te.__data=new Float32Array(Me.storage/Float32Array.BYTES_PER_ELEMENT),te.__offset=L,L+=Me.storage}}}const D=L%B;return D>0&&(L+=B-D),P.__size=L,P.__cache={},this}function A(P){const b={boundary:0,storage:0};return typeof P=="number"||typeof P=="boolean"?(b.boundary=4,b.storage=4):P.isVector2?(b.boundary=8,b.storage=8):P.isVector3||P.isColor?(b.boundary=16,b.storage=12):P.isVector4?(b.boundary=16,b.storage=16):P.isMatrix3?(b.boundary=48,b.storage=48):P.isMatrix4?(b.boundary=64,b.storage=64):P.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",P),b}function E(P){const b=P.target;b.removeEventListener("dispose",E);const L=u.indexOf(b.__bindingPointIndex);u.splice(L,1),s.deleteBuffer(i[b.id]),delete i[b.id],delete o[b.id]}function S(){for(const P in i)s.deleteBuffer(i[P]);u=[],i={},o={}}return{bind:d,update:p,dispose:S}}class PM{constructor(e={}){const{canvas:t=pM(),context:n=null,depth:i=!0,stencil:o=!1,alpha:u=!1,antialias:f=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:p=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:g=!1}=e;this.isWebGLRenderer=!0;let y;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");y=n.getContextAttributes().alpha}else y=u;const _=new Uint32Array(4),M=new Int32Array(4);let A=null,E=null;const S=[],P=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=vs,this._useLegacyLights=!1,this.toneMapping=Eo,this.toneMappingExposure=1;const b=this;let L=!1,B=0,D=0,F=null,j=-1,O=null;const N=new nn,X=new nn;let te=null;const Q=new st(0);let ue=0,fe=t.width,ye=t.height,Me=1,W=null,ee=null;const k=new nn(0,0,fe,ye),J=new nn(0,0,fe,ye);let Ce=!1;const Ve=new Mh;let se=!1,Re=!1;const ke=new It,Le=new G,tt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function xt(){return F===null?Me:1}let ae=n;function Mt(H,le){return t.getContext(H,le)}try{const H={alpha:!0,depth:i,stencil:o,antialias:f,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:g};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${bf}`),t.addEventListener("webglcontextlost",K,!1),t.addEventListener("webglcontextrestored",Ee,!1),t.addEventListener("webglcontextcreationerror",Te,!1),ae===null){const le="webgl2";if(ae=Mt(le,H),ae===null)throw Mt(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(H){throw console.error("THREE.WebGLRenderer: "+H.message),H}let Ae,Oe,De,Xe,xe,Fe,$e,q,z,de,Ie,ze,Ue,vt,Je,Ke,Ct,qe,ft,Nt,Tt,ot,Dt,Bt;function ne(){Ae=new tb(ae),Ae.init(),ot=new bM(ae,Ae),Oe=new ZC(ae,Ae,e,ot),De=new NR(ae),Xe=new rb(ae),xe=new SR,Fe=new DR(ae,Ae,De,xe,Oe,ot,Xe),$e=new KC(b),q=new eb(b),z=new fA(ae),Dt=new YC(ae,z),de=new nb(ae,z,Xe,Dt),Ie=new ob(ae,de,z,Xe),ft=new sb(ae,Oe,Fe),Ke=new QC(xe),ze=new _R(b,$e,q,Ae,Oe,Dt,Ke),Ue=new HR(b,xe),vt=new wR,Je=new RR(Ae),qe=new XC(b,$e,q,De,Ie,y,d),Ct=new IR(b,Ie,Oe),Bt=new VR(ae,Xe,Oe,De),Nt=new qC(ae,Ae,Xe),Tt=new ib(ae,Ae,Xe),Xe.programs=ze.programs,b.capabilities=Oe,b.extensions=Ae,b.properties=xe,b.renderLists=vt,b.shadowMap=Ct,b.state=De,b.info=Xe}ne();const Pe=new FR(b,ae);this.xr=Pe,this.getContext=function(){return ae},this.getContextAttributes=function(){return ae.getContextAttributes()},this.forceContextLoss=function(){const H=Ae.get("WEBGL_lose_context");H&&H.loseContext()},this.forceContextRestore=function(){const H=Ae.get("WEBGL_lose_context");H&&H.restoreContext()},this.getPixelRatio=function(){return Me},this.setPixelRatio=function(H){H!==void 0&&(Me=H,this.setSize(fe,ye,!1))},this.getSize=function(H){return H.set(fe,ye)},this.setSize=function(H,le,Se=!0){if(Pe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}fe=H,ye=le,t.width=Math.floor(H*Me),t.height=Math.floor(le*Me),Se===!0&&(t.style.width=H+"px",t.style.height=le+"px"),this.setViewport(0,0,H,le)},this.getDrawingBufferSize=function(H){return H.set(fe*Me,ye*Me).floor()},this.setDrawingBufferSize=function(H,le,Se){fe=H,ye=le,Me=Se,t.width=Math.floor(H*Se),t.height=Math.floor(le*Se),this.setViewport(0,0,H,le)},this.getCurrentViewport=function(H){return H.copy(N)},this.getViewport=function(H){return H.copy(k)},this.setViewport=function(H,le,Se,me){H.isVector4?k.set(H.x,H.y,H.z,H.w):k.set(H,le,Se,me),De.viewport(N.copy(k).multiplyScalar(Me).round())},this.getScissor=function(H){return H.copy(J)},this.setScissor=function(H,le,Se,me){H.isVector4?J.set(H.x,H.y,H.z,H.w):J.set(H,le,Se,me),De.scissor(X.copy(J).multiplyScalar(Me).round())},this.getScissorTest=function(){return Ce},this.setScissorTest=function(H){De.setScissorTest(Ce=H)},this.setOpaqueSort=function(H){W=H},this.setTransparentSort=function(H){ee=H},this.getClearColor=function(H){return H.copy(qe.getClearColor())},this.setClearColor=function(){qe.setClearColor.apply(qe,arguments)},this.getClearAlpha=function(){return qe.getClearAlpha()},this.setClearAlpha=function(){qe.setClearAlpha.apply(qe,arguments)},this.clear=function(H=!0,le=!0,Se=!0){let me=0;if(H){let ge=!1;if(F!==null){const nt=F.texture.format;ge=nt===uy||nt===ly||nt===ay}if(ge){const nt=F.texture.type,ht=nt===Ao||nt===Du||nt===ny||nt===Pf||nt===ry||nt===sy,yt=qe.getClearColor(),bt=qe.getClearAlpha(),kt=yt.r,ut=yt.g,zt=yt.b;ht?(_[0]=kt,_[1]=ut,_[2]=zt,_[3]=bt,ae.clearBufferuiv(ae.COLOR,0,_)):(M[0]=kt,M[1]=ut,M[2]=zt,M[3]=bt,ae.clearBufferiv(ae.COLOR,0,M))}else me|=ae.COLOR_BUFFER_BIT}le&&(me|=ae.DEPTH_BUFFER_BIT),Se&&(me|=ae.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),ae.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",K,!1),t.removeEventListener("webglcontextrestored",Ee,!1),t.removeEventListener("webglcontextcreationerror",Te,!1),vt.dispose(),Je.dispose(),xe.dispose(),$e.dispose(),q.dispose(),Ie.dispose(),Dt.dispose(),Bt.dispose(),ze.dispose(),Pe.dispose(),Pe.removeEventListener("sessionstart",Xt),Pe.removeEventListener("sessionend",On),wn.stop()};function K(H){H.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),L=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),L=!1;const H=Xe.autoReset,le=Ct.enabled,Se=Ct.autoUpdate,me=Ct.needsUpdate,ge=Ct.type;ne(),Xe.autoReset=H,Ct.enabled=le,Ct.autoUpdate=Se,Ct.needsUpdate=me,Ct.type=ge}function Te(H){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",H.statusMessage)}function We(H){const le=H.target;le.removeEventListener("dispose",We),Ze(le)}function Ze(H){Kt(H),xe.remove(H)}function Kt(H){const le=xe.get(H).programs;le!==void 0&&(le.forEach(function(Se){ze.releaseProgram(Se)}),H.isShaderMaterial&&ze.releaseShaderCache(H))}this.renderBufferDirect=function(H,le,Se,me,ge,nt){le===null&&(le=tt);const ht=ge.isMesh&&ge.matrixWorld.determinant()<0,yt=Uf(H,le,Se,me,ge);De.setMaterial(me,ht);let bt=Se.index,kt=1;if(me.wireframe===!0){if(bt=de.getWireframeAttribute(Se),bt===void 0)return;kt=2}const ut=Se.drawRange,zt=Se.attributes.position;let gn=ut.start*kt,kn=(ut.start+ut.count)*kt;nt!==null&&(gn=Math.max(gn,nt.start*kt),kn=Math.min(kn,(nt.start+nt.count)*kt)),bt!==null?(gn=Math.max(gn,0),kn=Math.min(kn,bt.count)):zt!=null&&(gn=Math.max(gn,0),kn=Math.min(kn,zt.count));const ni=kn-gn;if(ni<0||ni===1/0)return;Dt.setup(ge,me,yt,Se,bt);let sr,Qt=Nt;if(bt!==null&&(sr=z.get(bt),Qt=Tt,Qt.setIndex(sr)),ge.isMesh)me.wireframe===!0?(De.setLineWidth(me.wireframeLinewidth*xt()),Qt.setMode(ae.LINES)):Qt.setMode(ae.TRIANGLES);else if(ge.isLine){let wt=me.linewidth;wt===void 0&&(wt=1),De.setLineWidth(wt*xt()),ge.isLineSegments?Qt.setMode(ae.LINES):ge.isLineLoop?Qt.setMode(ae.LINE_LOOP):Qt.setMode(ae.LINE_STRIP)}else ge.isPoints?Qt.setMode(ae.POINTS):ge.isSprite&&Qt.setMode(ae.TRIANGLES);if(ge.isBatchedMesh)ge._multiDrawInstances!==null?Qt.renderMultiDrawInstances(ge._multiDrawStarts,ge._multiDrawCounts,ge._multiDrawCount,ge._multiDrawInstances):Qt.renderMultiDraw(ge._multiDrawStarts,ge._multiDrawCounts,ge._multiDrawCount);else if(ge.isInstancedMesh)Qt.renderInstances(gn,ni,ge.count);else if(Se.isInstancedBufferGeometry){const wt=Se._maxInstanceCount!==void 0?Se._maxInstanceCount:1/0,Vt=Math.min(Se.instanceCount,wt);Qt.renderInstances(gn,ni,Vt)}else Qt.render(gn,ni)};function rn(H,le,Se){H.transparent===!0&&H.side===_o&&H.forceSinglePass===!1?(H.side=nr,H.needsUpdate=!0,Ss(H,le,Se),H.side=ma,H.needsUpdate=!0,Ss(H,le,Se),H.side=_o):Ss(H,le,Se)}this.compile=function(H,le,Se=null){Se===null&&(Se=H),E=Je.get(Se),E.init(le),P.push(E),Se.traverseVisible(function(ge){ge.isLight&&ge.layers.test(le.layers)&&(E.pushLight(ge),ge.castShadow&&E.pushShadow(ge))}),H!==Se&&H.traverseVisible(function(ge){ge.isLight&&ge.layers.test(le.layers)&&(E.pushLight(ge),ge.castShadow&&E.pushShadow(ge))}),E.setupLights(b._useLegacyLights);const me=new Set;return H.traverse(function(ge){const nt=ge.material;if(nt)if(Array.isArray(nt))for(let ht=0;ht<nt.length;ht++){const yt=nt[ht];rn(yt,Se,ge),me.add(yt)}else rn(nt,Se,ge),me.add(nt)}),P.pop(),E=null,me},this.compileAsync=function(H,le,Se=null){const me=this.compile(H,le,Se);return new Promise(ge=>{function nt(){if(me.forEach(function(ht){xe.get(ht).currentProgram.isReady()&&me.delete(ht)}),me.size===0){ge(H);return}setTimeout(nt,10)}Ae.get("KHR_parallel_shader_compile")!==null?nt():setTimeout(nt,10)})};let Jt=null;function fn(H){Jt&&Jt(H)}function Xt(){wn.stop()}function On(){wn.start()}const wn=new MM;wn.setAnimationLoop(fn),typeof self<"u"&&wn.setContext(self),this.setAnimationLoop=function(H){Jt=H,Pe.setAnimationLoop(H),H===null?wn.stop():wn.start()},Pe.addEventListener("sessionstart",Xt),Pe.addEventListener("sessionend",On),this.render=function(H,le){if(le!==void 0&&le.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(L===!0)return;H.matrixWorldAutoUpdate===!0&&H.updateMatrixWorld(),le.parent===null&&le.matrixWorldAutoUpdate===!0&&le.updateMatrixWorld(),Pe.enabled===!0&&Pe.isPresenting===!0&&(Pe.cameraAutoUpdate===!0&&Pe.updateCamera(le),le=Pe.getCamera()),H.isScene===!0&&H.onBeforeRender(b,H,le,F),E=Je.get(H,P.length),E.init(le),P.push(E),ke.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),Ve.setFromProjectionMatrix(ke),Re=this.localClippingEnabled,se=Ke.init(this.clippingPlanes,Re),A=vt.get(H,S.length),A.init(),S.push(A),rr(H,le,0,b.sortObjects),A.finish(),b.sortObjects===!0&&A.sort(W,ee);const Se=Pe.enabled===!1||Pe.isPresenting===!1||Pe.hasDepthSensing()===!1;Se&&qe.addToRenderList(A,H),this.info.render.frame++,se===!0&&Ke.beginShadows();const me=E.state.shadowsArray;Ct.render(me,H,le),se===!0&&Ke.endShadows(),this.info.autoReset===!0&&this.info.reset();const ge=A.opaque,nt=A.transmissive;if(E.setupLights(b._useLegacyLights),le.isArrayCamera){const ht=le.cameras;if(nt.length>0)for(let yt=0,bt=ht.length;yt<bt;yt++){const kt=ht[yt];Ks(ge,nt,H,kt)}Se&&qe.render(H);for(let yt=0,bt=ht.length;yt<bt;yt++){const kt=ht[yt];_a(A,H,kt,kt.viewport)}}else nt.length>0&&Ks(ge,nt,H,le),Se&&qe.render(H),_a(A,H,le);F!==null&&(Fe.updateMultisampleRenderTarget(F),Fe.updateRenderTargetMipmap(F)),H.isScene===!0&&H.onAfterRender(b,H,le),Dt.resetDefaultState(),j=-1,O=null,P.pop(),P.length>0?(E=P[P.length-1],se===!0&&Ke.setGlobalState(b.clippingPlanes,E.state.camera)):E=null,S.pop(),S.length>0?A=S[S.length-1]:A=null};function rr(H,le,Se,me){if(H.visible===!1)return;if(H.layers.test(le.layers)){if(H.isGroup)Se=H.renderOrder;else if(H.isLOD)H.autoUpdate===!0&&H.update(le);else if(H.isLight)E.pushLight(H),H.castShadow&&E.pushShadow(H);else if(H.isSprite){if(!H.frustumCulled||Ve.intersectsSprite(H)){me&&Le.setFromMatrixPosition(H.matrixWorld).applyMatrix4(ke);const ht=Ie.update(H),yt=H.material;yt.visible&&A.push(H,ht,yt,Se,Le.z,null)}}else if((H.isMesh||H.isLine||H.isPoints)&&(!H.frustumCulled||Ve.intersectsObject(H))){const ht=Ie.update(H),yt=H.material;if(me&&(H.boundingSphere!==void 0?(H.boundingSphere===null&&H.computeBoundingSphere(),Le.copy(H.boundingSphere.center)):(ht.boundingSphere===null&&ht.computeBoundingSphere(),Le.copy(ht.boundingSphere.center)),Le.applyMatrix4(H.matrixWorld).applyMatrix4(ke)),Array.isArray(yt)){const bt=ht.groups;for(let kt=0,ut=bt.length;kt<ut;kt++){const zt=bt[kt],gn=yt[zt.materialIndex];gn&&gn.visible&&A.push(H,ht,gn,Se,Le.z,zt)}}else yt.visible&&A.push(H,ht,yt,Se,Le.z,null)}}const nt=H.children;for(let ht=0,yt=nt.length;ht<yt;ht++)rr(nt[ht],le,Se,me)}function _a(H,le,Se,me){const ge=H.opaque,nt=H.transmissive,ht=H.transparent;E.setupLightsView(Se),se===!0&&Ke.setGlobalState(b.clippingPlanes,Se),me&&De.viewport(N.copy(me)),ge.length>0&&Ro(ge,le,Se),nt.length>0&&Ro(nt,le,Se),ht.length>0&&Ro(ht,le,Se),De.buffers.depth.setTest(!0),De.buffers.depth.setMask(!0),De.buffers.color.setMask(!0),De.setPolygonOffset(!1)}function Ks(H,le,Se,me){if((Se.isScene===!0?Se.overrideMaterial:null)!==null)return;E.state.transmissionRenderTarget[me.id]===void 0&&(E.state.transmissionRenderTarget[me.id]=new qs(1,1,{generateMipmaps:!0,type:Ae.has("EXT_color_buffer_half_float")||Ae.has("EXT_color_buffer_float")?yh:Ao,minFilter:Mo,samples:4,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));const nt=E.state.transmissionRenderTarget[me.id],ht=me.viewport||N;nt.setSize(ht.z,ht.w);const yt=b.getRenderTarget();b.setRenderTarget(nt),b.getClearColor(Q),ue=b.getClearAlpha(),ue<1&&b.setClearColor(16777215,.5),b.clear();const bt=b.toneMapping;b.toneMapping=Eo;const kt=me.viewport;if(me.viewport!==void 0&&(me.viewport=void 0),E.setupLightsView(me),se===!0&&Ke.setGlobalState(b.clippingPlanes,me),Ro(H,Se,me),Fe.updateMultisampleRenderTarget(nt),Fe.updateRenderTargetMipmap(nt),Ae.has("WEBGL_multisampled_render_to_texture")===!1){let ut=!1;for(let zt=0,gn=le.length;zt<gn;zt++){const kn=le[zt],ni=kn.object,sr=kn.geometry,Qt=kn.material,wt=kn.group;if(Qt.side===_o&&ni.layers.test(me.layers)){const Vt=Qt.side;Qt.side=nr,Qt.needsUpdate=!0,rs(ni,Se,me,sr,Qt,wt),Qt.side=Vt,Qt.needsUpdate=!0,ut=!0}}ut===!0&&(Fe.updateMultisampleRenderTarget(nt),Fe.updateRenderTargetMipmap(nt))}b.setRenderTarget(yt),b.setClearColor(Q,ue),kt!==void 0&&(me.viewport=kt),b.toneMapping=bt}function Ro(H,le,Se){const me=le.isScene===!0?le.overrideMaterial:null;for(let ge=0,nt=H.length;ge<nt;ge++){const ht=H[ge],yt=ht.object,bt=ht.geometry,kt=me===null?ht.material:me,ut=ht.group;yt.layers.test(Se.layers)&&rs(yt,le,Se,bt,kt,ut)}}function rs(H,le,Se,me,ge,nt){H.onBeforeRender(b,le,Se,me,ge,nt),H.modelViewMatrix.multiplyMatrices(Se.matrixWorldInverse,H.matrixWorld),H.normalMatrix.getNormalMatrix(H.modelViewMatrix),ge.onBeforeRender(b,le,Se,me,H,nt),ge.transparent===!0&&ge.side===_o&&ge.forceSinglePass===!1?(ge.side=nr,ge.needsUpdate=!0,b.renderBufferDirect(Se,le,me,ge,H,nt),ge.side=ma,ge.needsUpdate=!0,b.renderBufferDirect(Se,le,me,ge,H,nt),ge.side=_o):b.renderBufferDirect(Se,le,me,ge,H,nt),H.onAfterRender(b,le,Se,me,ge,nt)}function Ss(H,le,Se){le.isScene!==!0&&(le=tt);const me=xe.get(H),ge=E.state.lights,nt=E.state.shadowsArray,ht=ge.state.version,yt=ze.getParameters(H,ge.state,nt,le,Se),bt=ze.getProgramCacheKey(yt);let kt=me.programs;me.environment=H.isMeshStandardMaterial?le.environment:null,me.fog=le.fog,me.envMap=(H.isMeshStandardMaterial?q:$e).get(H.envMap||me.environment),me.envMapRotation=me.environment!==null&&H.envMap===null?le.environmentRotation:H.envMapRotation,kt===void 0&&(H.addEventListener("dispose",We),kt=new Map,me.programs=kt);let ut=kt.get(bt);if(ut!==void 0){if(me.currentProgram===ut&&me.lightsStateVersion===ht)return Sa(H,yt),ut}else yt.uniforms=ze.getUniforms(H),H.onBuild(Se,yt,b),H.onBeforeCompile(yt,b),ut=ze.acquireProgram(yt,bt),kt.set(bt,ut),me.uniforms=yt.uniforms;const zt=me.uniforms;return(!H.isShaderMaterial&&!H.isRawShaderMaterial||H.clipping===!0)&&(zt.clippingPlanes=Ke.uniform),Sa(H,yt),me.needsLights=kf(H),me.lightsStateVersion=ht,me.needsLights&&(zt.ambientLightColor.value=ge.state.ambient,zt.lightProbe.value=ge.state.probe,zt.directionalLights.value=ge.state.directional,zt.directionalLightShadows.value=ge.state.directionalShadow,zt.spotLights.value=ge.state.spot,zt.spotLightShadows.value=ge.state.spotShadow,zt.rectAreaLights.value=ge.state.rectArea,zt.ltc_1.value=ge.state.rectAreaLTC1,zt.ltc_2.value=ge.state.rectAreaLTC2,zt.pointLights.value=ge.state.point,zt.pointLightShadows.value=ge.state.pointShadow,zt.hemisphereLights.value=ge.state.hemi,zt.directionalShadowMap.value=ge.state.directionalShadowMap,zt.directionalShadowMatrix.value=ge.state.directionalShadowMatrix,zt.spotShadowMap.value=ge.state.spotShadowMap,zt.spotLightMatrix.value=ge.state.spotLightMatrix,zt.spotLightMap.value=ge.state.spotLightMap,zt.pointShadowMap.value=ge.state.pointShadowMap,zt.pointShadowMatrix.value=ge.state.pointShadowMatrix),me.currentProgram=ut,me.uniformsList=null,ut}function Fr(H){if(H.uniformsList===null){const le=H.currentProgram.getUniforms();H.uniformsList=bm.seqWithValue(le.seq,H.uniforms)}return H.uniformsList}function Sa(H,le){const Se=xe.get(H);Se.outputColorSpace=le.outputColorSpace,Se.batching=le.batching,Se.instancing=le.instancing,Se.instancingColor=le.instancingColor,Se.instancingMorph=le.instancingMorph,Se.skinning=le.skinning,Se.morphTargets=le.morphTargets,Se.morphNormals=le.morphNormals,Se.morphColors=le.morphColors,Se.morphTargetsCount=le.morphTargetsCount,Se.numClippingPlanes=le.numClippingPlanes,Se.numIntersection=le.numClipIntersection,Se.vertexAlphas=le.vertexAlphas,Se.vertexTangents=le.vertexTangents,Se.toneMapping=le.toneMapping}function Uf(H,le,Se,me,ge){le.isScene!==!0&&(le=tt),Fe.resetTextureUnits();const nt=le.fog,ht=me.isMeshStandardMaterial?le.environment:null,yt=F===null?b.outputColorSpace:F.isXRRenderTarget===!0?F.texture.colorSpace:ya,bt=(me.isMeshStandardMaterial?q:$e).get(me.envMap||ht),kt=me.vertexColors===!0&&!!Se.attributes.color&&Se.attributes.color.itemSize===4,ut=!!Se.attributes.tangent&&(!!me.normalMap||me.anisotropy>0),zt=!!Se.morphAttributes.position,gn=!!Se.morphAttributes.normal,kn=!!Se.morphAttributes.color;let ni=Eo;me.toneMapped&&(F===null||F.isXRRenderTarget===!0)&&(ni=b.toneMapping);const sr=Se.morphAttributes.position||Se.morphAttributes.normal||Se.morphAttributes.color,Qt=sr!==void 0?sr.length:0,wt=xe.get(me),Vt=E.state.lights;if(se===!0&&(Re===!0||H!==O)){const ii=H===O&&me.id===j;Ke.setState(me,H,ii)}let At=!1;me.version===wt.__version?(wt.needsLights&&wt.lightsStateVersion!==Vt.state.version||wt.outputColorSpace!==yt||ge.isBatchedMesh&&wt.batching===!1||!ge.isBatchedMesh&&wt.batching===!0||ge.isInstancedMesh&&wt.instancing===!1||!ge.isInstancedMesh&&wt.instancing===!0||ge.isSkinnedMesh&&wt.skinning===!1||!ge.isSkinnedMesh&&wt.skinning===!0||ge.isInstancedMesh&&wt.instancingColor===!0&&ge.instanceColor===null||ge.isInstancedMesh&&wt.instancingColor===!1&&ge.instanceColor!==null||ge.isInstancedMesh&&wt.instancingMorph===!0&&ge.morphTexture===null||ge.isInstancedMesh&&wt.instancingMorph===!1&&ge.morphTexture!==null||wt.envMap!==bt||me.fog===!0&&wt.fog!==nt||wt.numClippingPlanes!==void 0&&(wt.numClippingPlanes!==Ke.numPlanes||wt.numIntersection!==Ke.numIntersection)||wt.vertexAlphas!==kt||wt.vertexTangents!==ut||wt.morphTargets!==zt||wt.morphNormals!==gn||wt.morphColors!==kn||wt.toneMapping!==ni||wt.morphTargetsCount!==Qt)&&(At=!0):(At=!0,wt.__version=me.version);let vn=wt.currentProgram;At===!0&&(vn=Ss(me,le,ge));let qn=!1,Gn=!1,Br=!1;const yn=vn.getUniforms(),xn=wt.uniforms;if(De.useProgram(vn.program)&&(qn=!0,Gn=!0,Br=!0),me.id!==j&&(j=me.id,Gn=!0),qn||O!==H){yn.setValue(ae,"projectionMatrix",H.projectionMatrix),yn.setValue(ae,"viewMatrix",H.matrixWorldInverse);const ii=yn.map.cameraPosition;ii!==void 0&&ii.setValue(ae,Le.setFromMatrixPosition(H.matrixWorld)),Oe.logarithmicDepthBuffer&&yn.setValue(ae,"logDepthBufFC",2/(Math.log(H.far+1)/Math.LN2)),(me.isMeshPhongMaterial||me.isMeshToonMaterial||me.isMeshLambertMaterial||me.isMeshBasicMaterial||me.isMeshStandardMaterial||me.isShaderMaterial)&&yn.setValue(ae,"isOrthographic",H.isOrthographicCamera===!0),O!==H&&(O=H,Gn=!0,Br=!0)}if(ge.isSkinnedMesh){yn.setOptional(ae,ge,"bindMatrix"),yn.setOptional(ae,ge,"bindMatrixInverse");const ii=ge.skeleton;ii&&(ii.boneTexture===null&&ii.computeBoneTexture(),yn.setValue(ae,"boneTexture",ii.boneTexture,Fe))}ge.isBatchedMesh&&(yn.setOptional(ae,ge,"batchingTexture"),yn.setValue(ae,"batchingTexture",ge._matricesTexture,Fe));const yr=Se.morphAttributes;if((yr.position!==void 0||yr.normal!==void 0||yr.color!==void 0)&&ft.update(ge,Se,vn),(Gn||wt.receiveShadow!==ge.receiveShadow)&&(wt.receiveShadow=ge.receiveShadow,yn.setValue(ae,"receiveShadow",ge.receiveShadow)),me.isMeshGouraudMaterial&&me.envMap!==null&&(xn.envMap.value=bt,xn.flipEnvMap.value=bt.isCubeTexture&&bt.isRenderTargetTexture===!1?-1:1),me.isMeshStandardMaterial&&me.envMap===null&&le.environment!==null&&(xn.envMapIntensity.value=le.environmentIntensity),Gn&&(yn.setValue(ae,"toneMappingExposure",b.toneMappingExposure),wt.needsLights&&Of(xn,Br),nt&&me.fog===!0&&Ue.refreshFogUniforms(xn,nt),Ue.refreshMaterialUniforms(xn,me,Me,ye,E.state.transmissionRenderTarget[H.id]),bm.upload(ae,Fr(wt),xn,Fe)),me.isShaderMaterial&&me.uniformsNeedUpdate===!0&&(bm.upload(ae,Fr(wt),xn,Fe),me.uniformsNeedUpdate=!1),me.isSpriteMaterial&&yn.setValue(ae,"center",ge.center),yn.setValue(ae,"modelViewMatrix",ge.modelViewMatrix),yn.setValue(ae,"normalMatrix",ge.normalMatrix),yn.setValue(ae,"modelMatrix",ge.matrixWorld),me.isShaderMaterial||me.isRawShaderMaterial){const ii=me.uniformsGroups;for(let Ma=0,wa=ii.length;Ma<wa;Ma++){const Po=ii[Ma];Bt.update(Po,vn),Bt.bind(Po,vn)}}return vn}function Of(H,le){H.ambientLightColor.needsUpdate=le,H.lightProbe.needsUpdate=le,H.directionalLights.needsUpdate=le,H.directionalLightShadows.needsUpdate=le,H.pointLights.needsUpdate=le,H.pointLightShadows.needsUpdate=le,H.spotLights.needsUpdate=le,H.spotLightShadows.needsUpdate=le,H.rectAreaLights.needsUpdate=le,H.hemisphereLights.needsUpdate=le}function kf(H){return H.isMeshLambertMaterial||H.isMeshToonMaterial||H.isMeshPhongMaterial||H.isMeshStandardMaterial||H.isShadowMaterial||H.isShaderMaterial&&H.lights===!0}this.getActiveCubeFace=function(){return B},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return F},this.setRenderTargetTextures=function(H,le,Se){xe.get(H.texture).__webglTexture=le,xe.get(H.depthTexture).__webglTexture=Se;const me=xe.get(H);me.__hasExternalTextures=!0,me.__autoAllocateDepthBuffer=Se===void 0,me.__autoAllocateDepthBuffer||Ae.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),me.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(H,le){const Se=xe.get(H);Se.__webglFramebuffer=le,Se.__useDefaultFramebuffer=le===void 0},this.setRenderTarget=function(H,le=0,Se=0){F=H,B=le,D=Se;let me=!0,ge=null,nt=!1,ht=!1;if(H){const bt=xe.get(H);bt.__useDefaultFramebuffer!==void 0?(De.bindFramebuffer(ae.FRAMEBUFFER,null),me=!1):bt.__webglFramebuffer===void 0?Fe.setupRenderTarget(H):bt.__hasExternalTextures&&Fe.rebindTextures(H,xe.get(H.texture).__webglTexture,xe.get(H.depthTexture).__webglTexture);const kt=H.texture;(kt.isData3DTexture||kt.isDataArrayTexture||kt.isCompressedArrayTexture)&&(ht=!0);const ut=xe.get(H).__webglFramebuffer;H.isWebGLCubeRenderTarget?(Array.isArray(ut[le])?ge=ut[le][Se]:ge=ut[le],nt=!0):H.samples>0&&Fe.useMultisampledRTT(H)===!1?ge=xe.get(H).__webglMultisampledFramebuffer:Array.isArray(ut)?ge=ut[Se]:ge=ut,N.copy(H.viewport),X.copy(H.scissor),te=H.scissorTest}else N.copy(k).multiplyScalar(Me).floor(),X.copy(J).multiplyScalar(Me).floor(),te=Ce;if(De.bindFramebuffer(ae.FRAMEBUFFER,ge)&&me&&De.drawBuffers(H,ge),De.viewport(N),De.scissor(X),De.setScissorTest(te),nt){const bt=xe.get(H.texture);ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_CUBE_MAP_POSITIVE_X+le,bt.__webglTexture,Se)}else if(ht){const bt=xe.get(H.texture),kt=le||0;ae.framebufferTextureLayer(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,bt.__webglTexture,Se||0,kt)}j=-1},this.readRenderTargetPixels=function(H,le,Se,me,ge,nt,ht){if(!(H&&H.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let yt=xe.get(H).__webglFramebuffer;if(H.isWebGLCubeRenderTarget&&ht!==void 0&&(yt=yt[ht]),yt){De.bindFramebuffer(ae.FRAMEBUFFER,yt);try{const bt=H.texture,kt=bt.format,ut=bt.type;if(!Oe.textureFormatReadable(kt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Oe.textureTypeReadable(ut)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}le>=0&&le<=H.width-me&&Se>=0&&Se<=H.height-ge&&ae.readPixels(le,Se,me,ge,ot.convert(kt),ot.convert(ut),nt)}finally{const bt=F!==null?xe.get(F).__webglFramebuffer:null;De.bindFramebuffer(ae.FRAMEBUFFER,bt)}}},this.copyFramebufferToTexture=function(H,le,Se=0){const me=Math.pow(2,-Se),ge=Math.floor(le.image.width*me),nt=Math.floor(le.image.height*me);Fe.setTexture2D(le,0),ae.copyTexSubImage2D(ae.TEXTURE_2D,Se,0,0,H.x,H.y,ge,nt),De.unbindTexture()},this.copyTextureToTexture=function(H,le,Se,me=0){const ge=le.image.width,nt=le.image.height,ht=ot.convert(Se.format),yt=ot.convert(Se.type);Fe.setTexture2D(Se,0),ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,Se.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Se.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,Se.unpackAlignment),le.isDataTexture?ae.texSubImage2D(ae.TEXTURE_2D,me,H.x,H.y,ge,nt,ht,yt,le.image.data):le.isCompressedTexture?ae.compressedTexSubImage2D(ae.TEXTURE_2D,me,H.x,H.y,le.mipmaps[0].width,le.mipmaps[0].height,ht,le.mipmaps[0].data):ae.texSubImage2D(ae.TEXTURE_2D,me,H.x,H.y,ht,yt,le.image),me===0&&Se.generateMipmaps&&ae.generateMipmap(ae.TEXTURE_2D),De.unbindTexture()},this.copyTextureToTexture3D=function(H,le,Se,me,ge=0){const nt=H.max.x-H.min.x,ht=H.max.y-H.min.y,yt=H.max.z-H.min.z,bt=ot.convert(me.format),kt=ot.convert(me.type);let ut;if(me.isData3DTexture)Fe.setTexture3D(me,0),ut=ae.TEXTURE_3D;else if(me.isDataArrayTexture||me.isCompressedArrayTexture)Fe.setTexture2DArray(me,0),ut=ae.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ae.pixelStorei(ae.UNPACK_FLIP_Y_WEBGL,me.flipY),ae.pixelStorei(ae.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),ae.pixelStorei(ae.UNPACK_ALIGNMENT,me.unpackAlignment);const zt=ae.getParameter(ae.UNPACK_ROW_LENGTH),gn=ae.getParameter(ae.UNPACK_IMAGE_HEIGHT),kn=ae.getParameter(ae.UNPACK_SKIP_PIXELS),ni=ae.getParameter(ae.UNPACK_SKIP_ROWS),sr=ae.getParameter(ae.UNPACK_SKIP_IMAGES),Qt=Se.isCompressedTexture?Se.mipmaps[ge]:Se.image;ae.pixelStorei(ae.UNPACK_ROW_LENGTH,Qt.width),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,Qt.height),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,H.min.x),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,H.min.y),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,H.min.z),Se.isDataTexture||Se.isData3DTexture?ae.texSubImage3D(ut,ge,le.x,le.y,le.z,nt,ht,yt,bt,kt,Qt.data):me.isCompressedArrayTexture?ae.compressedTexSubImage3D(ut,ge,le.x,le.y,le.z,nt,ht,yt,bt,Qt.data):ae.texSubImage3D(ut,ge,le.x,le.y,le.z,nt,ht,yt,bt,kt,Qt),ae.pixelStorei(ae.UNPACK_ROW_LENGTH,zt),ae.pixelStorei(ae.UNPACK_IMAGE_HEIGHT,gn),ae.pixelStorei(ae.UNPACK_SKIP_PIXELS,kn),ae.pixelStorei(ae.UNPACK_SKIP_ROWS,ni),ae.pixelStorei(ae.UNPACK_SKIP_IMAGES,sr),ge===0&&me.generateMipmaps&&ae.generateMipmap(ut),De.unbindTexture()},this.initTexture=function(H){H.isCubeTexture?Fe.setTextureCube(H,0):H.isData3DTexture?Fe.setTexture3D(H,0):H.isDataArrayTexture||H.isCompressedArrayTexture?Fe.setTexture2DArray(H,0):Fe.setTexture2D(H,0),De.unbindTexture()},this.resetState=function(){B=0,D=0,F=null,De.reset(),Dt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return wo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Wm?"display-p3":"srgb",t.unpackColorSpace=pn.workingColorSpace===xh?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Ym{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new st(e),this.density=t}clone(){return new Ym(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class qm{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new st(e),this.near=t,this.far=n}clone(){return new qm(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Nm extends cn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ns,this.environmentIntensity=1,this.environmentRotation=new ns,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Zm{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=sh,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=ts()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return mM("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,o=this.stride;i<o;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ts()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ts()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const pr=new G;class es{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)pr.fromBufferAttribute(this,t),pr.applyMatrix4(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)pr.fromBufferAttribute(this,t),pr.applyNormalMatrix(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)pr.fromBufferAttribute(this,t),pr.transformDirection(e),this.setXYZ(t,pr.x,pr.y,pr.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=gr(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=jt(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=jt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=gr(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=gr(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=gr(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=gr(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array),i=jt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,o){return e=e*this.data.stride+this.offset,this.normalized&&(t=jt(t,this.array),n=jt(n,this.array),i=jt(i,this.array),o=jt(o,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=o,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[i+o])}return new mn(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new es(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let o=0;o<this.itemSize;o++)t.push(this.data.array[i+o])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Sy extends Wi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let rf;const Ld=new G,sf=new G,of=new G,af=new Ne,Id=new Ne,LM=new It,Wp=new G,Nd=new G,jp=new G,M_=new Ne,x0=new Ne,w_=new Ne;class IM extends cn{constructor(e=new Sy){if(super(),this.isSprite=!0,this.type="Sprite",rf===void 0){rf=new Zt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Zm(t,5);rf.setIndex([0,1,2,0,2,3]),rf.setAttribute("position",new es(n,3,0,!1)),rf.setAttribute("uv",new es(n,2,3,!1))}this.geometry=rf,this.material=e,this.center=new Ne(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),sf.setFromMatrixScale(this.matrixWorld),LM.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),of.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sf.multiplyScalar(-of.z);const n=this.material.rotation;let i,o;n!==0&&(o=Math.cos(n),i=Math.sin(n));const u=this.center;Xp(Wp.set(-.5,-.5,0),of,u,sf,i,o),Xp(Nd.set(.5,-.5,0),of,u,sf,i,o),Xp(jp.set(.5,.5,0),of,u,sf,i,o),M_.set(0,0),x0.set(1,0),w_.set(1,1);let f=e.ray.intersectTriangle(Wp,Nd,jp,!1,Ld);if(f===null&&(Xp(Nd.set(-.5,.5,0),of,u,sf,i,o),x0.set(0,1),f=e.ray.intersectTriangle(Wp,jp,Nd,!1,Ld),f===null))return;const d=e.ray.origin.distanceTo(Ld);d<e.near||d>e.far||t.push({distance:d,point:Ld.clone(),uv:$r.getInterpolation(Ld,Wp,Nd,jp,M_,x0,w_,new Ne),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Xp(s,e,t,n,i,o){af.subVectors(s,t).addScalar(.5).multiply(n),i!==void 0?(Id.x=o*af.x-i*af.y,Id.y=i*af.x+o*af.y):Id.copy(af),s.copy(e),s.x+=Id.x,s.y+=Id.y,s.applyMatrix4(LM)}const Yp=new G,E_=new G;class NM extends cn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const o=t[n];this.addLevel(o.object.clone(),o.distance,o.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let o;for(o=0;o<i.length&&!(t<i[o].distance);o++);return i.splice(o,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let o=t[n].distance;if(t[n].object.visible&&(o-=o*t[n].hysteresis),e<o)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){Yp.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(Yp);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Yp.setFromMatrixPosition(e.matrixWorld),E_.setFromMatrixPosition(this.matrixWorld);const n=Yp.distanceTo(E_)/e.zoom;t[0].object.visible=!0;let i,o;for(i=1,o=t.length;i<o;i++){let u=t[i].distance;if(t[i].object.visible&&(u-=u*t[i].hysteresis),n>=u)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<o;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,o=n.length;i<o;i++){const u=n[i];t.object.levels.push({object:u.object.uuid,distance:u.distance,hysteresis:u.hysteresis})}return t}}const T_=new G,A_=new nn,C_=new nn,GR=new G,b_=new It,qp=new G,_0=new bi,R_=new It,S0=new Ou;class DM extends ti{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=dv,this.bindMatrix=new It,this.bindMatrixInverse=new It,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ci),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,qp),this.boundingBox.expandByPoint(qp)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new bi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,qp),this.boundingSphere.expandByPoint(qp)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),_0.copy(this.boundingSphere),_0.applyMatrix4(i),e.ray.intersectsSphere(_0)!==!1&&(R_.copy(i).invert(),S0.copy(e.ray).applyMatrix4(R_),!(this.boundingBox!==null&&S0.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,S0)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new nn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===dv?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===WS?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;A_.fromBufferAttribute(i.attributes.skinIndex,e),C_.fromBufferAttribute(i.attributes.skinWeight,e),T_.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let o=0;o<4;o++){const u=C_.getComponent(o);if(u!==0){const f=A_.getComponent(o);b_.multiplyMatrices(n.bones[f].matrixWorld,n.boneInverses[f]),t.addScaledVector(GR.copy(T_).applyMatrix4(b_),u)}}return t.applyMatrix4(this.bindMatrixInverse)}}class My extends cn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class yl extends Vn{constructor(e=null,t=1,n=1,i,o,u,f,d,p=Ai,m=Ai,g,y){super(null,u,f,d,p,m,i,o,g,y),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const P_=new It,WR=new It;class Qm{constructor(e=[],t=[]){this.uuid=ts(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new It)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new It;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let o=0,u=e.length;o<u;o++){const f=e[o]?e[o].matrixWorld:WR;P_.multiplyMatrices(f,t[o]),P_.toArray(n,o*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new Qm(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new yl(t,e,e,kr,_s);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const o=e.bones[n];let u=t[o];u===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),u=new My),this.bones.push(u),this.boneInverses.push(new It().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,o=t.length;i<o;i++){const u=t[i];e.bones.push(u.uuid);const f=n[i];e.boneInverses.push(f.toArray())}return e}}class Tf extends mn{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const lf=new It,L_=new It,Zp=[],I_=new Ci,jR=new It,Dd=new ti,Ud=new bi;class UM extends ti{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Tf(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,jR)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ci),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,lf),I_.copy(e.boundingBox).applyMatrix4(lf),this.boundingBox.union(I_)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new bi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,lf),Ud.copy(e.boundingSphere).applyMatrix4(lf),this.boundingSphere.union(Ud)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,o=n.length+1,u=e*o+1;for(let f=0;f<n.length;f++)n[f]=i[u+f]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Dd.geometry=this.geometry,Dd.material=this.material,Dd.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Ud.copy(this.boundingSphere),Ud.applyMatrix4(n),e.ray.intersectsSphere(Ud)!==!1))for(let o=0;o<i;o++){this.getMatrixAt(o,lf),L_.multiplyMatrices(n,lf),Dd.matrixWorld=L_,Dd.raycast(e,Zp);for(let u=0,f=Zp.length;u<f;u++){const d=Zp[u];d.instanceId=o,d.object=this,t.push(d)}Zp.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Tf(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new yl(new Float32Array(i*this.count),i,this.count,oy,_s));const o=this.morphTexture.source.data.data;let u=0;for(let p=0;p<n.length;p++)u+=n[p];const f=this.geometry.morphTargetsRelative?1:1-u,d=i*e;o[d]=f,o.set(n,d+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function XR(s,e){return s.z-e.z}function YR(s,e){return e.z-s.z}class qR{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const n=this.pool,i=this.list;this.index>=n.length&&n.push({start:-1,count:-1,z:-1});const o=n[this.index];i.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=t}reset(){this.list.length=0,this.index=0}}const uf="batchId",hl=new It,N_=new It,ZR=new It,D_=new It,M0=new Mh,Qp=new Ci,hu=new bi,Od=new G,w0=new qR,tr=new ti,Kp=[];function QR(s,e,t=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const i=s.count;for(let o=0;o<i;o++)for(let u=0;u<n;u++)e.setComponent(o+t,u,s.getComponent(o,u))}else e.array.set(s.array,t*n);e.needsUpdate=!0}class OM extends ti{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,n=t*2,i){super(new Zt,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new yl(t,e,e,kr,_s);this._matricesTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxGeometryCount,o=this._maxIndexCount;if(this._geometryInitialized===!1){for(const f in e.attributes){const d=e.getAttribute(f),{array:p,itemSize:m,normalized:g}=d,y=new p.constructor(n*m),_=new mn(y,m,g);t.setAttribute(f,_)}if(e.getIndex()!==null){const f=n>65536?new Uint32Array(o):new Uint16Array(o);t.setIndex(new mn(f,1))}const u=i>65536?new Uint32Array(n):new Uint16Array(n);t.setAttribute(uf,new mn(u,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(uf))throw new Error(`BatchedMesh: Geometry cannot use attribute "${uf}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(n===uf)continue;if(!e.hasAttribute(n))throw new Error(`BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),o=t.getAttribute(n);if(i.itemSize!==o.itemSize||i.normalized!==o.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ci);const e=this._geometryCount,t=this.boundingBox,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)n[i]!==!1&&(this.getMatrixAt(i,hl),this.getBoundingBoxAt(i,Qp).applyMatrix4(hl),t.union(Qp))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bi);const e=this._geometryCount,t=this.boundingSphere,n=this._active;t.makeEmpty();for(let i=0;i<e;i++)n[i]!==!1&&(this.getMatrixAt(i,hl),this.getBoundingSphereAt(i,hu).applyMatrix4(hl),t.union(hu))}addGeometry(e,t=-1,n=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let o=null;const u=this._reservedRanges,f=this._drawRanges,d=this._bounds;this._geometryCount!==0&&(o=u[u.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,o===null?i.vertexStart=0:i.vertexStart=o.vertexStart+o.vertexCount;const p=e.getIndex(),m=p!==null;if(m&&(n===-1?i.indexCount=p.count:i.indexCount=n,o===null?i.indexStart=0:i.indexStart=o.indexStart+o.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const g=this._visibility,y=this._active,_=this._matricesTexture,M=this._matricesTexture.image.data;g.push(!0),y.push(!0);const A=this._geometryCount;this._geometryCount++,ZR.toArray(M,A*16),_.needsUpdate=!0,u.push(i),f.push({start:m?i.indexStart:i.vertexStart,count:-1}),d.push({boxInitialized:!1,box:new Ci,sphereInitialized:!1,sphere:new bi});const E=this.geometry.getAttribute(uf);for(let S=0;S<i.vertexCount;S++)E.setX(i.vertexStart+S,A);return E.needsUpdate=!0,this.setGeometryAt(A,e),A}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,o=n.getIndex(),u=t.getIndex(),f=this._reservedRanges[e];if(i&&u.count>f.indexCount||t.attributes.position.count>f.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const d=f.vertexStart,p=f.vertexCount;for(const _ in n.attributes){if(_===uf)continue;const M=t.getAttribute(_),A=n.getAttribute(_);QR(M,A,d);const E=M.itemSize;for(let S=M.count,P=p;S<P;S++){const b=d+S;for(let L=0;L<E;L++)A.setComponent(b,L,0)}A.needsUpdate=!0,A.addUpdateRange(d*E,p*E)}if(i){const _=f.indexStart;for(let M=0;M<u.count;M++)o.setX(_+M,d+u.getX(M));for(let M=u.count,A=f.indexCount;M<A;M++)o.setX(_+M,d);o.needsUpdate=!0,o.addUpdateRange(_,f.indexCount)}const m=this._bounds[e];t.boundingBox!==null?(m.box.copy(t.boundingBox),m.boxInitialized=!0):m.boxInitialized=!1,t.boundingSphere!==null?(m.sphere.copy(t.boundingSphere),m.sphereInitialized=!0):m.sphereInitialized=!1;const g=this._drawRanges[e],y=t.getAttribute("position");return g.count=i?u.count:y.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getInstanceCountAt(e){return this._multiDrawInstances===null?null:this._multiDrawInstances[e]}setInstanceCountAt(e,t){return this._multiDrawInstances===null&&(this._multiDrawInstances=new Int32Array(this._maxGeometryCount).fill(1)),this._multiDrawInstances[e]=t,e}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;const i=this._bounds[e],o=i.box,u=this.geometry;if(i.boxInitialized===!1){o.makeEmpty();const f=u.index,d=u.attributes.position,p=this._drawRanges[e];for(let m=p.start,g=p.start+p.count;m<g;m++){let y=m;f&&(y=f.getX(y)),o.expandByPoint(Od.fromBufferAttribute(d,y))}i.boxInitialized=!0}return t.copy(o),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;const i=this._bounds[e],o=i.sphere,u=this.geometry;if(i.sphereInitialized===!1){o.makeEmpty(),this.getBoundingBoxAt(e,Qp),Qp.getCenter(o.center);const f=u.index,d=u.attributes.position,p=this._drawRanges[e];let m=0;for(let g=p.start,y=p.start+p.count;g<y;g++){let _=g;f&&(_=f.getX(_)),Od.fromBufferAttribute(d,_),m=Math.max(m,o.center.distanceToSquared(Od))}o.radius=Math.sqrt(m),i.sphereInitialized=!0}return t.copy(o),t}setMatrixAt(e,t){const n=this._active,i=this._matricesTexture,o=this._matricesTexture.image.data,u=this._geometryCount;return e>=u||n[e]===!1?this:(t.toArray(o,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const n=this._active,i=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||n[e]===!1?null:t.fromArray(i,e*16)}setVisibleAt(e,t){const n=this._visibility,i=this._active,o=this._geometryCount;return e>=o||i[e]===!1||n[e]===t?this:(n[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,n=this._active,i=this._geometryCount;return e>=i||n[e]===!1?!1:t[e]}raycast(e,t){const n=this._visibility,i=this._active,o=this._drawRanges,u=this._geometryCount,f=this.matrixWorld,d=this.geometry;tr.material=this.material,tr.geometry.index=d.index,tr.geometry.attributes=d.attributes,tr.geometry.boundingBox===null&&(tr.geometry.boundingBox=new Ci),tr.geometry.boundingSphere===null&&(tr.geometry.boundingSphere=new bi);for(let p=0;p<u;p++){if(!n[p]||!i[p])continue;const m=o[p];tr.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(p,tr.matrixWorld).premultiply(f),this.getBoundingBoxAt(p,tr.geometry.boundingBox),this.getBoundingSphereAt(p,tr.geometry.boundingSphere),tr.raycast(e,Kp);for(let g=0,y=Kp.length;g<y;g++){const _=Kp[g];_.object=this,_.batchId=p,t.push(_)}Kp.length=0}tr.material=null,tr.geometry.index=null,tr.geometry.attributes={},tr.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,n,i,o){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const u=i.getIndex(),f=u===null?1:u.array.BYTES_PER_ELEMENT,d=this._active,p=this._visibility,m=this._multiDrawStarts,g=this._multiDrawCounts,y=this._drawRanges,_=this.perObjectFrustumCulled;_&&(D_.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),M0.setFromProjectionMatrix(D_,e.coordinateSystem));let M=0;if(this.sortObjects){N_.copy(this.matrixWorld).invert(),Od.setFromMatrixPosition(n.matrixWorld).applyMatrix4(N_);for(let S=0,P=p.length;S<P;S++)if(p[S]&&d[S]){this.getMatrixAt(S,hl),this.getBoundingSphereAt(S,hu).applyMatrix4(hl);let b=!1;if(_&&(b=!M0.intersectsSphere(hu)),!b){const L=Od.distanceTo(hu.center);w0.push(y[S],L)}}const A=w0.list,E=this.customSort;E===null?A.sort(o.transparent?YR:XR):E.call(this,A,n);for(let S=0,P=A.length;S<P;S++){const b=A[S];m[M]=b.start*f,g[M]=b.count,M++}w0.reset()}else for(let A=0,E=p.length;A<E;A++)if(p[A]&&d[A]){let S=!1;if(_&&(this.getMatrixAt(A,hl),this.getBoundingSphereAt(A,hu).applyMatrix4(hl),S=!M0.intersectsSphere(hu)),!S){const P=y[A];m[M]=P.start*f,g[M]=P.count,M++}}this._multiDrawCount=M,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,o,u){this.onBeforeRender(e,null,i,o,u)}}class vr extends Wi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new st(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Dm=new G,Um=new G,U_=new It,kd=new Ou,Jp=new bi,E0=new G,O_=new G;let _l=class extends cn{constructor(e=new Zt,t=new vr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,o=t.count;i<o;i++)Dm.fromBufferAttribute(t,i-1),Um.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Dm.distanceTo(Um);e.setAttribute("lineDistance",new pt(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,o=e.params.Line.threshold,u=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),Jp.copy(n.boundingSphere),Jp.applyMatrix4(i),Jp.radius+=o,e.ray.intersectsSphere(Jp)===!1)return;U_.copy(i).invert(),kd.copy(e.ray).applyMatrix4(U_);const f=o/((this.scale.x+this.scale.y+this.scale.z)/3),d=f*f,p=this.isLineSegments?2:1,m=n.index,y=n.attributes.position;if(m!==null){const _=Math.max(0,u.start),M=Math.min(m.count,u.start+u.count);for(let A=_,E=M-1;A<E;A+=p){const S=m.getX(A),P=m.getX(A+1),b=$p(this,e,kd,d,S,P);b&&t.push(b)}if(this.isLineLoop){const A=m.getX(M-1),E=m.getX(_),S=$p(this,e,kd,d,A,E);S&&t.push(S)}}else{const _=Math.max(0,u.start),M=Math.min(y.count,u.start+u.count);for(let A=_,E=M-1;A<E;A+=p){const S=$p(this,e,kd,d,A,A+1);S&&t.push(S)}if(this.isLineLoop){const A=$p(this,e,kd,d,M-1,_);A&&t.push(A)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=i.length;o<u;o++){const f=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}};function $p(s,e,t,n,i,o){const u=s.geometry.attributes.position;if(Dm.fromBufferAttribute(u,i),Um.fromBufferAttribute(u,o),t.distanceSqToSegment(Dm,Um,E0,O_)>n)return;E0.applyMatrix4(s.matrixWorld);const d=e.ray.origin.distanceTo(E0);if(!(d<e.near||d>e.far))return{distance:d,point:O_.clone().applyMatrix4(s.matrixWorld),index:i,face:null,faceIndex:null,object:s}}const k_=new G,z_=new G;class bo extends _l{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,o=t.count;i<o;i+=2)k_.fromBufferAttribute(t,i),z_.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+k_.distanceTo(z_);e.setAttribute("lineDistance",new pt(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kM extends _l{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class wy extends Wi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const F_=new It,Gv=new Ou,em=new bi,tm=new G;class zM extends cn{constructor(e=new Zt,t=new wy){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,o=e.params.Points.threshold,u=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),em.copy(n.boundingSphere),em.applyMatrix4(i),em.radius+=o,e.ray.intersectsSphere(em)===!1)return;F_.copy(i).invert(),Gv.copy(e.ray).applyMatrix4(F_);const f=o/((this.scale.x+this.scale.y+this.scale.z)/3),d=f*f,p=n.index,g=n.attributes.position;if(p!==null){const y=Math.max(0,u.start),_=Math.min(p.count,u.start+u.count);for(let M=y,A=_;M<A;M++){const E=p.getX(M);tm.fromBufferAttribute(g,E),B_(tm,E,d,i,e,t,this)}}else{const y=Math.max(0,u.start),_=Math.min(g.count,u.start+u.count);for(let M=y,A=_;M<A;M++)tm.fromBufferAttribute(g,M),B_(tm,M,d,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,u=i.length;o<u;o++){const f=i[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}}function B_(s,e,t,n,i,o,u){const f=Gv.distanceSqToPoint(s);if(f<t){const d=new G;Gv.closestPointToPoint(s,d),d.applyMatrix4(n);const p=i.ray.origin.distanceTo(d);if(p<i.near||p>i.far)return;o.push({distance:p,distanceToRay:Math.sqrt(f),point:d,index:e,face:null,object:u})}}class KR extends Vn{constructor(e,t,n,i,o,u,f,d,p){super(e,t,n,i,o,u,f,d,p),this.isVideoTexture=!0,this.minFilter=u!==void 0?u:pi,this.magFilter=o!==void 0?o:pi,this.generateMipmaps=!1;const m=this;function g(){m.needsUpdate=!0,e.requestVideoFrameCallback(g)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(g)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class JR extends Vn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ai,this.minFilter=Ai,this.generateMipmaps=!1,this.needsUpdate=!0}}class Km extends Vn{constructor(e,t,n,i,o,u,f,d,p,m,g,y){super(null,u,f,d,p,m,i,o,g,y),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class $R extends Km{constructor(e,t,n,i,o,u){super(e,t,n,o,u),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=xs}}class eP extends Km{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ga),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class tP extends Vn{constructor(e,t,n,i,o,u,f,d,p){super(e,t,n,i,o,u,f,d,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Zs{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),o=0;t.push(0);for(let u=1;u<=e;u++)n=this.getPoint(u/e),o+=n.distanceTo(i),t.push(o),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const n=this.getLengths();let i=0;const o=n.length;let u;t?u=t:u=e*n[o-1];let f=0,d=o-1,p;for(;f<=d;)if(i=Math.floor(f+(d-f)/2),p=n[i]-u,p<0)f=i+1;else if(p>0)d=i-1;else{d=i;break}if(i=d,n[i]===u)return i/(o-1);const m=n[i],y=n[i+1]-m,_=(u-m)/y;return(i+_)/(o-1)}getTangent(e,t){let i=e-1e-4,o=e+1e-4;i<0&&(i=0),o>1&&(o=1);const u=this.getPoint(i),f=this.getPoint(o),d=t||(u.isVector2?new Ne:new G);return d.copy(f).sub(u).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){const n=new G,i=[],o=[],u=[],f=new G,d=new It;for(let _=0;_<=e;_++){const M=_/e;i[_]=this.getTangentAt(M,new G)}o[0]=new G,u[0]=new G;let p=Number.MAX_VALUE;const m=Math.abs(i[0].x),g=Math.abs(i[0].y),y=Math.abs(i[0].z);m<=p&&(p=m,n.set(1,0,0)),g<=p&&(p=g,n.set(0,1,0)),y<=p&&n.set(0,0,1),f.crossVectors(i[0],n).normalize(),o[0].crossVectors(i[0],f),u[0].crossVectors(i[0],o[0]);for(let _=1;_<=e;_++){if(o[_]=o[_-1].clone(),u[_]=u[_-1].clone(),f.crossVectors(i[_-1],i[_]),f.length()>Number.EPSILON){f.normalize();const M=Math.acos(Yn(i[_-1].dot(i[_]),-1,1));o[_].applyMatrix4(d.makeRotationAxis(f,M))}u[_].crossVectors(i[_],o[_])}if(t===!0){let _=Math.acos(Yn(o[0].dot(o[e]),-1,1));_/=e,i[0].dot(f.crossVectors(o[0],o[e]))>0&&(_=-_);for(let M=1;M<=e;M++)o[M].applyMatrix4(d.makeRotationAxis(i[M],_*M)),u[M].crossVectors(i[M],o[M])}return{tangents:i,normals:o,binormals:u}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Jm extends Zs{constructor(e=0,t=0,n=1,i=1,o=0,u=Math.PI*2,f=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=o,this.aEndAngle=u,this.aClockwise=f,this.aRotation=d}getPoint(e,t=new Ne){const n=t,i=Math.PI*2;let o=this.aEndAngle-this.aStartAngle;const u=Math.abs(o)<Number.EPSILON;for(;o<0;)o+=i;for(;o>i;)o-=i;o<Number.EPSILON&&(u?o=0:o=i),this.aClockwise===!0&&!u&&(o===i?o=-i:o=o-i);const f=this.aStartAngle+e*o;let d=this.aX+this.xRadius*Math.cos(f),p=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){const m=Math.cos(this.aRotation),g=Math.sin(this.aRotation),y=d-this.aX,_=p-this.aY;d=y*m-_*g+this.aX,p=y*g+_*m+this.aY}return n.set(d,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class FM extends Jm{constructor(e,t,n,i,o,u){super(e,t,n,n,i,o,u),this.isArcCurve=!0,this.type="ArcCurve"}}function Ey(){let s=0,e=0,t=0,n=0;function i(o,u,f,d){s=o,e=f,t=-3*o+3*u-2*f-d,n=2*o-2*u+f+d}return{initCatmullRom:function(o,u,f,d,p){i(u,f,p*(f-o),p*(d-u))},initNonuniformCatmullRom:function(o,u,f,d,p,m,g){let y=(u-o)/p-(f-o)/(p+m)+(f-u)/m,_=(f-u)/m-(d-u)/(m+g)+(d-f)/g;y*=m,_*=m,i(u,f,y,_)},calc:function(o){const u=o*o,f=u*o;return s+e*o+t*u+n*f}}}const nm=new G,T0=new Ey,A0=new Ey,C0=new Ey;class BM extends Zs{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new G){const n=t,i=this.points,o=i.length,u=(o-(this.closed?0:1))*e;let f=Math.floor(u),d=u-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/o)+1)*o:d===0&&f===o-1&&(f=o-2,d=1);let p,m;this.closed||f>0?p=i[(f-1)%o]:(nm.subVectors(i[0],i[1]).add(i[0]),p=nm);const g=i[f%o],y=i[(f+1)%o];if(this.closed||f+2<o?m=i[(f+2)%o]:(nm.subVectors(i[o-1],i[o-2]).add(i[o-1]),m=nm),this.curveType==="centripetal"||this.curveType==="chordal"){const _=this.curveType==="chordal"?.5:.25;let M=Math.pow(p.distanceToSquared(g),_),A=Math.pow(g.distanceToSquared(y),_),E=Math.pow(y.distanceToSquared(m),_);A<1e-4&&(A=1),M<1e-4&&(M=A),E<1e-4&&(E=A),T0.initNonuniformCatmullRom(p.x,g.x,y.x,m.x,M,A,E),A0.initNonuniformCatmullRom(p.y,g.y,y.y,m.y,M,A,E),C0.initNonuniformCatmullRom(p.z,g.z,y.z,m.z,M,A,E)}else this.curveType==="catmullrom"&&(T0.initCatmullRom(p.x,g.x,y.x,m.x,this.tension),A0.initCatmullRom(p.y,g.y,y.y,m.y,this.tension),C0.initCatmullRom(p.z,g.z,y.z,m.z,this.tension));return n.set(T0.calc(d),A0.calc(d),C0.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new G().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function H_(s,e,t,n,i){const o=(n-e)*.5,u=(i-t)*.5,f=s*s,d=s*f;return(2*t-2*n+o+u)*d+(-3*t+3*n-2*o-u)*f+o*s+t}function nP(s,e){const t=1-s;return t*t*e}function iP(s,e){return 2*(1-s)*s*e}function rP(s,e){return s*s*e}function Xd(s,e,t,n){return nP(s,e)+iP(s,t)+rP(s,n)}function sP(s,e){const t=1-s;return t*t*t*e}function oP(s,e){const t=1-s;return 3*t*t*s*e}function aP(s,e){return 3*(1-s)*s*s*e}function lP(s,e){return s*s*s*e}function Yd(s,e,t,n,i){return sP(s,e)+oP(s,t)+aP(s,n)+lP(s,i)}class Ty extends Zs{constructor(e=new Ne,t=new Ne,n=new Ne,i=new Ne){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new Ne){const n=t,i=this.v0,o=this.v1,u=this.v2,f=this.v3;return n.set(Yd(e,i.x,o.x,u.x,f.x),Yd(e,i.y,o.y,u.y,f.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class HM extends Zs{constructor(e=new G,t=new G,n=new G,i=new G){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new G){const n=t,i=this.v0,o=this.v1,u=this.v2,f=this.v3;return n.set(Yd(e,i.x,o.x,u.x,f.x),Yd(e,i.y,o.y,u.y,f.y),Yd(e,i.z,o.z,u.z,f.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Ay extends Zs{constructor(e=new Ne,t=new Ne){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ne){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ne){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class VM extends Zs{constructor(e=new G,t=new G){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new G){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new G){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Cy extends Zs{constructor(e=new Ne,t=new Ne,n=new Ne){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Ne){const n=t,i=this.v0,o=this.v1,u=this.v2;return n.set(Xd(e,i.x,o.x,u.x),Xd(e,i.y,o.y,u.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class by extends Zs{constructor(e=new G,t=new G,n=new G){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new G){const n=t,i=this.v0,o=this.v1,u=this.v2;return n.set(Xd(e,i.x,o.x,u.x),Xd(e,i.y,o.y,u.y),Xd(e,i.z,o.z,u.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Ry extends Zs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ne){const n=t,i=this.points,o=(i.length-1)*e,u=Math.floor(o),f=o-u,d=i[u===0?u:u-1],p=i[u],m=i[u>i.length-2?i.length-1:u+1],g=i[u>i.length-3?i.length-1:u+2];return n.set(H_(f,d.x,p.x,m.x,g.x),H_(f,d.y,p.y,m.y,g.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new Ne().fromArray(i))}return this}}var Om=Object.freeze({__proto__:null,ArcCurve:FM,CatmullRomCurve3:BM,CubicBezierCurve:Ty,CubicBezierCurve3:HM,EllipseCurve:Jm,LineCurve:Ay,LineCurve3:VM,QuadraticBezierCurve:Cy,QuadraticBezierCurve3:by,SplineCurve:Ry});class GM extends Zs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Om[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let o=0;for(;o<i.length;){if(i[o]>=n){const u=i[o]-n,f=this.curves[o],d=f.getLength(),p=d===0?0:1-u/d;return f.getPointAt(p,t)}o++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,o=this.curves;i<o.length;i++){const u=o[i],f=u.isEllipseCurve?e*2:u.isLineCurve||u.isLineCurve3?1:u.isSplineCurve?e*u.points.length:e,d=u.getPoints(f);for(let p=0;p<d.length;p++){const m=d[p];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new Om[i.type]().fromJSON(i))}return this}}class uh extends GM{constructor(e){super(),this.type="Path",this.currentPoint=new Ne,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new Ay(this.currentPoint.clone(),new Ne(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const o=new Cy(this.currentPoint.clone(),new Ne(e,t),new Ne(n,i));return this.curves.push(o),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,o,u){const f=new Ty(this.currentPoint.clone(),new Ne(e,t),new Ne(n,i),new Ne(o,u));return this.curves.push(f),this.currentPoint.set(o,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new Ry(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,o,u){const f=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+f,t+d,n,i,o,u),this}absarc(e,t,n,i,o,u){return this.absellipse(e,t,n,n,i,o,u),this}ellipse(e,t,n,i,o,u,f,d){const p=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+p,t+m,n,i,o,u,f,d),this}absellipse(e,t,n,i,o,u,f,d){const p=new Jm(e,t,n,i,o,u,f,d);if(this.curves.length>0){const g=p.getPoint(0);g.equals(this.currentPoint)||this.lineTo(g.x,g.y)}this.curves.push(p);const m=p.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class wh extends Zt{constructor(e=[new Ne(0,-.5),new Ne(.5,0),new Ne(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Yn(i,0,Math.PI*2);const o=[],u=[],f=[],d=[],p=[],m=1/t,g=new G,y=new Ne,_=new G,M=new G,A=new G;let E=0,S=0;for(let P=0;P<=e.length-1;P++)switch(P){case 0:E=e[P+1].x-e[P].x,S=e[P+1].y-e[P].y,_.x=S*1,_.y=-E,_.z=S*0,A.copy(_),_.normalize(),d.push(_.x,_.y,_.z);break;case e.length-1:d.push(A.x,A.y,A.z);break;default:E=e[P+1].x-e[P].x,S=e[P+1].y-e[P].y,_.x=S*1,_.y=-E,_.z=S*0,M.copy(_),_.x+=A.x,_.y+=A.y,_.z+=A.z,_.normalize(),d.push(_.x,_.y,_.z),A.copy(M)}for(let P=0;P<=t;P++){const b=n+P*m*i,L=Math.sin(b),B=Math.cos(b);for(let D=0;D<=e.length-1;D++){g.x=e[D].x*L,g.y=e[D].y,g.z=e[D].x*B,u.push(g.x,g.y,g.z),y.x=P/t,y.y=D/(e.length-1),f.push(y.x,y.y);const F=d[3*D+0]*L,j=d[3*D+1],O=d[3*D+0]*B;p.push(F,j,O)}}for(let P=0;P<t;P++)for(let b=0;b<e.length-1;b++){const L=b+P*e.length,B=L,D=L+e.length,F=L+e.length+1,j=L+1;o.push(B,D,j),o.push(F,j,D)}this.setIndex(o),this.setAttribute("position",new pt(u,3)),this.setAttribute("uv",new pt(f,2)),this.setAttribute("normal",new pt(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wh(e.points,e.segments,e.phiStart,e.phiLength)}}class $m extends wh{constructor(e=1,t=1,n=4,i=8){const o=new uh;o.absarc(0,-t/2,e,Math.PI*1.5,0),o.absarc(0,t/2,e,0,Math.PI*.5),super(o.getPoints(n),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:n,radialSegments:i}}static fromJSON(e){return new $m(e.radius,e.length,e.capSegments,e.radialSegments)}}class eg extends Zt{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const o=[],u=[],f=[],d=[],p=new G,m=new Ne;u.push(0,0,0),f.push(0,0,1),d.push(.5,.5);for(let g=0,y=3;g<=t;g++,y+=3){const _=n+g/t*i;p.x=e*Math.cos(_),p.y=e*Math.sin(_),u.push(p.x,p.y,p.z),f.push(0,0,1),m.x=(u[y]/e+1)/2,m.y=(u[y+1]/e+1)/2,d.push(m.x,m.y)}for(let g=1;g<=t;g++)o.push(g,g+1,0);this.setIndex(o),this.setAttribute("position",new pt(u,3)),this.setAttribute("normal",new pt(f,3)),this.setAttribute("uv",new pt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new eg(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Nf extends Zt{constructor(e=1,t=1,n=1,i=32,o=1,u=!1,f=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:o,openEnded:u,thetaStart:f,thetaLength:d};const p=this;i=Math.floor(i),o=Math.floor(o);const m=[],g=[],y=[],_=[];let M=0;const A=[],E=n/2;let S=0;P(),u===!1&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(m),this.setAttribute("position",new pt(g,3)),this.setAttribute("normal",new pt(y,3)),this.setAttribute("uv",new pt(_,2));function P(){const L=new G,B=new G;let D=0;const F=(t-e)/n;for(let j=0;j<=o;j++){const O=[],N=j/o,X=N*(t-e)+e;for(let te=0;te<=i;te++){const Q=te/i,ue=Q*d+f,fe=Math.sin(ue),ye=Math.cos(ue);B.x=X*fe,B.y=-N*n+E,B.z=X*ye,g.push(B.x,B.y,B.z),L.set(fe,F,ye).normalize(),y.push(L.x,L.y,L.z),_.push(Q,1-N),O.push(M++)}A.push(O)}for(let j=0;j<i;j++)for(let O=0;O<o;O++){const N=A[O][j],X=A[O+1][j],te=A[O+1][j+1],Q=A[O][j+1];m.push(N,X,Q),m.push(X,te,Q),D+=6}p.addGroup(S,D,0),S+=D}function b(L){const B=M,D=new Ne,F=new G;let j=0;const O=L===!0?e:t,N=L===!0?1:-1;for(let te=1;te<=i;te++)g.push(0,E*N,0),y.push(0,N,0),_.push(.5,.5),M++;const X=M;for(let te=0;te<=i;te++){const ue=te/i*d+f,fe=Math.cos(ue),ye=Math.sin(ue);F.x=O*ye,F.y=E*N,F.z=O*fe,g.push(F.x,F.y,F.z),y.push(0,N,0),D.x=fe*.5+.5,D.y=ye*.5*N+.5,_.push(D.x,D.y),M++}for(let te=0;te<i;te++){const Q=B+te,ue=X+te;L===!0?m.push(ue,ue+1,Q):m.push(ue+1,ue,Q),j+=3}p.addGroup(S,j,L===!0?1:2),S+=j}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nf(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class tg extends Nf{constructor(e=1,t=1,n=32,i=1,o=!1,u=0,f=Math.PI*2){super(0,e,t,n,i,o,u,f),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:u,thetaLength:f}}static fromJSON(e){return new tg(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class wl extends Zt{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const o=[],u=[];f(i),p(n),m(),this.setAttribute("position",new pt(o,3)),this.setAttribute("normal",new pt(o.slice(),3)),this.setAttribute("uv",new pt(u,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function f(P){const b=new G,L=new G,B=new G;for(let D=0;D<t.length;D+=3)_(t[D+0],b),_(t[D+1],L),_(t[D+2],B),d(b,L,B,P)}function d(P,b,L,B){const D=B+1,F=[];for(let j=0;j<=D;j++){F[j]=[];const O=P.clone().lerp(L,j/D),N=b.clone().lerp(L,j/D),X=D-j;for(let te=0;te<=X;te++)te===0&&j===D?F[j][te]=O:F[j][te]=O.clone().lerp(N,te/X)}for(let j=0;j<D;j++)for(let O=0;O<2*(D-j)-1;O++){const N=Math.floor(O/2);O%2===0?(y(F[j][N+1]),y(F[j+1][N]),y(F[j][N])):(y(F[j][N+1]),y(F[j+1][N+1]),y(F[j+1][N]))}}function p(P){const b=new G;for(let L=0;L<o.length;L+=3)b.x=o[L+0],b.y=o[L+1],b.z=o[L+2],b.normalize().multiplyScalar(P),o[L+0]=b.x,o[L+1]=b.y,o[L+2]=b.z}function m(){const P=new G;for(let b=0;b<o.length;b+=3){P.x=o[b+0],P.y=o[b+1],P.z=o[b+2];const L=E(P)/2/Math.PI+.5,B=S(P)/Math.PI+.5;u.push(L,1-B)}M(),g()}function g(){for(let P=0;P<u.length;P+=6){const b=u[P+0],L=u[P+2],B=u[P+4],D=Math.max(b,L,B),F=Math.min(b,L,B);D>.9&&F<.1&&(b<.2&&(u[P+0]+=1),L<.2&&(u[P+2]+=1),B<.2&&(u[P+4]+=1))}}function y(P){o.push(P.x,P.y,P.z)}function _(P,b){const L=P*3;b.x=e[L+0],b.y=e[L+1],b.z=e[L+2]}function M(){const P=new G,b=new G,L=new G,B=new G,D=new Ne,F=new Ne,j=new Ne;for(let O=0,N=0;O<o.length;O+=9,N+=6){P.set(o[O+0],o[O+1],o[O+2]),b.set(o[O+3],o[O+4],o[O+5]),L.set(o[O+6],o[O+7],o[O+8]),D.set(u[N+0],u[N+1]),F.set(u[N+2],u[N+3]),j.set(u[N+4],u[N+5]),B.copy(P).add(b).add(L).divideScalar(3);const X=E(B);A(D,N+0,P,X),A(F,N+2,b,X),A(j,N+4,L,X)}}function A(P,b,L,B){B<0&&P.x===1&&(u[b]=P.x-1),L.x===0&&L.z===0&&(u[b]=B/2/Math.PI+.5)}function E(P){return Math.atan2(P.z,-P.x)}function S(P){return Math.atan2(-P.y,Math.sqrt(P.x*P.x+P.z*P.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wl(e.vertices,e.indices,e.radius,e.details)}}class ng extends wl{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,o=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],u=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(o,u,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ng(e.radius,e.detail)}}const im=new G,rm=new G,b0=new G,sm=new $r;class Py extends Zt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),o=Math.cos(Pu*t),u=e.getIndex(),f=e.getAttribute("position"),d=u?u.count:f.count,p=[0,0,0],m=["a","b","c"],g=new Array(3),y={},_=[];for(let M=0;M<d;M+=3){u?(p[0]=u.getX(M),p[1]=u.getX(M+1),p[2]=u.getX(M+2)):(p[0]=M,p[1]=M+1,p[2]=M+2);const{a:A,b:E,c:S}=sm;if(A.fromBufferAttribute(f,p[0]),E.fromBufferAttribute(f,p[1]),S.fromBufferAttribute(f,p[2]),sm.getNormal(b0),g[0]=`${Math.round(A.x*i)},${Math.round(A.y*i)},${Math.round(A.z*i)}`,g[1]=`${Math.round(E.x*i)},${Math.round(E.y*i)},${Math.round(E.z*i)}`,g[2]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,!(g[0]===g[1]||g[1]===g[2]||g[2]===g[0]))for(let P=0;P<3;P++){const b=(P+1)%3,L=g[P],B=g[b],D=sm[m[P]],F=sm[m[b]],j=`${L}_${B}`,O=`${B}_${L}`;O in y&&y[O]?(b0.dot(y[O].normal)<=o&&(_.push(D.x,D.y,D.z),_.push(F.x,F.y,F.z)),y[O]=null):j in y||(y[j]={index0:p[P],index1:p[b],normal:b0.clone()})}}for(const M in y)if(y[M]){const{index0:A,index1:E}=y[M];im.fromBufferAttribute(f,A),rm.fromBufferAttribute(f,E),_.push(im.x,im.y,im.z),_.push(rm.x,rm.y,rm.z)}this.setAttribute("position",new pt(_,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Iu extends uh{constructor(e){super(e),this.uuid=ts(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new uh().fromJSON(i))}return this}}const uP={triangulate:function(s,e,t=2){const n=e&&e.length,i=n?e[0]*t:s.length;let o=WM(s,0,i,t,!0);const u=[];if(!o||o.next===o.prev)return u;let f,d,p,m,g,y,_;if(n&&(o=pP(s,e,o,t)),s.length>80*t){f=p=s[0],d=m=s[1];for(let M=t;M<i;M+=t)g=s[M],y=s[M+1],g<f&&(f=g),y<d&&(d=y),g>p&&(p=g),y>m&&(m=y);_=Math.max(p-f,m-d),_=_!==0?32767/_:0}return ch(o,u,t,f,d,_,0),u}};function WM(s,e,t,n,i){let o,u;if(i===TP(s,e,t,n)>0)for(o=e;o<t;o+=n)u=V_(o,s[o],s[o+1],u);else for(o=t-n;o>=e;o-=n)u=V_(o,s[o],s[o+1],u);return u&&ig(u,u.next)&&(dh(u),u=u.next),u}function Uu(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(ig(t,t.next)||Hn(t.prev,t,t.next)===0)){if(dh(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function ch(s,e,t,n,i,o,u){if(!s)return;!u&&o&&xP(s,n,i,o);let f=s,d,p;for(;s.prev!==s.next;){if(d=s.prev,p=s.next,o?fP(s,n,i,o):cP(s)){e.push(d.i/t|0),e.push(s.i/t|0),e.push(p.i/t|0),dh(s),s=p.next,f=p.next;continue}if(s=p,s===f){u?u===1?(s=dP(Uu(s),e,t),ch(s,e,t,n,i,o,2)):u===2&&hP(s,e,t,n,i,o):ch(Uu(s),e,t,n,i,o,1);break}}}function cP(s){const e=s.prev,t=s,n=s.next;if(Hn(e,t,n)>=0)return!1;const i=e.x,o=t.x,u=n.x,f=e.y,d=t.y,p=n.y,m=i<o?i<u?i:u:o<u?o:u,g=f<d?f<p?f:p:d<p?d:p,y=i>o?i>u?i:u:o>u?o:u,_=f>d?f>p?f:p:d>p?d:p;let M=n.next;for(;M!==e;){if(M.x>=m&&M.x<=y&&M.y>=g&&M.y<=_&&xf(i,f,o,d,u,p,M.x,M.y)&&Hn(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function fP(s,e,t,n){const i=s.prev,o=s,u=s.next;if(Hn(i,o,u)>=0)return!1;const f=i.x,d=o.x,p=u.x,m=i.y,g=o.y,y=u.y,_=f<d?f<p?f:p:d<p?d:p,M=m<g?m<y?m:y:g<y?g:y,A=f>d?f>p?f:p:d>p?d:p,E=m>g?m>y?m:y:g>y?g:y,S=Wv(_,M,e,t,n),P=Wv(A,E,e,t,n);let b=s.prevZ,L=s.nextZ;for(;b&&b.z>=S&&L&&L.z<=P;){if(b.x>=_&&b.x<=A&&b.y>=M&&b.y<=E&&b!==i&&b!==u&&xf(f,m,d,g,p,y,b.x,b.y)&&Hn(b.prev,b,b.next)>=0||(b=b.prevZ,L.x>=_&&L.x<=A&&L.y>=M&&L.y<=E&&L!==i&&L!==u&&xf(f,m,d,g,p,y,L.x,L.y)&&Hn(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;b&&b.z>=S;){if(b.x>=_&&b.x<=A&&b.y>=M&&b.y<=E&&b!==i&&b!==u&&xf(f,m,d,g,p,y,b.x,b.y)&&Hn(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;L&&L.z<=P;){if(L.x>=_&&L.x<=A&&L.y>=M&&L.y<=E&&L!==i&&L!==u&&xf(f,m,d,g,p,y,L.x,L.y)&&Hn(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function dP(s,e,t){let n=s;do{const i=n.prev,o=n.next.next;!ig(i,o)&&jM(i,n,n.next,o)&&fh(i,o)&&fh(o,i)&&(e.push(i.i/t|0),e.push(n.i/t|0),e.push(o.i/t|0),dh(n),dh(n.next),n=s=o),n=n.next}while(n!==s);return Uu(n)}function hP(s,e,t,n,i,o){let u=s;do{let f=u.next.next;for(;f!==u.prev;){if(u.i!==f.i&&MP(u,f)){let d=XM(u,f);u=Uu(u,u.next),d=Uu(d,d.next),ch(u,e,t,n,i,o,0),ch(d,e,t,n,i,o,0);return}f=f.next}u=u.next}while(u!==s)}function pP(s,e,t,n){const i=[];let o,u,f,d,p;for(o=0,u=e.length;o<u;o++)f=e[o]*n,d=o<u-1?e[o+1]*n:s.length,p=WM(s,f,d,n,!1),p===p.next&&(p.steiner=!0),i.push(SP(p));for(i.sort(mP),o=0;o<i.length;o++)t=gP(i[o],t);return t}function mP(s,e){return s.x-e.x}function gP(s,e){const t=vP(s,e);if(!t)return e;const n=XM(t,s);return Uu(n,n.next),Uu(t,t.next)}function vP(s,e){let t=e,n=-1/0,i;const o=s.x,u=s.y;do{if(u<=t.y&&u>=t.next.y&&t.next.y!==t.y){const y=t.x+(u-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(y<=o&&y>n&&(n=y,i=t.x<t.next.x?t:t.next,y===o))return i}t=t.next}while(t!==e);if(!i)return null;const f=i,d=i.x,p=i.y;let m=1/0,g;t=i;do o>=t.x&&t.x>=d&&o!==t.x&&xf(u<p?o:n,u,d,p,u<p?n:o,u,t.x,t.y)&&(g=Math.abs(u-t.y)/(o-t.x),fh(t,s)&&(g<m||g===m&&(t.x>i.x||t.x===i.x&&yP(i,t)))&&(i=t,m=g)),t=t.next;while(t!==f);return i}function yP(s,e){return Hn(s.prev,s,e.prev)<0&&Hn(e.next,s,s.next)<0}function xP(s,e,t,n){let i=s;do i.z===0&&(i.z=Wv(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,_P(i)}function _P(s){let e,t,n,i,o,u,f,d,p=1;do{for(t=s,s=null,o=null,u=0;t;){for(u++,n=t,f=0,e=0;e<p&&(f++,n=n.nextZ,!!n);e++);for(d=p;f>0||d>0&&n;)f!==0&&(d===0||!n||t.z<=n.z)?(i=t,t=t.nextZ,f--):(i=n,n=n.nextZ,d--),o?o.nextZ=i:s=i,i.prevZ=o,o=i;t=n}o.nextZ=null,p*=2}while(u>1);return s}function Wv(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function SP(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function xf(s,e,t,n,i,o,u,f){return(i-u)*(e-f)>=(s-u)*(o-f)&&(s-u)*(n-f)>=(t-u)*(e-f)&&(t-u)*(o-f)>=(i-u)*(n-f)}function MP(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!wP(s,e)&&(fh(s,e)&&fh(e,s)&&EP(s,e)&&(Hn(s.prev,s,e.prev)||Hn(s,e.prev,e))||ig(s,e)&&Hn(s.prev,s,s.next)>0&&Hn(e.prev,e,e.next)>0)}function Hn(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function ig(s,e){return s.x===e.x&&s.y===e.y}function jM(s,e,t,n){const i=am(Hn(s,e,t)),o=am(Hn(s,e,n)),u=am(Hn(t,n,s)),f=am(Hn(t,n,e));return!!(i!==o&&u!==f||i===0&&om(s,t,e)||o===0&&om(s,n,e)||u===0&&om(t,s,n)||f===0&&om(t,e,n))}function om(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function am(s){return s>0?1:s<0?-1:0}function wP(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&jM(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function fh(s,e){return Hn(s.prev,s,s.next)<0?Hn(s,e,s.next)>=0&&Hn(s,s.prev,e)>=0:Hn(s,e,s.prev)<0||Hn(s,s.next,e)<0}function EP(s,e){let t=s,n=!1;const i=(s.x+e.x)/2,o=(s.y+e.y)/2;do t.y>o!=t.next.y>o&&t.next.y!==t.y&&i<(t.next.x-t.x)*(o-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function XM(s,e){const t=new jv(s.i,s.x,s.y),n=new jv(e.i,e.x,e.y),i=s.next,o=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,o.next=n,n.prev=o,n}function V_(s,e,t,n){const i=new jv(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function dh(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function jv(s,e,t){this.i=s,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function TP(s,e,t,n){let i=0;for(let o=e,u=t-n;o<t;o+=n)i+=(s[u]-s[o])*(s[o+1]+s[u+1]),u=o;return i}class To{static area(e){const t=e.length;let n=0;for(let i=t-1,o=0;o<t;i=o++)n+=e[i].x*e[o].y-e[o].x*e[i].y;return n*.5}static isClockWise(e){return To.area(e)<0}static triangulateShape(e,t){const n=[],i=[],o=[];G_(e),W_(n,e);let u=e.length;t.forEach(G_);for(let d=0;d<t.length;d++)i.push(u),u+=t[d].length,W_(n,t[d]);const f=uP.triangulate(n,i);for(let d=0;d<f.length;d+=3)o.push(f.slice(d,d+3));return o}}function G_(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function W_(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class rg extends Zt{constructor(e=new Iu([new Ne(.5,.5),new Ne(-.5,.5),new Ne(-.5,-.5),new Ne(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],o=[];for(let f=0,d=e.length;f<d;f++){const p=e[f];u(p)}this.setAttribute("position",new pt(i,3)),this.setAttribute("uv",new pt(o,2)),this.computeVertexNormals();function u(f){const d=[],p=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,g=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,_=t.bevelThickness!==void 0?t.bevelThickness:.2,M=t.bevelSize!==void 0?t.bevelSize:_-.1,A=t.bevelOffset!==void 0?t.bevelOffset:0,E=t.bevelSegments!==void 0?t.bevelSegments:3;const S=t.extrudePath,P=t.UVGenerator!==void 0?t.UVGenerator:AP;let b,L=!1,B,D,F,j;S&&(b=S.getSpacedPoints(m),L=!0,y=!1,B=S.computeFrenetFrames(m,!1),D=new G,F=new G,j=new G),y||(E=0,_=0,M=0,A=0);const O=f.extractPoints(p);let N=O.shape;const X=O.holes;if(!To.isClockWise(N)){N=N.reverse();for(let Ae=0,Oe=X.length;Ae<Oe;Ae++){const De=X[Ae];To.isClockWise(De)&&(X[Ae]=De.reverse())}}const Q=To.triangulateShape(N,X),ue=N;for(let Ae=0,Oe=X.length;Ae<Oe;Ae++){const De=X[Ae];N=N.concat(De)}function fe(Ae,Oe,De){return Oe||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ae.clone().addScaledVector(Oe,De)}const ye=N.length,Me=Q.length;function W(Ae,Oe,De){let Xe,xe,Fe;const $e=Ae.x-Oe.x,q=Ae.y-Oe.y,z=De.x-Ae.x,de=De.y-Ae.y,Ie=$e*$e+q*q,ze=$e*de-q*z;if(Math.abs(ze)>Number.EPSILON){const Ue=Math.sqrt(Ie),vt=Math.sqrt(z*z+de*de),Je=Oe.x-q/Ue,Ke=Oe.y+$e/Ue,Ct=De.x-de/vt,qe=De.y+z/vt,ft=((Ct-Je)*de-(qe-Ke)*z)/($e*de-q*z);Xe=Je+$e*ft-Ae.x,xe=Ke+q*ft-Ae.y;const Nt=Xe*Xe+xe*xe;if(Nt<=2)return new Ne(Xe,xe);Fe=Math.sqrt(Nt/2)}else{let Ue=!1;$e>Number.EPSILON?z>Number.EPSILON&&(Ue=!0):$e<-Number.EPSILON?z<-Number.EPSILON&&(Ue=!0):Math.sign(q)===Math.sign(de)&&(Ue=!0),Ue?(Xe=-q,xe=$e,Fe=Math.sqrt(Ie)):(Xe=$e,xe=q,Fe=Math.sqrt(Ie/2))}return new Ne(Xe/Fe,xe/Fe)}const ee=[];for(let Ae=0,Oe=ue.length,De=Oe-1,Xe=Ae+1;Ae<Oe;Ae++,De++,Xe++)De===Oe&&(De=0),Xe===Oe&&(Xe=0),ee[Ae]=W(ue[Ae],ue[De],ue[Xe]);const k=[];let J,Ce=ee.concat();for(let Ae=0,Oe=X.length;Ae<Oe;Ae++){const De=X[Ae];J=[];for(let Xe=0,xe=De.length,Fe=xe-1,$e=Xe+1;Xe<xe;Xe++,Fe++,$e++)Fe===xe&&(Fe=0),$e===xe&&($e=0),J[Xe]=W(De[Xe],De[Fe],De[$e]);k.push(J),Ce=Ce.concat(J)}for(let Ae=0;Ae<E;Ae++){const Oe=Ae/E,De=_*Math.cos(Oe*Math.PI/2),Xe=M*Math.sin(Oe*Math.PI/2)+A;for(let xe=0,Fe=ue.length;xe<Fe;xe++){const $e=fe(ue[xe],ee[xe],Xe);Le($e.x,$e.y,-De)}for(let xe=0,Fe=X.length;xe<Fe;xe++){const $e=X[xe];J=k[xe];for(let q=0,z=$e.length;q<z;q++){const de=fe($e[q],J[q],Xe);Le(de.x,de.y,-De)}}}const Ve=M+A;for(let Ae=0;Ae<ye;Ae++){const Oe=y?fe(N[Ae],Ce[Ae],Ve):N[Ae];L?(F.copy(B.normals[0]).multiplyScalar(Oe.x),D.copy(B.binormals[0]).multiplyScalar(Oe.y),j.copy(b[0]).add(F).add(D),Le(j.x,j.y,j.z)):Le(Oe.x,Oe.y,0)}for(let Ae=1;Ae<=m;Ae++)for(let Oe=0;Oe<ye;Oe++){const De=y?fe(N[Oe],Ce[Oe],Ve):N[Oe];L?(F.copy(B.normals[Ae]).multiplyScalar(De.x),D.copy(B.binormals[Ae]).multiplyScalar(De.y),j.copy(b[Ae]).add(F).add(D),Le(j.x,j.y,j.z)):Le(De.x,De.y,g/m*Ae)}for(let Ae=E-1;Ae>=0;Ae--){const Oe=Ae/E,De=_*Math.cos(Oe*Math.PI/2),Xe=M*Math.sin(Oe*Math.PI/2)+A;for(let xe=0,Fe=ue.length;xe<Fe;xe++){const $e=fe(ue[xe],ee[xe],Xe);Le($e.x,$e.y,g+De)}for(let xe=0,Fe=X.length;xe<Fe;xe++){const $e=X[xe];J=k[xe];for(let q=0,z=$e.length;q<z;q++){const de=fe($e[q],J[q],Xe);L?Le(de.x,de.y+b[m-1].y,b[m-1].x+De):Le(de.x,de.y,g+De)}}}se(),Re();function se(){const Ae=i.length/3;if(y){let Oe=0,De=ye*Oe;for(let Xe=0;Xe<Me;Xe++){const xe=Q[Xe];tt(xe[2]+De,xe[1]+De,xe[0]+De)}Oe=m+E*2,De=ye*Oe;for(let Xe=0;Xe<Me;Xe++){const xe=Q[Xe];tt(xe[0]+De,xe[1]+De,xe[2]+De)}}else{for(let Oe=0;Oe<Me;Oe++){const De=Q[Oe];tt(De[2],De[1],De[0])}for(let Oe=0;Oe<Me;Oe++){const De=Q[Oe];tt(De[0]+ye*m,De[1]+ye*m,De[2]+ye*m)}}n.addGroup(Ae,i.length/3-Ae,0)}function Re(){const Ae=i.length/3;let Oe=0;ke(ue,Oe),Oe+=ue.length;for(let De=0,Xe=X.length;De<Xe;De++){const xe=X[De];ke(xe,Oe),Oe+=xe.length}n.addGroup(Ae,i.length/3-Ae,1)}function ke(Ae,Oe){let De=Ae.length;for(;--De>=0;){const Xe=De;let xe=De-1;xe<0&&(xe=Ae.length-1);for(let Fe=0,$e=m+E*2;Fe<$e;Fe++){const q=ye*Fe,z=ye*(Fe+1),de=Oe+Xe+q,Ie=Oe+xe+q,ze=Oe+xe+z,Ue=Oe+Xe+z;xt(de,Ie,ze,Ue)}}}function Le(Ae,Oe,De){d.push(Ae),d.push(Oe),d.push(De)}function tt(Ae,Oe,De){ae(Ae),ae(Oe),ae(De);const Xe=i.length/3,xe=P.generateTopUV(n,i,Xe-3,Xe-2,Xe-1);Mt(xe[0]),Mt(xe[1]),Mt(xe[2])}function xt(Ae,Oe,De,Xe){ae(Ae),ae(Oe),ae(Xe),ae(Oe),ae(De),ae(Xe);const xe=i.length/3,Fe=P.generateSideWallUV(n,i,xe-6,xe-3,xe-2,xe-1);Mt(Fe[0]),Mt(Fe[1]),Mt(Fe[3]),Mt(Fe[1]),Mt(Fe[2]),Mt(Fe[3])}function ae(Ae){i.push(d[Ae*3+0]),i.push(d[Ae*3+1]),i.push(d[Ae*3+2])}function Mt(Ae){o.push(Ae.x),o.push(Ae.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return CP(t,n,e)}static fromJSON(e,t){const n=[];for(let o=0,u=e.shapes.length;o<u;o++){const f=t[e.shapes[o]];n.push(f)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new Om[i.type]().fromJSON(i)),new rg(n,e.options)}}const AP={generateTopUV:function(s,e,t,n,i){const o=e[t*3],u=e[t*3+1],f=e[n*3],d=e[n*3+1],p=e[i*3],m=e[i*3+1];return[new Ne(o,u),new Ne(f,d),new Ne(p,m)]},generateSideWallUV:function(s,e,t,n,i,o){const u=e[t*3],f=e[t*3+1],d=e[t*3+2],p=e[n*3],m=e[n*3+1],g=e[n*3+2],y=e[i*3],_=e[i*3+1],M=e[i*3+2],A=e[o*3],E=e[o*3+1],S=e[o*3+2];return Math.abs(f-m)<Math.abs(u-p)?[new Ne(u,1-d),new Ne(p,1-g),new Ne(y,1-M),new Ne(A,1-S)]:[new Ne(f,1-d),new Ne(m,1-g),new Ne(_,1-M),new Ne(E,1-S)]}};function CP(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,i=s.length;n<i;n++){const o=s[n];t.shapes.push(o.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class sg extends wl{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],o=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,o,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sg(e.radius,e.detail)}}class Eh extends wl{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Eh(e.radius,e.detail)}}class og extends Zt{constructor(e=.5,t=1,n=32,i=1,o=0,u=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:o,thetaLength:u},n=Math.max(3,n),i=Math.max(1,i);const f=[],d=[],p=[],m=[];let g=e;const y=(t-e)/i,_=new G,M=new Ne;for(let A=0;A<=i;A++){for(let E=0;E<=n;E++){const S=o+E/n*u;_.x=g*Math.cos(S),_.y=g*Math.sin(S),d.push(_.x,_.y,_.z),p.push(0,0,1),M.x=(_.x/t+1)/2,M.y=(_.y/t+1)/2,m.push(M.x,M.y)}g+=y}for(let A=0;A<i;A++){const E=A*(n+1);for(let S=0;S<n;S++){const P=S+E,b=P,L=P+n+1,B=P+n+2,D=P+1;f.push(b,L,D),f.push(L,B,D)}}this.setIndex(f),this.setAttribute("position",new pt(d,3)),this.setAttribute("normal",new pt(p,3)),this.setAttribute("uv",new pt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new og(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class ag extends Zt{constructor(e=new Iu([new Ne(0,.5),new Ne(-.5,-.5),new Ne(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],o=[],u=[];let f=0,d=0;if(Array.isArray(e)===!1)p(e);else for(let m=0;m<e.length;m++)p(e[m]),this.addGroup(f,d,m),f+=d,d=0;this.setIndex(n),this.setAttribute("position",new pt(i,3)),this.setAttribute("normal",new pt(o,3)),this.setAttribute("uv",new pt(u,2));function p(m){const g=i.length/3,y=m.extractPoints(t);let _=y.shape;const M=y.holes;To.isClockWise(_)===!1&&(_=_.reverse());for(let E=0,S=M.length;E<S;E++){const P=M[E];To.isClockWise(P)===!0&&(M[E]=P.reverse())}const A=To.triangulateShape(_,M);for(let E=0,S=M.length;E<S;E++){const P=M[E];_=_.concat(P)}for(let E=0,S=_.length;E<S;E++){const P=_[E];i.push(P.x,P.y,0),o.push(0,0,1),u.push(P.x,P.y)}for(let E=0,S=A.length;E<S;E++){const P=A[E],b=P[0]+g,L=P[1]+g,B=P[2]+g;n.push(b,L,B),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return bP(t,e)}static fromJSON(e,t){const n=[];for(let i=0,o=e.shapes.length;i<o;i++){const u=t[e.shapes[i]];n.push(u)}return new ag(n,e.curveSegments)}}function bP(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){const i=s[t];e.shapes.push(i.uuid)}else e.shapes.push(s.uuid);return e}class Th extends Zt{constructor(e=1,t=32,n=16,i=0,o=Math.PI*2,u=0,f=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:o,thetaStart:u,thetaLength:f},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(u+f,Math.PI);let p=0;const m=[],g=new G,y=new G,_=[],M=[],A=[],E=[];for(let S=0;S<=n;S++){const P=[],b=S/n;let L=0;S===0&&u===0?L=.5/t:S===n&&d===Math.PI&&(L=-.5/t);for(let B=0;B<=t;B++){const D=B/t;g.x=-e*Math.cos(i+D*o)*Math.sin(u+b*f),g.y=e*Math.cos(u+b*f),g.z=e*Math.sin(i+D*o)*Math.sin(u+b*f),M.push(g.x,g.y,g.z),y.copy(g).normalize(),A.push(y.x,y.y,y.z),E.push(D+L,1-b),P.push(p++)}m.push(P)}for(let S=0;S<n;S++)for(let P=0;P<t;P++){const b=m[S][P+1],L=m[S][P],B=m[S+1][P],D=m[S+1][P+1];(S!==0||u>0)&&_.push(b,L,D),(S!==n-1||d<Math.PI)&&_.push(L,B,D)}this.setIndex(_),this.setAttribute("position",new pt(M,3)),this.setAttribute("normal",new pt(A,3)),this.setAttribute("uv",new pt(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Th(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class lg extends wl{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new lg(e.radius,e.detail)}}class ug extends Zt{constructor(e=1,t=.4,n=12,i=48,o=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:o},n=Math.floor(n),i=Math.floor(i);const u=[],f=[],d=[],p=[],m=new G,g=new G,y=new G;for(let _=0;_<=n;_++)for(let M=0;M<=i;M++){const A=M/i*o,E=_/n*Math.PI*2;g.x=(e+t*Math.cos(E))*Math.cos(A),g.y=(e+t*Math.cos(E))*Math.sin(A),g.z=t*Math.sin(E),f.push(g.x,g.y,g.z),m.x=e*Math.cos(A),m.y=e*Math.sin(A),y.subVectors(g,m).normalize(),d.push(y.x,y.y,y.z),p.push(M/i),p.push(_/n)}for(let _=1;_<=n;_++)for(let M=1;M<=i;M++){const A=(i+1)*_+M-1,E=(i+1)*(_-1)+M-1,S=(i+1)*(_-1)+M,P=(i+1)*_+M;u.push(A,E,P),u.push(E,S,P)}this.setIndex(u),this.setAttribute("position",new pt(f,3)),this.setAttribute("normal",new pt(d,3)),this.setAttribute("uv",new pt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ug(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class cg extends Zt{constructor(e=1,t=.4,n=64,i=8,o=2,u=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:o,q:u},n=Math.floor(n),i=Math.floor(i);const f=[],d=[],p=[],m=[],g=new G,y=new G,_=new G,M=new G,A=new G,E=new G,S=new G;for(let b=0;b<=n;++b){const L=b/n*o*Math.PI*2;P(L,o,u,e,_),P(L+.01,o,u,e,M),E.subVectors(M,_),S.addVectors(M,_),A.crossVectors(E,S),S.crossVectors(A,E),A.normalize(),S.normalize();for(let B=0;B<=i;++B){const D=B/i*Math.PI*2,F=-t*Math.cos(D),j=t*Math.sin(D);g.x=_.x+(F*S.x+j*A.x),g.y=_.y+(F*S.y+j*A.y),g.z=_.z+(F*S.z+j*A.z),d.push(g.x,g.y,g.z),y.subVectors(g,_).normalize(),p.push(y.x,y.y,y.z),m.push(b/n),m.push(B/i)}}for(let b=1;b<=n;b++)for(let L=1;L<=i;L++){const B=(i+1)*(b-1)+(L-1),D=(i+1)*b+(L-1),F=(i+1)*b+L,j=(i+1)*(b-1)+L;f.push(B,D,j),f.push(D,F,j)}this.setIndex(f),this.setAttribute("position",new pt(d,3)),this.setAttribute("normal",new pt(p,3)),this.setAttribute("uv",new pt(m,2));function P(b,L,B,D,F){const j=Math.cos(b),O=Math.sin(b),N=B/L*b,X=Math.cos(N);F.x=D*(2+X)*.5*j,F.y=D*(2+X)*O*.5,F.z=D*Math.sin(N)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cg(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class fg extends Zt{constructor(e=new by(new G(-1,-1,0),new G(-1,1,0),new G(1,1,0)),t=64,n=1,i=8,o=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:o};const u=e.computeFrenetFrames(t,o);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;const f=new G,d=new G,p=new Ne;let m=new G;const g=[],y=[],_=[],M=[];A(),this.setIndex(M),this.setAttribute("position",new pt(g,3)),this.setAttribute("normal",new pt(y,3)),this.setAttribute("uv",new pt(_,2));function A(){for(let b=0;b<t;b++)E(b);E(o===!1?t:0),P(),S()}function E(b){m=e.getPointAt(b/t,m);const L=u.normals[b],B=u.binormals[b];for(let D=0;D<=i;D++){const F=D/i*Math.PI*2,j=Math.sin(F),O=-Math.cos(F);d.x=O*L.x+j*B.x,d.y=O*L.y+j*B.y,d.z=O*L.z+j*B.z,d.normalize(),y.push(d.x,d.y,d.z),f.x=m.x+n*d.x,f.y=m.y+n*d.y,f.z=m.z+n*d.z,g.push(f.x,f.y,f.z)}}function S(){for(let b=1;b<=t;b++)for(let L=1;L<=i;L++){const B=(i+1)*(b-1)+(L-1),D=(i+1)*b+(L-1),F=(i+1)*b+L,j=(i+1)*(b-1)+L;M.push(B,D,j),M.push(D,F,j)}}function P(){for(let b=0;b<=t;b++)for(let L=0;L<=i;L++)p.x=b/t,p.y=L/i,_.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new fg(new Om[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Ly extends Zt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new G,o=new G;if(e.index!==null){const u=e.attributes.position,f=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:f.count,materialIndex:0}]);for(let p=0,m=d.length;p<m;++p){const g=d[p],y=g.start,_=g.count;for(let M=y,A=y+_;M<A;M+=3)for(let E=0;E<3;E++){const S=f.getX(M+E),P=f.getX(M+(E+1)%3);i.fromBufferAttribute(u,S),o.fromBufferAttribute(u,P),j_(i,o,n)===!0&&(t.push(i.x,i.y,i.z),t.push(o.x,o.y,o.z))}}}else{const u=e.attributes.position;for(let f=0,d=u.count/3;f<d;f++)for(let p=0;p<3;p++){const m=3*f+p,g=3*f+(p+1)%3;i.fromBufferAttribute(u,m),o.fromBufferAttribute(u,g),j_(i,o,n)===!0&&(t.push(i.x,i.y,i.z),t.push(o.x,o.y,o.z))}}this.setAttribute("position",new pt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function j_(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var X_=Object.freeze({__proto__:null,BoxGeometry:ku,CapsuleGeometry:$m,CircleGeometry:eg,ConeGeometry:tg,CylinderGeometry:Nf,DodecahedronGeometry:ng,EdgesGeometry:Py,ExtrudeGeometry:rg,IcosahedronGeometry:sg,LatheGeometry:wh,OctahedronGeometry:Eh,PlaneGeometry:Lf,PolyhedronGeometry:wl,RingGeometry:og,ShapeGeometry:ag,SphereGeometry:Th,TetrahedronGeometry:lg,TorusGeometry:ug,TorusKnotGeometry:cg,TubeGeometry:fg,WireframeGeometry:Ly});class YM extends Wi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new st(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class qM extends is{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Iy extends Wi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new st(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sl,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ZM extends Iy{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ne(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Yn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new st(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new st(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new st(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class QM extends Wi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new st(16777215),this.specular=new st(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sl,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class KM extends Wi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new st(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sl,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class JM extends Wi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sl,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class $M extends Wi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sl,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ns,this.combine=vh,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class ew extends Wi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new st(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Sl,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class tw extends vr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Cu(s,e,t){return!s||!t&&s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function nw(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function iw(s){function e(i,o){return s[i]-s[o]}const t=s.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function Xv(s,e,t){const n=s.length,i=new s.constructor(n);for(let o=0,u=0;u!==n;++o){const f=t[o]*e;for(let d=0;d!==e;++d)i[u++]=s[f+d]}return i}function Ny(s,e,t,n){let i=1,o=s[0];for(;o!==void 0&&o[n]===void 0;)o=s[i++];if(o===void 0)return;let u=o[n];if(u!==void 0)if(Array.isArray(u))do u=o[n],u!==void 0&&(e.push(o.time),t.push.apply(t,u)),o=s[i++];while(o!==void 0);else if(u.toArray!==void 0)do u=o[n],u!==void 0&&(e.push(o.time),u.toArray(t,t.length)),o=s[i++];while(o!==void 0);else do u=o[n],u!==void 0&&(e.push(o.time),t.push(u)),o=s[i++];while(o!==void 0)}function RP(s,e,t,n,i=30){const o=s.clone();o.name=e;const u=[];for(let d=0;d<o.tracks.length;++d){const p=o.tracks[d],m=p.getValueSize(),g=[],y=[];for(let _=0;_<p.times.length;++_){const M=p.times[_]*i;if(!(M<t||M>=n)){g.push(p.times[_]);for(let A=0;A<m;++A)y.push(p.values[_*m+A])}}g.length!==0&&(p.times=Cu(g,p.times.constructor),p.values=Cu(y,p.values.constructor),u.push(p))}o.tracks=u;let f=1/0;for(let d=0;d<o.tracks.length;++d)f>o.tracks[d].times[0]&&(f=o.tracks[d].times[0]);for(let d=0;d<o.tracks.length;++d)o.tracks[d].shift(-1*f);return o.resetDuration(),o}function PP(s,e=0,t=s,n=30){n<=0&&(n=30);const i=t.tracks.length,o=e/n;for(let u=0;u<i;++u){const f=t.tracks[u],d=f.ValueTypeName;if(d==="bool"||d==="string")continue;const p=s.tracks.find(function(S){return S.name===f.name&&S.ValueTypeName===d});if(p===void 0)continue;let m=0;const g=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=g/3);let y=0;const _=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=_/3);const M=f.times.length-1;let A;if(o<=f.times[0]){const S=m,P=g-m;A=f.values.slice(S,P)}else if(o>=f.times[M]){const S=M*g+m,P=S+g-m;A=f.values.slice(S,P)}else{const S=f.createInterpolant(),P=m,b=g-m;S.evaluate(o),A=S.resultBuffer.slice(P,b)}d==="quaternion"&&new ir().fromArray(A).normalize().conjugate().toArray(A);const E=p.times.length;for(let S=0;S<E;++S){const P=S*_+y;if(d==="quaternion")ir.multiplyQuaternionsFlat(p.values,P,A,0,p.values,P);else{const b=_-y*2;for(let L=0;L<b;++L)p.values[P+L]-=A[L]}}}return s.blendMode=cy,s}const LP={convertArray:Cu,isTypedArray:nw,getKeyframeOrder:iw,sortedArray:Xv,flattenJSON:Ny,subclip:RP,makeClipAdditive:PP};class Ah{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],o=t[n-1];e:{t:{let u;n:{i:if(!(e<i)){for(let f=n+2;;){if(i===void 0){if(e<o)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===f)break;if(o=i,i=t[++n],e<i)break t}u=t.length;break n}if(!(e>=o)){const f=t[1];e<f&&(n=2,o=f);for(let d=n-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(i=o,o=t[--n-1],e>=o)break t}u=n,n=0;break n}break e}for(;n<u;){const f=n+u>>>1;e<t[f]?u=f:n=f+1}if(i=t[n],o=t[n-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,o,i)}return this.interpolate_(n,o,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,o=e*i;for(let u=0;u!==i;++u)t[u]=n[o+u];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class rw extends Ah{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Eu,endingEnd:Eu}}intervalChanged_(e,t,n){const i=this.parameterPositions;let o=e-2,u=e+1,f=i[o],d=i[u];if(f===void 0)switch(this.getSettings_().endingStart){case Tu:o=e,f=2*t-n;break;case th:o=i.length-2,f=t+i[o]-i[o+1];break;default:o=e,f=n}if(d===void 0)switch(this.getSettings_().endingEnd){case Tu:u=e,d=2*n-t;break;case th:u=1,d=n+i[1]-i[0];break;default:u=e-1,d=t}const p=(n-t)*.5,m=this.valueSize;this._weightPrev=p/(t-f),this._weightNext=p/(d-n),this._offsetPrev=o*m,this._offsetNext=u*m}interpolate_(e,t,n,i){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,d=e*f,p=d-f,m=this._offsetPrev,g=this._offsetNext,y=this._weightPrev,_=this._weightNext,M=(n-t)/(i-t),A=M*M,E=A*M,S=-y*E+2*y*A-y*M,P=(1+y)*E+(-1.5-2*y)*A+(-.5+y)*M+1,b=(-1-_)*E+(1.5+_)*A+.5*M,L=_*E-_*A;for(let B=0;B!==f;++B)o[B]=S*u[m+B]+P*u[p+B]+b*u[d+B]+L*u[g+B];return o}}class Dy extends Ah{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,d=e*f,p=d-f,m=(n-t)/(i-t),g=1-m;for(let y=0;y!==f;++y)o[y]=u[p+y]*g+u[d+y]*m;return o}}class sw extends Ah{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Qs{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Cu(t,this.TimeBufferType),this.values=Cu(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:Cu(e.times,Array),values:Cu(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new sw(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Dy(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new rw(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case $d:t=this.InterpolantFactoryMethodDiscrete;break;case eh:t=this.InterpolantFactoryMethodLinear;break;case Cm:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return $d;case this.InterpolantFactoryMethodLinear:return eh;case this.InterpolantFactoryMethodSmooth:return Cm}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let o=0,u=i-1;for(;o!==i&&n[o]<e;)++o;for(;u!==-1&&n[u]>t;)--u;if(++u,o!==0||u!==i){o>=u&&(u=Math.max(u,1),o=u-1);const f=this.getValueSize();this.times=n.slice(o,u),this.values=this.values.slice(o*f,u*f)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,o=n.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let f=0;f!==o;f++){const d=n[f];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,d),e=!1;break}if(u!==null&&u>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,d,u),e=!1;break}u=d}if(i!==void 0&&nw(i))for(let f=0,d=i.length;f!==d;++f){const p=i[f];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===Cm,o=e.length-1;let u=1;for(let f=1;f<o;++f){let d=!1;const p=e[f],m=e[f+1];if(p!==m&&(f!==1||p!==e[0]))if(i)d=!0;else{const g=f*n,y=g-n,_=g+n;for(let M=0;M!==n;++M){const A=t[g+M];if(A!==t[y+M]||A!==t[_+M]){d=!0;break}}}if(d){if(f!==u){e[u]=e[f];const g=f*n,y=u*n;for(let _=0;_!==n;++_)t[y+_]=t[g+_]}++u}}if(o>0){e[u]=e[o];for(let f=o*n,d=u*n,p=0;p!==n;++p)t[d+p]=t[f+p];++u}return u!==e.length?(this.times=e.slice(0,u),this.values=t.slice(0,u*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Qs.prototype.TimeBufferType=Float32Array;Qs.prototype.ValueBufferType=Float32Array;Qs.prototype.DefaultInterpolation=eh;class zu extends Qs{}zu.prototype.ValueTypeName="bool";zu.prototype.ValueBufferType=Array;zu.prototype.DefaultInterpolation=$d;zu.prototype.InterpolantFactoryMethodLinear=void 0;zu.prototype.InterpolantFactoryMethodSmooth=void 0;class Uy extends Qs{}Uy.prototype.ValueTypeName="color";class hh extends Qs{}hh.prototype.ValueTypeName="number";class ow extends Ah{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const o=this.resultBuffer,u=this.sampleValues,f=this.valueSize,d=(n-t)/(i-t);let p=e*f;for(let m=p+f;p!==m;p+=4)ir.slerpFlat(o,0,u,p-f,u,p,d);return o}}class Df extends Qs{InterpolantFactoryMethodLinear(e){return new ow(this.times,this.values,this.getValueSize(),e)}}Df.prototype.ValueTypeName="quaternion";Df.prototype.DefaultInterpolation=eh;Df.prototype.InterpolantFactoryMethodSmooth=void 0;class Fu extends Qs{}Fu.prototype.ValueTypeName="string";Fu.prototype.ValueBufferType=Array;Fu.prototype.DefaultInterpolation=$d;Fu.prototype.InterpolantFactoryMethodLinear=void 0;Fu.prototype.InterpolantFactoryMethodSmooth=void 0;class ph extends Qs{}ph.prototype.ValueTypeName="vector";class mh{constructor(e="",t=-1,n=[],i=Gm){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=ts(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let u=0,f=n.length;u!==f;++u)t.push(NP(n[u]).scale(i));const o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let o=0,u=n.length;o!==u;++o)t.push(Qs.toJSON(n[o]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const o=t.length,u=[];for(let f=0;f<o;f++){let d=[],p=[];d.push((f+o-1)%o,f,(f+1)%o),p.push(0,1,0);const m=iw(d);d=Xv(d,1,m),p=Xv(p,1,m),!i&&d[0]===0&&(d.push(o),p.push(p[0])),u.push(new hh(".morphTargetInfluences["+t[f].name+"]",d,p).scale(1/n))}return new this(e,-1,u)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},o=/^([\w-]*?)([\d]+)$/;for(let f=0,d=e.length;f<d;f++){const p=e[f],m=p.name.match(o);if(m&&m.length>1){const g=m[1];let y=i[g];y||(i[g]=y=[]),y.push(p)}}const u=[];for(const f in i)u.push(this.CreateFromMorphTargetSequence(f,i[f],t,n));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(g,y,_,M,A){if(_.length!==0){const E=[],S=[];Ny(_,E,S,M),E.length!==0&&A.push(new g(y,E,S))}},i=[],o=e.name||"default",u=e.fps||30,f=e.blendMode;let d=e.length||-1;const p=e.hierarchy||[];for(let g=0;g<p.length;g++){const y=p[g].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const _={};let M;for(M=0;M<y.length;M++)if(y[M].morphTargets)for(let A=0;A<y[M].morphTargets.length;A++)_[y[M].morphTargets[A]]=-1;for(const A in _){const E=[],S=[];for(let P=0;P!==y[M].morphTargets.length;++P){const b=y[M];E.push(b.time),S.push(b.morphTarget===A?1:0)}i.push(new hh(".morphTargetInfluence["+A+"]",E,S))}d=_.length*u}else{const _=".bones["+t[g].name+"]";n(ph,_+".position",y,"pos",i),n(Df,_+".quaternion",y,"rot",i),n(ph,_+".scale",y,"scl",i)}}return i.length===0?null:new this(o,d,i,f)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const o=this.tracks[n];t=Math.max(t,o.times[o.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function IP(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hh;case"vector":case"vector2":case"vector3":case"vector4":return ph;case"color":return Uy;case"quaternion":return Df;case"bool":case"boolean":return zu;case"string":return Fu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function NP(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=IP(s.type);if(s.times===void 0){const t=[],n=[];Ny(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const ha={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class Oy{constructor(e,t,n){const i=this;let o=!1,u=0,f=0,d;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(m){f++,o===!1&&i.onStart!==void 0&&i.onStart(m,u,f),o=!0},this.itemEnd=function(m){u++,i.onProgress!==void 0&&i.onProgress(m,u,f),u===f&&(o=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(m){i.onError!==void 0&&i.onError(m)},this.resolveURL=function(m){return d?d(m):m},this.setURLModifier=function(m){return d=m,this},this.addHandler=function(m,g){return p.push(m,g),this},this.removeHandler=function(m){const g=p.indexOf(m);return g!==-1&&p.splice(g,2),this},this.getHandler=function(m){for(let g=0,y=p.length;g<y;g+=2){const _=p[g],M=p[g+1];if(_.global&&(_.lastIndex=0),_.test(m))return M}return null}}}const aw=new Oy;class zr{constructor(e){this.manager=e!==void 0?e:aw,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,o){n.load(e,i,t,o)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}zr.DEFAULT_MATERIAL_NAME="__DEFAULT";const ua={};class DP extends Error{constructor(e,t){super(e),this.response=t}}class va extends zr{constructor(e){super(e)}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=ha.get(e);if(o!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(o),this.manager.itemEnd(e)},0),o;if(ua[e]!==void 0){ua[e].push({onLoad:t,onProgress:n,onError:i});return}ua[e]=[],ua[e].push({onLoad:t,onProgress:n,onError:i});const u=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),f=this.mimeType,d=this.responseType;fetch(u).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const m=ua[e],g=p.body.getReader(),y=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),_=y?parseInt(y):0,M=_!==0;let A=0;const E=new ReadableStream({start(S){P();function P(){g.read().then(({done:b,value:L})=>{if(b)S.close();else{A+=L.byteLength;const B=new ProgressEvent("progress",{lengthComputable:M,loaded:A,total:_});for(let D=0,F=m.length;D<F;D++){const j=m[D];j.onProgress&&j.onProgress(B)}S.enqueue(L),P()}})}}});return new Response(E)}else throw new DP(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(m=>new DOMParser().parseFromString(m,f));case"json":return p.json();default:if(f===void 0)return p.text();{const g=/charset="?([^;"\s]*)"?/i.exec(f),y=g&&g[1]?g[1].toLowerCase():void 0,_=new TextDecoder(y);return p.arrayBuffer().then(M=>_.decode(M))}}}).then(p=>{ha.add(e,p);const m=ua[e];delete ua[e];for(let g=0,y=m.length;g<y;g++){const _=m[g];_.onLoad&&_.onLoad(p)}}).catch(p=>{const m=ua[e];if(m===void 0)throw this.manager.itemError(e),p;delete ua[e];for(let g=0,y=m.length;g<y;g++){const _=m[g];_.onError&&_.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class UP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=this,u=new va(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(f){try{t(o.parse(JSON.parse(f)))}catch(d){i?i(d):console.error(d),o.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=mh.parse(e[n]);t.push(i)}return t}}class OP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=this,u=[],f=new Km,d=new va(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(o.withCredentials);let p=0;function m(g){d.load(e[g],function(y){const _=o.parse(y,!0);u[g]={width:_.width,height:_.height,format:_.format,mipmaps:_.mipmaps},p+=1,p===6&&(_.mipmapCount===1&&(f.minFilter=pi),f.image=u,f.format=_.format,f.needsUpdate=!0,t&&t(f))},n,i)}if(Array.isArray(e))for(let g=0,y=e.length;g<y;++g)m(g);else d.load(e,function(g){const y=o.parse(g,!0);if(y.isCubemap){const _=y.mipmaps.length/y.mipmapCount;for(let M=0;M<_;M++){u[M]={mipmaps:[]};for(let A=0;A<y.mipmapCount;A++)u[M].mipmaps.push(y.mipmaps[M*y.mipmapCount+A]),u[M].format=y.format,u[M].width=y.width,u[M].height=y.height}f.image=u}else f.image.width=y.width,f.image.height=y.height,f.mipmaps=y.mipmaps;y.mipmapCount===1&&(f.minFilter=pi),f.format=y.format,f.needsUpdate=!0,t&&t(f)},n,i);return f}}class gh extends zr{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,u=ha.get(e);if(u!==void 0)return o.manager.itemStart(e),setTimeout(function(){t&&t(u),o.manager.itemEnd(e)},0),u;const f=ah("img");function d(){m(),ha.add(e,this),t&&t(this),o.manager.itemEnd(e)}function p(g){m(),i&&i(g),o.manager.itemError(e),o.manager.itemEnd(e)}function m(){f.removeEventListener("load",d,!1),f.removeEventListener("error",p,!1)}return f.addEventListener("load",d,!1),f.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),o.manager.itemStart(e),f.src=e,f}}class kP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=new Sh;o.colorSpace=vs;const u=new gh(this.manager);u.setCrossOrigin(this.crossOrigin),u.setPath(this.path);let f=0;function d(p){u.load(e[p],function(m){o.images[p]=m,f++,f===6&&(o.needsUpdate=!0,t&&t(o))},void 0,i)}for(let p=0;p<e.length;++p)d(p);return o}}class zP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=this,u=new yl,f=new va(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(o.withCredentials),f.load(e,function(d){let p;try{p=o.parse(d)}catch(m){if(i!==void 0)i(m);else{console.error(m);return}}p.image!==void 0?u.image=p.image:p.data!==void 0&&(u.image.width=p.width,u.image.height=p.height,u.image.data=p.data),u.wrapS=p.wrapS!==void 0?p.wrapS:xs,u.wrapT=p.wrapT!==void 0?p.wrapT:xs,u.magFilter=p.magFilter!==void 0?p.magFilter:pi,u.minFilter=p.minFilter!==void 0?p.minFilter:pi,u.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(u.colorSpace=p.colorSpace),p.flipY!==void 0&&(u.flipY=p.flipY),p.format!==void 0&&(u.format=p.format),p.type!==void 0&&(u.type=p.type),p.mipmaps!==void 0&&(u.mipmaps=p.mipmaps,u.minFilter=Mo),p.mipmapCount===1&&(u.minFilter=pi),p.generateMipmaps!==void 0&&(u.generateMipmaps=p.generateMipmaps),u.needsUpdate=!0,t&&t(u,p)},n,i),u}}class FP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=new Vn,u=new gh(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(e,function(f){o.image=f,o.needsUpdate=!0,t!==void 0&&t(o)},n,i),o}}class El extends cn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new st(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class lw extends El{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(cn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new st(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const R0=new It,Y_=new G,q_=new G;class ky{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ne(512,512),this.map=null,this.mapPass=null,this.matrix=new It,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Mh,this._frameExtents=new Ne(1,1),this._viewportCount=1,this._viewports=[new nn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Y_.setFromMatrixPosition(e.matrixWorld),t.position.copy(Y_),q_.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(q_),t.updateMatrixWorld(),R0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R0),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(R0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class BP extends ky{constructor(){super(new ei(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=wf*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,o=e.distance||t.far;(n!==t.fov||i!==t.aspect||o!==t.far)&&(t.fov=n,t.aspect=i,t.far=o,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class uw extends El{constructor(e,t,n=0,i=Math.PI/3,o=0,u=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(cn.DEFAULT_UP),this.updateMatrix(),this.target=new cn,this.distance=n,this.angle=i,this.penumbra=o,this.decay=u,this.map=null,this.shadow=new BP}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Z_=new It,zd=new G,P0=new G;class HP extends ky{constructor(){super(new ei(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ne(4,2),this._viewportCount=6,this._viewports=[new nn(2,1,1,1),new nn(0,1,1,1),new nn(3,1,1,1),new nn(1,1,1,1),new nn(3,0,1,1),new nn(1,0,1,1)],this._cubeDirections=[new G(1,0,0),new G(-1,0,0),new G(0,0,1),new G(0,0,-1),new G(0,1,0),new G(0,-1,0)],this._cubeUps=[new G(0,1,0),new G(0,1,0),new G(0,1,0),new G(0,1,0),new G(0,0,1),new G(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,o=e.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),zd.setFromMatrixPosition(e.matrixWorld),n.position.copy(zd),P0.copy(n.position),P0.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(P0),n.updateMatrixWorld(),i.makeTranslation(-zd.x,-zd.y,-zd.z),Z_.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Z_)}}class cw extends El{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new HP}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class VP extends ky{constructor(){super(new vl(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class fw extends El{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(cn.DEFAULT_UP),this.updateMatrix(),this.target=new cn,this.shadow=new VP}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class dw extends El{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class hw extends El{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class pw{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new G)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,o=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*i),t.addScaledVector(u[2],.488603*o),t.addScaledVector(u[3],.488603*n),t.addScaledVector(u[4],1.092548*(n*i)),t.addScaledVector(u[5],1.092548*(i*o)),t.addScaledVector(u[6],.315392*(3*o*o-1)),t.addScaledVector(u[7],1.092548*(n*o)),t.addScaledVector(u[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,o=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],2*.511664*i),t.addScaledVector(u[2],2*.511664*o),t.addScaledVector(u[3],2*.511664*n),t.addScaledVector(u[4],2*.429043*n*i),t.addScaledVector(u[5],2*.429043*i*o),t.addScaledVector(u[6],.743125*o*o-.247708),t.addScaledVector(u[7],2*.429043*n*o),t.addScaledVector(u[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,o=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*o,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*n*o,t[8]=.546274*(n*n-i*i)}}class mw extends El{constructor(e=new pw,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class dg extends zr{constructor(e){super(e),this.textures={}}load(e,t,n,i){const o=this,u=new va(o.manager);u.setPath(o.path),u.setRequestHeader(o.requestHeader),u.setWithCredentials(o.withCredentials),u.load(e,function(f){try{t(o.parse(JSON.parse(f)))}catch(d){i?i(d):console.error(d),o.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(o){return t[o]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",o),t[o]}const i=dg.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new st().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const o in e.uniforms){const u=e.uniforms[o];switch(i.uniforms[o]={},u.type){case"t":i.uniforms[o].value=n(u.value);break;case"c":i.uniforms[o].value=new st().setHex(u.value);break;case"v2":i.uniforms[o].value=new Ne().fromArray(u.value);break;case"v3":i.uniforms[o].value=new G().fromArray(u.value);break;case"v4":i.uniforms[o].value=new nn().fromArray(u.value);break;case"m3":i.uniforms[o].value=new Wt().fromArray(u.value);break;case"m4":i.uniforms[o].value=new It().fromArray(u.value);break;default:i.uniforms[o].value=u.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const o in e.extensions)i.extensions[o]=e.extensions[o];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let o=e.normalScale;Array.isArray(o)===!1&&(o=[o,o]),i.normalScale=new Ne().fromArray(o)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Ne().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:YM,SpriteMaterial:Sy,RawShaderMaterial:qM,ShaderMaterial:is,PointsMaterial:wy,MeshPhysicalMaterial:ZM,MeshStandardMaterial:Iy,MeshPhongMaterial:QM,MeshToonMaterial:KM,MeshNormalMaterial:JM,MeshLambertMaterial:$M,MeshDepthMaterial:xy,MeshDistanceMaterial:_y,MeshBasicMaterial:Ml,MeshMatcapMaterial:ew,LineDashedMaterial:tw,LineBasicMaterial:vr,Material:Wi};return new t[e]}}class Yv{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class zy extends Zt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class gw extends zr{constructor(e){super(e)}load(e,t,n,i){const o=this,u=new va(o.manager);u.setPath(o.path),u.setRequestHeader(o.requestHeader),u.setWithCredentials(o.withCredentials),u.load(e,function(f){try{t(o.parse(JSON.parse(f)))}catch(d){i?i(d):console.error(d),o.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(_,M){if(t[M]!==void 0)return t[M];const E=_.interleavedBuffers[M],S=o(_,E.buffer),P=gf(E.type,S),b=new Zm(P,E.stride);return b.uuid=E.uuid,t[M]=b,b}function o(_,M){if(n[M]!==void 0)return n[M];const E=_.arrayBuffers[M],S=new Uint32Array(E).buffer;return n[M]=S,S}const u=e.isInstancedBufferGeometry?new zy:new Zt,f=e.data.index;if(f!==void 0){const _=gf(f.type,f.array);u.setIndex(new mn(_,1))}const d=e.data.attributes;for(const _ in d){const M=d[_];let A;if(M.isInterleavedBufferAttribute){const E=i(e.data,M.data);A=new es(E,M.itemSize,M.offset,M.normalized)}else{const E=gf(M.type,M.array),S=M.isInstancedBufferAttribute?Tf:mn;A=new S(E,M.itemSize,M.normalized)}M.name!==void 0&&(A.name=M.name),M.usage!==void 0&&A.setUsage(M.usage),u.setAttribute(_,A)}const p=e.data.morphAttributes;if(p)for(const _ in p){const M=p[_],A=[];for(let E=0,S=M.length;E<S;E++){const P=M[E];let b;if(P.isInterleavedBufferAttribute){const L=i(e.data,P.data);b=new es(L,P.itemSize,P.offset,P.normalized)}else{const L=gf(P.type,P.array);b=new mn(L,P.itemSize,P.normalized)}P.name!==void 0&&(b.name=P.name),A.push(b)}u.morphAttributes[_]=A}e.data.morphTargetsRelative&&(u.morphTargetsRelative=!0);const g=e.data.groups||e.data.drawcalls||e.data.offsets;if(g!==void 0)for(let _=0,M=g.length;_!==M;++_){const A=g[_];u.addGroup(A.start,A.count,A.materialIndex)}const y=e.data.boundingSphere;if(y!==void 0){const _=new G;y.center!==void 0&&_.fromArray(y.center),u.boundingSphere=new bi(_,y.radius)}return e.name&&(u.name=e.name),e.userData&&(u.userData=e.userData),u}}class GP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=this,u=this.path===""?Yv.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||u;const f=new va(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(d){let p=null;try{p=JSON.parse(d)}catch(g){i!==void 0&&i(g),console.error("THREE:ObjectLoader: Can't parse "+e+".",g.message);return}const m=p.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}o.parse(p,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?Yv.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const o=new va(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials);const u=await o.loadAsync(e,t),f=JSON.parse(u),d=f.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(f)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),o=this.parseGeometries(e.geometries,i),u=this.parseImages(e.images,function(){t!==void 0&&t(p)}),f=this.parseTextures(e.textures,u),d=this.parseMaterials(e.materials,f),p=this.parseObject(e.object,o,d,f,n),m=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,m),t!==void 0){let g=!1;for(const y in u)if(u[y].data instanceof HTMLImageElement){g=!0;break}g===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),o=await this.parseImagesAsync(e.images),u=this.parseTextures(e.textures,o),f=this.parseMaterials(e.materials,u),d=this.parseObject(e.object,i,f,u,t),p=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,p),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const o=new Iu().fromJSON(e[n]);t[o.uuid]=o}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(o){o.isBone&&(i[o.uuid]=o)}),e!==void 0)for(let o=0,u=e.length;o<u;o++){const f=new Qm().fromJSON(e[o],i);n[f.uuid]=f}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new gw;for(let o=0,u=e.length;o<u;o++){let f;const d=e[o];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":f=i.parse(d);break;default:d.type in X_?f=X_[d.type].fromJSON(d,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${d.type}"`)}f.uuid=d.uuid,d.name!==void 0&&(f.name=d.name),d.userData!==void 0&&(f.userData=d.userData),n[d.uuid]=f}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const o=new dg;o.setTextures(t);for(let u=0,f=e.length;u<f;u++){const d=e[u];n[d.uuid]===void 0&&(n[d.uuid]=o.parse(d)),i[d.uuid]=n[d.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],o=mh.parse(i);t[o.uuid]=o}return t}parseImages(e,t){const n=this,i={};let o;function u(d){return n.manager.itemStart(d),o.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function f(d){if(typeof d=="string"){const p=d,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return u(m)}else return d.data?{data:gf(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new Oy(t);o=new gh(d),o.setCrossOrigin(this.crossOrigin);for(let p=0,m=e.length;p<m;p++){const g=e[p],y=g.url;if(Array.isArray(y)){const _=[];for(let M=0,A=y.length;M<A;M++){const E=y[M],S=f(E);S!==null&&(S instanceof HTMLImageElement?_.push(S):_.push(new yl(S.data,S.width,S.height)))}i[g.uuid]=new Au(_)}else{const _=f(g.url);i[g.uuid]=new Au(_)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function o(u){if(typeof u=="string"){const f=u,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:t.resourcePath+f;return await i.loadAsync(d)}else return u.data?{data:gf(u.type,u.data),width:u.width,height:u.height}:null}if(e!==void 0&&e.length>0){i=new gh(this.manager),i.setCrossOrigin(this.crossOrigin);for(let u=0,f=e.length;u<f;u++){const d=e[u],p=d.url;if(Array.isArray(p)){const m=[];for(let g=0,y=p.length;g<y;g++){const _=p[g],M=await o(_);M!==null&&(M instanceof HTMLImageElement?m.push(M):m.push(new yl(M.data,M.width,M.height)))}n[d.uuid]=new Au(m)}else{const m=await o(d.url);n[d.uuid]=new Au(m)}}}return n}parseTextures(e,t){function n(o,u){return typeof o=="number"?o:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",o),u[o])}const i={};if(e!==void 0)for(let o=0,u=e.length;o<u;o++){const f=e[o];f.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',f.uuid),t[f.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",f.image);const d=t[f.image],p=d.data;let m;Array.isArray(p)?(m=new Sh,p.length===6&&(m.needsUpdate=!0)):(p&&p.data?m=new yl:m=new Vn,p&&(m.needsUpdate=!0)),m.source=d,m.uuid=f.uuid,f.name!==void 0&&(m.name=f.name),f.mapping!==void 0&&(m.mapping=n(f.mapping,WP)),f.channel!==void 0&&(m.channel=f.channel),f.offset!==void 0&&m.offset.fromArray(f.offset),f.repeat!==void 0&&m.repeat.fromArray(f.repeat),f.center!==void 0&&m.center.fromArray(f.center),f.rotation!==void 0&&(m.rotation=f.rotation),f.wrap!==void 0&&(m.wrapS=n(f.wrap[0],Q_),m.wrapT=n(f.wrap[1],Q_)),f.format!==void 0&&(m.format=f.format),f.internalFormat!==void 0&&(m.internalFormat=f.internalFormat),f.type!==void 0&&(m.type=f.type),f.colorSpace!==void 0&&(m.colorSpace=f.colorSpace),f.minFilter!==void 0&&(m.minFilter=n(f.minFilter,K_)),f.magFilter!==void 0&&(m.magFilter=n(f.magFilter,K_)),f.anisotropy!==void 0&&(m.anisotropy=f.anisotropy),f.flipY!==void 0&&(m.flipY=f.flipY),f.generateMipmaps!==void 0&&(m.generateMipmaps=f.generateMipmaps),f.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=f.premultiplyAlpha),f.unpackAlignment!==void 0&&(m.unpackAlignment=f.unpackAlignment),f.compareFunction!==void 0&&(m.compareFunction=f.compareFunction),f.userData!==void 0&&(m.userData=f.userData),i[f.uuid]=m}return i}parseObject(e,t,n,i,o){let u;function f(y){return t[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",y),t[y]}function d(y){if(y!==void 0){if(Array.isArray(y)){const _=[];for(let M=0,A=y.length;M<A;M++){const E=y[M];n[E]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",E),_.push(n[E])}return _}return n[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),n[y]}}function p(y){return i[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",y),i[y]}let m,g;switch(e.type){case"Scene":u=new Nm,e.background!==void 0&&(Number.isInteger(e.background)?u.background=new st(e.background):u.background=p(e.background)),e.environment!==void 0&&(u.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?u.fog=new qm(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(u.fog=new Ym(e.fog.color,e.fog.density)),e.fog.name!==""&&(u.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(u.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(u.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&u.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(u.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&u.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":u=new ei(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(u.focus=e.focus),e.zoom!==void 0&&(u.zoom=e.zoom),e.filmGauge!==void 0&&(u.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(u.filmOffset=e.filmOffset),e.view!==void 0&&(u.view=Object.assign({},e.view));break;case"OrthographicCamera":u=new vl(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(u.zoom=e.zoom),e.view!==void 0&&(u.view=Object.assign({},e.view));break;case"AmbientLight":u=new dw(e.color,e.intensity);break;case"DirectionalLight":u=new fw(e.color,e.intensity);break;case"PointLight":u=new cw(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":u=new hw(e.color,e.intensity,e.width,e.height);break;case"SpotLight":u=new uw(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":u=new lw(e.color,e.groundColor,e.intensity);break;case"LightProbe":u=new mw().fromJSON(e);break;case"SkinnedMesh":m=f(e.geometry),g=d(e.material),u=new DM(m,g),e.bindMode!==void 0&&(u.bindMode=e.bindMode),e.bindMatrix!==void 0&&u.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(u.skeleton=e.skeleton);break;case"Mesh":m=f(e.geometry),g=d(e.material),u=new ti(m,g);break;case"InstancedMesh":m=f(e.geometry),g=d(e.material);const y=e.count,_=e.instanceMatrix,M=e.instanceColor;u=new UM(m,g,y),u.instanceMatrix=new Tf(new Float32Array(_.array),16),M!==void 0&&(u.instanceColor=new Tf(new Float32Array(M.array),M.itemSize));break;case"BatchedMesh":m=f(e.geometry),g=d(e.material),u=new OM(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,g),u.geometry=m,u.perObjectFrustumCulled=e.perObjectFrustumCulled,u.sortObjects=e.sortObjects,u._drawRanges=e.drawRanges,u._reservedRanges=e.reservedRanges,u._visibility=e.visibility,u._active=e.active,u._bounds=e.bounds.map(A=>{const E=new Ci;E.min.fromArray(A.boxMin),E.max.fromArray(A.boxMax);const S=new bi;return S.radius=A.sphereRadius,S.center.fromArray(A.sphereCenter),{boxInitialized:A.boxInitialized,box:E,sphereInitialized:A.sphereInitialized,sphere:S}}),u._maxGeometryCount=e.maxGeometryCount,u._maxVertexCount=e.maxVertexCount,u._maxIndexCount=e.maxIndexCount,u._geometryInitialized=e.geometryInitialized,u._geometryCount=e.geometryCount,u._matricesTexture=p(e.matricesTexture.uuid);break;case"LOD":u=new NM;break;case"Line":u=new _l(f(e.geometry),d(e.material));break;case"LineLoop":u=new kM(f(e.geometry),d(e.material));break;case"LineSegments":u=new bo(f(e.geometry),d(e.material));break;case"PointCloud":case"Points":u=new zM(f(e.geometry),d(e.material));break;case"Sprite":u=new IM(d(e.material));break;case"Group":u=new yf;break;case"Bone":u=new My;break;default:u=new cn}if(u.uuid=e.uuid,e.name!==void 0&&(u.name=e.name),e.matrix!==void 0?(u.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(u.matrixAutoUpdate=e.matrixAutoUpdate),u.matrixAutoUpdate&&u.matrix.decompose(u.position,u.quaternion,u.scale)):(e.position!==void 0&&u.position.fromArray(e.position),e.rotation!==void 0&&u.rotation.fromArray(e.rotation),e.quaternion!==void 0&&u.quaternion.fromArray(e.quaternion),e.scale!==void 0&&u.scale.fromArray(e.scale)),e.up!==void 0&&u.up.fromArray(e.up),e.castShadow!==void 0&&(u.castShadow=e.castShadow),e.receiveShadow!==void 0&&(u.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(u.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(u.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(u.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&u.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(u.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(u.visible=e.visible),e.frustumCulled!==void 0&&(u.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(u.renderOrder=e.renderOrder),e.userData!==void 0&&(u.userData=e.userData),e.layers!==void 0&&(u.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let _=0;_<y.length;_++)u.add(this.parseObject(y[_],t,n,i,o))}if(e.animations!==void 0){const y=e.animations;for(let _=0;_<y.length;_++){const M=y[_];u.animations.push(o[M])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(u.autoUpdate=e.autoUpdate);const y=e.levels;for(let _=0;_<y.length;_++){const M=y[_],A=u.getObjectByProperty("uuid",M.object);A!==void 0&&u.addLevel(A,M.distance,M.hysteresis)}}return u}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}}const WP={UVMapping:Vm,CubeReflectionMapping:ga,CubeRefractionMapping:xl,EquirectangularReflectionMapping:Zd,EquirectangularRefractionMapping:Qd,CubeUVReflectionMapping:Rf},Q_={RepeatWrapping:Kd,ClampToEdgeWrapping:xs,MirroredRepeatWrapping:Jd},K_={NearestFilter:Ai,NearestMipmapNearestFilter:ty,NearestMipmapLinearFilter:mf,LinearFilter:pi,LinearMipmapNearestFilter:Wd,LinearMipmapLinearFilter:Mo};class jP extends zr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const o=this,u=ha.get(e);if(u!==void 0){if(o.manager.itemStart(e),u.then){u.then(p=>{t&&t(p),o.manager.itemEnd(e)}).catch(p=>{i&&i(p)});return}return setTimeout(function(){t&&t(u),o.manager.itemEnd(e)},0),u}const f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",f.headers=this.requestHeader;const d=fetch(e,f).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(o.options,{colorSpaceConversion:"none"}))}).then(function(p){return ha.add(e,p),t&&t(p),o.manager.itemEnd(e),p}).catch(function(p){i&&i(p),ha.remove(e),o.manager.itemError(e),o.manager.itemEnd(e)});ha.add(e,d),o.manager.itemStart(e)}}let lm;class Fy{static getContext(){return lm===void 0&&(lm=new(window.AudioContext||window.webkitAudioContext)),lm}static setContext(e){lm=e}}class XP extends zr{constructor(e){super(e)}load(e,t,n,i){const o=this,u=new va(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(d){try{const p=d.slice(0);Fy.getContext().decodeAudioData(p,function(g){t(g)}).catch(f)}catch(p){f(p)}},n,i);function f(d){i?i(d):console.error(d),o.manager.itemError(e)}}}const J_=new It,$_=new It,pu=new It;class YP{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ei,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ei,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,pu.copy(e.projectionMatrix);const i=t.eyeSep/2,o=i*t.near/t.focus,u=t.near*Math.tan(Pu*t.fov*.5)/t.zoom;let f,d;$_.elements[12]=-i,J_.elements[12]=i,f=-u*t.aspect+o,d=u*t.aspect+o,pu.elements[0]=2*t.near/(d-f),pu.elements[8]=(d+f)/(d-f),this.cameraL.projectionMatrix.copy(pu),f=-u*t.aspect-o,d=u*t.aspect-o,pu.elements[0]=2*t.near/(d-f),pu.elements[8]=(d+f)/(d-f),this.cameraR.projectionMatrix.copy(pu)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply($_),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(J_)}}let By=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=e1(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=e1();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function e1(){return(typeof performance>"u"?Date:performance).now()}const mu=new G,t1=new ir,qP=new G,gu=new G;class ZP extends cn{constructor(){super(),this.type="AudioListener",this.context=Fy.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new By}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(mu,t1,qP),gu.set(0,0,-1).applyQuaternion(t1),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(mu.x,i),t.positionY.linearRampToValueAtTime(mu.y,i),t.positionZ.linearRampToValueAtTime(mu.z,i),t.forwardX.linearRampToValueAtTime(gu.x,i),t.forwardY.linearRampToValueAtTime(gu.y,i),t.forwardZ.linearRampToValueAtTime(gu.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(mu.x,mu.y,mu.z),t.setOrientation(gu.x,gu.y,gu.z,n.x,n.y,n.z)}}class vw extends cn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const vu=new G,n1=new ir,QP=new G,yu=new G;class KP extends vw{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(vu,n1,QP),yu.set(0,0,1).applyQuaternion(n1);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(vu.x,n),t.positionY.linearRampToValueAtTime(vu.y,n),t.positionZ.linearRampToValueAtTime(vu.z,n),t.orientationX.linearRampToValueAtTime(yu.x,n),t.orientationY.linearRampToValueAtTime(yu.y,n),t.orientationZ.linearRampToValueAtTime(yu.z,n)}else t.setPosition(vu.x,vu.y,vu.z),t.setOrientation(yu.x,yu.y,yu.z)}}class JP{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class yw{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,o,u;switch(t){case"quaternion":i=this._slerp,o=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,o=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,o=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=o,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,o=e*i+i;let u=this.cumulativeWeight;if(u===0){for(let f=0;f!==i;++f)n[o+f]=n[f];u=t}else{u+=t;const f=t/u;this._mixBufferRegion(n,o,0,f,i)}this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,o=this.cumulativeWeight,u=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){const d=t*this._origIndex;this._mixBufferRegion(n,i,d,1-o,t)}u>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let d=t,p=t+t;d!==p;++d)if(n[d]!==n[d+t]){f.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let o=n,u=i;o!==u;++o)t[o]=t[i+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,o){if(i>=.5)for(let u=0;u!==o;++u)e[t+u]=e[n+u]}_slerp(e,t,n,i){ir.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,o){const u=this._workIndex*o;ir.multiplyQuaternionsFlat(e,u,e,t,e,n),ir.slerpFlat(e,t,e,t,e,u,i)}_lerp(e,t,n,i,o){const u=1-i;for(let f=0;f!==o;++f){const d=t+f;e[d]=e[d]*u+e[n+f]*i}}_lerpAdditive(e,t,n,i,o){for(let u=0;u!==o;++u){const f=t+u;e[f]=e[f]+e[n+u]*i}}}const Hy="\\[\\]\\.:\\/",$P=new RegExp("["+Hy+"]","g"),Vy="[^"+Hy+"]",e3="[^"+Hy.replace("\\.","")+"]",t3=/((?:WC+[\/:])*)/.source.replace("WC",Vy),n3=/(WCOD+)?/.source.replace("WCOD",e3),i3=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vy),r3=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vy),s3=new RegExp("^"+t3+n3+i3+r3+"$"),o3=["material","materials","bones","map"];class a3{constructor(e,t,n){const i=n||an.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,o=n.length;i!==o;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class an{constructor(e,t,n){this.path=t,this.parsedPath=n||an.parseTrackName(t),this.node=an.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new an.Composite(e,t,n):new an(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace($P,"")}static parseTrackName(e){const t=s3.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const o=n.nodeName.substring(i+1);o3.indexOf(o)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=o)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(o){for(let u=0;u<o.length;u++){const f=o[u];if(f.name===t||f.uuid===t)return f;const d=n(f.children);if(d)return d}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,o=n.length;i!==o;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let o=t.propertyIndex;if(e||(e=an.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===p){p=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const u=e[i];if(u===void 0){const p=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+p+"."+i+" but it wasn't found.",e);return}let f=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?f=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(o!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}d=this.BindingType.ArrayElement,this.resolvedProperty=u,this.propertyIndex=o}else u.fromArray!==void 0&&u.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=u):Array.isArray(u)?(d=this.BindingType.EntireArray,this.resolvedProperty=u):this.propertyName=i;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}an.Composite=a3;an.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};an.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};an.prototype.GetterByBindingType=[an.prototype._getValue_direct,an.prototype._getValue_array,an.prototype._getValue_arrayElement,an.prototype._getValue_toArray];an.prototype.SetterByBindingTypeAndVersioning=[[an.prototype._setValue_direct,an.prototype._setValue_direct_setNeedsUpdate,an.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[an.prototype._setValue_array,an.prototype._setValue_array_setNeedsUpdate,an.prototype._setValue_array_setMatrixWorldNeedsUpdate],[an.prototype._setValue_arrayElement,an.prototype._setValue_arrayElement_setNeedsUpdate,an.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[an.prototype._setValue_fromArray,an.prototype._setValue_fromArray_setNeedsUpdate,an.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class l3{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ts(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,o=this._bindings,u=o.length;let f,d=e.length,p=this.nCachedObjects_;for(let m=0,g=arguments.length;m!==g;++m){const y=arguments[m],_=y.uuid;let M=t[_];if(M===void 0){M=d++,t[_]=M,e.push(y);for(let A=0,E=u;A!==E;++A)o[A].push(new an(y,n[A],i[A]))}else if(M<p){f=e[M];const A=--p,E=e[A];t[E.uuid]=M,e[M]=E,t[_]=A,e[A]=y;for(let S=0,P=u;S!==P;++S){const b=o[S],L=b[A];let B=b[M];b[M]=L,B===void 0&&(B=new an(y,n[S],i[S])),b[A]=B}}else e[M]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let o=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],p=d.uuid,m=t[p];if(m!==void 0&&m>=o){const g=o++,y=e[g];t[y.uuid]=m,e[m]=y,t[p]=g,e[g]=d;for(let _=0,M=i;_!==M;++_){const A=n[_],E=A[g],S=A[m];A[m]=E,A[g]=S}}}this.nCachedObjects_=o}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let o=this.nCachedObjects_,u=e.length;for(let f=0,d=arguments.length;f!==d;++f){const p=arguments[f],m=p.uuid,g=t[m];if(g!==void 0)if(delete t[m],g<o){const y=--o,_=e[y],M=--u,A=e[M];t[_.uuid]=g,e[g]=_,t[A.uuid]=y,e[y]=A,e.pop();for(let E=0,S=i;E!==S;++E){const P=n[E],b=P[y],L=P[M];P[g]=b,P[y]=L,P.pop()}}else{const y=--u,_=e[y];y>0&&(t[_.uuid]=g),e[g]=_,e.pop();for(let M=0,A=i;M!==A;++M){const E=n[M];E[g]=E[y],E.pop()}}}this.nCachedObjects_=o}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const o=this._bindings;if(i!==void 0)return o[i];const u=this._paths,f=this._parsedPaths,d=this._objects,p=d.length,m=this.nCachedObjects_,g=new Array(p);i=o.length,n[e]=i,u.push(e),f.push(t),o.push(g);for(let y=m,_=d.length;y!==_;++y){const M=d[y];g[y]=new an(M,e,t)}return g}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,o=this._parsedPaths,u=this._bindings,f=u.length-1,d=u[f],p=e[f];t[p]=n,u[n]=d,u.pop(),o[n]=o[f],o.pop(),i[n]=i[f],i.pop()}}}class xw{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const o=t.tracks,u=o.length,f=new Array(u),d={endingStart:Eu,endingEnd:Eu};for(let p=0;p!==u;++p){const m=o[p].createInterpolant(null);f[p]=m,m.settings=d}this._interpolantSettings=d,this._interpolants=f,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=tM,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){const i=this._clip.duration,o=e._clip.duration,u=o/i,f=i/o;e.warp(1,u,t),this.warp(f,1,t)}return this}crossFadeTo(e,t,n){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,o=i.time,u=this.timeScale;let f=this._timeScaleInterpolant;f===null&&(f=i._lendControlInterpolant(),this._timeScaleInterpolant=f);const d=f.parameterPositions,p=f.sampleValues;return d[0]=o,d[1]=o+n,p[0]=e/u,p[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const o=this._startTime;if(o!==null){const d=(e-o)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const u=this._updateTime(t),f=this._updateWeight(e);if(f>0){const d=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case cy:for(let m=0,g=d.length;m!==g;++m)d[m].evaluate(u),p[m].accumulateAdditive(f);break;case Gm:default:for(let m=0,g=d.length;m!==g;++m)d[m].evaluate(u),p[m].accumulate(i,f)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,o=this._loopCount;const u=n===nM;if(e===0)return o===-1?i:u&&(o&1)===1?t-i:i;if(n===eM){o===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(o===-1&&(e>=0?(o=0,this._setEndings(!0,this.repetitions===0,u)):this._setEndings(this.repetitions===0,!0,u)),i>=t||i<0){const f=Math.floor(i/t);i-=t*f,o+=Math.abs(f);const d=this.repetitions-o;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const p=e<0;this._setEndings(p,!p,u)}else this._setEndings(!1,!1,u);this._loopCount=o,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=i;if(u&&(o&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Tu,i.endingEnd=Tu):(e?i.endingStart=this.zeroSlopeAtStart?Tu:Eu:i.endingStart=th,t?i.endingEnd=this.zeroSlopeAtEnd?Tu:Eu:i.endingEnd=th)}_scheduleFading(e,t,n){const i=this._mixer,o=i.time;let u=this._weightInterpolant;u===null&&(u=i._lendControlInterpolant(),this._weightInterpolant=u);const f=u.parameterPositions,d=u.sampleValues;return f[0]=o,d[0]=t,f[1]=o+e,d[1]=n,this}}const u3=new Float32Array(1);class c3 extends xa{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,o=i.length,u=e._propertyBindings,f=e._interpolants,d=n.uuid,p=this._bindingsByRootAndName;let m=p[d];m===void 0&&(m={},p[d]=m);for(let g=0;g!==o;++g){const y=i[g],_=y.name;let M=m[_];if(M!==void 0)++M.referenceCount,u[g]=M;else{if(M=u[g],M!==void 0){M._cacheIndex===null&&(++M.referenceCount,this._addInactiveBinding(M,d,_));continue}const A=t&&t._propertyBindings[g].binding.parsedPath;M=new yw(an.create(n,_,A),y.ValueTypeName,y.getValueSize()),++M.referenceCount,this._addInactiveBinding(M,d,_),u[g]=M}f[g].resultBuffer=M.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,o=this._actionsByClip[i];this._bindAction(e,o&&o.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const o=t[n];o.useCount++===0&&(this._lendBinding(o),o.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const o=t[n];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,o=this._actionsByClip;let u=o[t];if(u===void 0)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=u;else{const f=u.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=i.length,i.push(e),u.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const o=e._clip.uuid,u=this._actionsByClip,f=u[o],d=f.knownActions,p=d[d.length-1],m=e._byClipCacheIndex;p._byClipCacheIndex=m,d[m]=p,d.pop(),e._byClipCacheIndex=null;const g=f.actionByRoot,y=(e._localRoot||this._root).uuid;delete g[y],d.length===0&&delete u[o],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const o=t[n];--o.referenceCount===0&&this._removeInactiveBinding(o)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,o=this._bindings;let u=i[t];u===void 0&&(u={},i[t]=u),u[n]=e,e._cacheIndex=o.length,o.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,o=n.path,u=this._bindingsByRootAndName,f=u[i],d=t[t.length-1],p=e._cacheIndex;d._cacheIndex=p,t[p]=d,t.pop(),delete f[o],Object.keys(f).length===0&&delete u[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,o=t[i];e._cacheIndex=i,t[i]=e,o._cacheIndex=n,t[n]=o}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new Dy(new Float32Array(2),new Float32Array(2),1,u3),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,o=t[i];e.__cacheIndex=i,t[i]=e,o.__cacheIndex=n,t[n]=o}clipAction(e,t,n){const i=t||this._root,o=i.uuid;let u=typeof e=="string"?mh.findByName(i,e):e;const f=u!==null?u.uuid:e,d=this._actionsByClip[f];let p=null;if(n===void 0&&(u!==null?n=u.blendMode:n=Gm),d!==void 0){const g=d.actionByRoot[o];if(g!==void 0&&g.blendMode===n)return g;p=d.knownActions[0],u===null&&(u=p._clip)}if(u===null)return null;const m=new xw(this,u,t,n);return this._bindAction(m,p),this._addInactiveAction(m,f,o),m}existingAction(e,t){const n=t||this._root,i=n.uuid,o=typeof e=="string"?mh.findByName(n,e):e,u=o?o.uuid:e,f=this._actionsByClip[u];return f!==void 0&&f.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,o=Math.sign(e),u=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(i,e,o,u);const f=this._bindings,d=this._nActiveBindings;for(let p=0;p!==d;++p)f[p].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,o=i[n];if(o!==void 0){const u=o.knownActions;for(let f=0,d=u.length;f!==d;++f){const p=u[f];this._deactivateAction(p);const m=p._cacheIndex,g=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,g._cacheIndex=m,t[m]=g,t.pop(),this._removeInactiveBindingsForAction(p)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const u in n){const f=n[u].actionByRoot,d=f[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const i=this._bindingsByRootAndName,o=i[t];if(o!==void 0)for(const u in o){const f=o[u];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class Gy{constructor(e){this.value=e}clone(){return new Gy(this.value.clone===void 0?this.value:this.value.clone())}}let f3=0;class d3 extends xa{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:f3++}),this.name="",this.usage=sh,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const o=Array.isArray(t[n])?t[n]:[t[n]];for(let u=0;u<o.length;u++)this.uniforms.push(o[u].clone())}return this}clone(){return new this.constructor().copy(this)}}class km extends Zm{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class h3{constructor(e,t,n,i,o){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const i1=new It;class _w{constructor(e,t,n=0,i=1/0){this.ray=new Ou(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new Lu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return i1.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(i1),this}intersectObject(e,t=!0,n=[]){return qv(e,this,n,t),n.sort(r1),n}intersectObjects(e,t=!0,n=[]){for(let i=0,o=e.length;i<o;i++)qv(e[i],this,n,t);return n.sort(r1),n}}function r1(s,e){return s.distance-e.distance}function qv(s,e,t,n){if(s.layers.test(e.layers)&&s.raycast(e,t),n===!0){const i=s.children;for(let o=0,u=i.length;o<u;o++)qv(i[o],e,t,!0)}}class Zv{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Yn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class p3{constructor(e=1,t=0,n=0){return this.radius=e,this.theta=t,this.y=n,this}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}const s1=new Ne;class m3{constructor(e=new Ne(1/0,1/0),t=new Ne(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=s1.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,s1).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const o1=new G,um=new G;class Sw{constructor(e=new G,t=new G){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){o1.subVectors(e,this.start),um.subVectors(this.end,this.start);const n=um.dot(um);let o=um.dot(o1)/n;return t&&(o=Yn(o,0,1)),o}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const a1=new G;class g3 extends cn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Zt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let u=0,f=1,d=32;u<d;u++,f++){const p=u/d*Math.PI*2,m=f/d*Math.PI*2;i.push(Math.cos(p),Math.sin(p),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new pt(i,3));const o=new vr({fog:!1,toneMapped:!1});this.cone=new bo(n,o),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),a1.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(a1),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const pl=new G,cm=new It,L0=new It;class v3 extends bo{constructor(e){const t=Mw(e),n=new Zt,i=[],o=[],u=new st(0,0,1),f=new st(0,1,0);for(let p=0;p<t.length;p++){const m=t[p];m.parent&&m.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),o.push(u.r,u.g,u.b),o.push(f.r,f.g,f.b))}n.setAttribute("position",new pt(i,3)),n.setAttribute("color",new pt(o,3));const d=new vr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,d),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");L0.copy(this.root.matrixWorld).invert();for(let o=0,u=0;o<t.length;o++){const f=t[o];f.parent&&f.parent.isBone&&(cm.multiplyMatrices(L0,f.matrixWorld),pl.setFromMatrixPosition(cm),i.setXYZ(u,pl.x,pl.y,pl.z),cm.multiplyMatrices(L0,f.parent.matrixWorld),pl.setFromMatrixPosition(cm),i.setXYZ(u+1,pl.x,pl.y,pl.z),u+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function Mw(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push.apply(e,Mw(s.children[t]));return e}class y3 extends ti{constructor(e,t,n){const i=new Th(t,4,2),o=new Ml({wireframe:!0,fog:!1,toneMapped:!1});super(i,o),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const x3=new G,l1=new st,u1=new st;class _3 extends cn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new Eh(t);i.rotateY(Math.PI*.5),this.material=new Ml({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const o=i.getAttribute("position"),u=new Float32Array(o.count*3);i.setAttribute("color",new mn(u,3)),this.add(new ti(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");l1.copy(this.light.color),u1.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const o=n<i/2?l1:u1;t.setXYZ(n,o.r,o.g,o.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(x3.setFromMatrixPosition(this.light.matrixWorld).negate())}}class S3 extends bo{constructor(e=10,t=10,n=4473924,i=8947848){n=new st(n),i=new st(i);const o=t/2,u=e/t,f=e/2,d=[],p=[];for(let y=0,_=0,M=-f;y<=t;y++,M+=u){d.push(-f,0,M,f,0,M),d.push(M,0,-f,M,0,f);const A=y===o?n:i;A.toArray(p,_),_+=3,A.toArray(p,_),_+=3,A.toArray(p,_),_+=3,A.toArray(p,_),_+=3}const m=new Zt;m.setAttribute("position",new pt(d,3)),m.setAttribute("color",new pt(p,3));const g=new vr({vertexColors:!0,toneMapped:!1});super(m,g),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class M3 extends bo{constructor(e=10,t=16,n=8,i=64,o=4473924,u=8947848){o=new st(o),u=new st(u);const f=[],d=[];if(t>1)for(let g=0;g<t;g++){const y=g/t*(Math.PI*2),_=Math.sin(y)*e,M=Math.cos(y)*e;f.push(0,0,0),f.push(_,0,M);const A=g&1?o:u;d.push(A.r,A.g,A.b),d.push(A.r,A.g,A.b)}for(let g=0;g<n;g++){const y=g&1?o:u,_=e-e/n*g;for(let M=0;M<i;M++){let A=M/i*(Math.PI*2),E=Math.sin(A)*_,S=Math.cos(A)*_;f.push(E,0,S),d.push(y.r,y.g,y.b),A=(M+1)/i*(Math.PI*2),E=Math.sin(A)*_,S=Math.cos(A)*_,f.push(E,0,S),d.push(y.r,y.g,y.b)}}const p=new Zt;p.setAttribute("position",new pt(f,3)),p.setAttribute("color",new pt(d,3));const m=new vr({vertexColors:!0,toneMapped:!1});super(p,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const c1=new G,fm=new G,f1=new G;class w3 extends cn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Zt;i.setAttribute("position",new pt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const o=new vr({fog:!1,toneMapped:!1});this.lightPlane=new _l(i,o),this.add(this.lightPlane),i=new Zt,i.setAttribute("position",new pt([0,0,0,0,0,1],3)),this.targetLine=new _l(i,o),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),c1.setFromMatrixPosition(this.light.matrixWorld),fm.setFromMatrixPosition(this.light.target.matrixWorld),f1.subVectors(fm,c1),this.lightPlane.lookAt(fm),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(fm),this.targetLine.scale.z=f1.length()}}const dm=new G,Xn=new _h;class E3 extends bo{constructor(e){const t=new Zt,n=new vr({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],o=[],u={};f("n1","n2"),f("n2","n4"),f("n4","n3"),f("n3","n1"),f("f1","f2"),f("f2","f4"),f("f4","f3"),f("f3","f1"),f("n1","f1"),f("n2","f2"),f("n3","f3"),f("n4","f4"),f("p","n1"),f("p","n2"),f("p","n3"),f("p","n4"),f("u1","u2"),f("u2","u3"),f("u3","u1"),f("c","t"),f("p","c"),f("cn1","cn2"),f("cn3","cn4"),f("cf1","cf2"),f("cf3","cf4");function f(M,A){d(M),d(A)}function d(M){i.push(0,0,0),o.push(0,0,0),u[M]===void 0&&(u[M]=[]),u[M].push(i.length/3-1)}t.setAttribute("position",new pt(i,3)),t.setAttribute("color",new pt(o,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=u,this.update();const p=new st(16755200),m=new st(16711680),g=new st(43775),y=new st(16777215),_=new st(3355443);this.setColors(p,m,g,y,_)}setColors(e,t,n,i,o){const f=this.geometry.getAttribute("color");f.setXYZ(0,e.r,e.g,e.b),f.setXYZ(1,e.r,e.g,e.b),f.setXYZ(2,e.r,e.g,e.b),f.setXYZ(3,e.r,e.g,e.b),f.setXYZ(4,e.r,e.g,e.b),f.setXYZ(5,e.r,e.g,e.b),f.setXYZ(6,e.r,e.g,e.b),f.setXYZ(7,e.r,e.g,e.b),f.setXYZ(8,e.r,e.g,e.b),f.setXYZ(9,e.r,e.g,e.b),f.setXYZ(10,e.r,e.g,e.b),f.setXYZ(11,e.r,e.g,e.b),f.setXYZ(12,e.r,e.g,e.b),f.setXYZ(13,e.r,e.g,e.b),f.setXYZ(14,e.r,e.g,e.b),f.setXYZ(15,e.r,e.g,e.b),f.setXYZ(16,e.r,e.g,e.b),f.setXYZ(17,e.r,e.g,e.b),f.setXYZ(18,e.r,e.g,e.b),f.setXYZ(19,e.r,e.g,e.b),f.setXYZ(20,e.r,e.g,e.b),f.setXYZ(21,e.r,e.g,e.b),f.setXYZ(22,e.r,e.g,e.b),f.setXYZ(23,e.r,e.g,e.b),f.setXYZ(24,t.r,t.g,t.b),f.setXYZ(25,t.r,t.g,t.b),f.setXYZ(26,t.r,t.g,t.b),f.setXYZ(27,t.r,t.g,t.b),f.setXYZ(28,t.r,t.g,t.b),f.setXYZ(29,t.r,t.g,t.b),f.setXYZ(30,t.r,t.g,t.b),f.setXYZ(31,t.r,t.g,t.b),f.setXYZ(32,n.r,n.g,n.b),f.setXYZ(33,n.r,n.g,n.b),f.setXYZ(34,n.r,n.g,n.b),f.setXYZ(35,n.r,n.g,n.b),f.setXYZ(36,n.r,n.g,n.b),f.setXYZ(37,n.r,n.g,n.b),f.setXYZ(38,i.r,i.g,i.b),f.setXYZ(39,i.r,i.g,i.b),f.setXYZ(40,o.r,o.g,o.b),f.setXYZ(41,o.r,o.g,o.b),f.setXYZ(42,o.r,o.g,o.b),f.setXYZ(43,o.r,o.g,o.b),f.setXYZ(44,o.r,o.g,o.b),f.setXYZ(45,o.r,o.g,o.b),f.setXYZ(46,o.r,o.g,o.b),f.setXYZ(47,o.r,o.g,o.b),f.setXYZ(48,o.r,o.g,o.b),f.setXYZ(49,o.r,o.g,o.b),f.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;Xn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),$n("c",t,e,Xn,0,0,-1),$n("t",t,e,Xn,0,0,1),$n("n1",t,e,Xn,-n,-i,-1),$n("n2",t,e,Xn,n,-i,-1),$n("n3",t,e,Xn,-n,i,-1),$n("n4",t,e,Xn,n,i,-1),$n("f1",t,e,Xn,-n,-i,1),$n("f2",t,e,Xn,n,-i,1),$n("f3",t,e,Xn,-n,i,1),$n("f4",t,e,Xn,n,i,1),$n("u1",t,e,Xn,n*.7,i*1.1,-1),$n("u2",t,e,Xn,-n*.7,i*1.1,-1),$n("u3",t,e,Xn,0,i*2,-1),$n("cf1",t,e,Xn,-n,0,1),$n("cf2",t,e,Xn,n,0,1),$n("cf3",t,e,Xn,0,-i,1),$n("cf4",t,e,Xn,0,i,1),$n("cn1",t,e,Xn,-n,0,-1),$n("cn2",t,e,Xn,n,0,-1),$n("cn3",t,e,Xn,0,-i,-1),$n("cn4",t,e,Xn,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function $n(s,e,t,n,i,o,u){dm.set(i,o,u).unproject(n);const f=e[s];if(f!==void 0){const d=t.getAttribute("position");for(let p=0,m=f.length;p<m;p++)d.setXYZ(f[p],dm.x,dm.y,dm.z)}}const hm=new Ci;class T3 extends bo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),o=new Zt;o.setIndex(new mn(n,1)),o.setAttribute("position",new mn(i,3)),super(o,new vr({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&hm.setFromObject(this.object),hm.isEmpty())return;const t=hm.min,n=hm.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=t.x,o[4]=n.y,o[5]=n.z,o[6]=t.x,o[7]=t.y,o[8]=n.z,o[9]=n.x,o[10]=t.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=t.z,o[15]=t.x,o[16]=n.y,o[17]=t.z,o[18]=t.x,o[19]=t.y,o[20]=t.z,o[21]=n.x,o[22]=t.y,o[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class A3 extends bo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Zt;o.setIndex(new mn(n,1)),o.setAttribute("position",new pt(i,3)),super(o,new vr({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class C3 extends _l{constructor(e,t=1,n=16776960){const i=n,o=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],u=new Zt;u.setAttribute("position",new pt(o,3)),u.computeBoundingSphere(),super(u,new vr({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const f=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new Zt;d.setAttribute("position",new pt(f,3)),d.computeBoundingSphere(),this.add(new ti(d,new Ml({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const d1=new G;let pm,I0;class b3 extends cn{constructor(e=new G(0,0,1),t=new G(0,0,0),n=1,i=16776960,o=n*.2,u=o*.2){super(),this.type="ArrowHelper",pm===void 0&&(pm=new Zt,pm.setAttribute("position",new pt([0,0,0,0,1,0],3)),I0=new Nf(0,.5,1,5,1),I0.translate(0,-.5,0)),this.position.copy(t),this.line=new _l(pm,new vr({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ti(I0,new Ml({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,o,u)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{d1.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(d1,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class R3 extends bo{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Zt;i.setAttribute("position",new pt(t,3)),i.setAttribute("color",new pt(n,3));const o=new vr({vertexColors:!0,toneMapped:!1});super(i,o),this.type="AxesHelper"}setColors(e,t,n){const i=new st,o=this.geometry.attributes.color.array;return i.set(e),i.toArray(o,0),i.toArray(o,3),i.set(t),i.toArray(o,6),i.toArray(o,9),i.set(n),i.toArray(o,12),i.toArray(o,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class P3{constructor(){this.type="ShapePath",this.color=new st,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new uh,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,o,u){return this.currentPath.bezierCurveTo(e,t,n,i,o,u),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(S){const P=[];for(let b=0,L=S.length;b<L;b++){const B=S[b],D=new Iu;D.curves=B.curves,P.push(D)}return P}function n(S,P){const b=P.length;let L=!1;for(let B=b-1,D=0;D<b;B=D++){let F=P[B],j=P[D],O=j.x-F.x,N=j.y-F.y;if(Math.abs(N)>Number.EPSILON){if(N<0&&(F=P[D],O=-O,j=P[B],N=-N),S.y<F.y||S.y>j.y)continue;if(S.y===F.y){if(S.x===F.x)return!0}else{const X=N*(S.x-F.x)-O*(S.y-F.y);if(X===0)return!0;if(X<0)continue;L=!L}}else{if(S.y!==F.y)continue;if(j.x<=S.x&&S.x<=F.x||F.x<=S.x&&S.x<=j.x)return!0}}return L}const i=To.isClockWise,o=this.subPaths;if(o.length===0)return[];let u,f,d;const p=[];if(o.length===1)return f=o[0],d=new Iu,d.curves=f.curves,p.push(d),p;let m=!i(o[0].getPoints());m=e?!m:m;const g=[],y=[];let _=[],M=0,A;y[M]=void 0,_[M]=[];for(let S=0,P=o.length;S<P;S++)f=o[S],A=f.getPoints(),u=i(A),u=e?!u:u,u?(!m&&y[M]&&M++,y[M]={s:new Iu,p:A},y[M].s.curves=f.curves,m&&M++,_[M]=[]):_[M].push({h:f,p:A[0]});if(!y[0])return t(o);if(y.length>1){let S=!1,P=0;for(let b=0,L=y.length;b<L;b++)g[b]=[];for(let b=0,L=y.length;b<L;b++){const B=_[b];for(let D=0;D<B.length;D++){const F=B[D];let j=!0;for(let O=0;O<y.length;O++)n(F.p,y[O].p)&&(b!==O&&P++,j?(j=!1,g[O].push(F)):S=!0);j&&g[b].push(F)}}P>0&&S===!1&&(_=g)}let E;for(let S=0,P=y.length;S<P;S++){d=y[S].s,p.push(d),E=_[S];for(let b=0,L=E.length;b<L;b++)d.holes.push(E[b].h)}return p}}class L3 extends qs{constructor(e=1,t=1,n=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...i,count:n}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:bf}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=bf);const I3=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:ey,AddEquation:gl,AddOperation:kS,AdditiveAnimationBlendMode:cy,AdditiveBlending:uv,AgXToneMapping:VS,AlphaFormat:qS,AlwaysCompare:dM,AlwaysDepth:PS,AlwaysStencilFunc:Fv,AmbientLight:dw,AnimationAction:xw,AnimationClip:mh,AnimationLoader:UP,AnimationMixer:c3,AnimationObjectGroup:l3,AnimationUtils:LP,ArcCurve:FM,ArrayCamera:RM,ArrowHelper:b3,AttachedBindMode:dv,Audio:vw,AudioAnalyser:JP,AudioContext:Fy,AudioListener:ZP,AudioLoader:XP,AxesHelper:R3,BackSide:nr,BasicDepthPacking:iM,BasicShadowMap:cS,BatchedMesh:OM,Bone:My,BooleanKeyframeTrack:zu,Box2:m3,Box3:Ci,Box3Helper:A3,BoxGeometry:ku,BoxHelper:T3,BufferAttribute:mn,BufferGeometry:Zt,BufferGeometryLoader:gw,ByteType:jS,Cache:ha,Camera:_h,CameraHelper:E3,CanvasTexture:tP,CapsuleGeometry:$m,CatmullRomCurve3:BM,CineonToneMapping:BS,CircleGeometry:eg,ClampToEdgeWrapping:xs,Clock:By,Color:st,ColorKeyframeTrack:Uy,ColorManagement:pn,CompressedArrayTexture:$R,CompressedCubeTexture:eP,CompressedTexture:Km,CompressedTextureLoader:OP,ConeGeometry:tg,ConstantAlphaFactor:CS,ConstantColorFactor:TS,CubeCamera:_M,CubeReflectionMapping:ga,CubeRefractionMapping:xl,CubeTexture:Sh,CubeTextureLoader:kP,CubeUVReflectionMapping:Rf,CubicBezierCurve:Ty,CubicBezierCurve3:HM,CubicInterpolant:rw,CullFaceBack:lv,CullFaceFront:uS,CullFaceFrontBack:GE,CullFaceNone:lS,Curve:Zs,CurvePath:GM,CustomBlending:fS,CustomToneMapping:HS,CylinderGeometry:Nf,Cylindrical:p3,Data3DTexture:py,DataArrayTexture:jm,DataTexture:yl,DataTextureLoader:zP,DataUtils:KT,DecrementStencilOp:eT,DecrementWrapStencilOp:nT,DefaultLoadingManager:aw,DepthFormat:Ru,DepthStencilFormat:Mf,DepthTexture:yy,DetachedBindMode:WS,DirectionalLight:fw,DirectionalLightHelper:w3,DiscreteInterpolant:sw,DisplayP3ColorSpace:Wm,DodecahedronGeometry:ng,DoubleSide:_o,DstAlphaFactor:_S,DstColorFactor:MS,DynamicCopyUsage:vT,DynamicDrawUsage:fT,DynamicReadUsage:pT,EdgesGeometry:Py,EllipseCurve:Jm,EqualCompare:lM,EqualDepth:IS,EqualStencilFunc:oT,EquirectangularReflectionMapping:Zd,EquirectangularRefractionMapping:Qd,Euler:ns,EventDispatcher:xa,ExtrudeGeometry:rg,FileLoader:va,Float16BufferAttribute:iA,Float32BufferAttribute:pt,FloatType:_s,Fog:qm,FogExp2:Ym,FramebufferTexture:JR,FrontSide:ma,Frustum:Mh,GLBufferAttribute:h3,GLSL1:xT,GLSL3:Bv,GreaterCompare:uM,GreaterDepth:DS,GreaterEqualCompare:fM,GreaterEqualDepth:NS,GreaterEqualStencilFunc:cT,GreaterStencilFunc:lT,GridHelper:S3,Group:yf,HalfFloatType:yh,HemisphereLight:lw,HemisphereLightHelper:_3,IcosahedronGeometry:sg,ImageBitmapLoader:jP,ImageLoader:gh,ImageUtils:gM,IncrementStencilOp:$E,IncrementWrapStencilOp:tT,InstancedBufferAttribute:Tf,InstancedBufferGeometry:zy,InstancedInterleavedBuffer:km,InstancedMesh:UM,Int16BufferAttribute:tA,Int32BufferAttribute:nA,Int8BufferAttribute:JT,IntType:iy,InterleavedBuffer:Zm,InterleavedBufferAttribute:es,Interpolant:Ah,InterpolateDiscrete:$d,InterpolateLinear:eh,InterpolateSmooth:Cm,InvertStencilOp:iT,KeepStencilOp:Su,KeyframeTrack:Qs,LOD:NM,LatheGeometry:wh,Layers:Lu,LessCompare:aM,LessDepth:LS,LessEqualCompare:fy,LessEqualDepth:qd,LessEqualStencilFunc:aT,LessStencilFunc:sT,Light:El,LightProbe:mw,Line:_l,Line3:Sw,LineBasicMaterial:vr,LineCurve:Ay,LineCurve3:VM,LineDashedMaterial:tw,LineLoop:kM,LineSegments:bo,LinearDisplayP3ColorSpace:xh,LinearFilter:pi,LinearInterpolant:Dy,LinearMipMapLinearFilter:YE,LinearMipMapNearestFilter:XE,LinearMipmapLinearFilter:Mo,LinearMipmapNearestFilter:Wd,LinearSRGBColorSpace:ya,LinearToneMapping:zS,LinearTransfer:nh,Loader:zr,LoaderUtils:Yv,LoadingManager:Oy,LoopOnce:eM,LoopPingPong:nM,LoopRepeat:tM,LuminanceAlphaFormat:KS,LuminanceFormat:QS,MOUSE:xu,Material:Wi,MaterialLoader:dg,MathUtils:hy,Matrix3:Wt,Matrix4:It,MaxEquation:mS,Mesh:ti,MeshBasicMaterial:Ml,MeshDepthMaterial:xy,MeshDistanceMaterial:_y,MeshLambertMaterial:$M,MeshMatcapMaterial:ew,MeshNormalMaterial:JM,MeshPhongMaterial:QM,MeshPhysicalMaterial:ZM,MeshStandardMaterial:Iy,MeshToonMaterial:KM,MinEquation:pS,MirroredRepeatWrapping:Jd,MixOperation:OS,MultiplyBlending:fv,MultiplyOperation:vh,NearestFilter:Ai,NearestMipMapLinearFilter:jE,NearestMipMapNearestFilter:WE,NearestMipmapLinearFilter:mf,NearestMipmapNearestFilter:ty,NeutralToneMapping:GS,NeverCompare:oM,NeverDepth:RS,NeverStencilFunc:rT,NoBlending:pa,NoColorSpace:fa,NoToneMapping:Eo,NormalAnimationBlendMode:Gm,NormalBlending:bu,NotEqualCompare:cM,NotEqualDepth:US,NotEqualStencilFunc:uT,NumberKeyframeTrack:hh,Object3D:cn,ObjectLoader:GP,ObjectSpaceNormalMap:sM,OctahedronGeometry:Eh,OneFactor:vS,OneMinusConstantAlphaFactor:bS,OneMinusConstantColorFactor:AS,OneMinusDstAlphaFactor:SS,OneMinusDstColorFactor:wS,OneMinusSrcAlphaFactor:Im,OneMinusSrcColorFactor:xS,OrthographicCamera:vl,P3Primaries:rh,PCFShadowMap:Hm,PCFSoftShadowMap:Gd,PMREMGenerator:Hv,Path:uh,PerspectiveCamera:ei,Plane:xo,PlaneGeometry:Lf,PlaneHelper:C3,PointLight:cw,PointLightHelper:y3,Points:zM,PointsMaterial:wy,PolarGridHelper:M3,PolyhedronGeometry:wl,PositionalAudio:KP,PropertyBinding:an,PropertyMixer:yw,QuadraticBezierCurve:Cy,QuadraticBezierCurve3:by,Quaternion:ir,QuaternionKeyframeTrack:Df,QuaternionLinearInterpolant:ow,RED_GREEN_RGTC2_Format:kv,RED_RGTC1_Format:$S,REVISION:bf,RGBADepthPacking:rM,RGBAFormat:kr,RGBAIntegerFormat:uy,RGBA_ASTC_10x10_Format:Lv,RGBA_ASTC_10x5_Format:bv,RGBA_ASTC_10x6_Format:Rv,RGBA_ASTC_10x8_Format:Pv,RGBA_ASTC_12x10_Format:Iv,RGBA_ASTC_12x12_Format:Nv,RGBA_ASTC_4x4_Format:_v,RGBA_ASTC_5x4_Format:Sv,RGBA_ASTC_5x5_Format:Mv,RGBA_ASTC_6x5_Format:wv,RGBA_ASTC_6x6_Format:Ev,RGBA_ASTC_8x5_Format:Tv,RGBA_ASTC_8x6_Format:Av,RGBA_ASTC_8x8_Format:Cv,RGBA_BPTC_Format:Am,RGBA_ETC2_EAC_Format:xv,RGBA_PVRTC_2BPPV1_Format:gv,RGBA_PVRTC_4BPPV1_Format:mv,RGBA_S3TC_DXT1_Format:wm,RGBA_S3TC_DXT3_Format:Em,RGBA_S3TC_DXT5_Format:Tm,RGBFormat:ZS,RGB_BPTC_SIGNED_Format:Dv,RGB_BPTC_UNSIGNED_Format:Uv,RGB_ETC1_Format:vv,RGB_ETC2_Format:yv,RGB_PVRTC_2BPPV1_Format:pv,RGB_PVRTC_4BPPV1_Format:hv,RGB_S3TC_DXT1_Format:Mm,RGFormat:JS,RGIntegerFormat:ly,RawShaderMaterial:qM,Ray:Ou,Raycaster:_w,Rec709Primaries:ih,RectAreaLight:hw,RedFormat:oy,RedIntegerFormat:ay,ReinhardToneMapping:FS,RenderTarget:vM,RepeatWrapping:Kd,ReplaceStencilOp:JE,ReverseSubtractEquation:hS,RingGeometry:og,SIGNED_RED_GREEN_RGTC2_Format:zv,SIGNED_RED_RGTC1_Format:Ov,SRGBColorSpace:vs,SRGBTransfer:bn,Scene:Nm,ShaderChunk:qt,ShaderLib:Ys,ShaderMaterial:is,ShadowMaterial:YM,Shape:Iu,ShapeGeometry:ag,ShapePath:P3,ShapeUtils:To,ShortType:XS,Skeleton:Qm,SkeletonHelper:v3,SkinnedMesh:DM,Source:Au,Sphere:bi,SphereGeometry:Th,Spherical:Zv,SphericalHarmonics3:pw,SplineCurve:Ry,SpotLight:uw,SpotLightHelper:g3,Sprite:IM,SpriteMaterial:Sy,SrcAlphaFactor:Lm,SrcAlphaSaturateFactor:ES,SrcColorFactor:yS,StaticCopyUsage:gT,StaticDrawUsage:sh,StaticReadUsage:hT,StereoCamera:YP,StreamCopyUsage:yT,StreamDrawUsage:dT,StreamReadUsage:mT,StringKeyframeTrack:Fu,SubtractEquation:dS,SubtractiveBlending:cv,TOUCH:_u,TangentSpaceNormalMap:Sl,TetrahedronGeometry:lg,Texture:Vn,TextureLoader:FP,TorusGeometry:ug,TorusKnotGeometry:cg,Triangle:$r,TriangleFanDrawMode:QE,TriangleStripDrawMode:ZE,TrianglesDrawMode:qE,TubeGeometry:fg,UVMapping:Vm,Uint16BufferAttribute:my,Uint32BufferAttribute:gy,Uint8BufferAttribute:$T,Uint8ClampedBufferAttribute:eA,Uniform:Gy,UniformsGroup:d3,UniformsLib:et,UniformsUtils:lh,UnsignedByteType:Ao,UnsignedInt248Type:Pf,UnsignedInt5999Type:YS,UnsignedIntType:Du,UnsignedShort4444Type:ry,UnsignedShort5551Type:sy,UnsignedShortType:ny,VSMShadowMap:js,Vector2:Ne,Vector3:G,Vector4:nn,VectorKeyframeTrack:ph,VideoTexture:KR,WebGL3DRenderTarget:HT,WebGLArrayRenderTarget:BT,WebGLCoordinateSystem:wo,WebGLCubeRenderTarget:SM,WebGLMultipleRenderTargets:L3,WebGLRenderTarget:qs,WebGLRenderer:PM,WebGLUtils:bM,WebGPUCoordinateSystem:oh,WireframeGeometry:Ly,WrapAroundEnding:th,ZeroCurvatureEnding:Eu,ZeroFactor:gS,ZeroSlopeEnding:Tu,ZeroStencilOp:KE,createCanvasElement:pM},Symbol.toStringTag,{value:"Module"}));var N0={exports:{}},ml={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h1;function N3(){return h1||(h1=1,ml.ConcurrentRoot=1,ml.ContinuousEventPriority=4,ml.DefaultEventPriority=16,ml.DiscreteEventPriority=1,ml.IdleEventPriority=536870912,ml.LegacyRoot=0),ml}var p1;function D3(){return p1||(p1=1,N0.exports=N3()),N0.exports}var _f=D3();function U3(s){let e;const t=new Set,n=(p,m)=>{const g=typeof p=="function"?p(e):p;if(g!==e){const y=e;e=m?g:Object.assign({},e,g),t.forEach(_=>_(e,y))}},i=()=>e,o=(p,m=i,g=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let y=m(e);function _(){const M=m(e);if(!g(y,M)){const A=y;p(y=M,A)}}return t.add(_),()=>t.delete(_)},d={setState:n,getState:i,subscribe:(p,m,g)=>m||g?o(p,m,g):(t.add(p),()=>t.delete(p)),destroy:()=>t.clear()};return e=s(n,i,d),d}const O3=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),m1=O3?ve.useEffect:ve.useLayoutEffect;function k3(s){const e=typeof s=="function"?U3(s):s,t=(n=e.getState,i=Object.is)=>{const[,o]=ve.useReducer(E=>E+1,0),u=e.getState(),f=ve.useRef(u),d=ve.useRef(n),p=ve.useRef(i),m=ve.useRef(!1),g=ve.useRef();g.current===void 0&&(g.current=n(u));let y,_=!1;(f.current!==u||d.current!==n||p.current!==i||m.current)&&(y=n(u),_=!i(g.current,y)),m1(()=>{_&&(g.current=y),f.current=u,d.current=n,p.current=i,m.current=!1});const M=ve.useRef(u);m1(()=>{const E=()=>{try{const P=e.getState(),b=d.current(P);p.current(g.current,b)||(f.current=P,g.current=b,o())}catch{m.current=!0,o()}},S=e.subscribe(E);return e.getState()!==M.current&&E(),S},[]);const A=_?y:g.current;return ve.useDebugValue(A),A};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const i=n.length<=0;return{value:n.shift(),done:i}}}},t}var D0={exports:{}},U0={exports:{}},O0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g1;function z3(){return g1||(g1=1,(function(s){function e(W,ee){var k=W.length;W.push(ee);e:for(;0<k;){var J=k-1>>>1,Ce=W[J];if(0<i(Ce,ee))W[J]=ee,W[k]=Ce,k=J;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var ee=W[0],k=W.pop();if(k!==ee){W[0]=k;e:for(var J=0,Ce=W.length,Ve=Ce>>>1;J<Ve;){var se=2*(J+1)-1,Re=W[se],ke=se+1,Le=W[ke];if(0>i(Re,k))ke<Ce&&0>i(Le,Re)?(W[J]=Le,W[ke]=k,J=ke):(W[J]=Re,W[se]=k,J=se);else if(ke<Ce&&0>i(Le,k))W[J]=Le,W[ke]=k,J=ke;else break e}}return ee}function i(W,ee){var k=W.sortIndex-ee.sortIndex;return k!==0?k:W.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();s.unstable_now=function(){return u.now()-f}}var d=[],p=[],m=1,g=null,y=3,_=!1,M=!1,A=!1,E=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(W){for(var ee=t(p);ee!==null;){if(ee.callback===null)n(p);else if(ee.startTime<=W)n(p),ee.sortIndex=ee.expirationTime,e(d,ee);else break;ee=t(p)}}function L(W){if(A=!1,b(W),!M)if(t(d)!==null)M=!0,ye(B);else{var ee=t(p);ee!==null&&Me(L,ee.startTime-W)}}function B(W,ee){M=!1,A&&(A=!1,S(j),j=-1),_=!0;var k=y;try{for(b(ee),g=t(d);g!==null&&(!(g.expirationTime>ee)||W&&!X());){var J=g.callback;if(typeof J=="function"){g.callback=null,y=g.priorityLevel;var Ce=J(g.expirationTime<=ee);ee=s.unstable_now(),typeof Ce=="function"?g.callback=Ce:g===t(d)&&n(d),b(ee)}else n(d);g=t(d)}if(g!==null)var Ve=!0;else{var se=t(p);se!==null&&Me(L,se.startTime-ee),Ve=!1}return Ve}finally{g=null,y=k,_=!1}}var D=!1,F=null,j=-1,O=5,N=-1;function X(){return!(s.unstable_now()-N<O)}function te(){if(F!==null){var W=s.unstable_now();N=W;var ee=!0;try{ee=F(!0,W)}finally{ee?Q():(D=!1,F=null)}}else D=!1}var Q;if(typeof P=="function")Q=function(){P(te)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,fe=ue.port2;ue.port1.onmessage=te,Q=function(){fe.postMessage(null)}}else Q=function(){E(te,0)};function ye(W){F=W,D||(D=!0,Q())}function Me(W,ee){j=E(function(){W(s.unstable_now())},ee)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(W){W.callback=null},s.unstable_continueExecution=function(){M||_||(M=!0,ye(B))},s.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<W?Math.floor(1e3/W):5},s.unstable_getCurrentPriorityLevel=function(){return y},s.unstable_getFirstCallbackNode=function(){return t(d)},s.unstable_next=function(W){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var k=y;y=ee;try{return W()}finally{y=k}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(W,ee){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var k=y;y=W;try{return ee()}finally{y=k}},s.unstable_scheduleCallback=function(W,ee,k){var J=s.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?J+k:J):k=J,W){case 1:var Ce=-1;break;case 2:Ce=250;break;case 5:Ce=1073741823;break;case 4:Ce=1e4;break;default:Ce=5e3}return Ce=k+Ce,W={id:m++,callback:ee,priorityLevel:W,startTime:k,expirationTime:Ce,sortIndex:-1},k>J?(W.sortIndex=k,e(p,W),t(d)===null&&W===t(p)&&(A?(S(j),j=-1):A=!0,Me(L,k-J))):(W.sortIndex=Ce,e(d,W),M||_||(M=!0,ye(B))),W},s.unstable_shouldYield=X,s.unstable_wrapCallback=function(W){var ee=y;return function(){var k=y;y=ee;try{return W.apply(this,arguments)}finally{y=k}}}})(O0)),O0}var v1;function ww(){return v1||(v1=1,U0.exports=z3()),U0.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k0,y1;function F3(){return y1||(y1=1,k0=function(e){var t={},n=Cf(),i=ww(),o=Object.assign;function u(l){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+l,v=1;v<arguments.length;v++)c+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d=Symbol.for("react.element"),p=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),M=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),L=Symbol.for("react.offscreen"),B=Symbol.iterator;function D(l){return l===null||typeof l!="object"?null:(l=B&&l[B]||l["@@iterator"],typeof l=="function"?l:null)}function F(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case m:return"Fragment";case p:return"Portal";case y:return"Profiler";case g:return"StrictMode";case E:return"Suspense";case S:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case M:return(l.displayName||"Context")+".Consumer";case _:return(l._context.displayName||"Context")+".Provider";case A:var c=l.render;return l=l.displayName,l||(l=c.displayName||c.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case P:return c=l.displayName||null,c!==null?c:F(l.type)||"Memo";case b:c=l._payload,l=l._init;try{return F(l(c))}catch{}}return null}function j(l){var c=l.type;switch(l.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=c.render,l=l.displayName||l.name||"",c.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(c);case 8:return c===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function O(l){var c=l,v=l;if(l.alternate)for(;c.return;)c=c.return;else{l=c;do c=l,(c.flags&4098)!==0&&(v=c.return),l=c.return;while(l)}return c.tag===3?v:null}function N(l){if(O(l)!==l)throw Error(u(188))}function X(l){var c=l.alternate;if(!c){if(c=O(l),c===null)throw Error(u(188));return c!==l?null:l}for(var v=l,w=c;;){var C=v.return;if(C===null)break;var I=C.alternate;if(I===null){if(w=C.return,w!==null){v=w;continue}break}if(C.child===I.child){for(I=C.child;I;){if(I===v)return N(C),l;if(I===w)return N(C),c;I=I.sibling}throw Error(u(188))}if(v.return!==w.return)v=C,w=I;else{for(var Y=!1,re=C.child;re;){if(re===v){Y=!0,v=C,w=I;break}if(re===w){Y=!0,w=C,v=I;break}re=re.sibling}if(!Y){for(re=I.child;re;){if(re===v){Y=!0,v=I,w=C;break}if(re===w){Y=!0,w=I,v=C;break}re=re.sibling}if(!Y)throw Error(u(189))}}if(v.alternate!==w)throw Error(u(190))}if(v.tag!==3)throw Error(u(188));return v.stateNode.current===v?l:c}function te(l){return l=X(l),l!==null?Q(l):null}function Q(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var c=Q(l);if(c!==null)return c;l=l.sibling}return null}function ue(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var c=ue(l);if(c!==null)return c}l=l.sibling}return null}var fe=Array.isArray,ye=e.getPublicInstance,Me=e.getRootHostContext,W=e.getChildHostContext,ee=e.prepareForCommit,k=e.resetAfterCommit,J=e.createInstance,Ce=e.appendInitialChild,Ve=e.finalizeInitialChildren,se=e.prepareUpdate,Re=e.shouldSetTextContent,ke=e.createTextInstance,Le=e.scheduleTimeout,tt=e.cancelTimeout,xt=e.noTimeout,ae=e.isPrimaryRenderer,Mt=e.supportsMutation,Ae=e.supportsPersistence,Oe=e.supportsHydration,De=e.getInstanceFromNode,Xe=e.preparePortalMount,xe=e.getCurrentEventPriority,Fe=e.detachDeletedInstance,$e=e.supportsMicrotasks,q=e.scheduleMicrotask,z=e.supportsTestSelectors,de=e.findFiberRoot,Ie=e.getBoundingRect,ze=e.getTextContent,Ue=e.isHiddenSubtree,vt=e.matchAccessibilityRole,Je=e.setFocusIfFocusable,Ke=e.setupIntersectionObserver,Ct=e.appendChild,qe=e.appendChildToContainer,ft=e.commitTextUpdate,Nt=e.commitMount,Tt=e.commitUpdate,ot=e.insertBefore,Dt=e.insertInContainerBefore,Bt=e.removeChild,ne=e.removeChildFromContainer,Pe=e.resetTextContent,K=e.hideInstance,Ee=e.hideTextInstance,Te=e.unhideInstance,We=e.unhideTextInstance,Ze=e.clearContainer,Kt=e.cloneInstance,rn=e.createContainerChildSet,Jt=e.appendChildToContainerChildSet,fn=e.finalizeContainerChildren,Xt=e.replaceContainerChildren,On=e.cloneHiddenInstance,wn=e.cloneHiddenTextInstance,rr=e.canHydrateInstance,_a=e.canHydrateTextInstance,Ks=e.canHydrateSuspenseInstance,Ro=e.isSuspenseInstancePending,rs=e.isSuspenseInstanceFallback,Ss=e.registerSuspenseInstanceRetry,Fr=e.getNextHydratableSibling,Sa=e.getFirstHydratableChild,Uf=e.getFirstHydratableChildWithinContainer,Of=e.getFirstHydratableChildWithinSuspenseInstance,kf=e.hydrateInstance,H=e.hydrateTextInstance,le=e.hydrateSuspenseInstance,Se=e.getNextHydratableInstanceAfterSuspenseInstance,me=e.commitHydratedContainer,ge=e.commitHydratedSuspenseInstance,nt=e.clearSuspenseBoundary,ht=e.clearSuspenseBoundaryFromContainer,yt=e.shouldDeleteUnhydratedTailInstances,bt=e.didNotMatchHydratedContainerTextInstance,kt=e.didNotMatchHydratedTextInstance,ut;function zt(l){if(ut===void 0)try{throw Error()}catch(v){var c=v.stack.trim().match(/\n( *(at )?)/);ut=c&&c[1]||""}return`
`+ut+l}var gn=!1;function kn(l,c){if(!l||gn)return"";gn=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(je){var w=je}Reflect.construct(l,[],c)}else{try{c.call()}catch(je){w=je}l.call(c.prototype)}else{try{throw Error()}catch(je){w=je}l()}}catch(je){if(je&&w&&typeof je.stack=="string"){for(var C=je.stack.split(`
`),I=w.stack.split(`
`),Y=C.length-1,re=I.length-1;1<=Y&&0<=re&&C[Y]!==I[re];)re--;for(;1<=Y&&0<=re;Y--,re--)if(C[Y]!==I[re]){if(Y!==1||re!==1)do if(Y--,re--,0>re||C[Y]!==I[re]){var be=`
`+C[Y].replace(" at new "," at ");return l.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",l.displayName)),be}while(1<=Y&&0<=re);break}}}finally{gn=!1,Error.prepareStackTrace=v}return(l=l?l.displayName||l.name:"")?zt(l):""}var ni=Object.prototype.hasOwnProperty,sr=[],Qt=-1;function wt(l){return{current:l}}function Vt(l){0>Qt||(l.current=sr[Qt],sr[Qt]=null,Qt--)}function At(l,c){Qt++,sr[Qt]=l.current,l.current=c}var vn={},qn=wt(vn),Gn=wt(!1),Br=vn;function yn(l,c){var v=l.type.contextTypes;if(!v)return vn;var w=l.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===c)return w.__reactInternalMemoizedMaskedChildContext;var C={},I;for(I in v)C[I]=c[I];return w&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=c,l.__reactInternalMemoizedMaskedChildContext=C),C}function xn(l){return l=l.childContextTypes,l!=null}function yr(){Vt(Gn),Vt(qn)}function ii(l,c,v){if(qn.current!==vn)throw Error(u(168));At(qn,c),At(Gn,v)}function Ma(l,c,v){var w=l.stateNode;if(c=c.childContextTypes,typeof w.getChildContext!="function")return v;w=w.getChildContext();for(var C in w)if(!(C in c))throw Error(u(108,j(l)||"Unknown",C));return o({},v,w)}function wa(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||vn,Br=qn.current,At(qn,l),At(Gn,Gn.current),!0}function Po(l,c,v){var w=l.stateNode;if(!w)throw Error(u(169));v?(l=Ma(l,c,Br),w.__reactInternalMemoizedMergedChildContext=l,Vt(Gn),Vt(qn),At(qn,l)):Vt(Gn),At(Gn,v)}var xr=Math.clz32?Math.clz32:hg,zf=Math.log,Tl=Math.LN2;function hg(l){return l>>>=0,l===0?32:31-(zf(l)/Tl|0)|0}var Ea=64,sn=4194304;function Ta(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Al(l,c){var v=l.pendingLanes;if(v===0)return 0;var w=0,C=l.suspendedLanes,I=l.pingedLanes,Y=v&268435455;if(Y!==0){var re=Y&~C;re!==0?w=Ta(re):(I&=Y,I!==0&&(w=Ta(I)))}else Y=v&~C,Y!==0?w=Ta(Y):I!==0&&(w=Ta(I));if(w===0)return 0;if(c!==0&&c!==w&&(c&C)===0&&(C=w&-w,I=c&-c,C>=I||C===16&&(I&4194240)!==0))return c;if((w&4)!==0&&(w|=v&16),c=l.entangledLanes,c!==0)for(l=l.entanglements,c&=w;0<c;)v=31-xr(c),C=1<<v,w|=l[v],c&=~C;return w}function Ff(l,c){switch(l){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bh(l,c){for(var v=l.suspendedLanes,w=l.pingedLanes,C=l.expirationTimes,I=l.pendingLanes;0<I;){var Y=31-xr(I),re=1<<Y,be=C[Y];be===-1?((re&v)===0||(re&w)!==0)&&(C[Y]=Ff(re,c)):be<=c&&(l.expiredLanes|=re),I&=~re}}function Bu(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Hu(l){for(var c=[],v=0;31>v;v++)c.push(l);return c}function Lo(l,c,v){l.pendingLanes|=c,c!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,c=31-xr(c),l[c]=v}function Vu(l,c){var v=l.pendingLanes&~c;l.pendingLanes=c,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=c,l.mutableReadLanes&=c,l.entangledLanes&=c,c=l.entanglements;var w=l.eventTimes;for(l=l.expirationTimes;0<v;){var C=31-xr(v),I=1<<C;c[C]=0,w[C]=-1,l[C]=-1,v&=~I}}function ss(l,c){var v=l.entangledLanes|=c;for(l=l.entanglements;v;){var w=31-xr(v),C=1<<w;C&c|l[w]&c&&(l[w]|=c),v&=~C}}var Yt=0;function Ms(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Io=i.unstable_scheduleCallback,Aa=i.unstable_cancelCallback,Js=i.unstable_shouldYield,pg=i.unstable_requestPaint,Zn=i.unstable_now,No=i.unstable_ImmediatePriority,mg=i.unstable_UserBlockingPriority,Gu=i.unstable_NormalPriority,Wu=i.unstable_IdlePriority,Cl=null,os=null;function bl(l){if(os&&typeof os.onCommitFiberRoot=="function")try{os.onCommitFiberRoot(Cl,l,void 0,(l.current.flags&128)===128)}catch{}}function Rl(l,c){return l===c&&(l!==0||1/l===1/c)||l!==l&&c!==c}var Ri=typeof Object.is=="function"?Object.is:Rl,_r=null,ju=!1,Bf=!1;function Xu(l){_r===null?_r=[l]:_r.push(l)}function Yu(l){ju=!0,Xu(l)}function Sr(){if(!Bf&&_r!==null){Bf=!0;var l=0,c=Yt;try{var v=_r;for(Yt=1;l<v.length;l++){var w=v[l];do w=w(!0);while(w!==null)}_r=null,ju=!1}catch(C){throw _r!==null&&(_r=_r.slice(l+1)),Io(No,Sr),C}finally{Yt=c,Bf=!1}}return null}var Rh=f.ReactCurrentBatchConfig;function Hr(l,c){if(Ri(l,c))return!0;if(typeof l!="object"||l===null||typeof c!="object"||c===null)return!1;var v=Object.keys(l),w=Object.keys(c);if(v.length!==w.length)return!1;for(w=0;w<v.length;w++){var C=v[w];if(!ni.call(c,C)||!Ri(l[C],c[C]))return!1}return!0}function Hf(l){switch(l.tag){case 5:return zt(l.type);case 16:return zt("Lazy");case 13:return zt("Suspense");case 19:return zt("SuspenseList");case 0:case 2:case 15:return l=kn(l.type,!1),l;case 11:return l=kn(l.type.render,!1),l;case 1:return l=kn(l.type,!0),l;default:return""}}function ji(l,c){if(l&&l.defaultProps){c=o({},c),l=l.defaultProps;for(var v in l)c[v]===void 0&&(c[v]=l[v]);return c}return c}var Pl=wt(null),Do=null,ws=null,qu=null;function Pi(){qu=ws=Do=null}function Uo(l,c,v){ae?(At(Pl,c._currentValue),c._currentValue=v):(At(Pl,c._currentValue2),c._currentValue2=v)}function Ll(l){var c=Pl.current;Vt(Pl),ae?l._currentValue=c:l._currentValue2=c}function Oo(l,c,v){for(;l!==null;){var w=l.alternate;if((l.childLanes&c)!==c?(l.childLanes|=c,w!==null&&(w.childLanes|=c)):w!==null&&(w.childLanes&c)!==c&&(w.childLanes|=c),l===v)break;l=l.return}}function Ca(l,c){Do=l,qu=ws=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&c)!==0&&(ai=!0),l.firstContext=null)}function Xi(l){var c=ae?l._currentValue:l._currentValue2;if(qu!==l)if(l={context:l,memoizedValue:c,next:null},ws===null){if(Do===null)throw Error(u(308));ws=l,Do.dependencies={lanes:0,firstContext:l}}else ws=ws.next=l;return c}var Mr=null,wr=!1;function ba(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vf(l,c){l=l.updateQueue,c.updateQueue===l&&(c.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Es(l,c){return{eventTime:l,lane:c,tag:0,payload:null,callback:null,next:null}}function $s(l,c){var v=l.updateQueue;v!==null&&(v=v.shared,Ln!==null&&(l.mode&1)!==0&&(Gt&2)===0?(l=v.interleaved,l===null?(c.next=c,Mr===null?Mr=[v]:Mr.push(v)):(c.next=l.next,l.next=c),v.interleaved=c):(l=v.pending,l===null?c.next=c:(c.next=l.next,l.next=c),v.pending=c))}function Zu(l,c,v){if(c=c.updateQueue,c!==null&&(c=c.shared,(v&4194240)!==0)){var w=c.lanes;w&=l.pendingLanes,v|=w,c.lanes=v,ss(l,v)}}function Qu(l,c){var v=l.updateQueue,w=l.alternate;if(w!==null&&(w=w.updateQueue,v===w)){var C=null,I=null;if(v=v.firstBaseUpdate,v!==null){do{var Y={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};I===null?C=I=Y:I=I.next=Y,v=v.next}while(v!==null);I===null?C=I=c:I=I.next=c}else C=I=c;v={baseState:w.baseState,firstBaseUpdate:C,lastBaseUpdate:I,shared:w.shared,effects:w.effects},l.updateQueue=v;return}l=v.lastBaseUpdate,l===null?v.firstBaseUpdate=c:l.next=c,v.lastBaseUpdate=c}function Ku(l,c,v,w){var C=l.updateQueue;wr=!1;var I=C.firstBaseUpdate,Y=C.lastBaseUpdate,re=C.shared.pending;if(re!==null){C.shared.pending=null;var be=re,je=be.next;be.next=null,Y===null?I=je:Y.next=je,Y=be;var lt=l.alternate;lt!==null&&(lt=lt.updateQueue,re=lt.lastBaseUpdate,re!==Y&&(re===null?lt.firstBaseUpdate=je:re.next=je,lt.lastBaseUpdate=be))}if(I!==null){var Ft=C.baseState;Y=0,lt=je=be=null,re=I;do{var Et=re.lane,hn=re.eventTime;if((w&Et)===Et){lt!==null&&(lt=lt.next={eventTime:hn,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var rt=l,ln=re;switch(Et=c,hn=v,ln.tag){case 1:if(rt=ln.payload,typeof rt=="function"){Ft=rt.call(hn,Ft,Et);break e}Ft=rt;break e;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=ln.payload,Et=typeof rt=="function"?rt.call(hn,Ft,Et):rt,Et==null)break e;Ft=o({},Ft,Et);break e;case 2:wr=!0}}re.callback!==null&&re.lane!==0&&(l.flags|=64,Et=C.effects,Et===null?C.effects=[re]:Et.push(re))}else hn={eventTime:hn,lane:Et,tag:re.tag,payload:re.payload,callback:re.callback,next:null},lt===null?(je=lt=hn,be=Ft):lt=lt.next=hn,Y|=Et;if(re=re.next,re===null){if(re=C.shared.pending,re===null)break;Et=re,re=Et.next,Et.next=null,C.lastBaseUpdate=Et,C.shared.pending=null}}while(!0);if(lt===null&&(be=Ft),C.baseState=be,C.firstBaseUpdate=je,C.lastBaseUpdate=lt,c=C.shared.interleaved,c!==null){C=c;do Y|=C.lane,C=C.next;while(C!==c)}else I===null&&(C.shared.lanes=0);Jo|=Y,l.lanes=Y,l.memoizedState=Ft}}function Ph(l,c,v){if(l=c.effects,c.effects=null,l!==null)for(c=0;c<l.length;c++){var w=l[c],C=w.callback;if(C!==null){if(w.callback=null,w=v,typeof C!="function")throw Error(u(191,C));C.call(w)}}}var Lh=new n.Component().refs;function Gf(l,c,v,w){c=l.memoizedState,v=v(w,c),v=v==null?c:o({},c,v),l.memoizedState=v,l.lanes===0&&(l.updateQueue.baseState=v)}var Ju={isMounted:function(l){return(l=l._reactInternals)?O(l)===l:!1},enqueueSetState:function(l,c,v){l=l._reactInternals;var w=ci(),C=ds(l),I=Es(w,C);I.payload=c,v!=null&&(I.callback=v),$s(l,I),c=Qi(l,C,w),c!==null&&Zu(c,l,C)},enqueueReplaceState:function(l,c,v){l=l._reactInternals;var w=ci(),C=ds(l),I=Es(w,C);I.tag=1,I.payload=c,v!=null&&(I.callback=v),$s(l,I),c=Qi(l,C,w),c!==null&&Zu(c,l,C)},enqueueForceUpdate:function(l,c){l=l._reactInternals;var v=ci(),w=ds(l),C=Es(v,w);C.tag=2,c!=null&&(C.callback=c),$s(l,C),c=Qi(l,w,v),c!==null&&Zu(c,l,w)}};function Wf(l,c,v,w,C,I,Y){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(w,I,Y):c.prototype&&c.prototype.isPureReactComponent?!Hr(v,w)||!Hr(C,I):!0}function Ih(l,c,v){var w=!1,C=vn,I=c.contextType;return typeof I=="object"&&I!==null?I=Xi(I):(C=xn(c)?Br:qn.current,w=c.contextTypes,I=(w=w!=null)?yn(l,C):vn),c=new c(v,I),l.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Ju,l.stateNode=c,c._reactInternals=l,w&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=C,l.__reactInternalMemoizedMaskedChildContext=I),c}function Nh(l,c,v,w){l=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(v,w),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(v,w),c.state!==l&&Ju.enqueueReplaceState(c,c.state,null)}function jf(l,c,v,w){var C=l.stateNode;C.props=v,C.state=l.memoizedState,C.refs=Lh,ba(l);var I=c.contextType;typeof I=="object"&&I!==null?C.context=Xi(I):(I=xn(c)?Br:qn.current,C.context=yn(l,I)),C.state=l.memoizedState,I=c.getDerivedStateFromProps,typeof I=="function"&&(Gf(l,c,I,v),C.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(c=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),c!==C.state&&Ju.enqueueReplaceState(C,C.state,null),Ku(l,v,C,w),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308)}var Ra=[],eo=0,$u=null,ec=0,Er=[],or=0,ko=null,Ts=1,As="";function zo(l,c){Ra[eo++]=ec,Ra[eo++]=$u,$u=l,ec=c}function Dh(l,c,v){Er[or++]=Ts,Er[or++]=As,Er[or++]=ko,ko=l;var w=Ts;l=As;var C=32-xr(w)-1;w&=~(1<<C),v+=1;var I=32-xr(c)+C;if(30<I){var Y=C-C%5;I=(w&(1<<Y)-1).toString(32),w>>=Y,C-=Y,Ts=1<<32-xr(c)+C|v<<C|w,As=I+l}else Ts=1<<I|v<<C|w,As=l}function Xf(l){l.return!==null&&(zo(l,1),Dh(l,1,0))}function Yf(l){for(;l===$u;)$u=Ra[--eo],Ra[eo]=null,ec=Ra[--eo],Ra[eo]=null;for(;l===ko;)ko=Er[--or],Er[or]=null,As=Er[--or],Er[or]=null,Ts=Er[--or],Er[or]=null}var Li=null,mi=null,An=!1,Pa=!1,Tr=null;function qf(l,c){var v=fr(5,null,null,0);v.elementType="DELETED",v.stateNode=c,v.return=l,c=l.deletions,c===null?(l.deletions=[v],l.flags|=16):c.push(v)}function Zf(l,c){switch(l.tag){case 5:return c=rr(c,l.type,l.pendingProps),c!==null?(l.stateNode=c,Li=l,mi=Sa(c),!0):!1;case 6:return c=_a(c,l.pendingProps),c!==null?(l.stateNode=c,Li=l,mi=null,!0):!1;case 13:if(c=Ks(c),c!==null){var v=ko!==null?{id:Ts,overflow:As}:null;return l.memoizedState={dehydrated:c,treeContext:v,retryLane:1073741824},v=fr(18,null,null,0),v.stateNode=c,v.return=l,l.child=v,Li=l,mi=null,!0}return!1;default:return!1}}function tc(l){return(l.mode&1)!==0&&(l.flags&128)===0}function to(l){if(An){var c=mi;if(c){var v=c;if(!Zf(l,c)){if(tc(l))throw Error(u(418));c=Fr(v);var w=Li;c&&Zf(l,c)?qf(w,v):(l.flags=l.flags&-4097|2,An=!1,Li=l)}}else{if(tc(l))throw Error(u(418));l.flags=l.flags&-4097|2,An=!1,Li=l}}}function Uh(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Li=l}function Il(l){if(!Oe||l!==Li)return!1;if(!An)return Uh(l),An=!0,!1;if(l.tag!==3&&(l.tag!==5||yt(l.type)&&!Re(l.type,l.memoizedProps))){var c=mi;if(c){if(tc(l)){for(l=mi;l;)l=Fr(l);throw Error(u(418))}for(;c;)qf(l,c),c=Fr(c)}}if(Uh(l),l.tag===13){if(!Oe)throw Error(u(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(u(317));mi=Se(l)}else mi=Li?Fr(l.stateNode):null;return!0}function La(){Oe&&(mi=Li=null,Pa=An=!1)}function nc(l){Tr===null?Tr=[l]:Tr.push(l)}function Ia(l,c,v){if(l=v.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(u(309));var w=v.stateNode}if(!w)throw Error(u(147,l));var C=w,I=""+l;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===I?c.ref:(c=function(Y){var re=C.refs;re===Lh&&(re=C.refs={}),Y===null?delete re[I]:re[I]=Y},c._stringRef=I,c)}if(typeof l!="string")throw Error(u(284));if(!v._owner)throw Error(u(290,l))}return l}function no(l,c){throw l=Object.prototype.toString.call(c),Error(u(31,l==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":l))}function Na(l){var c=l._init;return c(l._payload)}function Oh(l){function c(pe,oe){if(l){var we=pe.deletions;we===null?(pe.deletions=[oe],pe.flags|=16):we.push(oe)}}function v(pe,oe){if(!l)return null;for(;oe!==null;)c(pe,oe),oe=oe.sibling;return null}function w(pe,oe){for(pe=new Map;oe!==null;)oe.key!==null?pe.set(oe.key,oe):pe.set(oe.index,oe),oe=oe.sibling;return pe}function C(pe,oe){return pe=zs(pe,oe),pe.index=0,pe.sibling=null,pe}function I(pe,oe,we){return pe.index=we,l?(we=pe.alternate,we!==null?(we=we.index,we<oe?(pe.flags|=2,oe):we):(pe.flags|=2,oe)):(pe.flags|=1048576,oe)}function Y(pe){return l&&pe.alternate===null&&(pe.flags|=2),pe}function re(pe,oe,we,it){return oe===null||oe.tag!==6?(oe=Dc(we,pe.mode,it),oe.return=pe,oe):(oe=C(oe,we),oe.return=pe,oe)}function be(pe,oe,we,it){var mt=we.type;return mt===m?lt(pe,oe,we.props.children,it,we.key):oe!==null&&(oe.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===b&&Na(mt)===oe.type)?(it=C(oe,we.props),it.ref=Ia(pe,oe,we),it.return=pe,it):(it=tu(we.type,we.key,we.props,null,pe.mode,it),it.ref=Ia(pe,oe,we),it.return=pe,it)}function je(pe,oe,we,it){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==we.containerInfo||oe.stateNode.implementation!==we.implementation?(oe=Uc(we,pe.mode,it),oe.return=pe,oe):(oe=C(oe,we.children||[]),oe.return=pe,oe)}function lt(pe,oe,we,it,mt){return oe===null||oe.tag!==7?(oe=mo(we,pe.mode,it,mt),oe.return=pe,oe):(oe=C(oe,we),oe.return=pe,oe)}function Ft(pe,oe,we){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Dc(""+oe,pe.mode,we),oe.return=pe,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case d:return we=tu(oe.type,oe.key,oe.props,null,pe.mode,we),we.ref=Ia(pe,null,oe),we.return=pe,we;case p:return oe=Uc(oe,pe.mode,we),oe.return=pe,oe;case b:var it=oe._init;return Ft(pe,it(oe._payload),we)}if(fe(oe)||D(oe))return oe=mo(oe,pe.mode,we,null),oe.return=pe,oe;no(pe,oe)}return null}function Et(pe,oe,we,it){var mt=oe!==null?oe.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return mt!==null?null:re(pe,oe,""+we,it);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case d:return we.key===mt?be(pe,oe,we,it):null;case p:return we.key===mt?je(pe,oe,we,it):null;case b:return mt=we._init,Et(pe,oe,mt(we._payload),it)}if(fe(we)||D(we))return mt!==null?null:lt(pe,oe,we,it,null);no(pe,we)}return null}function hn(pe,oe,we,it,mt){if(typeof it=="string"&&it!==""||typeof it=="number")return pe=pe.get(we)||null,re(oe,pe,""+it,mt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case d:return pe=pe.get(it.key===null?we:it.key)||null,be(oe,pe,it,mt);case p:return pe=pe.get(it.key===null?we:it.key)||null,je(oe,pe,it,mt);case b:var Ht=it._init;return hn(pe,oe,we,Ht(it._payload),mt)}if(fe(it)||D(it))return pe=pe.get(we)||null,lt(oe,pe,it,mt,null);no(oe,it)}return null}function rt(pe,oe,we,it){for(var mt=null,Ht=null,Ut=oe,tn=oe=0,Kn=null;Ut!==null&&tn<we.length;tn++){Ut.index>tn?(Kn=Ut,Ut=null):Kn=Ut.sibling;var en=Et(pe,Ut,we[tn],it);if(en===null){Ut===null&&(Ut=Kn);break}l&&Ut&&en.alternate===null&&c(pe,Ut),oe=I(en,oe,tn),Ht===null?mt=en:Ht.sibling=en,Ht=en,Ut=Kn}if(tn===we.length)return v(pe,Ut),An&&zo(pe,tn),mt;if(Ut===null){for(;tn<we.length;tn++)Ut=Ft(pe,we[tn],it),Ut!==null&&(oe=I(Ut,oe,tn),Ht===null?mt=Ut:Ht.sibling=Ut,Ht=Ut);return An&&zo(pe,tn),mt}for(Ut=w(pe,Ut);tn<we.length;tn++)Kn=hn(Ut,pe,tn,we[tn],it),Kn!==null&&(l&&Kn.alternate!==null&&Ut.delete(Kn.key===null?tn:Kn.key),oe=I(Kn,oe,tn),Ht===null?mt=Kn:Ht.sibling=Kn,Ht=Kn);return l&&Ut.forEach(function(hs){return c(pe,hs)}),An&&zo(pe,tn),mt}function ln(pe,oe,we,it){var mt=D(we);if(typeof mt!="function")throw Error(u(150));if(we=mt.call(we),we==null)throw Error(u(151));for(var Ht=mt=null,Ut=oe,tn=oe=0,Kn=null,en=we.next();Ut!==null&&!en.done;tn++,en=we.next()){Ut.index>tn?(Kn=Ut,Ut=null):Kn=Ut.sibling;var hs=Et(pe,Ut,en.value,it);if(hs===null){Ut===null&&(Ut=Kn);break}l&&Ut&&hs.alternate===null&&c(pe,Ut),oe=I(hs,oe,tn),Ht===null?mt=hs:Ht.sibling=hs,Ht=hs,Ut=Kn}if(en.done)return v(pe,Ut),An&&zo(pe,tn),mt;if(Ut===null){for(;!en.done;tn++,en=we.next())en=Ft(pe,en.value,it),en!==null&&(oe=I(en,oe,tn),Ht===null?mt=en:Ht.sibling=en,Ht=en);return An&&zo(pe,tn),mt}for(Ut=w(pe,Ut);!en.done;tn++,en=we.next())en=hn(Ut,pe,tn,en.value,it),en!==null&&(l&&en.alternate!==null&&Ut.delete(en.key===null?tn:en.key),oe=I(en,oe,tn),Ht===null?mt=en:Ht.sibling=en,Ht=en);return l&&Ut.forEach(function(tp){return c(pe,tp)}),An&&zo(pe,tn),mt}function dr(pe,oe,we,it){if(typeof we=="object"&&we!==null&&we.type===m&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case d:e:{for(var mt=we.key,Ht=oe;Ht!==null;){if(Ht.key===mt){if(mt=we.type,mt===m){if(Ht.tag===7){v(pe,Ht.sibling),oe=C(Ht,we.props.children),oe.return=pe,pe=oe;break e}}else if(Ht.elementType===mt||typeof mt=="object"&&mt!==null&&mt.$$typeof===b&&Na(mt)===Ht.type){v(pe,Ht.sibling),oe=C(Ht,we.props),oe.ref=Ia(pe,Ht,we),oe.return=pe,pe=oe;break e}v(pe,Ht);break}else c(pe,Ht);Ht=Ht.sibling}we.type===m?(oe=mo(we.props.children,pe.mode,it,we.key),oe.return=pe,pe=oe):(it=tu(we.type,we.key,we.props,null,pe.mode,it),it.ref=Ia(pe,oe,we),it.return=pe,pe=it)}return Y(pe);case p:e:{for(Ht=we.key;oe!==null;){if(oe.key===Ht)if(oe.tag===4&&oe.stateNode.containerInfo===we.containerInfo&&oe.stateNode.implementation===we.implementation){v(pe,oe.sibling),oe=C(oe,we.children||[]),oe.return=pe,pe=oe;break e}else{v(pe,oe);break}else c(pe,oe);oe=oe.sibling}oe=Uc(we,pe.mode,it),oe.return=pe,pe=oe}return Y(pe);case b:return Ht=we._init,dr(pe,oe,Ht(we._payload),it)}if(fe(we))return rt(pe,oe,we,it);if(D(we))return ln(pe,oe,we,it);no(pe,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,oe!==null&&oe.tag===6?(v(pe,oe.sibling),oe=C(oe,we),oe.return=pe,pe=oe):(v(pe,oe),oe=Dc(we,pe.mode,it),oe.return=pe,pe=oe),Y(pe)):v(pe,oe)}return dr}var Cs=Oh(!0),kh=Oh(!1),Da={},Yi=wt(Da),Fo=wt(Da),Bo=wt(Da);function Vr(l){if(l===Da)throw Error(u(174));return l}function ic(l,c){At(Bo,c),At(Fo,l),At(Yi,Da),l=Me(c),Vt(Yi),At(Yi,l)}function Ua(){Vt(Yi),Vt(Fo),Vt(Bo)}function zh(l){var c=Vr(Bo.current),v=Vr(Yi.current);c=W(v,l.type,c),v!==c&&(At(Fo,l),At(Yi,c))}function Qf(l){Fo.current===l&&(Vt(Yi),Vt(Fo))}var Rn=wt(0);function rc(l){for(var c=l;c!==null;){if(c.tag===13){var v=c.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||Ro(v)||rs(v)))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var ar=[];function Ho(){for(var l=0;l<ar.length;l++){var c=ar[l];ae?c._workInProgressVersionPrimary=null:c._workInProgressVersionSecondary=null}ar.length=0}var Nl=f.ReactCurrentDispatcher,lr=f.ReactCurrentBatchConfig,Vo=0,Pn=null,ri=null,si=null,sc=!1,as=!1,Go=0,Dl=0;function oi(){throw Error(u(321))}function oc(l,c){if(c===null)return!1;for(var v=0;v<c.length&&v<l.length;v++)if(!Ri(l[v],c[v]))return!1;return!0}function Oa(l,c,v,w,C,I){if(Vo=I,Pn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Nl.current=l===null||l.memoizedState===null?nd:id,l=v(w,C),as){I=0;do{if(as=!1,Go=0,25<=I)throw Error(u(301));I+=1,si=ri=null,c.updateQueue=null,Nl.current=rd,l=v(w,C)}while(as)}if(Nl.current=Ba,c=ri!==null&&ri.next!==null,Vo=0,si=ri=Pn=null,sc=!1,c)throw Error(u(300));return l}function io(){var l=Go!==0;return Go=0,l}function Gr(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return si===null?Pn.memoizedState=si=l:si=si.next=l,si}function Wr(){if(ri===null){var l=Pn.alternate;l=l!==null?l.memoizedState:null}else l=ri.next;var c=si===null?Pn.memoizedState:si.next;if(c!==null)si=c,ri=l;else{if(l===null)throw Error(u(310));ri=l,l={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},si===null?Pn.memoizedState=si=l:si=si.next=l}return si}function ls(l,c){return typeof c=="function"?c(l):c}function Ul(l){var c=Wr(),v=c.queue;if(v===null)throw Error(u(311));v.lastRenderedReducer=l;var w=ri,C=w.baseQueue,I=v.pending;if(I!==null){if(C!==null){var Y=C.next;C.next=I.next,I.next=Y}w.baseQueue=C=I,v.pending=null}if(C!==null){I=C.next,w=w.baseState;var re=Y=null,be=null,je=I;do{var lt=je.lane;if((Vo&lt)===lt)be!==null&&(be=be.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),w=je.hasEagerState?je.eagerState:l(w,je.action);else{var Ft={lane:lt,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};be===null?(re=be=Ft,Y=w):be=be.next=Ft,Pn.lanes|=lt,Jo|=lt}je=je.next}while(je!==null&&je!==I);be===null?Y=w:be.next=re,Ri(w,c.memoizedState)||(ai=!0),c.memoizedState=w,c.baseState=Y,c.baseQueue=be,v.lastRenderedState=w}if(l=v.interleaved,l!==null){C=l;do I=C.lane,Pn.lanes|=I,Jo|=I,C=C.next;while(C!==l)}else C===null&&(v.lanes=0);return[c.memoizedState,v.dispatch]}function Ol(l){var c=Wr(),v=c.queue;if(v===null)throw Error(u(311));v.lastRenderedReducer=l;var w=v.dispatch,C=v.pending,I=c.memoizedState;if(C!==null){v.pending=null;var Y=C=C.next;do I=l(I,Y.action),Y=Y.next;while(Y!==C);Ri(I,c.memoizedState)||(ai=!0),c.memoizedState=I,c.baseQueue===null&&(c.baseState=I),v.lastRenderedState=I}return[I,w]}function Kf(){}function Jf(l,c){var v=Pn,w=Wr(),C=c(),I=!Ri(w.memoizedState,C);if(I&&(w.memoizedState=C,ai=!0),w=w.queue,ka(bs.bind(null,v,w,l),[l]),w.getSnapshot!==c||I||si!==null&&si.memoizedState.tag&1){if(v.flags|=2048,zl(9,ed.bind(null,v,w,C,c),void 0,null),Ln===null)throw Error(u(349));(Vo&30)!==0||$f(v,c,C)}return C}function $f(l,c,v){l.flags|=16384,l={getSnapshot:c,value:v},c=Pn.updateQueue,c===null?(c={lastEffect:null,stores:null},Pn.updateQueue=c,c.stores=[l]):(v=c.stores,v===null?c.stores=[l]:v.push(l))}function ed(l,c,v,w){c.value=v,c.getSnapshot=w,ac(c)&&Qi(l,1,-1)}function bs(l,c,v){return v(function(){ac(c)&&Qi(l,1,-1)})}function ac(l){var c=l.getSnapshot;l=l.value;try{var v=c();return!Ri(l,v)}catch{return!0}}function kl(l){var c=Gr();return typeof l=="function"&&(l=l()),c.memoizedState=c.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ls,lastRenderedState:l},c.queue=l,l=l.dispatch=gg.bind(null,Pn,l),[c.memoizedState,l]}function zl(l,c,v,w){return l={tag:l,create:c,destroy:v,deps:w,next:null},c=Pn.updateQueue,c===null?(c={lastEffect:null,stores:null},Pn.updateQueue=c,c.lastEffect=l.next=l):(v=c.lastEffect,v===null?c.lastEffect=l.next=l:(w=v.next,v.next=l,l.next=w,c.lastEffect=l)),l}function Fh(){return Wr().memoizedState}function ro(l,c,v,w){var C=Gr();Pn.flags|=l,C.memoizedState=zl(1|c,v,void 0,w===void 0?null:w)}function lc(l,c,v,w){var C=Wr();w=w===void 0?null:w;var I=void 0;if(ri!==null){var Y=ri.memoizedState;if(I=Y.destroy,w!==null&&oc(w,Y.deps)){C.memoizedState=zl(c,v,I,w);return}}Pn.flags|=l,C.memoizedState=zl(1|c,v,I,w)}function uc(l,c){return ro(8390656,8,l,c)}function ka(l,c){return lc(2048,8,l,c)}function _n(l,c){return lc(4,2,l,c)}function cc(l,c){return lc(4,4,l,c)}function Fl(l,c){if(typeof c=="function")return l=l(),c(l),function(){c(null)};if(c!=null)return l=l(),c.current=l,function(){c.current=null}}function za(l,c,v){return v=v!=null?v.concat([l]):null,lc(4,4,Fl.bind(null,c,l),v)}function fc(){}function dc(l,c){var v=Wr();c=c===void 0?null:c;var w=v.memoizedState;return w!==null&&c!==null&&oc(c,w[1])?w[0]:(v.memoizedState=[l,c],l)}function Fa(l,c){var v=Wr();c=c===void 0?null:c;var w=v.memoizedState;return w!==null&&c!==null&&oc(c,w[1])?w[0]:(l=l(),v.memoizedState=[l,c],l)}function hc(l,c){var v=Yt;Yt=v!==0&&4>v?v:4,l(!0);var w=lr.transition;lr.transition={};try{l(!1),c()}finally{Yt=v,lr.transition=w}}function Wo(){return Wr().memoizedState}function Bh(l,c,v){var w=ds(l);v={lane:w,action:v,hasEagerState:!1,eagerState:null,next:null},Hh(l)?td(c,v):(Bl(l,c,v),v=ci(),l=Qi(l,w,v),l!==null&&Hl(l,c,w))}function gg(l,c,v){var w=ds(l),C={lane:w,action:v,hasEagerState:!1,eagerState:null,next:null};if(Hh(l))td(c,C);else{Bl(l,c,C);var I=l.alternate;if(l.lanes===0&&(I===null||I.lanes===0)&&(I=c.lastRenderedReducer,I!==null))try{var Y=c.lastRenderedState,re=I(Y,v);if(C.hasEagerState=!0,C.eagerState=re,Ri(re,Y))return}catch{}finally{}v=ci(),l=Qi(l,w,v),l!==null&&Hl(l,c,w)}}function Hh(l){var c=l.alternate;return l===Pn||c!==null&&c===Pn}function td(l,c){as=sc=!0;var v=l.pending;v===null?c.next=c:(c.next=v.next,v.next=c),l.pending=c}function Bl(l,c,v){Ln!==null&&(l.mode&1)!==0&&(Gt&2)===0?(l=c.interleaved,l===null?(v.next=v,Mr===null?Mr=[c]:Mr.push(c)):(v.next=l.next,l.next=v),c.interleaved=v):(l=c.pending,l===null?v.next=v:(v.next=l.next,l.next=v),c.pending=v)}function Hl(l,c,v){if((v&4194240)!==0){var w=c.lanes;w&=l.pendingLanes,v|=w,c.lanes=v,ss(l,v)}}var Ba={readContext:Xi,useCallback:oi,useContext:oi,useEffect:oi,useImperativeHandle:oi,useInsertionEffect:oi,useLayoutEffect:oi,useMemo:oi,useReducer:oi,useRef:oi,useState:oi,useDebugValue:oi,useDeferredValue:oi,useTransition:oi,useMutableSource:oi,useSyncExternalStore:oi,useId:oi,unstable_isNewReconciler:!1},nd={readContext:Xi,useCallback:function(l,c){return Gr().memoizedState=[l,c===void 0?null:c],l},useContext:Xi,useEffect:uc,useImperativeHandle:function(l,c,v){return v=v!=null?v.concat([l]):null,ro(4194308,4,Fl.bind(null,c,l),v)},useLayoutEffect:function(l,c){return ro(4194308,4,l,c)},useInsertionEffect:function(l,c){return ro(4,2,l,c)},useMemo:function(l,c){var v=Gr();return c=c===void 0?null:c,l=l(),v.memoizedState=[l,c],l},useReducer:function(l,c,v){var w=Gr();return c=v!==void 0?v(c):c,w.memoizedState=w.baseState=c,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:c},w.queue=l,l=l.dispatch=Bh.bind(null,Pn,l),[w.memoizedState,l]},useRef:function(l){var c=Gr();return l={current:l},c.memoizedState=l},useState:kl,useDebugValue:fc,useDeferredValue:function(l){var c=kl(l),v=c[0],w=c[1];return uc(function(){var C=lr.transition;lr.transition={};try{w(l)}finally{lr.transition=C}},[l]),v},useTransition:function(){var l=kl(!1),c=l[0];return l=hc.bind(null,l[1]),Gr().memoizedState=l,[c,l]},useMutableSource:function(){},useSyncExternalStore:function(l,c,v){var w=Pn,C=Gr();if(An){if(v===void 0)throw Error(u(407));v=v()}else{if(v=c(),Ln===null)throw Error(u(349));(Vo&30)!==0||$f(w,c,v)}C.memoizedState=v;var I={value:v,getSnapshot:c};return C.queue=I,uc(bs.bind(null,w,I,l),[l]),w.flags|=2048,zl(9,ed.bind(null,w,I,v,c),void 0,null),v},useId:function(){var l=Gr(),c=Ln.identifierPrefix;if(An){var v=As,w=Ts;v=(w&~(1<<32-xr(w)-1)).toString(32)+v,c=":"+c+"R"+v,v=Go++,0<v&&(c+="H"+v.toString(32)),c+=":"}else v=Dl++,c=":"+c+"r"+v.toString(32)+":";return l.memoizedState=c},unstable_isNewReconciler:!1},id={readContext:Xi,useCallback:dc,useContext:Xi,useEffect:ka,useImperativeHandle:za,useInsertionEffect:_n,useLayoutEffect:cc,useMemo:Fa,useReducer:Ul,useRef:Fh,useState:function(){return Ul(ls)},useDebugValue:fc,useDeferredValue:function(l){var c=Ul(ls),v=c[0],w=c[1];return ka(function(){var C=lr.transition;lr.transition={};try{w(l)}finally{lr.transition=C}},[l]),v},useTransition:function(){var l=Ul(ls)[0],c=Wr().memoizedState;return[l,c]},useMutableSource:Kf,useSyncExternalStore:Jf,useId:Wo,unstable_isNewReconciler:!1},rd={readContext:Xi,useCallback:dc,useContext:Xi,useEffect:ka,useImperativeHandle:za,useInsertionEffect:_n,useLayoutEffect:cc,useMemo:Fa,useReducer:Ol,useRef:Fh,useState:function(){return Ol(ls)},useDebugValue:fc,useDeferredValue:function(l){var c=Ol(ls),v=c[0],w=c[1];return ka(function(){var C=lr.transition;lr.transition={};try{w(l)}finally{lr.transition=C}},[l]),v},useTransition:function(){var l=Ol(ls)[0],c=Wr().memoizedState;return[l,c]},useMutableSource:Kf,useSyncExternalStore:Jf,useId:Wo,unstable_isNewReconciler:!1};function sd(l,c){try{var v="",w=c;do v+=Hf(w),w=w.return;while(w);var C=v}catch(I){C=`
Error generating stack: `+I.message+`
`+I.stack}return{value:l,source:c,stack:C}}function pc(l,c){try{console.error(c.value)}catch(v){setTimeout(function(){throw v})}}var vg=typeof WeakMap=="function"?WeakMap:Map;function Vh(l,c,v){v=Es(-1,v),v.tag=3,v.payload={element:null};var w=c.value;return v.callback=function(){uo||(uo=!0,Rr=w),pc(l,c)},v}function mc(l,c,v){v=Es(-1,v),v.tag=3;var w=l.type.getDerivedStateFromError;if(typeof w=="function"){var C=c.value;v.payload=function(){return w(C)},v.callback=function(){pc(l,c)}}var I=l.stateNode;return I!==null&&typeof I.componentDidCatch=="function"&&(v.callback=function(){pc(l,c),typeof w!="function"&&(Pr===null?Pr=new Set([this]):Pr.add(this));var Y=c.stack;this.componentDidCatch(c.value,{componentStack:Y!==null?Y:""})}),v}function Rs(l,c,v){var w=l.pingCache;if(w===null){w=l.pingCache=new vg;var C=new Set;w.set(c,C)}else C=w.get(c),C===void 0&&(C=new Set,w.set(c,C));C.has(v)||(C.add(v),l=Xh.bind(null,l,c,v),c.then(l,l))}function od(l){do{var c;if((c=l.tag===13)&&(c=l.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return l;l=l.return}while(l!==null);return null}function jo(l,c,v,w,C){return(l.mode&1)===0?(l===c?l.flags|=65536:(l.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(c=Es(-1,1),c.tag=2,$s(v,c))),v.lanes|=1),l):(l.flags|=65536,l.lanes=C,l)}function Qn(l){l.flags|=4}function Ha(l,c){if(l!==null&&l.child===c.child)return!0;if((c.flags&16)!==0)return!1;for(l=c.child;l!==null;){if((l.flags&12854)!==0||(l.subtreeFlags&12854)!==0)return!1;l=l.sibling}return!0}var ur,Xo,gc,vc;if(Mt)ur=function(l,c){for(var v=c.child;v!==null;){if(v.tag===5||v.tag===6)Ce(l,v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===c)break;for(;v.sibling===null;){if(v.return===null||v.return===c)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},Xo=function(){},gc=function(l,c,v,w,C){if(l=l.memoizedProps,l!==w){var I=c.stateNode,Y=Vr(Yi.current);v=se(I,v,l,w,C,Y),(c.updateQueue=v)&&Qn(c)}},vc=function(l,c,v,w){v!==w&&Qn(c)};else if(Ae){ur=function(l,c,v,w){for(var C=c.child;C!==null;){if(C.tag===5){var I=C.stateNode;v&&w&&(I=On(I,C.type,C.memoizedProps,C)),Ce(l,I)}else if(C.tag===6)I=C.stateNode,v&&w&&(I=wn(I,C.memoizedProps,C)),Ce(l,I);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)I=C.child,I!==null&&(I.return=C),ur(l,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===c)break;for(;C.sibling===null;){if(C.return===null||C.return===c)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};var so=function(l,c,v,w){for(var C=c.child;C!==null;){if(C.tag===5){var I=C.stateNode;v&&w&&(I=On(I,C.type,C.memoizedProps,C)),Jt(l,I)}else if(C.tag===6)I=C.stateNode,v&&w&&(I=wn(I,C.memoizedProps,C)),Jt(l,I);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)I=C.child,I!==null&&(I.return=C),so(l,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===c)break;for(;C.sibling===null;){if(C.return===null||C.return===c)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};Xo=function(l,c){var v=c.stateNode;if(!Ha(l,c)){l=v.containerInfo;var w=rn(l);so(w,c,!1,!1),v.pendingChildren=w,Qn(c),fn(l,w)}},gc=function(l,c,v,w,C){var I=l.stateNode,Y=l.memoizedProps;if((l=Ha(l,c))&&Y===w)c.stateNode=I;else{var re=c.stateNode,be=Vr(Yi.current),je=null;Y!==w&&(je=se(re,v,Y,w,C,be)),l&&je===null?c.stateNode=I:(I=Kt(I,je,v,Y,w,c,l,re),Ve(I,v,w,C,be)&&Qn(c),c.stateNode=I,l?Qn(c):ur(I,c,!1,!1))}},vc=function(l,c,v,w){v!==w?(l=Vr(Bo.current),v=Vr(Yi.current),c.stateNode=ke(w,l,v,c),Qn(c)):c.stateNode=l.stateNode}}else Xo=function(){},gc=function(){},vc=function(){};function Ps(l,c){if(!An)switch(l.tailMode){case"hidden":c=l.tail;for(var v=null;c!==null;)c.alternate!==null&&(v=c),c=c.sibling;v===null?l.tail=null:v.sibling=null;break;case"collapsed":v=l.tail;for(var w=null;v!==null;)v.alternate!==null&&(w=v),v=v.sibling;w===null?c||l.tail===null?l.tail=null:l.tail.sibling=null:w.sibling=null}}function zn(l){var c=l.alternate!==null&&l.alternate.child===l.child,v=0,w=0;if(c)for(var C=l.child;C!==null;)v|=C.lanes|C.childLanes,w|=C.subtreeFlags&14680064,w|=C.flags&14680064,C.return=l,C=C.sibling;else for(C=l.child;C!==null;)v|=C.lanes|C.childLanes,w|=C.subtreeFlags,w|=C.flags,C.return=l,C=C.sibling;return l.subtreeFlags|=w,l.childLanes=v,c}function yc(l,c,v){var w=c.pendingProps;switch(Yf(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zn(c),null;case 1:return xn(c.type)&&yr(),zn(c),null;case 3:return w=c.stateNode,Ua(),Vt(Gn),Vt(qn),Ho(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(l===null||l.child===null)&&(Il(c)?Qn(c):l===null||l.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Tr!==null&&(Bn(Tr),Tr=null))),Xo(l,c),zn(c),null;case 5:Qf(c),v=Vr(Bo.current);var C=c.type;if(l!==null&&c.stateNode!=null)gc(l,c,C,w,v),l.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!w){if(c.stateNode===null)throw Error(u(166));return zn(c),null}if(l=Vr(Yi.current),Il(c)){if(!Oe)throw Error(u(175));l=kf(c.stateNode,c.type,c.memoizedProps,v,l,c,!Pa),c.updateQueue=l,l!==null&&Qn(c)}else{var I=J(C,w,v,l,c);ur(I,c,!1,!1),c.stateNode=I,Ve(I,C,w,v,l)&&Qn(c)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return zn(c),null;case 6:if(l&&c.stateNode!=null)vc(l,c,l.memoizedProps,w);else{if(typeof w!="string"&&c.stateNode===null)throw Error(u(166));if(l=Vr(Bo.current),v=Vr(Yi.current),Il(c)){if(!Oe)throw Error(u(176));if(l=c.stateNode,w=c.memoizedProps,(v=H(l,w,c,!Pa))&&(C=Li,C!==null))switch(I=(C.mode&1)!==0,C.tag){case 3:bt(C.stateNode.containerInfo,l,w,I);break;case 5:kt(C.type,C.memoizedProps,C.stateNode,l,w,I)}v&&Qn(c)}else c.stateNode=ke(w,l,v,c)}return zn(c),null;case 13:if(Vt(Rn),w=c.memoizedState,An&&mi!==null&&(c.mode&1)!==0&&(c.flags&128)===0){for(l=mi;l;)l=Fr(l);return La(),c.flags|=98560,c}if(w!==null&&w.dehydrated!==null){if(w=Il(c),l===null){if(!w)throw Error(u(318));if(!Oe)throw Error(u(344));if(l=c.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(u(317));le(l,c)}else La(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;return zn(c),null}return Tr!==null&&(Bn(Tr),Tr=null),(c.flags&128)!==0?(c.lanes=v,c):(w=w!==null,v=!1,l===null?Il(c):v=l.memoizedState!==null,w&&!v&&(c.child.flags|=8192,(c.mode&1)!==0&&(l===null||(Rn.current&1)!==0?Wn===0&&(Wn=3):Ql())),c.updateQueue!==null&&(c.flags|=4),zn(c),null);case 4:return Ua(),Xo(l,c),l===null&&Xe(c.stateNode.containerInfo),zn(c),null;case 10:return Ll(c.type._context),zn(c),null;case 17:return xn(c.type)&&yr(),zn(c),null;case 19:if(Vt(Rn),C=c.memoizedState,C===null)return zn(c),null;if(w=(c.flags&128)!==0,I=C.rendering,I===null)if(w)Ps(C,!1);else{if(Wn!==0||l!==null&&(l.flags&128)!==0)for(l=c.child;l!==null;){if(I=rc(l),I!==null){for(c.flags|=128,Ps(C,!1),l=I.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),c.subtreeFlags=0,l=v,w=c.child;w!==null;)v=w,C=l,v.flags&=14680066,I=v.alternate,I===null?(v.childLanes=0,v.lanes=C,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=I.childLanes,v.lanes=I.lanes,v.child=I.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=I.memoizedProps,v.memoizedState=I.memoizedState,v.updateQueue=I.updateQueue,v.type=I.type,C=I.dependencies,v.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),w=w.sibling;return At(Rn,Rn.current&1|2),c.child}l=l.sibling}C.tail!==null&&Zn()>lo&&(c.flags|=128,w=!0,Ps(C,!1),c.lanes=4194304)}else{if(!w)if(l=rc(I),l!==null){if(c.flags|=128,w=!0,l=l.updateQueue,l!==null&&(c.updateQueue=l,c.flags|=4),Ps(C,!0),C.tail===null&&C.tailMode==="hidden"&&!I.alternate&&!An)return zn(c),null}else 2*Zn()-C.renderingStartTime>lo&&v!==1073741824&&(c.flags|=128,w=!0,Ps(C,!1),c.lanes=4194304);C.isBackwards?(I.sibling=c.child,c.child=I):(l=C.last,l!==null?l.sibling=I:c.child=I,C.last=I)}return C.tail!==null?(c=C.tail,C.rendering=c,C.tail=c.sibling,C.renderingStartTime=Zn(),c.sibling=null,l=Rn.current,At(Rn,w?l&1|2:l&1),c):(zn(c),null);case 22:case 23:return md(),w=c.memoizedState!==null,l!==null&&l.memoizedState!==null!==w&&(c.flags|=8192),w&&(c.mode&1)!==0?(Oi&1073741824)!==0&&(zn(c),Mt&&c.subtreeFlags&6&&(c.flags|=8192)):zn(c),null;case 24:return null;case 25:return null}throw Error(u(156,c.tag))}var ad=f.ReactCurrentOwner,ai=!1;function Nn(l,c,v,w){c.child=l===null?kh(c,null,v,w):Cs(c,l.child,v,w)}function Sn(l,c,v,w,C){v=v.render;var I=c.ref;return Ca(c,C),w=Oa(l,c,v,w,I,C),v=io(),l!==null&&!ai?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~C,qi(l,c,C)):(An&&v&&Xf(c),c.flags|=1,Nn(l,c,w,C),c.child)}function dn(l,c,v,w,C){if(l===null){var I=v.type;return typeof I=="function"&&!eu(I)&&I.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(c.tag=15,c.type=I,Ls(l,c,I,w,C)):(l=tu(v.type,null,w,c,c.mode,C),l.ref=c.ref,l.return=c,c.child=l)}if(I=l.child,(l.lanes&C)===0){var Y=I.memoizedProps;if(v=v.compare,v=v!==null?v:Hr,v(Y,w)&&l.ref===c.ref)return qi(l,c,C)}return c.flags|=1,l=zs(I,w),l.ref=c.ref,l.return=c,c.child=l}function Ls(l,c,v,w,C){if(l!==null&&Hr(l.memoizedProps,w)&&l.ref===c.ref)if(ai=!1,(l.lanes&C)!==0)(l.flags&131072)!==0&&(ai=!0);else return c.lanes=l.lanes,qi(l,c,C);return Is(l,c,v,w,C)}function gi(l,c,v){var w=c.pendingProps,C=w.children,I=l!==null?l.memoizedState:null;if(w.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null},At(ks,Oi),Oi|=v;else if((v&1073741824)!==0)c.memoizedState={baseLanes:0,cachePool:null},w=I!==null?I.baseLanes:v,At(ks,Oi),Oi|=w;else return l=I!==null?I.baseLanes|v:v,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:l,cachePool:null},c.updateQueue=null,At(ks,Oi),Oi|=l,null;else I!==null?(w=I.baseLanes|v,c.memoizedState=null):w=v,At(ks,Oi),Oi|=w;return Nn(l,c,C,v),c.child}function Ii(l,c){var v=c.ref;(l===null&&v!==null||l!==null&&l.ref!==v)&&(c.flags|=512,c.flags|=2097152)}function Is(l,c,v,w,C){var I=xn(v)?Br:qn.current;return I=yn(c,I),Ca(c,C),v=Oa(l,c,v,w,I,C),w=io(),l!==null&&!ai?(c.updateQueue=l.updateQueue,c.flags&=-2053,l.lanes&=~C,qi(l,c,C)):(An&&w&&Xf(c),c.flags|=1,Nn(l,c,v,C),c.child)}function Yo(l,c,v,w,C){if(xn(v)){var I=!0;wa(c)}else I=!1;if(Ca(c,C),c.stateNode===null)l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2),Ih(c,v,w),jf(c,v,w,C),w=!0;else if(l===null){var Y=c.stateNode,re=c.memoizedProps;Y.props=re;var be=Y.context,je=v.contextType;typeof je=="object"&&je!==null?je=Xi(je):(je=xn(v)?Br:qn.current,je=yn(c,je));var lt=v.getDerivedStateFromProps,Ft=typeof lt=="function"||typeof Y.getSnapshotBeforeUpdate=="function";Ft||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(re!==w||be!==je)&&Nh(c,Y,w,je),wr=!1;var Et=c.memoizedState;Y.state=Et,Ku(c,w,Y,C),be=c.memoizedState,re!==w||Et!==be||Gn.current||wr?(typeof lt=="function"&&(Gf(c,v,lt,w),be=c.memoizedState),(re=wr||Wf(c,v,re,w,Et,be,je))?(Ft||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount()),typeof Y.componentDidMount=="function"&&(c.flags|=4194308)):(typeof Y.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=w,c.memoizedState=be),Y.props=w,Y.state=be,Y.context=je,w=re):(typeof Y.componentDidMount=="function"&&(c.flags|=4194308),w=!1)}else{Y=c.stateNode,Vf(l,c),re=c.memoizedProps,je=c.type===c.elementType?re:ji(c.type,re),Y.props=je,Ft=c.pendingProps,Et=Y.context,be=v.contextType,typeof be=="object"&&be!==null?be=Xi(be):(be=xn(v)?Br:qn.current,be=yn(c,be));var hn=v.getDerivedStateFromProps;(lt=typeof hn=="function"||typeof Y.getSnapshotBeforeUpdate=="function")||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(re!==Ft||Et!==be)&&Nh(c,Y,w,be),wr=!1,Et=c.memoizedState,Y.state=Et,Ku(c,w,Y,C);var rt=c.memoizedState;re!==Ft||Et!==rt||Gn.current||wr?(typeof hn=="function"&&(Gf(c,v,hn,w),rt=c.memoizedState),(je=wr||Wf(c,v,je,w,Et,rt,be)||!1)?(lt||typeof Y.UNSAFE_componentWillUpdate!="function"&&typeof Y.componentWillUpdate!="function"||(typeof Y.componentWillUpdate=="function"&&Y.componentWillUpdate(w,rt,be),typeof Y.UNSAFE_componentWillUpdate=="function"&&Y.UNSAFE_componentWillUpdate(w,rt,be)),typeof Y.componentDidUpdate=="function"&&(c.flags|=4),typeof Y.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof Y.componentDidUpdate!="function"||re===l.memoizedProps&&Et===l.memoizedState||(c.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||re===l.memoizedProps&&Et===l.memoizedState||(c.flags|=1024),c.memoizedProps=w,c.memoizedState=rt),Y.props=w,Y.state=rt,Y.context=be,w=je):(typeof Y.componentDidUpdate!="function"||re===l.memoizedProps&&Et===l.memoizedState||(c.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||re===l.memoizedProps&&Et===l.memoizedState||(c.flags|=1024),w=!1)}return Si(l,c,v,w,I,C)}function Si(l,c,v,w,C,I){Ii(l,c);var Y=(c.flags&128)!==0;if(!w&&!Y)return C&&Po(c,v,!1),qi(l,c,I);w=c.stateNode,ad.current=c;var re=Y&&typeof v.getDerivedStateFromError!="function"?null:w.render();return c.flags|=1,l!==null&&Y?(c.child=Cs(c,l.child,null,I),c.child=Cs(c,null,re,I)):Nn(l,c,re,I),c.memoizedState=w.state,C&&Po(c,v,!0),c.child}function Vl(l){var c=l.stateNode;c.pendingContext?ii(l,c.pendingContext,c.pendingContext!==c.context):c.context&&ii(l,c.context,!1),ic(l,c.containerInfo)}function ld(l,c,v,w,C){return La(),nc(C),c.flags|=256,Nn(l,c,v,w),c.child}var Gl={dehydrated:null,treeContext:null,retryLane:0};function qo(l){return{baseLanes:l,cachePool:null}}function ud(l,c,v){var w=c.pendingProps,C=Rn.current,I=!1,Y=(c.flags&128)!==0,re;if((re=Y)||(re=l!==null&&l.memoizedState===null?!1:(C&2)!==0),re?(I=!0,c.flags&=-129):(l===null||l.memoizedState!==null)&&(C|=1),At(Rn,C&1),l===null)return to(c),l=c.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((c.mode&1)===0?c.lanes=1:rs(l)?c.lanes=8:c.lanes=1073741824,null):(C=w.children,l=w.fallback,I?(w=c.mode,I=c.child,C={mode:"hidden",children:C},(w&1)===0&&I!==null?(I.childLanes=0,I.pendingProps=C):I=$a(C,w,0,null),l=mo(l,w,v,null),I.return=c,l.return=c,I.sibling=l,c.child=I,c.child.memoizedState=qo(v),c.memoizedState=Gl,l):jr(c,C));if(C=l.memoizedState,C!==null){if(re=C.dehydrated,re!==null){if(Y)return c.flags&256?(c.flags&=-257,jl(l,c,v,Error(u(422)))):c.memoizedState!==null?(c.child=l.child,c.flags|=128,null):(I=w.fallback,C=c.mode,w=$a({mode:"visible",children:w.children},C,0,null),I=mo(I,C,v,null),I.flags|=2,w.return=c,I.return=c,w.sibling=I,c.child=w,(c.mode&1)!==0&&Cs(c,l.child,null,v),c.child.memoizedState=qo(v),c.memoizedState=Gl,I);if((c.mode&1)===0)c=jl(l,c,v,null);else if(rs(re))c=jl(l,c,v,Error(u(419)));else if(w=(v&l.childLanes)!==0,ai||w){if(w=Ln,w!==null){switch(v&-v){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}w=(I&(w.suspendedLanes|v))!==0?0:I,w!==0&&w!==C.retryLane&&(C.retryLane=w,Qi(l,w,-1))}Ql(),c=jl(l,c,v,Error(u(421)))}else Ro(re)?(c.flags|=128,c.child=l.child,c=Yh.bind(null,l),Ss(re,c),c=null):(v=C.treeContext,Oe&&(mi=Of(re),Li=c,An=!0,Tr=null,Pa=!1,v!==null&&(Er[or++]=Ts,Er[or++]=As,Er[or++]=ko,Ts=v.id,As=v.overflow,ko=c)),c=jr(c,c.pendingProps.children),c.flags|=4096);return c}return I?(w=xc(l,c,w.children,w.fallback,v),I=c.child,C=l.child.memoizedState,I.memoizedState=C===null?qo(v):{baseLanes:C.baseLanes|v,cachePool:null},I.childLanes=l.childLanes&~v,c.memoizedState=Gl,w):(v=Wl(l,c,w.children,v),c.memoizedState=null,v)}return I?(w=xc(l,c,w.children,w.fallback,v),I=c.child,C=l.child.memoizedState,I.memoizedState=C===null?qo(v):{baseLanes:C.baseLanes|v,cachePool:null},I.childLanes=l.childLanes&~v,c.memoizedState=Gl,w):(v=Wl(l,c,w.children,v),c.memoizedState=null,v)}function jr(l,c){return c=$a({mode:"visible",children:c},l.mode,0,null),c.return=l,l.child=c}function Wl(l,c,v,w){var C=l.child;return l=C.sibling,v=zs(C,{mode:"visible",children:v}),(c.mode&1)===0&&(v.lanes=w),v.return=c,v.sibling=null,l!==null&&(w=c.deletions,w===null?(c.deletions=[l],c.flags|=16):w.push(l)),c.child=v}function xc(l,c,v,w,C){var I=c.mode;l=l.child;var Y=l.sibling,re={mode:"hidden",children:v};return(I&1)===0&&c.child!==l?(v=c.child,v.childLanes=0,v.pendingProps=re,c.deletions=null):(v=zs(l,re),v.subtreeFlags=l.subtreeFlags&14680064),Y!==null?w=zs(Y,w):(w=mo(w,I,C,null),w.flags|=2),w.return=c,v.return=c,v.sibling=w,c.child=v,w}function jl(l,c,v,w){return w!==null&&nc(w),Cs(c,l.child,null,v),l=jr(c,c.pendingProps.children),l.flags|=2,c.memoizedState=null,l}function Gh(l,c,v){l.lanes|=c;var w=l.alternate;w!==null&&(w.lanes|=c),Oo(l.return,c,v)}function us(l,c,v,w,C){var I=l.memoizedState;I===null?l.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:w,tail:v,tailMode:C}:(I.isBackwards=c,I.rendering=null,I.renderingStartTime=0,I.last=w,I.tail=v,I.tailMode=C)}function Zo(l,c,v){var w=c.pendingProps,C=w.revealOrder,I=w.tail;if(Nn(l,c,w.children,v),w=Rn.current,(w&2)!==0)w=w&1|2,c.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=c.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Gh(l,v,c);else if(l.tag===19)Gh(l,v,c);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===c)break e;for(;l.sibling===null;){if(l.return===null||l.return===c)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}w&=1}if(At(Rn,w),(c.mode&1)===0)c.memoizedState=null;else switch(C){case"forwards":for(v=c.child,C=null;v!==null;)l=v.alternate,l!==null&&rc(l)===null&&(C=v),v=v.sibling;v=C,v===null?(C=c.child,c.child=null):(C=v.sibling,v.sibling=null),us(c,!1,C,v,I);break;case"backwards":for(v=null,C=c.child,c.child=null;C!==null;){if(l=C.alternate,l!==null&&rc(l)===null){c.child=C;break}l=C.sibling,C.sibling=v,v=C,C=l}us(c,!0,v,null,I);break;case"together":us(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function qi(l,c,v){if(l!==null&&(c.dependencies=l.dependencies),Jo|=c.lanes,(v&c.childLanes)===0)return null;if(l!==null&&c.child!==l.child)throw Error(u(153));if(c.child!==null){for(l=c.child,v=zs(l,l.pendingProps),c.child=v,v.return=c;l.sibling!==null;)l=l.sibling,v=v.sibling=zs(l,l.pendingProps),v.return=c;v.sibling=null}return c.child}function _c(l,c,v){switch(c.tag){case 3:Vl(c),La();break;case 5:zh(c);break;case 1:xn(c.type)&&wa(c);break;case 4:ic(c,c.stateNode.containerInfo);break;case 10:Uo(c,c.type._context,c.memoizedProps.value);break;case 13:var w=c.memoizedState;if(w!==null)return w.dehydrated!==null?(At(Rn,Rn.current&1),c.flags|=128,null):(v&c.child.childLanes)!==0?ud(l,c,v):(At(Rn,Rn.current&1),l=qi(l,c,v),l!==null?l.sibling:null);At(Rn,Rn.current&1);break;case 19:if(w=(v&c.childLanes)!==0,(l.flags&128)!==0){if(w)return Zo(l,c,v);c.flags|=128}var C=c.memoizedState;if(C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),At(Rn,Rn.current),w)break;return null;case 22:case 23:return c.lanes=0,gi(l,c,v)}return qi(l,c,v)}function Sc(l,c){switch(Yf(c),c.tag){case 1:return xn(c.type)&&yr(),l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 3:return Ua(),Vt(Gn),Vt(qn),Ho(),l=c.flags,(l&65536)!==0&&(l&128)===0?(c.flags=l&-65537|128,c):null;case 5:return Qf(c),null;case 13:if(Vt(Rn),l=c.memoizedState,l!==null&&l.dehydrated!==null){if(c.alternate===null)throw Error(u(340));La()}return l=c.flags,l&65536?(c.flags=l&-65537|128,c):null;case 19:return Vt(Rn),null;case 4:return Ua(),null;case 10:return Ll(c.type._context),null;case 22:case 23:return md(),null;case 24:return null;default:return null}}var Ni=!1,li=!1,Qo=typeof WeakSet=="function"?WeakSet:Set,Qe=null;function Ar(l,c){var v=l.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(w){zi(l,c,w)}else v.current=null}function Ns(l,c,v){try{v()}catch(w){zi(l,c,w)}}var cd=!1;function fd(l,c){for(ee(l.containerInfo),Qe=c;Qe!==null;)if(l=Qe,c=l.child,(l.subtreeFlags&1028)!==0&&c!==null)c.return=l,Qe=c;else for(;Qe!==null;){l=Qe;try{var v=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var w=v.memoizedProps,C=v.memoizedState,I=l.stateNode,Y=I.getSnapshotBeforeUpdate(l.elementType===l.type?w:ji(l.type,w),C);I.__reactInternalSnapshotBeforeUpdate=Y}break;case 3:Mt&&Ze(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(u(163))}}catch(re){zi(l,l.return,re)}if(c=l.sibling,c!==null){c.return=l.return,Qe=c;break}Qe=l.return}return v=cd,cd=!1,v}function Ds(l,c,v){var w=c.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var C=w=w.next;do{if((C.tag&l)===l){var I=C.destroy;C.destroy=void 0,I!==void 0&&Ns(c,v,I)}C=C.next}while(C!==w)}}function vi(l,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var v=c=c.next;do{if((v.tag&l)===l){var w=v.create;v.destroy=w()}v=v.next}while(v!==c)}}function Di(l){var c=l.ref;if(c!==null){var v=l.stateNode;switch(l.tag){case 5:l=ye(v);break;default:l=v}typeof c=="function"?c(l):c.current=l}}function En(l,c,v){if(os&&typeof os.onCommitFiberUnmount=="function")try{os.onCommitFiberUnmount(Cl,c)}catch{}switch(c.tag){case 0:case 11:case 14:case 15:if(l=c.updateQueue,l!==null&&(l=l.lastEffect,l!==null)){var w=l=l.next;do{var C=w,I=C.destroy;C=C.tag,I!==void 0&&((C&2)!==0||(C&4)!==0)&&Ns(c,v,I),w=w.next}while(w!==l)}break;case 1:if(Ar(c,v),l=c.stateNode,typeof l.componentWillUnmount=="function")try{l.props=c.memoizedProps,l.state=c.memoizedState,l.componentWillUnmount()}catch(Y){zi(c,v,Y)}break;case 5:Ar(c,v);break;case 4:Mt?pd(l,c,v):Ae&&Ae&&(c=c.stateNode.containerInfo,v=rn(c),Xt(c,v))}}function Cr(l,c,v){for(var w=c;;)if(En(l,w,v),w.child===null||Mt&&w.tag===4){if(w===c)break;for(;w.sibling===null;){if(w.return===null||w.return===c)return;w=w.return}w.sibling.return=w.return,w=w.sibling}else w.child.return=w,w=w.child}function dd(l){var c=l.alternate;c!==null&&(l.alternate=null,dd(c)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(c=l.stateNode,c!==null&&Fe(c)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function hd(l){return l.tag===5||l.tag===3||l.tag===4}function Mc(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||hd(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function wc(l){if(Mt){e:{for(var c=l.return;c!==null;){if(hd(c))break e;c=c.return}throw Error(u(160))}var v=c;switch(v.tag){case 5:c=v.stateNode,v.flags&32&&(Pe(c),v.flags&=-33),v=Mc(l),Va(l,v,c);break;case 3:case 4:c=v.stateNode.containerInfo,v=Mc(l),Ec(l,v,c);break;default:throw Error(u(161))}}}function Ec(l,c,v){var w=l.tag;if(w===5||w===6)l=l.stateNode,c?Dt(v,l,c):qe(v,l);else if(w!==4&&(l=l.child,l!==null))for(Ec(l,c,v),l=l.sibling;l!==null;)Ec(l,c,v),l=l.sibling}function Va(l,c,v){var w=l.tag;if(w===5||w===6)l=l.stateNode,c?ot(v,l,c):Ct(v,l);else if(w!==4&&(l=l.child,l!==null))for(Va(l,c,v),l=l.sibling;l!==null;)Va(l,c,v),l=l.sibling}function pd(l,c,v){for(var w=c,C=!1,I,Y;;){if(!C){C=w.return;e:for(;;){if(C===null)throw Error(u(160));switch(I=C.stateNode,C.tag){case 5:Y=!1;break e;case 3:I=I.containerInfo,Y=!0;break e;case 4:I=I.containerInfo,Y=!0;break e}C=C.return}C=!0}if(w.tag===5||w.tag===6)Cr(l,w,v),Y?ne(I,w.stateNode):Bt(I,w.stateNode);else if(w.tag===18)Y?ht(I,w.stateNode):nt(I,w.stateNode);else if(w.tag===4){if(w.child!==null){I=w.stateNode.containerInfo,Y=!0,w.child.return=w,w=w.child;continue}}else if(En(l,w,v),w.child!==null){w.child.return=w,w=w.child;continue}if(w===c)break;for(;w.sibling===null;){if(w.return===null||w.return===c)return;w=w.return,w.tag===4&&(C=!1)}w.sibling.return=w.return,w=w.sibling}}function oo(l,c){if(Mt){switch(c.tag){case 0:case 11:case 14:case 15:Ds(3,c,c.return),vi(3,c),Ds(5,c,c.return);return;case 1:return;case 5:var v=c.stateNode;if(v!=null){var w=c.memoizedProps;l=l!==null?l.memoizedProps:w;var C=c.type,I=c.updateQueue;c.updateQueue=null,I!==null&&Tt(v,I,C,l,w,c)}return;case 6:if(c.stateNode===null)throw Error(u(162));v=c.memoizedProps,ft(c.stateNode,l!==null?l.memoizedProps:v,v);return;case 3:Oe&&l!==null&&l.memoizedState.isDehydrated&&me(c.stateNode.containerInfo);return;case 12:return;case 13:Ga(c);return;case 19:Ga(c);return;case 17:return}throw Error(u(163))}switch(c.tag){case 0:case 11:case 14:case 15:Ds(3,c,c.return),vi(3,c),Ds(5,c,c.return);return;case 12:return;case 13:Ga(c);return;case 19:Ga(c);return;case 3:Oe&&l!==null&&l.memoizedState.isDehydrated&&me(c.stateNode.containerInfo);break;case 22:case 23:return}e:if(Ae){switch(c.tag){case 1:case 5:case 6:break e;case 3:case 4:c=c.stateNode,Xt(c.containerInfo,c.pendingChildren);break e}throw Error(u(163))}}function Ga(l){var c=l.updateQueue;if(c!==null){l.updateQueue=null;var v=l.stateNode;v===null&&(v=l.stateNode=new Qo),c.forEach(function(w){var C=Jl.bind(null,l,w);v.has(w)||(v.add(w),w.then(C,C))})}}function yg(l,c){for(Qe=c;Qe!==null;){c=Qe;var v=c.deletions;if(v!==null)for(var w=0;w<v.length;w++){var C=v[w];try{var I=l;Mt?pd(I,C,c):Cr(I,C,c);var Y=C.alternate;Y!==null&&(Y.return=null),C.return=null}catch(mt){zi(C,c,mt)}}if(v=c.child,(c.subtreeFlags&12854)!==0&&v!==null)v.return=c,Qe=v;else for(;Qe!==null;){c=Qe;try{var re=c.flags;if(re&32&&Mt&&Pe(c.stateNode),re&512){var be=c.alternate;if(be!==null){var je=be.ref;je!==null&&(typeof je=="function"?je(null):je.current=null)}}if(re&8192)switch(c.tag){case 13:if(c.memoizedState!==null){var lt=c.alternate;(lt===null||lt.memoizedState===null)&&(Cc=Zn())}break;case 22:var Ft=c.memoizedState!==null,Et=c.alternate,hn=Et!==null&&Et.memoizedState!==null;if(v=c,Mt){e:if(w=v,C=Ft,I=null,Mt)for(var rt=w;;){if(rt.tag===5){if(I===null){I=rt;var ln=rt.stateNode;C?K(ln):Te(rt.stateNode,rt.memoizedProps)}}else if(rt.tag===6){if(I===null){var dr=rt.stateNode;C?Ee(dr):We(dr,rt.memoizedProps)}}else if((rt.tag!==22&&rt.tag!==23||rt.memoizedState===null||rt===w)&&rt.child!==null){rt.child.return=rt,rt=rt.child;continue}if(rt===w)break;for(;rt.sibling===null;){if(rt.return===null||rt.return===w)break e;I===rt&&(I=null),rt=rt.return}I===rt&&(I=null),rt.sibling.return=rt.return,rt=rt.sibling}}if(Ft&&!hn&&(v.mode&1)!==0){Qe=v;for(var pe=v.child;pe!==null;){for(v=Qe=pe;Qe!==null;){w=Qe;var oe=w.child;switch(w.tag){case 0:case 11:case 14:case 15:Ds(4,w,w.return);break;case 1:Ar(w,w.return);var we=w.stateNode;if(typeof we.componentWillUnmount=="function"){var it=w.return;try{we.props=w.memoizedProps,we.state=w.memoizedState,we.componentWillUnmount()}catch(mt){zi(w,it,mt)}}break;case 5:Ar(w,w.return);break;case 22:if(w.memoizedState!==null){Ko(v);continue}}oe!==null?(oe.return=w,Qe=oe):Ko(v)}pe=pe.sibling}}}switch(re&4102){case 2:wc(c),c.flags&=-3;break;case 6:wc(c),c.flags&=-3,oo(c.alternate,c);break;case 4096:c.flags&=-4097;break;case 4100:c.flags&=-4097,oo(c.alternate,c);break;case 4:oo(c.alternate,c)}}catch(mt){zi(c,c.return,mt)}if(v=c.sibling,v!==null){v.return=c.return,Qe=v;break}Qe=c.return}}}function Xr(l,c,v){Qe=l,Xl(l)}function Xl(l,c,v){for(var w=(l.mode&1)!==0;Qe!==null;){var C=Qe,I=C.child;if(C.tag===22&&w){var Y=C.memoizedState!==null||Ni;if(!Y){var re=C.alternate,be=re!==null&&re.memoizedState!==null||li;re=Ni;var je=li;if(Ni=Y,(li=be)&&!je)for(Qe=C;Qe!==null;)Y=Qe,be=Y.child,Y.tag===22&&Y.memoizedState!==null?Tc(C):be!==null?(be.return=Y,Qe=be):Tc(C);for(;I!==null;)Qe=I,Xl(I),I=I.sibling;Qe=C,Ni=re,li=je}Yl(l)}else(C.subtreeFlags&8772)!==0&&I!==null?(I.return=C,Qe=I):Yl(l)}}function Yl(l){for(;Qe!==null;){var c=Qe;if((c.flags&8772)!==0){var v=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:li||vi(5,c);break;case 1:var w=c.stateNode;if(c.flags&4&&!li)if(v===null)w.componentDidMount();else{var C=c.elementType===c.type?v.memoizedProps:ji(c.type,v.memoizedProps);w.componentDidUpdate(C,v.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var I=c.updateQueue;I!==null&&Ph(c,I,w);break;case 3:var Y=c.updateQueue;if(Y!==null){if(v=null,c.child!==null)switch(c.child.tag){case 5:v=ye(c.child.stateNode);break;case 1:v=c.child.stateNode}Ph(c,Y,v)}break;case 5:var re=c.stateNode;v===null&&c.flags&4&&Nt(re,c.type,c.memoizedProps,c);break;case 6:break;case 4:break;case 12:break;case 13:if(Oe&&c.memoizedState===null){var be=c.alternate;if(be!==null){var je=be.memoizedState;if(je!==null){var lt=je.dehydrated;lt!==null&&ge(lt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(u(163))}li||c.flags&512&&Di(c)}catch(Ft){zi(c,c.return,Ft)}}if(c===l){Qe=null;break}if(v=c.sibling,v!==null){v.return=c.return,Qe=v;break}Qe=c.return}}function Ko(l){for(;Qe!==null;){var c=Qe;if(c===l){Qe=null;break}var v=c.sibling;if(v!==null){v.return=c.return,Qe=v;break}Qe=c.return}}function Tc(l){for(;Qe!==null;){var c=Qe;try{switch(c.tag){case 0:case 11:case 15:var v=c.return;try{vi(4,c)}catch(be){zi(c,v,be)}break;case 1:var w=c.stateNode;if(typeof w.componentDidMount=="function"){var C=c.return;try{w.componentDidMount()}catch(be){zi(c,C,be)}}var I=c.return;try{Di(c)}catch(be){zi(c,I,be)}break;case 5:var Y=c.return;try{Di(c)}catch(be){zi(c,Y,be)}}}catch(be){zi(c,c.return,be)}if(c===l){Qe=null;break}var re=c.sibling;if(re!==null){re.return=c.return,Qe=re;break}Qe=c.return}}var Wa=0,ja=1,Xa=2,Us=3,Ui=4;if(typeof Symbol=="function"&&Symbol.for){var Yr=Symbol.for;Wa=Yr("selector.component"),ja=Yr("selector.has_pseudo_class"),Xa=Yr("selector.role"),Us=Yr("selector.test_id"),Ui=Yr("selector.text")}function ql(l){var c=De(l);if(c!=null){if(typeof c.memoizedProps["data-testname"]!="string")throw Error(u(364));return c}if(l=de(l),l===null)throw Error(u(362));return l.stateNode.current}function Ac(l,c){switch(c.$$typeof){case Wa:if(l.type===c.value)return!0;break;case ja:e:{c=c.value,l=[l,0];for(var v=0;v<l.length;){var w=l[v++],C=l[v++],I=c[C];if(w.tag!==5||!Ue(w)){for(;I!=null&&Ac(w,I);)C++,I=c[C];if(C===c.length){c=!0;break e}else for(w=w.child;w!==null;)l.push(w,C),w=w.sibling}}c=!1}return c;case Xa:if(l.tag===5&&vt(l.stateNode,c.value))return!0;break;case Ui:if((l.tag===5||l.tag===6)&&(l=ze(l),l!==null&&0<=l.indexOf(c.value)))return!0;break;case Us:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===c.value.toLowerCase()))return!0;break;default:throw Error(u(365))}return!1}function qr(l){switch(l.$$typeof){case Wa:return"<"+(F(l.value)||"Unknown")+">";case ja:return":has("+(qr(l)||"")+")";case Xa:return'[role="'+l.value+'"]';case Ui:return'"'+l.value+'"';case Us:return'[data-testname="'+l.value+'"]';default:throw Error(u(365))}}function Os(l,c){var v=[];l=[l,0];for(var w=0;w<l.length;){var C=l[w++],I=l[w++],Y=c[I];if(C.tag!==5||!Ue(C)){for(;Y!=null&&Ac(C,Y);)I++,Y=c[I];if(I===c.length)v.push(C);else for(C=C.child;C!==null;)l.push(C,I),C=C.sibling}}return v}function Zl(l,c){if(!z)throw Error(u(363));l=ql(l),l=Os(l,c),c=[],l=Array.from(l);for(var v=0;v<l.length;){var w=l[v++];if(w.tag===5)Ue(w)||c.push(w.stateNode);else for(w=w.child;w!==null;)l.push(w),w=w.sibling}return c}var Wh=Math.ceil,br=f.ReactCurrentDispatcher,cs=f.ReactCurrentOwner,Cn=f.ReactCurrentBatchConfig,Gt=0,Ln=null,Fn=null,ui=0,Oi=0,ks=wt(0),Wn=0,Ya=null,Jo=0,qa=0,$o=0,ao=null,ki=null,Cc=0,lo=1/0;function ea(){lo=Zn()+500}var uo=!1,Rr=null,Pr=null,co=!1,Zi=null,Za=0,fs=0,bc=null,Qa=-1,Mn=0;function ci(){return(Gt&6)!==0?Zn():Qa!==-1?Qa:Qa=Zn()}function ds(l){return(l.mode&1)===0?1:(Gt&2)!==0&&ui!==0?ui&-ui:Rh.transition!==null?(Mn===0&&(l=Ea,Ea<<=1,(Ea&4194240)===0&&(Ea=64),Mn=l),Mn):(l=Yt,l!==0?l:xe())}function Qi(l,c,v){if(50<fs)throw fs=0,bc=null,Error(u(185));var w=ta(l,c);return w===null?null:(Lo(w,c,v),((Gt&2)===0||w!==Ln)&&(w===Ln&&((Gt&2)===0&&(qa|=c),Wn===4&&Zr(w,ui)),Mi(w,v),c===1&&Gt===0&&(l.mode&1)===0&&(ea(),ju&&Sr())),w)}function ta(l,c){l.lanes|=c;var v=l.alternate;for(v!==null&&(v.lanes|=c),v=l,l=l.return;l!==null;)l.childLanes|=c,v=l.alternate,v!==null&&(v.childLanes|=c),v=l,l=l.return;return v.tag===3?v.stateNode:null}function Mi(l,c){var v=l.callbackNode;bh(l,c);var w=Al(l,l===Ln?ui:0);if(w===0)v!==null&&Aa(v),l.callbackNode=null,l.callbackPriority=0;else if(c=w&-w,l.callbackPriority!==c){if(v!=null&&Aa(v),c===1)l.tag===0?Yu(Ka.bind(null,l)):Xu(Ka.bind(null,l)),$e?q(function(){Gt===0&&Sr()}):Io(No,Sr),v=null;else{switch(Ms(w)){case 1:v=No;break;case 4:v=mg;break;case 16:v=Gu;break;case 536870912:v=Wu;break;default:v=Gu}v=$l(v,fo.bind(null,l))}l.callbackPriority=c,l.callbackNode=v}}function fo(l,c){if(Qa=-1,Mn=0,(Gt&6)!==0)throw Error(u(327));var v=l.callbackNode;if(po()&&l.callbackNode!==v)return null;var w=Al(l,l===Ln?ui:0);if(w===0)return null;if((w&30)!==0||(w&l.expiredLanes)!==0||c)c=cr(l,w);else{c=w;var C=Gt;Gt|=2;var I=Pc();(Ln!==l||ui!==c)&&(ea(),Dn(l,c));do try{Kl();break}catch(re){Rc(l,re)}while(!0);Pi(),br.current=I,Gt=C,Fn!==null?c=0:(Ln=null,ui=0,c=Wn)}if(c!==0){if(c===2&&(C=Bu(l),C!==0&&(w=C,c=Tn(l,C))),c===1)throw v=Ya,Dn(l,0),Zr(l,w),Mi(l,Zn()),v;if(c===6)Zr(l,w);else{if(C=l.current.alternate,(w&30)===0&&!fi(C)&&(c=cr(l,w),c===2&&(I=Bu(l),I!==0&&(w=I,c=Tn(l,I))),c===1))throw v=Ya,Dn(l,0),Zr(l,w),Mi(l,Zn()),v;switch(l.finishedWork=C,l.finishedLanes=w,c){case 0:case 1:throw Error(u(345));case 2:ho(l,ki);break;case 3:if(Zr(l,w),(w&130023424)===w&&(c=Cc+500-Zn(),10<c)){if(Al(l,0)!==0)break;if(C=l.suspendedLanes,(C&w)!==w){ci(),l.pingedLanes|=l.suspendedLanes&C;break}l.timeoutHandle=Le(ho.bind(null,l,ki),c);break}ho(l,ki);break;case 4:if(Zr(l,w),(w&4194240)===w)break;for(c=l.eventTimes,C=-1;0<w;){var Y=31-xr(w);I=1<<Y,Y=c[Y],Y>C&&(C=Y),w&=~I}if(w=C,w=Zn()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*Wh(w/1960))-w,10<w){l.timeoutHandle=Le(ho.bind(null,l,ki),w);break}ho(l,ki);break;case 5:ho(l,ki);break;default:throw Error(u(329))}}}return Mi(l,Zn()),l.callbackNode===v?fo.bind(null,l):null}function Tn(l,c){var v=ao;return l.current.memoizedState.isDehydrated&&(Dn(l,c).flags|=256),l=cr(l,c),l!==2&&(c=ki,ki=v,c!==null&&Bn(c)),l}function Bn(l){ki===null?ki=l:ki.push.apply(ki,l)}function fi(l){for(var c=l;;){if(c.flags&16384){var v=c.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var w=0;w<v.length;w++){var C=v[w],I=C.getSnapshot;C=C.value;try{if(!Ri(I(),C))return!1}catch{return!1}}}if(v=c.child,c.subtreeFlags&16384&&v!==null)v.return=c,c=v;else{if(c===l)break;for(;c.sibling===null;){if(c.return===null||c.return===l)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Zr(l,c){for(c&=~$o,c&=~qa,l.suspendedLanes|=c,l.pingedLanes&=~c,l=l.expirationTimes;0<c;){var v=31-xr(c),w=1<<v;l[v]=-1,c&=~w}}function Ka(l){if((Gt&6)!==0)throw Error(u(327));po();var c=Al(l,0);if((c&1)===0)return Mi(l,Zn()),null;var v=cr(l,c);if(l.tag!==0&&v===2){var w=Bu(l);w!==0&&(c=w,v=Tn(l,w))}if(v===1)throw v=Ya,Dn(l,0),Zr(l,c),Mi(l,Zn()),v;if(v===6)throw Error(u(345));return l.finishedWork=l.current.alternate,l.finishedLanes=c,ho(l,ki),Mi(l,Zn()),null}function Ja(l){Zi!==null&&Zi.tag===0&&(Gt&6)===0&&po();var c=Gt;Gt|=1;var v=Cn.transition,w=Yt;try{if(Cn.transition=null,Yt=1,l)return l()}finally{Yt=w,Cn.transition=v,Gt=c,(Gt&6)===0&&Sr()}}function md(){Oi=ks.current,Vt(ks)}function Dn(l,c){l.finishedWork=null,l.finishedLanes=0;var v=l.timeoutHandle;if(v!==xt&&(l.timeoutHandle=xt,tt(v)),Fn!==null)for(v=Fn.return;v!==null;){var w=v;switch(Yf(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&yr();break;case 3:Ua(),Vt(Gn),Vt(qn),Ho();break;case 5:Qf(w);break;case 4:Ua();break;case 13:Vt(Rn);break;case 19:Vt(Rn);break;case 10:Ll(w.type._context);break;case 22:case 23:md()}v=v.return}if(Ln=l,Fn=l=zs(l.current,null),ui=Oi=c,Wn=0,Ya=null,$o=qa=Jo=0,ki=ao=null,Mr!==null){for(c=0;c<Mr.length;c++)if(v=Mr[c],w=v.interleaved,w!==null){v.interleaved=null;var C=w.next,I=v.pending;if(I!==null){var Y=I.next;I.next=C,w.next=Y}v.pending=w}Mr=null}return l}function Rc(l,c){do{var v=Fn;try{if(Pi(),Nl.current=Ba,sc){for(var w=Pn.memoizedState;w!==null;){var C=w.queue;C!==null&&(C.pending=null),w=w.next}sc=!1}if(Vo=0,si=ri=Pn=null,as=!1,Go=0,cs.current=null,v===null||v.return===null){Wn=1,Ya=c,Fn=null;break}e:{var I=l,Y=v.return,re=v,be=c;if(c=ui,re.flags|=32768,be!==null&&typeof be=="object"&&typeof be.then=="function"){var je=be,lt=re,Ft=lt.tag;if((lt.mode&1)===0&&(Ft===0||Ft===11||Ft===15)){var Et=lt.alternate;Et?(lt.updateQueue=Et.updateQueue,lt.memoizedState=Et.memoizedState,lt.lanes=Et.lanes):(lt.updateQueue=null,lt.memoizedState=null)}var hn=od(Y);if(hn!==null){hn.flags&=-257,jo(hn,Y,re,I,c),hn.mode&1&&Rs(I,je,c),c=hn,be=je;var rt=c.updateQueue;if(rt===null){var ln=new Set;ln.add(be),c.updateQueue=ln}else rt.add(be);break e}else{if((c&1)===0){Rs(I,je,c),Ql();break e}be=Error(u(426))}}else if(An&&re.mode&1){var dr=od(Y);if(dr!==null){(dr.flags&65536)===0&&(dr.flags|=256),jo(dr,Y,re,I,c),nc(be);break e}}I=be,Wn!==4&&(Wn=2),ao===null?ao=[I]:ao.push(I),be=sd(be,re),re=Y;do{switch(re.tag){case 3:re.flags|=65536,c&=-c,re.lanes|=c;var pe=Vh(re,be,c);Qu(re,pe);break e;case 1:I=be;var oe=re.type,we=re.stateNode;if((re.flags&128)===0&&(typeof oe.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(Pr===null||!Pr.has(we)))){re.flags|=65536,c&=-c,re.lanes|=c;var it=mc(re,I,c);Qu(re,it);break e}}re=re.return}while(re!==null)}Ic(v)}catch(mt){c=mt,Fn===v&&v!==null&&(Fn=v=v.return);continue}break}while(!0)}function Pc(){var l=br.current;return br.current=Ba,l===null?Ba:l}function Ql(){(Wn===0||Wn===3||Wn===2)&&(Wn=4),Ln===null||(Jo&268435455)===0&&(qa&268435455)===0||Zr(Ln,ui)}function cr(l,c){var v=Gt;Gt|=2;var w=Pc();Ln===l&&ui===c||Dn(l,c);do try{Lr();break}catch(C){Rc(l,C)}while(!0);if(Pi(),Gt=v,br.current=w,Fn!==null)throw Error(u(261));return Ln=null,ui=0,Wn}function Lr(){for(;Fn!==null;)Lc(Fn)}function Kl(){for(;Fn!==null&&!Js();)Lc(Fn)}function Lc(l){var c=yd(l.alternate,l,Oi);l.memoizedProps=l.pendingProps,c===null?Ic(l):Fn=c,cs.current=null}function Ic(l){var c=l;do{var v=c.alternate;if(l=c.return,(c.flags&32768)===0){if(v=yc(v,c,Oi),v!==null){Fn=v;return}}else{if(v=Sc(v,c),v!==null){v.flags&=32767,Fn=v;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Wn=6,Fn=null;return}}if(c=c.sibling,c!==null){Fn=c;return}Fn=c=l}while(c!==null);Wn===0&&(Wn=5)}function ho(l,c){var v=Yt,w=Cn.transition;try{Cn.transition=null,Yt=1,jh(l,c,v)}finally{Cn.transition=w,Yt=v}return null}function jh(l,c,v){do po();while(Zi!==null);if((Gt&6)!==0)throw Error(u(327));var w=l.finishedWork,C=l.finishedLanes;if(w===null)return null;if(l.finishedWork=null,l.finishedLanes=0,w===l.current)throw Error(u(177));l.callbackNode=null,l.callbackPriority=0;var I=w.lanes|w.childLanes;if(Vu(l,I),l===Ln&&(Fn=Ln=null,ui=0),(w.subtreeFlags&2064)===0&&(w.flags&2064)===0||co||(co=!0,$l(Gu,function(){return po(),null})),I=(w.flags&15990)!==0,(w.subtreeFlags&15990)!==0||I){I=Cn.transition,Cn.transition=null;var Y=Yt;Yt=1;var re=Gt;Gt|=4,cs.current=null,fd(l,w),yg(l,w),k(l.containerInfo),l.current=w,Xr(w),pg(),Gt=re,Yt=Y,Cn.transition=I}else l.current=w;if(co&&(co=!1,Zi=l,Za=C),I=l.pendingLanes,I===0&&(Pr=null),bl(w.stateNode),Mi(l,Zn()),c!==null)for(v=l.onRecoverableError,w=0;w<c.length;w++)v(c[w]);if(uo)throw uo=!1,l=Rr,Rr=null,l;return(Za&1)!==0&&l.tag!==0&&po(),I=l.pendingLanes,(I&1)!==0?l===bc?fs++:(fs=0,bc=l):fs=0,Sr(),null}function po(){if(Zi!==null){var l=Ms(Za),c=Cn.transition,v=Yt;try{if(Cn.transition=null,Yt=16>l?16:l,Zi===null)var w=!1;else{if(l=Zi,Zi=null,Za=0,(Gt&6)!==0)throw Error(u(331));var C=Gt;for(Gt|=4,Qe=l.current;Qe!==null;){var I=Qe,Y=I.child;if((Qe.flags&16)!==0){var re=I.deletions;if(re!==null){for(var be=0;be<re.length;be++){var je=re[be];for(Qe=je;Qe!==null;){var lt=Qe;switch(lt.tag){case 0:case 11:case 15:Ds(8,lt,I)}var Ft=lt.child;if(Ft!==null)Ft.return=lt,Qe=Ft;else for(;Qe!==null;){lt=Qe;var Et=lt.sibling,hn=lt.return;if(dd(lt),lt===je){Qe=null;break}if(Et!==null){Et.return=hn,Qe=Et;break}Qe=hn}}}var rt=I.alternate;if(rt!==null){var ln=rt.child;if(ln!==null){rt.child=null;do{var dr=ln.sibling;ln.sibling=null,ln=dr}while(ln!==null)}}Qe=I}}if((I.subtreeFlags&2064)!==0&&Y!==null)Y.return=I,Qe=Y;else e:for(;Qe!==null;){if(I=Qe,(I.flags&2048)!==0)switch(I.tag){case 0:case 11:case 15:Ds(9,I,I.return)}var pe=I.sibling;if(pe!==null){pe.return=I.return,Qe=pe;break e}Qe=I.return}}var oe=l.current;for(Qe=oe;Qe!==null;){Y=Qe;var we=Y.child;if((Y.subtreeFlags&2064)!==0&&we!==null)we.return=Y,Qe=we;else e:for(Y=oe;Qe!==null;){if(re=Qe,(re.flags&2048)!==0)try{switch(re.tag){case 0:case 11:case 15:vi(9,re)}}catch(mt){zi(re,re.return,mt)}if(re===Y){Qe=null;break e}var it=re.sibling;if(it!==null){it.return=re.return,Qe=it;break e}Qe=re.return}}if(Gt=C,Sr(),os&&typeof os.onPostCommitFiberRoot=="function")try{os.onPostCommitFiberRoot(Cl,l)}catch{}w=!0}return w}finally{Yt=v,Cn.transition=c}}return!1}function gd(l,c,v){c=sd(v,c),c=Vh(l,c,1),$s(l,c),c=ci(),l=ta(l,1),l!==null&&(Lo(l,1,c),Mi(l,c))}function zi(l,c,v){if(l.tag===3)gd(l,l,v);else for(;c!==null;){if(c.tag===3){gd(c,l,v);break}else if(c.tag===1){var w=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Pr===null||!Pr.has(w))){l=sd(v,l),l=mc(c,l,1),$s(c,l),l=ci(),c=ta(c,1),c!==null&&(Lo(c,1,l),Mi(c,l));break}}c=c.return}}function Xh(l,c,v){var w=l.pingCache;w!==null&&w.delete(c),c=ci(),l.pingedLanes|=l.suspendedLanes&v,Ln===l&&(ui&v)===v&&(Wn===4||Wn===3&&(ui&130023424)===ui&&500>Zn()-Cc?Dn(l,0):$o|=v),Mi(l,c)}function vd(l,c){c===0&&((l.mode&1)===0?c=1:(c=sn,sn<<=1,(sn&130023424)===0&&(sn=4194304)));var v=ci();l=ta(l,c),l!==null&&(Lo(l,c,v),Mi(l,v))}function Yh(l){var c=l.memoizedState,v=0;c!==null&&(v=c.retryLane),vd(l,v)}function Jl(l,c){var v=0;switch(l.tag){case 13:var w=l.stateNode,C=l.memoizedState;C!==null&&(v=C.retryLane);break;case 19:w=l.stateNode;break;default:throw Error(u(314))}w!==null&&w.delete(c),vd(l,v)}var yd;yd=function(l,c,v){if(l!==null)if(l.memoizedProps!==c.pendingProps||Gn.current)ai=!0;else{if((l.lanes&v)===0&&(c.flags&128)===0)return ai=!1,_c(l,c,v);ai=(l.flags&131072)!==0}else ai=!1,An&&(c.flags&1048576)!==0&&Dh(c,ec,c.index);switch(c.lanes=0,c.tag){case 2:var w=c.type;l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2),l=c.pendingProps;var C=yn(c,qn.current);Ca(c,v),C=Oa(null,c,w,l,C,v);var I=io();return c.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,xn(w)?(I=!0,wa(c)):I=!1,c.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,ba(c),C.updater=Ju,c.stateNode=C,C._reactInternals=c,jf(c,w,l,v),c=Si(null,c,w,!0,I,v)):(c.tag=0,An&&I&&Xf(c),Nn(null,c,C,v),c=c.child),c;case 16:w=c.elementType;e:{switch(l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2),l=c.pendingProps,C=w._init,w=C(w._payload),c.type=w,C=c.tag=qh(w),l=ji(w,l),C){case 0:c=Is(null,c,w,l,v);break e;case 1:c=Yo(null,c,w,l,v);break e;case 11:c=Sn(null,c,w,l,v);break e;case 14:c=dn(null,c,w,ji(w.type,l),v);break e}throw Error(u(306,w,""))}return c;case 0:return w=c.type,C=c.pendingProps,C=c.elementType===w?C:ji(w,C),Is(l,c,w,C,v);case 1:return w=c.type,C=c.pendingProps,C=c.elementType===w?C:ji(w,C),Yo(l,c,w,C,v);case 3:e:{if(Vl(c),l===null)throw Error(u(387));w=c.pendingProps,I=c.memoizedState,C=I.element,Vf(l,c),Ku(c,w,null,v);var Y=c.memoizedState;if(w=Y.element,Oe&&I.isDehydrated)if(I={element:w,isDehydrated:!1,cache:Y.cache,transitions:Y.transitions},c.updateQueue.baseState=I,c.memoizedState=I,c.flags&256){C=Error(u(423)),c=ld(l,c,w,v,C);break e}else if(w!==C){C=Error(u(424)),c=ld(l,c,w,v,C);break e}else for(Oe&&(mi=Uf(c.stateNode.containerInfo),Li=c,An=!0,Tr=null,Pa=!1),v=kh(c,null,w,v),c.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(La(),w===C){c=qi(l,c,v);break e}Nn(l,c,w,v)}c=c.child}return c;case 5:return zh(c),l===null&&to(c),w=c.type,C=c.pendingProps,I=l!==null?l.memoizedProps:null,Y=C.children,Re(w,C)?Y=null:I!==null&&Re(w,I)&&(c.flags|=32),Ii(l,c),Nn(l,c,Y,v),c.child;case 6:return l===null&&to(c),null;case 13:return ud(l,c,v);case 4:return ic(c,c.stateNode.containerInfo),w=c.pendingProps,l===null?c.child=Cs(c,null,w,v):Nn(l,c,w,v),c.child;case 11:return w=c.type,C=c.pendingProps,C=c.elementType===w?C:ji(w,C),Sn(l,c,w,C,v);case 7:return Nn(l,c,c.pendingProps,v),c.child;case 8:return Nn(l,c,c.pendingProps.children,v),c.child;case 12:return Nn(l,c,c.pendingProps.children,v),c.child;case 10:e:{if(w=c.type._context,C=c.pendingProps,I=c.memoizedProps,Y=C.value,Uo(c,w,Y),I!==null)if(Ri(I.value,Y)){if(I.children===C.children&&!Gn.current){c=qi(l,c,v);break e}}else for(I=c.child,I!==null&&(I.return=c);I!==null;){var re=I.dependencies;if(re!==null){Y=I.child;for(var be=re.firstContext;be!==null;){if(be.context===w){if(I.tag===1){be=Es(-1,v&-v),be.tag=2;var je=I.updateQueue;if(je!==null){je=je.shared;var lt=je.pending;lt===null?be.next=be:(be.next=lt.next,lt.next=be),je.pending=be}}I.lanes|=v,be=I.alternate,be!==null&&(be.lanes|=v),Oo(I.return,v,c),re.lanes|=v;break}be=be.next}}else if(I.tag===10)Y=I.type===c.type?null:I.child;else if(I.tag===18){if(Y=I.return,Y===null)throw Error(u(341));Y.lanes|=v,re=Y.alternate,re!==null&&(re.lanes|=v),Oo(Y,v,c),Y=I.sibling}else Y=I.child;if(Y!==null)Y.return=I;else for(Y=I;Y!==null;){if(Y===c){Y=null;break}if(I=Y.sibling,I!==null){I.return=Y.return,Y=I;break}Y=Y.return}I=Y}Nn(l,c,C.children,v),c=c.child}return c;case 9:return C=c.type,w=c.pendingProps.children,Ca(c,v),C=Xi(C),w=w(C),c.flags|=1,Nn(l,c,w,v),c.child;case 14:return w=c.type,C=ji(w,c.pendingProps),C=ji(w.type,C),dn(l,c,w,C,v);case 15:return Ls(l,c,c.type,c.pendingProps,v);case 17:return w=c.type,C=c.pendingProps,C=c.elementType===w?C:ji(w,C),l!==null&&(l.alternate=null,c.alternate=null,c.flags|=2),c.tag=1,xn(w)?(l=!0,wa(c)):l=!1,Ca(c,v),Ih(c,w,C),jf(c,w,C,v),Si(null,c,w,!0,l,v);case 19:return Zo(l,c,v);case 22:return gi(l,c,v)}throw Error(u(156,c.tag))};function $l(l,c){return Io(l,c)}function Nc(l,c,v,w){this.tag=l,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(l,c,v,w){return new Nc(l,c,v,w)}function eu(l){return l=l.prototype,!(!l||!l.isReactComponent)}function qh(l){if(typeof l=="function")return eu(l)?1:0;if(l!=null){if(l=l.$$typeof,l===A)return 11;if(l===P)return 14}return 2}function zs(l,c){var v=l.alternate;return v===null?(v=fr(l.tag,c,l.key,l.mode),v.elementType=l.elementType,v.type=l.type,v.stateNode=l.stateNode,v.alternate=l,l.alternate=v):(v.pendingProps=c,v.type=l.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=l.flags&14680064,v.childLanes=l.childLanes,v.lanes=l.lanes,v.child=l.child,v.memoizedProps=l.memoizedProps,v.memoizedState=l.memoizedState,v.updateQueue=l.updateQueue,c=l.dependencies,v.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},v.sibling=l.sibling,v.index=l.index,v.ref=l.ref,v}function tu(l,c,v,w,C,I){var Y=2;if(w=l,typeof l=="function")eu(l)&&(Y=1);else if(typeof l=="string")Y=5;else e:switch(l){case m:return mo(v.children,C,I,c);case g:Y=8,C|=8;break;case y:return l=fr(12,v,c,C|2),l.elementType=y,l.lanes=I,l;case E:return l=fr(13,v,c,C),l.elementType=E,l.lanes=I,l;case S:return l=fr(19,v,c,C),l.elementType=S,l.lanes=I,l;case L:return $a(v,C,I,c);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case _:Y=10;break e;case M:Y=9;break e;case A:Y=11;break e;case P:Y=14;break e;case b:Y=16,w=null;break e}throw Error(u(130,l==null?l:typeof l,""))}return c=fr(Y,v,c,C),c.elementType=l,c.type=w,c.lanes=I,c}function mo(l,c,v,w){return l=fr(7,l,w,c),l.lanes=v,l}function $a(l,c,v,w){return l=fr(22,l,w,c),l.elementType=L,l.lanes=v,l.stateNode={},l}function Dc(l,c,v){return l=fr(6,l,null,c),l.lanes=v,l}function Uc(l,c,v){return c=fr(4,l.children!==null?l.children:[],l.key,c),c.lanes=v,c.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},c}function Zh(l,c,v,w,C){this.tag=c,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=xt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hu(0),this.expirationTimes=Hu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hu(0),this.identifierPrefix=w,this.onRecoverableError=C,Oe&&(this.mutableSourceEagerHydrationData=null)}function Qh(l,c,v,w,C,I,Y,re,be){return l=new Zh(l,c,v,re,be),c===1?(c=1,I===!0&&(c|=8)):c=0,I=fr(3,null,null,c),l.current=I,I.stateNode=l,I.memoizedState={element:w,isDehydrated:v,cache:null,transitions:null},ba(I),l}function xd(l){if(!l)return vn;l=l._reactInternals;e:{if(O(l)!==l||l.tag!==1)throw Error(u(170));var c=l;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(xn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(u(171))}if(l.tag===1){var v=l.type;if(xn(v))return Ma(l,v,c)}return c}function Kh(l){var c=l._reactInternals;if(c===void 0)throw typeof l.render=="function"?Error(u(188)):(l=Object.keys(l).join(","),Error(u(268,l)));return l=te(c),l===null?null:l.stateNode}function Jh(l,c){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var v=l.retryLane;l.retryLane=v!==0&&v<c?v:c}}function Oc(l,c){Jh(l,c),(l=l.alternate)&&Jh(l,c)}function $h(l){return l=te(l),l===null?null:l.stateNode}function ep(){return null}return t.attemptContinuousHydration=function(l){if(l.tag===13){var c=ci();Qi(l,134217728,c),Oc(l,134217728)}},t.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var c=ci(),v=ds(l);Qi(l,v,c),Oc(l,v)}},t.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var c=l.stateNode;if(c.current.memoizedState.isDehydrated){var v=Ta(c.pendingLanes);v!==0&&(ss(c,v|1),Mi(c,Zn()),(Gt&6)===0&&(ea(),Sr()))}break;case 13:var w=ci();Ja(function(){return Qi(l,1,w)}),Oc(l,1)}},t.batchedUpdates=function(l,c){var v=Gt;Gt|=1;try{return l(c)}finally{Gt=v,Gt===0&&(ea(),ju&&Sr())}},t.createComponentSelector=function(l){return{$$typeof:Wa,value:l}},t.createContainer=function(l,c,v,w,C,I,Y){return Qh(l,c,!1,null,v,w,C,I,Y)},t.createHasPseudoClassSelector=function(l){return{$$typeof:ja,value:l}},t.createHydrationContainer=function(l,c,v,w,C,I,Y,re,be){return l=Qh(v,w,!0,l,C,I,Y,re,be),l.context=xd(null),v=l.current,w=ci(),C=ds(v),I=Es(w,C),I.callback=c??null,$s(v,I),l.current.lanes=C,Lo(l,C,w),Mi(l,w),l},t.createPortal=function(l,c,v){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:w==null?null:""+w,children:l,containerInfo:c,implementation:v}},t.createRoleSelector=function(l){return{$$typeof:Xa,value:l}},t.createTestNameSelector=function(l){return{$$typeof:Us,value:l}},t.createTextSelector=function(l){return{$$typeof:Ui,value:l}},t.deferredUpdates=function(l){var c=Yt,v=Cn.transition;try{return Cn.transition=null,Yt=16,l()}finally{Yt=c,Cn.transition=v}},t.discreteUpdates=function(l,c,v,w,C){var I=Yt,Y=Cn.transition;try{return Cn.transition=null,Yt=1,l(c,v,w,C)}finally{Yt=I,Cn.transition=Y,Gt===0&&ea()}},t.findAllNodes=Zl,t.findBoundingRects=function(l,c){if(!z)throw Error(u(363));c=Zl(l,c),l=[];for(var v=0;v<c.length;v++)l.push(Ie(c[v]));for(c=l.length-1;0<c;c--){v=l[c];for(var w=v.x,C=w+v.width,I=v.y,Y=I+v.height,re=c-1;0<=re;re--)if(c!==re){var be=l[re],je=be.x,lt=je+be.width,Ft=be.y,Et=Ft+be.height;if(w>=je&&I>=Ft&&C<=lt&&Y<=Et){l.splice(c,1);break}else if(w!==je||v.width!==be.width||Et<I||Ft>Y){if(!(I!==Ft||v.height!==be.height||lt<w||je>C)){je>w&&(be.width+=je-w,be.x=w),lt<C&&(be.width=C-je),l.splice(c,1);break}}else{Ft>I&&(be.height+=Ft-I,be.y=I),Et<Y&&(be.height=Y-Ft),l.splice(c,1);break}}}return l},t.findHostInstance=Kh,t.findHostInstanceWithNoPortals=function(l){return l=X(l),l=l!==null?ue(l):null,l===null?null:l.stateNode},t.findHostInstanceWithWarning=function(l){return Kh(l)},t.flushControlled=function(l){var c=Gt;Gt|=1;var v=Cn.transition,w=Yt;try{Cn.transition=null,Yt=1,l()}finally{Yt=w,Cn.transition=v,Gt=c,Gt===0&&(ea(),Sr())}},t.flushPassiveEffects=po,t.flushSync=Ja,t.focusWithin=function(l,c){if(!z)throw Error(u(363));for(l=ql(l),c=Os(l,c),c=Array.from(c),l=0;l<c.length;){var v=c[l++];if(!Ue(v)){if(v.tag===5&&Je(v.stateNode))return!0;for(v=v.child;v!==null;)c.push(v),v=v.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Yt},t.getFindAllNodesFailureDescription=function(l,c){if(!z)throw Error(u(363));var v=0,w=[];l=[ql(l),0];for(var C=0;C<l.length;){var I=l[C++],Y=l[C++],re=c[Y];if((I.tag!==5||!Ue(I))&&(Ac(I,re)&&(w.push(qr(re)),Y++,Y>v&&(v=Y)),Y<c.length))for(I=I.child;I!==null;)l.push(I,Y),I=I.sibling}if(v<c.length){for(l=[];v<c.length;v++)l.push(qr(c[v]));return`findAllNodes was able to match part of the selector:
  `+(w.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},t.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return ye(l.child.stateNode);default:return l.child.stateNode}},t.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:f.ReactCurrentDispatcher,findHostInstanceByFiber:$h,findFiberByHostInstance:l.findFiberByHostInstance||ep,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(c.isDisabled||!c.supportsFiber)l=!0;else{try{Cl=c.inject(l),os=c}catch{}l=!!c.checkDCE}}return l},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(l,c,v,w){if(!z)throw Error(u(363));l=Zl(l,c);var C=Ke(l,v,w).disconnect;return{disconnect:function(){C()}}},t.registerMutableSourceForHydration=function(l,c){var v=c._getVersion;v=v(c._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[c,v]:l.mutableSourceEagerHydrationData.push(c,v)},t.runWithPriority=function(l,c){var v=Yt;try{return Yt=l,c()}finally{Yt=v}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(l,c,v,w){var C=c.current,I=ci(),Y=ds(C);return v=xd(v),c.context===null?c.context=v:c.pendingContext=v,c=Es(I,Y),c.payload={element:l},w=w===void 0?null:w,w!==null&&(c.callback=w),$s(C,c),l=Qi(C,Y,I),l!==null&&Zu(l,C,Y),Y},t}),k0}var x1;function B3(){return x1||(x1=1,D0.exports=F3()),D0.exports}var H3=B3();const V3=Bm(H3);var _1=ww();const Wy={},Ew=s=>void Object.assign(Wy,s);function G3(s,e){function t(m,{args:g=[],attach:y,..._},M){let A=`${m[0].toUpperCase()}${m.slice(1)}`,E;if(m==="primitive"){if(_.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const S=_.object;E=hf(S,{type:m,root:M,attach:y,primitive:!0})}else{const S=Wy[A];if(!S)throw new Error(`R3F: ${A} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(g))throw new Error("R3F: The args prop must be an array!");E=hf(new S(...g),{type:m,root:M,attach:y,memoizedProps:{args:g}})}return E.__r3f.attach===void 0&&(E instanceof Zt?E.__r3f.attach="geometry":E instanceof Wi&&(E.__r3f.attach="material")),A!=="inject"&&B0(E,_),E}function n(m,g){let y=!1;if(g){var _,M;(_=g.__r3f)!=null&&_.attach?F0(m,g,g.__r3f.attach):g.isObject3D&&m.isObject3D&&(m.add(g),y=!0),y||(M=m.__r3f)==null||M.objects.push(g),g.__r3f||hf(g,{}),g.__r3f.parent=m,Kv(g),pf(g)}}function i(m,g,y){let _=!1;if(g){var M,A;if((M=g.__r3f)!=null&&M.attach)F0(m,g,g.__r3f.attach);else if(g.isObject3D&&m.isObject3D){g.parent=m,g.dispatchEvent({type:"added"}),m.dispatchEvent({type:"childadded",child:g});const E=m.children.filter(P=>P!==g),S=E.indexOf(y);m.children=[...E.slice(0,S),g,...E.slice(S)],_=!0}_||(A=m.__r3f)==null||A.objects.push(g),g.__r3f||hf(g,{}),g.__r3f.parent=m,Kv(g),pf(g)}}function o(m,g,y=!1){m&&[...m].forEach(_=>u(g,_,y))}function u(m,g,y){if(g){var _,M,A;if(g.__r3f&&(g.__r3f.parent=null),(_=m.__r3f)!=null&&_.objects&&(m.__r3f.objects=m.__r3f.objects.filter(L=>L!==g)),(M=g.__r3f)!=null&&M.attach)T1(m,g,g.__r3f.attach);else if(g.isObject3D&&m.isObject3D){var E;m.remove(g),(E=g.__r3f)!=null&&E.root&&Q3(Rm(g),g)}const P=(A=g.__r3f)==null?void 0:A.primitive,b=!P&&(y===void 0?g.dispose!==null:y);if(!P){var S;o((S=g.__r3f)==null?void 0:S.objects,g,b),o(g.children,g,b)}if(delete g.__r3f,b&&g.dispose&&g.type!=="Scene"){const L=()=>{try{g.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?_1.unstable_scheduleCallback(_1.unstable_IdlePriority,L):L()}pf(m)}}function f(m,g,y,_){var M;const A=(M=m.__r3f)==null?void 0:M.parent;if(!A)return;const E=t(g,y,m.__r3f.root);if(m.children){for(const S of m.children)S.__r3f&&n(E,S);m.children=m.children.filter(S=>!S.__r3f)}m.__r3f.objects.forEach(S=>n(E,S)),m.__r3f.objects=[],m.__r3f.autoRemovedBeforeAppend||u(A,m),E.parent&&(E.__r3f.autoRemovedBeforeAppend=!0),n(A,E),E.raycast&&E.__r3f.eventCount&&Rm(E).getState().internal.interaction.push(E),[_,_.alternate].forEach(S=>{S!==null&&(S.stateNode=E,S.ref&&(typeof S.ref=="function"?S.ref(E):S.ref.current=E))})}const d=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:V3({createInstance:t,removeChild:u,appendChild:n,appendInitialChild:n,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(m,g)=>{if(!g)return;const y=m.getState().scene;y.__r3f&&(y.__r3f.root=m,n(y,g))},removeChildFromContainer:(m,g)=>{g&&u(m.getState().scene,g)},insertInContainerBefore:(m,g,y)=>{if(!g||!y)return;const _=m.getState().scene;_.__r3f&&i(_,g,y)},getRootHostContext:()=>null,getChildHostContext:m=>m,finalizeInitialChildren(m){var g;return!!((g=m==null?void 0:m.__r3f)!=null?g:{}).handlers},prepareUpdate(m,g,y,_){var M;if(((M=m==null?void 0:m.__r3f)!=null?M:{}).primitive&&_.object&&_.object!==m)return[!0];{const{args:E=[],children:S,...P}=_,{args:b=[],children:L,...B}=y;if(!Array.isArray(E))throw new Error("R3F: the args prop must be an array!");if(E.some((F,j)=>F!==b[j]))return[!0];const D=Lw(m,P,B,!0);return D.changes.length?[!1,D]:null}},commitUpdate(m,[g,y],_,M,A,E){g?f(m,_,A,E):B0(m,y)},commitMount(m,g,y,_){var M;const A=(M=m.__r3f)!=null?M:{};m.raycast&&A.handlers&&A.eventCount&&Rm(m).getState().internal.interaction.push(m)},getPublicInstance:m=>m,prepareForCommit:()=>null,preparePortalMount:m=>hf(m.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(m){var g;const{attach:y,parent:_}=(g=m.__r3f)!=null?g:{};y&&_&&T1(_,m,y),m.isObject3D&&(m.visible=!1),pf(m)},unhideInstance(m,g){var y;const{attach:_,parent:M}=(y=m.__r3f)!=null?y:{};_&&M&&F0(M,m,_),(m.isObject3D&&g.visible==null||g.visible)&&(m.visible=!0),pf(m)},createTextInstance:d,hideTextInstance:d,unhideTextInstance:d,getCurrentEventPriority:()=>e?e():_f.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Un.fun(performance.now)?performance.now:Un.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Un.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Un.fun(clearTimeout)?clearTimeout:void 0}),applyProps:B0}}var S1,M1;const z0=s=>"colorSpace"in s||"outputColorSpace"in s,Tw=()=>{var s;return(s=Wy.ColorManagement)!=null?s:null},Aw=s=>s&&s.isOrthographicCamera,W3=s=>s&&s.hasOwnProperty("current"),Ch=typeof window<"u"&&((S1=window.document)!=null&&S1.createElement||((M1=window.navigator)==null?void 0:M1.product)==="ReactNative")?ve.useLayoutEffect:ve.useEffect;function Cw(s){const e=ve.useRef(s);return Ch(()=>void(e.current=s),[s]),e}function j3({set:s}){return Ch(()=>(s(new Promise(()=>null)),()=>s(!1)),[s]),null}let bw=class extends ve.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}};bw.getDerivedStateFromError=()=>({error:!0});const Rw="__default",w1=new Map,X3=s=>s&&!!s.memoized&&!!s.changes;function Pw(s){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(s)?Math.min(Math.max(s[0],t),s[1]):s}const Fd=s=>{var e;return(e=s.__r3f)==null?void 0:e.root.getState()};function Rm(s){let e=s.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Un={obj:s=>s===Object(s)&&!Un.arr(s)&&typeof s!="function",fun:s=>typeof s=="function",str:s=>typeof s=="string",num:s=>typeof s=="number",boo:s=>typeof s=="boolean",und:s=>s===void 0,arr:s=>Array.isArray(s),equ(s,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof s!=typeof e||!!s!=!!e)return!1;if(Un.str(s)||Un.num(s))return s===e;const o=Un.obj(s);if(o&&n==="reference")return s===e;const u=Un.arr(s);if(u&&t==="reference")return s===e;if((u||o)&&s===e)return!0;let f;for(f in s)if(!(f in e))return!1;if(o&&t==="shallow"&&n==="shallow"){for(f in i?e:s)if(!Un.equ(s[f],e[f],{strict:i,objects:"reference"}))return!1}else for(f in i?e:s)if(s[f]!==e[f])return!1;if(Un.und(f)){if(u&&s.length===0&&e.length===0||o&&Object.keys(s).length===0&&Object.keys(e).length===0)return!0;if(s!==e)return!1}return!0}};function Y3(s){s.dispose&&s.type!=="Scene"&&s.dispose();for(const e in s)e.dispose==null||e.dispose(),delete s[e]}function hf(s,e){const t=s;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},s}function Qv(s,e){let t=s;if(e.includes("-")){const n=e.split("-"),i=n.pop();return t=n.reduce((o,u)=>o[u],s),{target:t,key:i}}else return{target:t,key:e}}const E1=/-\d+$/;function F0(s,e,t){if(Un.str(t)){if(E1.test(t)){const o=t.replace(E1,""),{target:u,key:f}=Qv(s,o);Array.isArray(u[f])||(u[f]=[])}const{target:n,key:i}=Qv(s,t);e.__r3f.previousAttach=n[i],n[i]=e}else e.__r3f.previousAttach=t(s,e)}function T1(s,e,t){var n,i;if(Un.str(t)){const{target:o,key:u}=Qv(s,t),f=e.__r3f.previousAttach;f===void 0?delete o[u]:o[u]=f}else(n=e.__r3f)==null||n.previousAttach==null||n.previousAttach(s,e);(i=e.__r3f)==null||delete i.previousAttach}function Lw(s,{children:e,key:t,ref:n,...i},{children:o,key:u,ref:f,...d}={},p=!1){var m;const g=(m=s==null?void 0:s.__r3f)!=null?m:{},y=Object.entries(i),_=[];if(p){const A=Object.keys(d);for(let E=0;E<A.length;E++)i.hasOwnProperty(A[E])||y.unshift([A[E],Rw+"remove"])}y.forEach(([A,E])=>{var S;if((S=s.__r3f)!=null&&S.primitive&&A==="object"||Un.equ(E,d[A]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(A))return _.push([A,E,!0,[]]);let P=[];A.includes("-")&&(P=A.split("-")),_.push([A,E,!1,P]);for(const b in i){const L=i[b];b.startsWith(`${A}-`)&&_.push([b,L,!1,b.split("-")])}});const M={...i};return g.memoizedProps&&g.memoizedProps.args&&(M.args=g.memoizedProps.args),g.memoizedProps&&g.memoizedProps.attach&&(M.attach=g.memoizedProps.attach),{memoized:M,changes:_}}function B0(s,e){var t,n,i;const o=(t=s.__r3f)!=null?t:{},u=o.root,f=(n=u==null||u.getState==null?void 0:u.getState())!=null?n:{},{memoized:d,changes:p}=X3(e)?e:Lw(s,e),m=o.eventCount;s.__r3f&&(s.__r3f.memoizedProps=d);for(let y=0;y<p.length;y++){let[_,M,A,E]=p[y];if(z0(s)){const L="srgb",B="srgb-linear";_==="encoding"?(_="colorSpace",M=M===3001?L:B):_==="outputEncoding"&&(_="outputColorSpace",M=M===3001?L:B)}let S=s,P=S[_];if(E.length&&(P=E.reduce((b,L)=>b[L],s),!(P&&P.set))){const[b,...L]=E.reverse();S=L.reverse().reduce((B,D)=>B[D],s),_=b}if(M===Rw+"remove")if(S.constructor){let b=w1.get(S.constructor);b||(b=new S.constructor,w1.set(S.constructor,b)),M=b[_]}else M=0;if(A)M?o.handlers[_]=M:delete o.handlers[_],o.eventCount=Object.keys(o.handlers).length;else if(P&&P.set&&(P.copy||P instanceof Lu)){if(Array.isArray(M))P.fromArray?P.fromArray(M):P.set(...M);else if(P.copy&&M&&M.constructor&&P.constructor===M.constructor)P.copy(M);else if(M!==void 0){const b=P instanceof st;!b&&P.setScalar?P.setScalar(M):P instanceof Lu&&M instanceof Lu?P.mask=M.mask:P.set(M),!Tw()&&!f.linear&&b&&P.convertSRGBToLinear()}}else if(S[_]=M,S[_]instanceof Vn&&S[_].format===kr&&S[_].type===Ao){const b=S[_];z0(b)&&z0(f.gl)?b.colorSpace=f.gl.outputColorSpace:b.encoding=f.gl.outputEncoding}pf(s)}if(o.parent&&s.raycast&&m!==o.eventCount){const y=Rm(s).getState().internal,_=y.interaction.indexOf(s);_>-1&&y.interaction.splice(_,1),o.eventCount&&y.interaction.push(s)}return!(p.length===1&&p[0][0]==="onUpdate")&&p.length&&(i=s.__r3f)!=null&&i.parent&&Kv(s),s}function pf(s){var e,t;const n=(e=s.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Kv(s){s.onUpdate==null||s.onUpdate(s)}function q3(s,e){s.manual||(Aw(s)?(s.left=e.width/-2,s.right=e.width/2,s.top=e.height/2,s.bottom=e.height/-2):s.aspect=e.width/e.height,s.updateProjectionMatrix(),s.updateMatrixWorld())}function mm(s){return(s.eventObject||s.object).uuid+"/"+s.index+s.instanceId}function Z3(){var s;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return _f.DefaultEventPriority;switch((s=e.event)==null?void 0:s.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return _f.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return _f.ContinuousEventPriority;default:return _f.DefaultEventPriority}}function Iw(s,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(s.delete(n),i.target.releasePointerCapture(n)))}function Q3(s,e){const{internal:t}=s.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{Iw(t.capturedMap,e,n,i)})}function K3(s){function e(d){const{internal:p}=s.getState(),m=d.offsetX-p.initialClick[0],g=d.offsetY-p.initialClick[1];return Math.round(Math.sqrt(m*m+g*g))}function t(d){return d.filter(p=>["Move","Over","Enter","Out","Leave"].some(m=>{var g;return(g=p.__r3f)==null?void 0:g.handlers["onPointer"+m]}))}function n(d,p){const m=s.getState(),g=new Set,y=[],_=p?p(m.internal.interaction):m.internal.interaction;for(let S=0;S<_.length;S++){const P=Fd(_[S]);P&&(P.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(d,m);function M(S){const P=Fd(S);if(!P||!P.events.enabled||P.raycaster.camera===null)return[];if(P.raycaster.camera===void 0){var b;P.events.compute==null||P.events.compute(d,P,(b=P.previousRoot)==null?void 0:b.getState()),P.raycaster.camera===void 0&&(P.raycaster.camera=null)}return P.raycaster.camera?P.raycaster.intersectObject(S,!0):[]}let A=_.flatMap(M).sort((S,P)=>{const b=Fd(S.object),L=Fd(P.object);return!b||!L?S.distance-P.distance:L.events.priority-b.events.priority||S.distance-P.distance}).filter(S=>{const P=mm(S);return g.has(P)?!1:(g.add(P),!0)});m.events.filter&&(A=m.events.filter(A,m));for(const S of A){let P=S.object;for(;P;){var E;(E=P.__r3f)!=null&&E.eventCount&&y.push({...S,eventObject:P}),P=P.parent}}if("pointerId"in d&&m.internal.capturedMap.has(d.pointerId))for(let S of m.internal.capturedMap.get(d.pointerId).values())g.has(mm(S.intersection))||y.push(S.intersection);return y}function i(d,p,m,g){const y=s.getState();if(d.length){const _={stopped:!1};for(const M of d){const A=Fd(M.object)||y,{raycaster:E,pointer:S,camera:P,internal:b}=A,L=new G(S.x,S.y,0).unproject(P),B=N=>{var X,te;return(X=(te=b.capturedMap.get(N))==null?void 0:te.has(M.eventObject))!=null?X:!1},D=N=>{const X={intersection:M,target:p.target};b.capturedMap.has(N)?b.capturedMap.get(N).set(M.eventObject,X):b.capturedMap.set(N,new Map([[M.eventObject,X]])),p.target.setPointerCapture(N)},F=N=>{const X=b.capturedMap.get(N);X&&Iw(b.capturedMap,M.eventObject,X,N)};let j={};for(let N in p){let X=p[N];typeof X!="function"&&(j[N]=X)}let O={...M,...j,pointer:S,intersections:d,stopped:_.stopped,delta:m,unprojectedPoint:L,ray:E.ray,camera:P,stopPropagation(){const N="pointerId"in p&&b.capturedMap.get(p.pointerId);if((!N||N.has(M.eventObject))&&(O.stopped=_.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(X=>X.eventObject===M.eventObject))){const X=d.slice(0,d.indexOf(M));o([...X,M])}},target:{hasPointerCapture:B,setPointerCapture:D,releasePointerCapture:F},currentTarget:{hasPointerCapture:B,setPointerCapture:D,releasePointerCapture:F},nativeEvent:p};if(g(O),_.stopped===!0)break}}return d}function o(d){const{internal:p}=s.getState();for(const m of p.hovered.values())if(!d.length||!d.find(g=>g.object===m.object&&g.index===m.index&&g.instanceId===m.instanceId)){const y=m.eventObject.__r3f,_=y==null?void 0:y.handlers;if(p.hovered.delete(mm(m)),y!=null&&y.eventCount){const M={...m,intersections:d};_.onPointerOut==null||_.onPointerOut(M),_.onPointerLeave==null||_.onPointerLeave(M)}}}function u(d,p){for(let m=0;m<p.length;m++){const g=p[m].__r3f;g==null||g.handlers.onPointerMissed==null||g.handlers.onPointerMissed(d)}}function f(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>o([]);case"onLostPointerCapture":return p=>{const{internal:m}=s.getState();"pointerId"in p&&m.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(p.pointerId)&&(m.capturedMap.delete(p.pointerId),o([]))})}}return function(m){const{onPointerMissed:g,internal:y}=s.getState();y.lastEvent.current=m;const _=d==="onPointerMove",M=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",E=n(m,_?t:void 0),S=M?e(m):0;d==="onPointerDown"&&(y.initialClick=[m.offsetX,m.offsetY],y.initialHits=E.map(b=>b.eventObject)),M&&!E.length&&S<=2&&(u(m,y.interaction),g&&g(m)),_&&o(E);function P(b){const L=b.eventObject,B=L.__r3f,D=B==null?void 0:B.handlers;if(B!=null&&B.eventCount)if(_){if(D.onPointerOver||D.onPointerEnter||D.onPointerOut||D.onPointerLeave){const F=mm(b),j=y.hovered.get(F);j?j.stopped&&b.stopPropagation():(y.hovered.set(F,b),D.onPointerOver==null||D.onPointerOver(b),D.onPointerEnter==null||D.onPointerEnter(b))}D.onPointerMove==null||D.onPointerMove(b)}else{const F=D[d];F?(!M||y.initialHits.includes(L))&&(u(m,y.interaction.filter(j=>!y.initialHits.includes(j))),F(b)):M&&y.initialHits.includes(L)&&u(m,y.interaction.filter(j=>!y.initialHits.includes(j)))}}i(E,m,S,P)}}return{handlePointer:f}}const Nw=s=>!!(s!=null&&s.render),Dw=ve.createContext(null),J3=(s,e)=>{const t=k3((f,d)=>{const p=new G,m=new G,g=new G;function y(S=d().camera,P=m,b=d().size){const{width:L,height:B,top:D,left:F}=b,j=L/B;P instanceof G?g.copy(P):g.set(...P);const O=S.getWorldPosition(p).distanceTo(g);if(Aw(S))return{width:L/S.zoom,height:B/S.zoom,top:D,left:F,factor:1,distance:O,aspect:j};{const N=S.fov*Math.PI/180,X=2*Math.tan(N/2)*O,te=X*(L/B);return{width:te,height:X,top:D,left:F,factor:L/te,distance:O,aspect:j}}}let _;const M=S=>f(P=>({performance:{...P.performance,current:S}})),A=new Ne;return{set:f,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(S=1)=>s(d(),S),advance:(S,P)=>e(S,P,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new By,pointer:A,mouse:A,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const S=d();_&&clearTimeout(_),S.performance.current!==S.performance.min&&M(S.performance.min),_=setTimeout(()=>M(d().performance.max),S.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:S=>f(P=>({...P,events:{...P.events,...S}})),setSize:(S,P,b,L,B)=>{const D=d().camera,F={width:S,height:P,top:L||0,left:B||0,updateStyle:b};f(j=>({size:F,viewport:{...j.viewport,...y(D,m,F)}}))},setDpr:S=>f(P=>{const b=Pw(S);return{viewport:{...P.viewport,dpr:b,initialDpr:P.viewport.initialDpr||b}}}),setFrameloop:(S="always")=>{const P=d().clock;P.stop(),P.elapsedTime=0,S!=="never"&&(P.start(),P.elapsedTime=0),f(()=>({frameloop:S}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ve.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(S,P,b)=>{const L=d().internal;return L.priority=L.priority+(P>0?1:0),L.subscribers.push({ref:S,priority:P,store:b}),L.subscribers=L.subscribers.sort((B,D)=>B.priority-D.priority),()=>{const B=d().internal;B!=null&&B.subscribers&&(B.priority=B.priority-(P>0?1:0),B.subscribers=B.subscribers.filter(D=>D.ref!==S))}}}}}),n=t.getState();let i=n.size,o=n.viewport.dpr,u=n.camera;return t.subscribe(()=>{const{camera:f,size:d,viewport:p,gl:m,set:g}=t.getState();if(d.width!==i.width||d.height!==i.height||p.dpr!==o){var y;i=d,o=p.dpr,q3(f,d),m.setPixelRatio(p.dpr);const _=(y=d.updateStyle)!=null?y:typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(d.width,d.height,_)}f!==u&&(u=f,g(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(f)}})))}),t.subscribe(f=>s(f)),t};let gm,$3=new Set,eL=new Set,tL=new Set;function H0(s,e){if(s.size)for(const{callback:t}of s.values())t(e)}function Bd(s,e){switch(s){case"before":return H0($3,e);case"after":return H0(eL,e);case"tail":return H0(tL,e)}}let V0,G0;function W0(s,e,t){let n=e.clock.getDelta();for(e.frameloop==="never"&&typeof s=="number"&&(n=s-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=s),V0=e.internal.subscribers,gm=0;gm<V0.length;gm++)G0=V0[gm],G0.ref.current(G0.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function nL(s){let e=!1,t=!1,n,i,o;function u(p){i=requestAnimationFrame(u),e=!0,n=0,Bd("before",p),t=!0;for(const g of s.values()){var m;o=g.store.getState(),o.internal.active&&(o.frameloop==="always"||o.internal.frames>0)&&!((m=o.gl.xr)!=null&&m.isPresenting)&&(n+=W0(p,o))}if(t=!1,Bd("after",p),n===0)return Bd("tail",p),e=!1,cancelAnimationFrame(i)}function f(p,m=1){var g;if(!p)return s.forEach(y=>f(y.store.getState(),m));(g=p.gl.xr)!=null&&g.isPresenting||!p.internal.active||p.frameloop==="never"||(m>1?p.internal.frames=Math.min(60,p.internal.frames+m):t?p.internal.frames=2:p.internal.frames=1,e||(e=!0,requestAnimationFrame(u)))}function d(p,m=!0,g,y){if(m&&Bd("before",p),g)W0(p,g,y);else for(const _ of s.values())W0(p,_.store.getState());m&&Bd("after",p)}return{loop:u,invalidate:f,advance:d}}function Uw(){const s=ve.useContext(Dw);if(!s)throw new Error("R3F: Hooks can only be used within the Canvas component!");return s}function ca(s=t=>t,e){return Uw()(s,e)}function Ow(s,e=0){const t=Uw(),n=t.getState().internal.subscribe,i=Cw(s);return Ch(()=>n(i,e,t),[e,n,t]),null}const Af=new Map,{invalidate:A1,advance:C1}=nL(Af),{reconciler:zm,applyProps:cf}=G3(Af,Z3),ff={objects:"shallow",strict:!1},iL=(s,e)=>{const t=typeof s=="function"?s(e):s;return Nw(t)?t:new PM({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...s})};function rL(s,e){const t=typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement;if(e){const{width:n,height:i,top:o,left:u,updateStyle:f=t}=e;return{width:n,height:i,top:o,left:u,updateStyle:f}}else if(typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&s.parentElement){const{width:n,height:i,top:o,left:u}=s.parentElement.getBoundingClientRect();return{width:n,height:i,top:o,left:u,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas)return{width:s.width,height:s.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function sL(s){const e=Af.get(s),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,o=n||J3(A1,C1),u=t||zm.createContainer(o,_f.ConcurrentRoot,null,!1,null,"",i,null);e||Af.set(s,{fiber:u,store:o});let f,d=!1,p;return{configure(m={}){let{gl:g,size:y,scene:_,events:M,onCreated:A,shadows:E=!1,linear:S=!1,flat:P=!1,legacy:b=!1,orthographic:L=!1,frameloop:B="always",dpr:D=[1,2],performance:F,raycaster:j,camera:O,onPointerMissed:N}=m,X=o.getState(),te=X.gl;X.gl||X.set({gl:te=iL(g,s)});let Q=X.raycaster;Q||X.set({raycaster:Q=new _w});const{params:ue,...fe}=j||{};if(Un.equ(fe,Q,ff)||cf(Q,{...fe}),Un.equ(ue,Q.params,ff)||cf(Q,{params:{...Q.params,...ue}}),!X.camera||X.camera===p&&!Un.equ(p,O,ff)){p=O;const k=O instanceof _h,J=k?O:L?new vl(0,0,0,0,.1,1e3):new ei(75,0,.1,1e3);k||(J.position.z=5,O&&cf(J,O),!X.camera&&!(O!=null&&O.rotation)&&J.lookAt(0,0,0)),X.set({camera:J}),Q.camera=J}if(!X.scene){let k;_ instanceof Nm?k=_:(k=new Nm,_&&cf(k,_)),X.set({scene:hf(k)})}if(!X.xr){var ye;const k=(Ve,se)=>{const Re=o.getState();Re.frameloop!=="never"&&C1(Ve,!0,Re,se)},J=()=>{const Ve=o.getState();Ve.gl.xr.enabled=Ve.gl.xr.isPresenting,Ve.gl.xr.setAnimationLoop(Ve.gl.xr.isPresenting?k:null),Ve.gl.xr.isPresenting||A1(Ve)},Ce={connect(){const Ve=o.getState().gl;Ve.xr.addEventListener("sessionstart",J),Ve.xr.addEventListener("sessionend",J)},disconnect(){const Ve=o.getState().gl;Ve.xr.removeEventListener("sessionstart",J),Ve.xr.removeEventListener("sessionend",J)}};typeof((ye=te.xr)==null?void 0:ye.addEventListener)=="function"&&Ce.connect(),X.set({xr:Ce})}if(te.shadowMap){const k=te.shadowMap.enabled,J=te.shadowMap.type;if(te.shadowMap.enabled=!!E,Un.boo(E))te.shadowMap.type=Gd;else if(Un.str(E)){var Me;const Ce={basic:cS,percentage:Hm,soft:Gd,variance:js};te.shadowMap.type=(Me=Ce[E])!=null?Me:Gd}else Un.obj(E)&&Object.assign(te.shadowMap,E);(k!==te.shadowMap.enabled||J!==te.shadowMap.type)&&(te.shadowMap.needsUpdate=!0)}const W=Tw();W&&("enabled"in W?W.enabled=!b:"legacyMode"in W&&(W.legacyMode=b)),d||cf(te,{outputEncoding:S?3e3:3001,toneMapping:P?Eo:ey}),X.legacy!==b&&X.set(()=>({legacy:b})),X.linear!==S&&X.set(()=>({linear:S})),X.flat!==P&&X.set(()=>({flat:P})),g&&!Un.fun(g)&&!Nw(g)&&!Un.equ(g,te,ff)&&cf(te,g),M&&!X.events.handlers&&X.set({events:M(o)});const ee=rL(s,y);return Un.equ(ee,X.size,ff)||X.setSize(ee.width,ee.height,ee.updateStyle,ee.top,ee.left),D&&X.viewport.dpr!==Pw(D)&&X.setDpr(D),X.frameloop!==B&&X.setFrameloop(B),X.onPointerMissed||X.set({onPointerMissed:N}),F&&!Un.equ(F,X.performance,ff)&&X.set(k=>({performance:{...k.performance,...F}})),f=A,d=!0,this},render(m){return d||this.configure(),zm.updateContainer(ve.createElement(oL,{store:o,children:m,onCreated:f,rootElement:s}),u,null,()=>{}),o},unmount(){kw(s)}}}function oL({store:s,children:e,onCreated:t,rootElement:n}){return Ch(()=>{const i=s.getState();i.set(o=>({internal:{...o.internal,active:!0}})),t&&t(i),s.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),ve.createElement(Dw.Provider,{value:s},e)}function kw(s,e){const t=Af.get(s),n=t==null?void 0:t.fiber;if(n){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),zm.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var o,u,f,d;i.events.disconnect==null||i.events.disconnect(),(o=i.gl)==null||(u=o.renderLists)==null||u.dispose==null||u.dispose(),(f=i.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(d=i.gl)!=null&&d.xr&&i.xr.disconnect(),Y3(i),Af.delete(s)}catch{}},500)})}}zm.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ve.version});function Co(){return Co=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},Co.apply(null,arguments)}function b1(s,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>s(...n),e)}}function aL({debounce:s,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,u]=ve.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),f=ve.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o,orientationHandler:null}),d=s?typeof s=="number"?s:s.scroll:null,p=s?typeof s=="number"?s:s.resize:null,m=ve.useRef(!1);ve.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[g,y,_]=ve.useMemo(()=>{const S=()=>{if(!f.current.element)return;const{left:P,top:b,width:L,height:B,bottom:D,right:F,x:j,y:O}=f.current.element.getBoundingClientRect(),N={left:P,top:b,width:L,height:B,bottom:D,right:F,x:j,y:O};f.current.element instanceof HTMLElement&&n&&(N.height=f.current.element.offsetHeight,N.width=f.current.element.offsetWidth),Object.freeze(N),m.current&&!fL(f.current.lastBounds,N)&&u(f.current.lastBounds=N)};return[S,p?b1(S,p):S,d?b1(S,d):S]},[u,n,d,p]);function M(){f.current.scrollContainers&&(f.current.scrollContainers.forEach(S=>S.removeEventListener("scroll",_,!0)),f.current.scrollContainers=null),f.current.resizeObserver&&(f.current.resizeObserver.disconnect(),f.current.resizeObserver=null),f.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",f.current.orientationHandler))}function A(){f.current.element&&(f.current.resizeObserver=new i(_),f.current.resizeObserver.observe(f.current.element),e&&f.current.scrollContainers&&f.current.scrollContainers.forEach(S=>S.addEventListener("scroll",_,{capture:!0,passive:!0})),f.current.orientationHandler=()=>{_()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",f.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",f.current.orientationHandler))}const E=S=>{!S||S===f.current.element||(M(),f.current.element=S,f.current.scrollContainers=zw(S),A())};return uL(_,!!e),lL(y),ve.useEffect(()=>{M(),A()},[e,_,y]),ve.useEffect(()=>M,[]),[E,o,g]}function lL(s){ve.useEffect(()=>{const e=s;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[s])}function uL(s,e){ve.useEffect(()=>{if(e){const t=s;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[s,e])}function zw(s){const e=[];if(!s||s===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(s);return[t,n,i].some(o=>o==="auto"||o==="scroll")&&e.push(s),[...e,...zw(s.parentElement)]}const cL=["x","y","top","bottom","left","right","width","height"],fL=(s,e)=>cL.every(t=>s[t]===e[t]);var dL=Object.defineProperty,hL=Object.defineProperties,pL=Object.getOwnPropertyDescriptors,R1=Object.getOwnPropertySymbols,mL=Object.prototype.hasOwnProperty,gL=Object.prototype.propertyIsEnumerable,P1=(s,e,t)=>e in s?dL(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,L1=(s,e)=>{for(var t in e||(e={}))mL.call(e,t)&&P1(s,t,e[t]);if(R1)for(var t of R1(e))gL.call(e,t)&&P1(s,t,e[t]);return s},vL=(s,e)=>hL(s,pL(e)),I1,N1;typeof window<"u"&&((I1=window.document)!=null&&I1.createElement||((N1=window.navigator)==null?void 0:N1.product)==="ReactNative")?ve.useLayoutEffect:ve.useEffect;function Fw(s,e,t){if(!s)return;if(t(s)===!0)return s;let n=s.child;for(;n;){const i=Fw(n,e,t);if(i)return i;n=n.sibling}}function Bw(s){try{return Object.defineProperties(s,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return s}}const D1=console.error;console.error=function(){const s=[...arguments].join("");if(s!=null&&s.startsWith("Warning:")&&s.includes("useContext")){console.error=D1;return}return D1.apply(this,arguments)};const jy=Bw(ve.createContext(null));class Hw extends ve.Component{render(){return ve.createElement(jy.Provider,{value:this._reactInternals},this.props.children)}}function yL(){const s=ve.useContext(jy);if(s===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ve.useId();return ve.useMemo(()=>{for(const n of[s,s==null?void 0:s.alternate]){if(!n)continue;const i=Fw(n,!1,o=>{let u=o.memoizedState;for(;u;){if(u.memoizedState===e)return!0;u=u.next}});if(i)return i}},[s,e])}function xL(){const s=yL(),[e]=ve.useState(()=>new Map);e.clear();let t=s;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==jy&&!e.has(i)&&e.set(i,ve.useContext(Bw(i)))}t=t.return}return e}function _L(){const s=xL();return ve.useMemo(()=>Array.from(s.keys()).reduce((e,t)=>n=>ve.createElement(e,null,ve.createElement(t.Provider,vL(L1({},n),{value:s.get(t)}))),e=>ve.createElement(Hw,L1({},e))),[s])}const j0={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function SL(s){const{handlePointer:e}=K3(s);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(j0).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=s.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var n;const{set:i,events:o}=s.getState();o.disconnect==null||o.disconnect(),i(u=>({events:{...u.events,connected:t}})),Object.entries((n=o.handlers)!=null?n:[]).forEach(([u,f])=>{const[d,p]=j0[u];t.addEventListener(d,f,{passive:p})})},disconnect:()=>{const{set:t,events:n}=s.getState();if(n.connected){var i;Object.entries((i=n.handlers)!=null?i:[]).forEach(([o,u])=>{if(n&&n.connected instanceof HTMLElement){const[f]=j0[o];n.connected.removeEventListener(f,u)}}),t(o=>({events:{...o.events,connected:void 0}}))}}}}const ML=ve.forwardRef(function({children:e,fallback:t,resize:n,style:i,gl:o,events:u=SL,eventSource:f,eventPrefix:d,shadows:p,linear:m,flat:g,legacy:y,orthographic:_,frameloop:M,dpr:A,performance:E,raycaster:S,camera:P,scene:b,onPointerMissed:L,onCreated:B,...D},F){ve.useMemo(()=>Ew(I3),[]);const j=_L(),[O,N]=aL({scroll:!0,debounce:{scroll:50,resize:0},...n}),X=ve.useRef(null),te=ve.useRef(null);ve.useImperativeHandle(F,()=>X.current);const Q=Cw(L),[ue,fe]=ve.useState(!1),[ye,Me]=ve.useState(!1);if(ue)throw ue;if(ye)throw ye;const W=ve.useRef(null);Ch(()=>{const k=X.current;N.width>0&&N.height>0&&k&&(W.current||(W.current=sL(k)),W.current.configure({gl:o,events:u,shadows:p,linear:m,flat:g,legacy:y,orthographic:_,frameloop:M,dpr:A,performance:E,raycaster:S,camera:P,scene:b,size:N,onPointerMissed:(...J)=>Q.current==null?void 0:Q.current(...J),onCreated:J=>{J.events.connect==null||J.events.connect(f?W3(f)?f.current:f:te.current),d&&J.setEvents({compute:(Ce,Ve)=>{const se=Ce[d+"X"],Re=Ce[d+"Y"];Ve.pointer.set(se/Ve.size.width*2-1,-(Re/Ve.size.height)*2+1),Ve.raycaster.setFromCamera(Ve.pointer,Ve.camera)}}),B==null||B(J)}}),W.current.render(ve.createElement(j,null,ve.createElement(bw,{set:Me},ve.createElement(ve.Suspense,{fallback:ve.createElement(j3,{set:fe})},e)))))}),ve.useEffect(()=>{const k=X.current;if(k)return()=>kw(k)},[]);const ee=f?"none":"auto";return ve.createElement("div",Co({ref:te,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ee,...i}},D),ve.createElement("div",{ref:O,style:{width:"100%",height:"100%"}},ve.createElement("canvas",{ref:X,style:{display:"block"}},t)))}),wL=ve.forwardRef(function(e,t){return ve.createElement(Hw,null,ve.createElement(ML,Co({},e,{ref:t})))}),Vw=parseInt(bf.replace(/\D+/g,"")),Gw=Vw>=125?"uv1":"uv2";var EL=Object.defineProperty,TL=(s,e,t)=>e in s?EL(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,AL=(s,e,t)=>(TL(s,e+"",t),t);class CL{constructor(){AL(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const o=i.indexOf(t);o!==-1&&i.splice(o,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let o=0,u=i.length;o<u;o++)i[o].call(this,e);e.target=null}}}var bL=Object.defineProperty,RL=(s,e,t)=>e in s?bL(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Lt=(s,e,t)=>(RL(s,typeof e!="symbol"?e+"":e,t),t);const vm=new Ou,U1=new xo,PL=Math.cos(70*(Math.PI/180)),O1=(s,e)=>(s%e+e)%e;let LL=class extends CL{constructor(e,t){super(),Lt(this,"object"),Lt(this,"domElement"),Lt(this,"enabled",!0),Lt(this,"target",new G),Lt(this,"minDistance",0),Lt(this,"maxDistance",1/0),Lt(this,"minZoom",0),Lt(this,"maxZoom",1/0),Lt(this,"minPolarAngle",0),Lt(this,"maxPolarAngle",Math.PI),Lt(this,"minAzimuthAngle",-1/0),Lt(this,"maxAzimuthAngle",1/0),Lt(this,"enableDamping",!1),Lt(this,"dampingFactor",.05),Lt(this,"enableZoom",!0),Lt(this,"zoomSpeed",1),Lt(this,"enableRotate",!0),Lt(this,"rotateSpeed",1),Lt(this,"enablePan",!0),Lt(this,"panSpeed",1),Lt(this,"screenSpacePanning",!0),Lt(this,"keyPanSpeed",7),Lt(this,"zoomToCursor",!1),Lt(this,"autoRotate",!1),Lt(this,"autoRotateSpeed",2),Lt(this,"reverseOrbit",!1),Lt(this,"reverseHorizontalOrbit",!1),Lt(this,"reverseVerticalOrbit",!1),Lt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Lt(this,"mouseButtons",{LEFT:xu.ROTATE,MIDDLE:xu.DOLLY,RIGHT:xu.PAN}),Lt(this,"touches",{ONE:_u.ROTATE,TWO:_u.DOLLY_PAN}),Lt(this,"target0"),Lt(this,"position0"),Lt(this,"zoom0"),Lt(this,"_domElementKeyEvents",null),Lt(this,"getPolarAngle"),Lt(this,"getAzimuthalAngle"),Lt(this,"setPolarAngle"),Lt(this,"setAzimuthalAngle"),Lt(this,"getDistance"),Lt(this,"getZoomScale"),Lt(this,"listenToKeyEvents"),Lt(this,"stopListenToKeyEvents"),Lt(this,"saveState"),Lt(this,"reset"),Lt(this,"update"),Lt(this,"connect"),Lt(this,"dispose"),Lt(this,"dollyIn"),Lt(this,"dollyOut"),Lt(this,"getScale"),Lt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>m.phi,this.getAzimuthalAngle=()=>m.theta,this.setPolarAngle=ne=>{let Pe=O1(ne,2*Math.PI),K=m.phi;K<0&&(K+=2*Math.PI),Pe<0&&(Pe+=2*Math.PI);let Ee=Math.abs(Pe-K);2*Math.PI-Ee<Ee&&(Pe<K?Pe+=2*Math.PI:K+=2*Math.PI),g.phi=Pe-K,n.update()},this.setAzimuthalAngle=ne=>{let Pe=O1(ne,2*Math.PI),K=m.theta;K<0&&(K+=2*Math.PI),Pe<0&&(Pe+=2*Math.PI);let Ee=Math.abs(Pe-K);2*Math.PI-Ee<Ee&&(Pe<K?Pe+=2*Math.PI:K+=2*Math.PI),g.theta=Pe-K,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ne=>{ne.addEventListener("keydown",Ct),this._domElementKeyEvents=ne},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Ct),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),d=f.NONE},this.update=(()=>{const ne=new G,Pe=new G(0,1,0),K=new ir().setFromUnitVectors(e.up,Pe),Ee=K.clone().invert(),Te=new G,We=new ir,Ze=2*Math.PI;return function(){const rn=n.object.position;K.setFromUnitVectors(e.up,Pe),Ee.copy(K).invert(),ne.copy(rn).sub(n.target),ne.applyQuaternion(K),m.setFromVector3(ne),n.autoRotate&&d===f.NONE&&ue(te()),n.enableDamping?(m.theta+=g.theta*n.dampingFactor,m.phi+=g.phi*n.dampingFactor):(m.theta+=g.theta,m.phi+=g.phi);let Jt=n.minAzimuthAngle,fn=n.maxAzimuthAngle;isFinite(Jt)&&isFinite(fn)&&(Jt<-Math.PI?Jt+=Ze:Jt>Math.PI&&(Jt-=Ze),fn<-Math.PI?fn+=Ze:fn>Math.PI&&(fn-=Ze),Jt<=fn?m.theta=Math.max(Jt,Math.min(fn,m.theta)):m.theta=m.theta>(Jt+fn)/2?Math.max(Jt,m.theta):Math.min(fn,m.theta)),m.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,m.phi)),m.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(_,n.dampingFactor):n.target.add(_),n.zoomToCursor&&O||n.object.isOrthographicCamera?m.radius=Ve(m.radius):m.radius=Ve(m.radius*y),ne.setFromSpherical(m),ne.applyQuaternion(Ee),rn.copy(n.target).add(ne),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(g.theta*=1-n.dampingFactor,g.phi*=1-n.dampingFactor,_.multiplyScalar(1-n.dampingFactor)):(g.set(0,0,0),_.set(0,0,0));let Xt=!1;if(n.zoomToCursor&&O){let On=null;if(n.object instanceof ei&&n.object.isPerspectiveCamera){const wn=ne.length();On=Ve(wn*y);const rr=wn-On;n.object.position.addScaledVector(F,rr),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const wn=new G(j.x,j.y,0);wn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix(),Xt=!0;const rr=new G(j.x,j.y,0);rr.unproject(n.object),n.object.position.sub(rr).add(wn),n.object.updateMatrixWorld(),On=ne.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;On!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(On).add(n.object.position):(vm.origin.copy(n.object.position),vm.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(vm.direction))<PL?e.lookAt(n.target):(U1.setFromNormalAndCoplanarPoint(n.object.up,n.target),vm.intersectPlane(U1,n.target))))}else n.object instanceof vl&&n.object.isOrthographicCamera&&(Xt=y!==1,Xt&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix()));return y=1,O=!1,Xt||Te.distanceToSquared(n.object.position)>p||8*(1-We.dot(n.object.quaternion))>p?(n.dispatchEvent(i),Te.copy(n.object.position),We.copy(n.object.quaternion),Xt=!1,!0):!1}})(),this.connect=ne=>{n.domElement=ne,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Nt),n.domElement.addEventListener("pointerdown",Ie),n.domElement.addEventListener("pointercancel",Ue),n.domElement.addEventListener("wheel",Ke)},this.dispose=()=>{var ne,Pe,K,Ee,Te,We;n.domElement&&(n.domElement.style.touchAction="auto"),(ne=n.domElement)==null||ne.removeEventListener("contextmenu",Nt),(Pe=n.domElement)==null||Pe.removeEventListener("pointerdown",Ie),(K=n.domElement)==null||K.removeEventListener("pointercancel",Ue),(Ee=n.domElement)==null||Ee.removeEventListener("wheel",Ke),(Te=n.domElement)==null||Te.ownerDocument.removeEventListener("pointermove",ze),(We=n.domElement)==null||We.ownerDocument.removeEventListener("pointerup",Ue),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Ct)};const n=this,i={type:"change"},o={type:"start"},u={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=f.NONE;const p=1e-6,m=new Zv,g=new Zv;let y=1;const _=new G,M=new Ne,A=new Ne,E=new Ne,S=new Ne,P=new Ne,b=new Ne,L=new Ne,B=new Ne,D=new Ne,F=new G,j=new Ne;let O=!1;const N=[],X={};function te(){return 2*Math.PI/60/60*n.autoRotateSpeed}function Q(){return Math.pow(.95,n.zoomSpeed)}function ue(ne){n.reverseOrbit||n.reverseHorizontalOrbit?g.theta+=ne:g.theta-=ne}function fe(ne){n.reverseOrbit||n.reverseVerticalOrbit?g.phi+=ne:g.phi-=ne}const ye=(()=>{const ne=new G;return function(K,Ee){ne.setFromMatrixColumn(Ee,0),ne.multiplyScalar(-K),_.add(ne)}})(),Me=(()=>{const ne=new G;return function(K,Ee){n.screenSpacePanning===!0?ne.setFromMatrixColumn(Ee,1):(ne.setFromMatrixColumn(Ee,0),ne.crossVectors(n.object.up,ne)),ne.multiplyScalar(K),_.add(ne)}})(),W=(()=>{const ne=new G;return function(K,Ee){const Te=n.domElement;if(Te&&n.object instanceof ei&&n.object.isPerspectiveCamera){const We=n.object.position;ne.copy(We).sub(n.target);let Ze=ne.length();Ze*=Math.tan(n.object.fov/2*Math.PI/180),ye(2*K*Ze/Te.clientHeight,n.object.matrix),Me(2*Ee*Ze/Te.clientHeight,n.object.matrix)}else Te&&n.object instanceof vl&&n.object.isOrthographicCamera?(ye(K*(n.object.right-n.object.left)/n.object.zoom/Te.clientWidth,n.object.matrix),Me(Ee*(n.object.top-n.object.bottom)/n.object.zoom/Te.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ee(ne){n.object instanceof ei&&n.object.isPerspectiveCamera||n.object instanceof vl&&n.object.isOrthographicCamera?y=ne:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function k(ne){ee(y/ne)}function J(ne){ee(y*ne)}function Ce(ne){if(!n.zoomToCursor||!n.domElement)return;O=!0;const Pe=n.domElement.getBoundingClientRect(),K=ne.clientX-Pe.left,Ee=ne.clientY-Pe.top,Te=Pe.width,We=Pe.height;j.x=K/Te*2-1,j.y=-(Ee/We)*2+1,F.set(j.x,j.y,1).unproject(n.object).sub(n.object.position).normalize()}function Ve(ne){return Math.max(n.minDistance,Math.min(n.maxDistance,ne))}function se(ne){M.set(ne.clientX,ne.clientY)}function Re(ne){Ce(ne),L.set(ne.clientX,ne.clientY)}function ke(ne){S.set(ne.clientX,ne.clientY)}function Le(ne){A.set(ne.clientX,ne.clientY),E.subVectors(A,M).multiplyScalar(n.rotateSpeed);const Pe=n.domElement;Pe&&(ue(2*Math.PI*E.x/Pe.clientHeight),fe(2*Math.PI*E.y/Pe.clientHeight)),M.copy(A),n.update()}function tt(ne){B.set(ne.clientX,ne.clientY),D.subVectors(B,L),D.y>0?k(Q()):D.y<0&&J(Q()),L.copy(B),n.update()}function xt(ne){P.set(ne.clientX,ne.clientY),b.subVectors(P,S).multiplyScalar(n.panSpeed),W(b.x,b.y),S.copy(P),n.update()}function ae(ne){Ce(ne),ne.deltaY<0?J(Q()):ne.deltaY>0&&k(Q()),n.update()}function Mt(ne){let Pe=!1;switch(ne.code){case n.keys.UP:W(0,n.keyPanSpeed),Pe=!0;break;case n.keys.BOTTOM:W(0,-n.keyPanSpeed),Pe=!0;break;case n.keys.LEFT:W(n.keyPanSpeed,0),Pe=!0;break;case n.keys.RIGHT:W(-n.keyPanSpeed,0),Pe=!0;break}Pe&&(ne.preventDefault(),n.update())}function Ae(){if(N.length==1)M.set(N[0].pageX,N[0].pageY);else{const ne=.5*(N[0].pageX+N[1].pageX),Pe=.5*(N[0].pageY+N[1].pageY);M.set(ne,Pe)}}function Oe(){if(N.length==1)S.set(N[0].pageX,N[0].pageY);else{const ne=.5*(N[0].pageX+N[1].pageX),Pe=.5*(N[0].pageY+N[1].pageY);S.set(ne,Pe)}}function De(){const ne=N[0].pageX-N[1].pageX,Pe=N[0].pageY-N[1].pageY,K=Math.sqrt(ne*ne+Pe*Pe);L.set(0,K)}function Xe(){n.enableZoom&&De(),n.enablePan&&Oe()}function xe(){n.enableZoom&&De(),n.enableRotate&&Ae()}function Fe(ne){if(N.length==1)A.set(ne.pageX,ne.pageY);else{const K=Bt(ne),Ee=.5*(ne.pageX+K.x),Te=.5*(ne.pageY+K.y);A.set(Ee,Te)}E.subVectors(A,M).multiplyScalar(n.rotateSpeed);const Pe=n.domElement;Pe&&(ue(2*Math.PI*E.x/Pe.clientHeight),fe(2*Math.PI*E.y/Pe.clientHeight)),M.copy(A)}function $e(ne){if(N.length==1)P.set(ne.pageX,ne.pageY);else{const Pe=Bt(ne),K=.5*(ne.pageX+Pe.x),Ee=.5*(ne.pageY+Pe.y);P.set(K,Ee)}b.subVectors(P,S).multiplyScalar(n.panSpeed),W(b.x,b.y),S.copy(P)}function q(ne){const Pe=Bt(ne),K=ne.pageX-Pe.x,Ee=ne.pageY-Pe.y,Te=Math.sqrt(K*K+Ee*Ee);B.set(0,Te),D.set(0,Math.pow(B.y/L.y,n.zoomSpeed)),k(D.y),L.copy(B)}function z(ne){n.enableZoom&&q(ne),n.enablePan&&$e(ne)}function de(ne){n.enableZoom&&q(ne),n.enableRotate&&Fe(ne)}function Ie(ne){var Pe,K;n.enabled!==!1&&(N.length===0&&((Pe=n.domElement)==null||Pe.ownerDocument.addEventListener("pointermove",ze),(K=n.domElement)==null||K.ownerDocument.addEventListener("pointerup",Ue)),Tt(ne),ne.pointerType==="touch"?qe(ne):vt(ne))}function ze(ne){n.enabled!==!1&&(ne.pointerType==="touch"?ft(ne):Je(ne))}function Ue(ne){var Pe,K,Ee;ot(ne),N.length===0&&((Pe=n.domElement)==null||Pe.releasePointerCapture(ne.pointerId),(K=n.domElement)==null||K.ownerDocument.removeEventListener("pointermove",ze),(Ee=n.domElement)==null||Ee.ownerDocument.removeEventListener("pointerup",Ue)),n.dispatchEvent(u),d=f.NONE}function vt(ne){let Pe;switch(ne.button){case 0:Pe=n.mouseButtons.LEFT;break;case 1:Pe=n.mouseButtons.MIDDLE;break;case 2:Pe=n.mouseButtons.RIGHT;break;default:Pe=-1}switch(Pe){case xu.DOLLY:if(n.enableZoom===!1)return;Re(ne),d=f.DOLLY;break;case xu.ROTATE:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enablePan===!1)return;ke(ne),d=f.PAN}else{if(n.enableRotate===!1)return;se(ne),d=f.ROTATE}break;case xu.PAN:if(ne.ctrlKey||ne.metaKey||ne.shiftKey){if(n.enableRotate===!1)return;se(ne),d=f.ROTATE}else{if(n.enablePan===!1)return;ke(ne),d=f.PAN}break;default:d=f.NONE}d!==f.NONE&&n.dispatchEvent(o)}function Je(ne){if(n.enabled!==!1)switch(d){case f.ROTATE:if(n.enableRotate===!1)return;Le(ne);break;case f.DOLLY:if(n.enableZoom===!1)return;tt(ne);break;case f.PAN:if(n.enablePan===!1)return;xt(ne);break}}function Ke(ne){n.enabled===!1||n.enableZoom===!1||d!==f.NONE&&d!==f.ROTATE||(ne.preventDefault(),n.dispatchEvent(o),ae(ne),n.dispatchEvent(u))}function Ct(ne){n.enabled===!1||n.enablePan===!1||Mt(ne)}function qe(ne){switch(Dt(ne),N.length){case 1:switch(n.touches.ONE){case _u.ROTATE:if(n.enableRotate===!1)return;Ae(),d=f.TOUCH_ROTATE;break;case _u.PAN:if(n.enablePan===!1)return;Oe(),d=f.TOUCH_PAN;break;default:d=f.NONE}break;case 2:switch(n.touches.TWO){case _u.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Xe(),d=f.TOUCH_DOLLY_PAN;break;case _u.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;xe(),d=f.TOUCH_DOLLY_ROTATE;break;default:d=f.NONE}break;default:d=f.NONE}d!==f.NONE&&n.dispatchEvent(o)}function ft(ne){switch(Dt(ne),d){case f.TOUCH_ROTATE:if(n.enableRotate===!1)return;Fe(ne),n.update();break;case f.TOUCH_PAN:if(n.enablePan===!1)return;$e(ne),n.update();break;case f.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;z(ne),n.update();break;case f.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;de(ne),n.update();break;default:d=f.NONE}}function Nt(ne){n.enabled!==!1&&ne.preventDefault()}function Tt(ne){N.push(ne)}function ot(ne){delete X[ne.pointerId];for(let Pe=0;Pe<N.length;Pe++)if(N[Pe].pointerId==ne.pointerId){N.splice(Pe,1);return}}function Dt(ne){let Pe=X[ne.pointerId];Pe===void 0&&(Pe=new Ne,X[ne.pointerId]=Pe),Pe.set(ne.pageX,ne.pageY)}function Bt(ne){const Pe=ne.pointerId===N[0].pointerId?N[1]:N[0];return X[Pe.pointerId]}this.dollyIn=(ne=Q())=>{J(ne),n.update()},this.dollyOut=(ne=Q())=>{k(ne),n.update()},this.getScale=()=>y,this.setScale=ne=>{ee(ne),n.update()},this.getZoomScale=()=>Q(),t!==void 0&&this.connect(t),this.update()}};const k1=new Ci,ym=new G;class Xy extends zy{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new pt(e,3)),this.setAttribute("uv",new pt(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new km(t,6,1);return this.setAttribute("instanceStart",new es(n,3,0)),this.setAttribute("instanceEnd",new es(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const i=new km(n,t*2,1);return this.setAttribute("instanceColorStart",new es(i,t,0)),this.setAttribute("instanceColorEnd",new es(i,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new Ly(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ci);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),k1.setFromBufferAttribute(t),this.boundingBox.union(k1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new bi),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let o=0,u=e.count;o<u;o++)ym.fromBufferAttribute(e,o),i=Math.max(i,n.distanceToSquared(ym)),ym.fromBufferAttribute(t,o),i=Math.max(i,n.distanceToSquared(ym));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class Ww extends Xy{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,i=new Float32Array(2*n);if(t===3)for(let o=0;o<n;o+=t)i[2*o]=e[o],i[2*o+1]=e[o+1],i[2*o+2]=e[o+2],i[2*o+3]=e[o+3],i[2*o+4]=e[o+4],i[2*o+5]=e[o+5];else for(let o=0;o<n;o+=t)i[2*o]=e[o],i[2*o+1]=e[o+1],i[2*o+2]=e[o+2],i[2*o+3]=e[o+3],i[2*o+4]=e[o+4],i[2*o+5]=e[o+5],i[2*o+6]=e[o+6],i[2*o+7]=e[o+7];return super.setColors(i,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class Yy extends is{constructor(e){super({type:"LineMaterial",uniforms:lh.clone(lh.merge([et.common,et.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new Ne(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${Vw>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const X0=new nn,z1=new G,F1=new G,Hi=new nn,Vi=new nn,vo=new nn,Y0=new G,q0=new It,Gi=new Sw,B1=new G,xm=new Ci,_m=new bi,yo=new nn;let So,Nu;function H1(s,e,t){return yo.set(0,0,-e,1).applyMatrix4(s.projectionMatrix),yo.multiplyScalar(1/yo.w),yo.x=Nu/t.width,yo.y=Nu/t.height,yo.applyMatrix4(s.projectionMatrixInverse),yo.multiplyScalar(1/yo.w),Math.abs(Math.max(yo.x,yo.y))}function IL(s,e){const t=s.matrixWorld,n=s.geometry,i=n.attributes.instanceStart,o=n.attributes.instanceEnd,u=Math.min(n.instanceCount,i.count);for(let f=0,d=u;f<d;f++){Gi.start.fromBufferAttribute(i,f),Gi.end.fromBufferAttribute(o,f),Gi.applyMatrix4(t);const p=new G,m=new G;So.distanceSqToSegment(Gi.start,Gi.end,m,p),m.distanceTo(p)<Nu*.5&&e.push({point:m,pointOnLine:p,distance:So.origin.distanceTo(m),object:s,face:null,faceIndex:f,uv:null,[Gw]:null})}}function NL(s,e,t){const n=e.projectionMatrix,o=s.material.resolution,u=s.matrixWorld,f=s.geometry,d=f.attributes.instanceStart,p=f.attributes.instanceEnd,m=Math.min(f.instanceCount,d.count),g=-e.near;So.at(1,vo),vo.w=1,vo.applyMatrix4(e.matrixWorldInverse),vo.applyMatrix4(n),vo.multiplyScalar(1/vo.w),vo.x*=o.x/2,vo.y*=o.y/2,vo.z=0,Y0.copy(vo),q0.multiplyMatrices(e.matrixWorldInverse,u);for(let y=0,_=m;y<_;y++){if(Hi.fromBufferAttribute(d,y),Vi.fromBufferAttribute(p,y),Hi.w=1,Vi.w=1,Hi.applyMatrix4(q0),Vi.applyMatrix4(q0),Hi.z>g&&Vi.z>g)continue;if(Hi.z>g){const b=Hi.z-Vi.z,L=(Hi.z-g)/b;Hi.lerp(Vi,L)}else if(Vi.z>g){const b=Vi.z-Hi.z,L=(Vi.z-g)/b;Vi.lerp(Hi,L)}Hi.applyMatrix4(n),Vi.applyMatrix4(n),Hi.multiplyScalar(1/Hi.w),Vi.multiplyScalar(1/Vi.w),Hi.x*=o.x/2,Hi.y*=o.y/2,Vi.x*=o.x/2,Vi.y*=o.y/2,Gi.start.copy(Hi),Gi.start.z=0,Gi.end.copy(Vi),Gi.end.z=0;const A=Gi.closestPointToPointParameter(Y0,!0);Gi.at(A,B1);const E=hy.lerp(Hi.z,Vi.z,A),S=E>=-1&&E<=1,P=Y0.distanceTo(B1)<Nu*.5;if(S&&P){Gi.start.fromBufferAttribute(d,y),Gi.end.fromBufferAttribute(p,y),Gi.start.applyMatrix4(u),Gi.end.applyMatrix4(u);const b=new G,L=new G;So.distanceSqToSegment(Gi.start,Gi.end,L,b),t.push({point:L,pointOnLine:b,distance:So.origin.distanceTo(L),object:s,face:null,faceIndex:y,uv:null,[Gw]:null})}}}class jw extends ti{constructor(e=new Xy,t=new Yy({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let u=0,f=0,d=t.count;u<d;u++,f+=2)z1.fromBufferAttribute(t,u),F1.fromBufferAttribute(n,u),i[f]=f===0?0:i[f-1],i[f+1]=i[f]+z1.distanceTo(F1);const o=new km(i,2,1);return e.setAttribute("instanceDistanceStart",new es(o,1,0)),e.setAttribute("instanceDistanceEnd",new es(o,1,1)),this}raycast(e,t){const n=this.material.worldUnits,i=e.camera;i===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const o=e.params.Line2!==void 0&&e.params.Line2.threshold||0;So=e.ray;const u=this.matrixWorld,f=this.geometry,d=this.material;Nu=d.linewidth+o,f.boundingSphere===null&&f.computeBoundingSphere(),_m.copy(f.boundingSphere).applyMatrix4(u);let p;if(n)p=Nu*.5;else{const g=Math.max(i.near,_m.distanceToPoint(So.origin));p=H1(i,g,d.resolution)}if(_m.radius+=p,So.intersectsSphere(_m)===!1)return;f.boundingBox===null&&f.computeBoundingBox(),xm.copy(f.boundingBox).applyMatrix4(u);let m;if(n)m=Nu*.5;else{const g=Math.max(i.near,xm.distanceToPoint(So.origin));m=H1(i,g,d.resolution)}xm.expandByScalar(m),So.intersectsBox(xm)!==!1&&(n?IL(this,t):NL(this,i,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(X0),this.material.uniforms.resolution.value.set(X0.z,X0.w))}}class DL extends jw{constructor(e=new Ww,t=new Yy({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}const UL=ve.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:i,lineWidth:o,segments:u,dashed:f,...d},p){var m,g;const y=ca(S=>S.size),_=ve.useMemo(()=>u?new jw:new DL,[u]),[M]=ve.useState(()=>new Yy),A=(n==null||(m=n[0])==null?void 0:m.length)===4?4:3,E=ve.useMemo(()=>{const S=u?new Xy:new Ww,P=e.map(b=>{const L=Array.isArray(b);return b instanceof G||b instanceof nn?[b.x,b.y,b.z]:b instanceof Ne?[b.x,b.y,0]:L&&b.length===3?[b[0],b[1],b[2]]:L&&b.length===2?[b[0],b[1],0]:b});if(S.setPositions(P.flat()),n){t=16777215;const b=n.map(L=>L instanceof st?L.toArray():L);S.setColors(b.flat(),A)}return S},[e,u,n,A]);return ve.useLayoutEffect(()=>{_.computeLineDistances()},[e,_]),ve.useLayoutEffect(()=>{f?M.defines.USE_DASH="":delete M.defines.USE_DASH,M.needsUpdate=!0},[f,M]),ve.useEffect(()=>()=>E.dispose(),[E]),ve.createElement("primitive",Co({object:_,ref:p},d),ve.createElement("primitive",{object:E,attach:"geometry"}),ve.createElement("primitive",Co({object:M,attach:"material",color:t,vertexColors:!!n,resolution:[y.width,y.height],linewidth:(g=i??o)!==null&&g!==void 0?g:1,dashed:f,transparent:A===4},d)))});function OL(s,e,t,n){const i=class extends is{constructor(u={}){const f=Object.entries(s);super({uniforms:f.reduce((d,[p,m])=>{const g=lh.clone({[p]:{value:m}});return{...d,...g}},{}),vertexShader:e,fragmentShader:t}),this.key="",f.forEach(([d])=>Object.defineProperty(this,d,{get:()=>this.uniforms[d].value,set:p=>this.uniforms[d].value=p})),Object.assign(this,u)}};return i.key=hy.generateUUID(),i}const kL=()=>parseInt(bf.replace(/\D+/g,"")),zL=kL(),Xw=ve.forwardRef(({threshold:s=15,...e},t)=>{const n=ve.useRef(null);ve.useImperativeHandle(t,()=>n.current,[]);const i=ve.useMemo(()=>[0,0,0,1,0,0],[]),o=ve.useRef(),u=ve.useRef();return ve.useLayoutEffect(()=>{const f=n.current.parent;if(f){const d=f.geometry;if(d!==o.current||s!==u.current){o.current=d,u.current=s;const p=new Py(d,s).attributes.position.array;n.current.geometry.setPositions(p),n.current.geometry.attributes.instanceStart.needsUpdate=!0,n.current.geometry.attributes.instanceEnd.needsUpdate=!0,n.current.computeLineDistances()}}}),ve.createElement(UL,Co({segments:!0,points:i,ref:n,raycast:()=>null},e))}),FL=ve.forwardRef(({makeDefault:s,camera:e,regress:t,domElement:n,enableDamping:i=!0,keyEvents:o=!1,onChange:u,onStart:f,onEnd:d,...p},m)=>{const g=ca(D=>D.invalidate),y=ca(D=>D.camera),_=ca(D=>D.gl),M=ca(D=>D.events),A=ca(D=>D.setEvents),E=ca(D=>D.set),S=ca(D=>D.get),P=ca(D=>D.performance),b=e||y,L=n||M.connected||_.domElement,B=ve.useMemo(()=>new LL(b),[b]);return Ow(()=>{B.enabled&&B.update()},-1),ve.useEffect(()=>(o&&B.connect(o===!0?L:o),B.connect(L),()=>void B.dispose()),[o,L,t,B,g]),ve.useEffect(()=>{const D=O=>{g(),t&&P.regress(),u&&u(O)},F=O=>{f&&f(O)},j=O=>{d&&d(O)};return B.addEventListener("change",D),B.addEventListener("start",F),B.addEventListener("end",j),()=>{B.removeEventListener("start",F),B.removeEventListener("end",j),B.removeEventListener("change",D)}},[u,f,d,B,g,A]),ve.useEffect(()=>{if(s){const D=S().controls;return E({controls:B}),()=>E({controls:D})}},[s,B]),ve.createElement("primitive",Co({ref:m,object:B,enableDamping:i},p))}),BL=OL({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new st,sectionColor:new st,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new G,worldPlanePosition:new G},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${zL>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),HL=ve.forwardRef(({args:s,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:n=.5,sectionSize:i=1,followCamera:o=!1,infiniteGrid:u=!1,fadeDistance:f=100,fadeStrength:d=1,fadeFrom:p=1,cellThickness:m=.5,sectionThickness:g=1,side:y=nr,..._},M)=>{Ew({GridMaterial:BL});const A=ve.useRef(null);ve.useImperativeHandle(M,()=>A.current,[]);const E=new xo,S=new G(0,1,0),P=new G(0,0,0);Ow(B=>{E.setFromNormalAndCoplanarPoint(S,P).applyMatrix4(A.current.matrixWorld);const D=A.current.material,F=D.uniforms.worldCamProjPosition,j=D.uniforms.worldPlanePosition;E.projectPoint(B.camera.position,F.value),j.value.set(0,0,0).applyMatrix4(A.current.matrixWorld)});const b={cellSize:n,sectionSize:i,cellColor:e,sectionColor:t,cellThickness:m,sectionThickness:g},L={fadeDistance:f,fadeStrength:d,fadeFrom:p,infiniteGrid:u,followCamera:o};return ve.createElement("mesh",Co({ref:A,frustumCulled:!1},_),ve.createElement("gridMaterial",Co({transparent:!0,"extensions-derivatives":!0,side:y},b,L)),ve.createElement("planeGeometry",{args:s}))});var Z0={exports:{}},Q0,V1;function VL(){if(V1)return Q0;V1=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Q0=s,Q0}var K0,G1;function GL(){if(G1)return K0;G1=1;var s=VL();function e(){}function t(){}return t.resetWarningCache=e,K0=function(){function n(u,f,d,p,m,g){if(g!==s){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}n.isRequired=n;function i(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},K0}var W1;function Yw(){return W1||(W1=1,Z0.exports=GL()()),Z0.exports}class WL extends Pm.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("CubeStage Error:",e,t)}render(){return this.state.hasError?this.props.fallback:this.props.children}}const jL=({data:s,onRemove:e,onAdd:t,isGhost:n,showXRay:i,defaultColor:o})=>{const[u,f]=ve.useState(!1),d=[s.x-Math.floor(St/2),s.y+.5,s.z-Math.floor(St/2)],p=g=>{if(!n&&(g.stopPropagation(),!(g.delta>10))){if(t&&g.face){const y=Math.round(g.face.normal.x),_=Math.round(g.face.normal.y),M=Math.round(g.face.normal.z);t(s.x+y,s.y+_,s.z+M)}e&&e(s.id)}},m=i||n;return V.jsxs("mesh",{position:d,onClick:p,onPointerOver:g=>{g.stopPropagation(),f(!0)},onPointerOut:()=>f(!1),castShadow:!m,receiveShadow:!m,children:[V.jsx("boxGeometry",{args:[1,1,1]}),V.jsx("meshStandardMaterial",{color:s.color||o,transparent:m,opacity:m?.3:1,depthWrite:!m,roughness:.5,metalness:.1},`${m}`),V.jsx(Xw,{color:u&&!n?"white":Xs.voxelOutline,threshold:15,linewidth:2,visible:!0})]})},XL=({voxels:s,mode:e,onAddVoxel:t,onRemoveVoxel:n,showXRay:i,selectedColor:o})=>V.jsx("group",{position:[0,-.5,0],children:s.map(u=>V.jsx(jL,{data:u,onRemove:n,onAdd:t,showXRay:i,isGhost:e==="2d-blueprint",defaultColor:o},u.id))}),YL=({onAdd:s})=>{const[e,t]=ve.useState(null),n=o=>{o.stopPropagation();const u=Math.floor(o.point.x+St/2),f=Math.floor(o.point.z+St/2);u>=0&&u<St&&f>=0&&f<St?t([u,0,f]):t(null)},i=o=>{if(o.stopPropagation(),o.delta>10)return;const u=Math.floor(o.point.x+St/2),f=Math.floor(o.point.z+St/2);u>=0&&u<St&&f>=0&&f<St&&s(u,0,f)};return V.jsxs("group",{children:[V.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,0,0],onPointerMove:n,onClick:i,visible:!1,children:[V.jsx("planeGeometry",{args:[St,St]}),V.jsx("meshBasicMaterial",{})]}),e&&V.jsxs("mesh",{position:[e[0]-Math.floor(St/2),.02,e[2]-Math.floor(St/2)],rotation:[-Math.PI/2,0,0],children:[V.jsx("planeGeometry",{args:[1,1]}),V.jsx("meshBasicMaterial",{color:Xs.primary,transparent:!0,opacity:.4})]})]})},qL=({mode:s,onAddVoxel:e})=>V.jsxs(V.Fragment,{children:[V.jsx("color",{attach:"background",args:[Xs.background]}),V.jsx("ambientLight",{intensity:.7}),V.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-bias":-1e-4}),V.jsxs("group",{position:[0,-.5,0],children:[V.jsx(HL,{infiniteGrid:!0,fadeDistance:30,sectionColor:Xs.gridLine,cellColor:Xs.gridLine,sectionSize:1,cellSize:1,position:[0,-.01,0]}),V.jsxs("group",{position:[0,0,0],children:[V.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,0,0],receiveShadow:!0,children:[V.jsx("planeGeometry",{args:[St,St]}),V.jsx("meshBasicMaterial",{color:Xs.primary,transparent:!0,opacity:.05})]}),V.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.005,0],children:[V.jsx("planeGeometry",{args:[St,St]}),V.jsx("meshBasicMaterial",{transparent:!0,opacity:0}),V.jsx(Xw,{color:Xs.primary,linewidth:2})]}),V.jsx("gridHelper",{args:[St,St,Xs.gridLine,Xs.gridLine],position:[0,.005,0]})]}),s==="3d-edit"&&V.jsx(YL,{onAdd:e})]}),V.jsx(FL,{makeDefault:!0,enableDamping:!0})]}),qw=s=>V.jsxs(wL,{shadows:!0,camera:{position:[8,8,8],fov:45},children:[V.jsx(qL,{mode:s.mode,onAddVoxel:s.onAddVoxel}),V.jsx(WL,{fallback:null,children:V.jsx(XL,{...s})})]}),ys=({label:s,data:e,onToggle:t,editable:n,numbers:i,xAxisLabel:o,yAxisLabel:u,headerAction:f})=>V.jsxs("div",{className:"flex flex-col items-center bg-white p-3 rounded-lg shadow-sm border border-gray-100",children:[V.jsxs("div",{className:"flex justify-between items-center w-full mb-2",children:[V.jsx("h3",{className:"text-sm font-bold text-gray-700",children:s}),f&&V.jsx("div",{children:f})]}),V.jsx("div",{className:"grid gap-1 bg-gray-200 p-1 rounded",style:{gridTemplateColumns:`repeat(${St}, 1fr)`},children:e.map((d,p)=>d.map((m,g)=>{const y=i?i[p][g]:null;return V.jsx("div",{onClick:()=>n&&t&&t(p,g),className:`
                  w-8 h-8 flex items-center justify-center text-xs font-bold rounded-sm transition-all duration-200 select-none
                  ${n?"cursor-pointer hover:opacity-80":"cursor-default"}
                  ${m||y&&y>0?"bg-indigo-500 text-white shadow-sm":"bg-white text-gray-300"}
                `,children:i&&y&&y>0?y:""},`${p}-${g}`)}))}),(o||u)&&V.jsxs("div",{className:"flex justify-between w-full text-[10px] text-gray-400 mt-1 px-1",children:[V.jsx("span",{children:o}),V.jsx("span",{children:u})]})]});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ZL={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QL=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),In=(s,e)=>{const t=ve.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:u,className:f="",children:d,...p},m)=>ve.createElement("svg",{ref:m,...ZL,width:i,height:i,stroke:n,strokeWidth:u?Number(o)*24/Number(i):o,className:["lucide",`lucide-${QL(s)}`,f].join(" "),...p},[...e.map(([g,y])=>ve.createElement(g,y)),...Array.isArray(d)?d:[d]]));return t.displayName=`${s}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fm=In("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=In("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KL=In("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j1=In("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=In("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X1=In("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JL=In("Cuboid",[["path",{d:"m21.12 6.4-6.05-4.06a2 2 0 0 0-2.17-.05L2.95 8.41a2 2 0 0 0-.95 1.7v5.82a2 2 0 0 0 .88 1.66l6.05 4.07a2 2 0 0 0 2.17.05l9.95-6.12a2 2 0 0 0 .95-1.7V8.06a2 2 0 0 0-.88-1.66Z",key:"1u2ovd"}],["path",{d:"M10 22v-8L2.25 9.15",key:"11pn4q"}],["path",{d:"m10 14 11.77-6.87",key:"1kt1wh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $L=In("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=In("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=In("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=In("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=In("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jv=In("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=In("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=In("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=In("PlusSquare",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=In("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=In("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=In("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y1=In("Scaling",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=In("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=In("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=In("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=In("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=In("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),dI=({tool:s,setTool:e,onClear:t,mode:n,setMode:i,showXRay:o,setShowXRay:u,showNumbers:f,setShowNumbers:d,selectedColor:p,setSelectedColor:m,onGenerate:g})=>{const[y,_]=ve.useState({x:0,y:0}),[M,A]=ve.useState(null),[E,S]=ve.useState(!1),[P,b]=ve.useState({x:0,y:0}),[L,B]=ve.useState(!1),D=ve.useRef(null),F=ve.useCallback(N=>{if(!D.current)return;N.preventDefault();const X=D.current.getBoundingClientRect();L||(A({width:X.width,height:X.height}),_({x:X.left,y:X.top})),b({x:N.clientX-X.left,y:N.clientY-X.top}),S(!0),B(!0)},[L]),j=ve.useCallback(N=>{if(!D.current)return;const X=N.touches[0],te=D.current.getBoundingClientRect();L||(A({width:te.width,height:te.height}),_({x:te.left,y:te.top})),b({x:X.clientX-te.left,y:X.clientY-te.top}),S(!0),B(!0)},[L]);ve.useEffect(()=>{const N=ue=>{var ee,k;if(!E)return;B(!0);let fe=ue.clientX-P.x,ye=ue.clientY-P.y;const Me=window.innerWidth-(((ee=D.current)==null?void 0:ee.offsetWidth)||200),W=window.innerHeight-(((k=D.current)==null?void 0:k.offsetHeight)||400);fe=Math.max(0,Math.min(fe,Me)),ye=Math.max(0,Math.min(ye,W)),_({x:fe,y:ye})},X=ue=>{var k,J;if(!E)return;const fe=ue.touches[0];B(!0);let ye=fe.clientX-P.x,Me=fe.clientY-P.y;const W=window.innerWidth-(((k=D.current)==null?void 0:k.offsetWidth)||200),ee=window.innerHeight-(((J=D.current)==null?void 0:J.offsetHeight)||400);ye=Math.max(0,Math.min(ye,W)),Me=Math.max(0,Math.min(Me,ee)),_({x:ye,y:Me})},te=()=>{S(!1)},Q=()=>{S(!1)};return E&&(document.addEventListener("mousemove",N),document.addEventListener("mouseup",te),document.addEventListener("touchmove",X),document.addEventListener("touchend",Q)),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",te),document.removeEventListener("touchmove",X),document.removeEventListener("touchend",Q)}},[E,P]),ve.useEffect(()=>{const N=()=>{if(L&&D.current){const X=window.innerWidth-D.current.offsetWidth,te=window.innerHeight-D.current.offsetHeight;_(Q=>({x:Math.max(0,Math.min(Q.x,X)),y:Math.max(0,Math.min(Q.y,te))}))}};return window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[L]);const O=L?{position:"fixed",left:y.x,top:y.y,zIndex:50,width:M==null?void 0:M.width,maxWidth:M==null?void 0:M.width}:{};return V.jsxs("div",{ref:D,style:O,className:`bg-white rounded-xl shadow-lg flex flex-col border border-gray-100 w-full md:w-64 lg:w-72 h-min md:h-auto overflow-hidden ${E?"cursor-grabbing shadow-2xl scale-[1.02]":""} transition-shadow`,children:[V.jsxs("div",{onMouseDown:F,onTouchStart:j,className:`flex items-center justify-center gap-1 py-2 bg-gray-50 border-b border-gray-100 cursor-grab select-none ${E?"cursor-grabbing bg-gray-100":"hover:bg-gray-100"} transition-colors`,children:[V.jsx(tI,{size:16,className:"text-gray-400"}),V.jsx("span",{className:"text-xs text-gray-400 font-medium hidden md:inline",children:" "})]}),V.jsxs("div",{className:"p-4 flex flex-col gap-4 overflow-x-auto md:overflow-visible flex-row md:flex-col items-center md:items-stretch",children:[V.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[V.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider hidden md:block",children:"Mode"}),V.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[V.jsxs("button",{onClick:()=>i("3d-edit"),className:`flex-1 flex items-center justify-center p-2 rounded-md text-sm font-medium transition-colors ${n==="3d-edit"?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,title:"Interactive 3D Manipulation",children:[V.jsx(JL,{size:18,className:"md:mr-2"}),V.jsx("span",{className:"hidden md:inline",children:"3D Build"})]}),V.jsxs("button",{onClick:()=>i("2d-blueprint"),className:`flex-1 flex items-center justify-center p-2 rounded-md text-sm font-medium transition-colors ${n==="2d-blueprint"?"bg-white text-pink-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,title:"Create from 2D projections",children:[V.jsx($v,{size:18,className:"md:mr-2"}),V.jsx("span",{className:"hidden md:inline",children:"2D Blueprint"})]})]})]}),V.jsx("div",{className:"h-px bg-gray-200 w-full hidden md:block"}),n==="3d-edit"?V.jsxs(V.Fragment,{children:[V.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider hidden md:block",children:"Tools"}),V.jsxs("div",{className:"flex md:flex-col gap-2 w-full",children:[V.jsxs("button",{onClick:()=>e("build"),className:`flex items-center p-2 rounded-lg transition-colors ${s==="build"?"bg-indigo-50 text-indigo-700 border border-indigo-200":"hover:bg-gray-50 text-gray-700"}`,children:[V.jsx("div",{className:`p-1.5 rounded-md mr-3 ${s==="build"?"bg-indigo-600 text-white":"bg-gray-200 text-gray-500"}`,children:V.jsx(sI,{size:16})}),V.jsx("span",{className:"font-medium hidden md:inline",children:"Add Block"})]}),V.jsxs("button",{onClick:()=>e("erase"),className:`flex items-center p-2 rounded-lg transition-colors ${s==="erase"?"bg-pink-50 text-pink-700 border border-pink-200":"hover:bg-gray-50 text-gray-700"}`,children:[V.jsx("div",{className:`p-1.5 rounded-md mr-3 ${s==="erase"?"bg-pink-500 text-white":"bg-gray-200 text-gray-500"}`,children:V.jsx($L,{size:16})}),V.jsx("span",{className:"font-medium hidden md:inline",children:"Remove"})]})]})]}):V.jsxs("div",{className:"flex flex-col w-full gap-2",children:[V.jsx("p",{className:"text-xs text-gray-500 bg-blue-50 p-2 rounded border border-blue-100 hidden md:block",children:"Fill in the Top, Front, and Side grids to generate a 3D shape automatically."}),V.jsxs("button",{onClick:g,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center justify-center gap-2 animate-pulse",children:[V.jsx($v,{size:16}),"Generate 3D"]})]}),V.jsx("div",{className:"h-px bg-gray-200 w-full hidden md:block"}),V.jsxs("div",{className:"flex items-center justify-between w-full hidden md:flex",children:[V.jsx("span",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider",children:"Color"}),V.jsx(rI,{size:14,className:"text-gray-400"})]}),V.jsx("div",{className:"grid grid-cols-4 gap-2 w-full",children:aS.map(N=>V.jsx("button",{onClick:()=>{m(N),n==="3d-edit"&&e("build")},className:`w-full aspect-square rounded-full shadow-sm transition-transform hover:scale-110 border border-gray-200 ${p===N?"ring-2 ring-offset-1 ring-indigo-500 scale-110":""}`,style:{backgroundColor:N},title:N},N))}),V.jsx("div",{className:"h-px bg-gray-200 w-full hidden md:block"}),V.jsxs("div",{className:"flex md:flex-col gap-2 w-full",children:[V.jsxs("button",{onClick:()=>u(!o),className:`flex items-center justify-center p-2 rounded-lg text-sm font-medium w-full transition-colors ${o?"bg-emerald-50 text-emerald-700 border border-emerald-200":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50"}`,title:"Toggle Transparent View",children:[V.jsx(eI,{size:16,className:"md:mr-2"}),V.jsx("span",{className:"hidden md:inline",children:o?"X-Ray On":"X-Ray Off"})]}),V.jsxs("button",{onClick:()=>d(!f),className:`flex items-center justify-center p-2 rounded-lg text-sm font-medium w-full transition-colors ${f?"bg-amber-50 text-amber-700 border border-amber-200":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50"}`,title:"Toggle Numbers on 2D Grids",children:[V.jsx(Kw,{size:16,className:"md:mr-2"}),V.jsx("span",{className:"hidden md:inline",children:f?"Numbers On":"Numbers Off"})]}),V.jsxs("button",{onClick:t,className:"flex items-center justify-center p-2 rounded-lg text-sm font-medium text-red-600 border border-red-200 hover:bg-red-50 w-full transition-colors mt-2",children:[V.jsx(uI,{size:16,className:"md:mr-2"}),V.jsx("span",{className:"hidden md:inline",children:"Clear All"})]})]})]})]})},hI=s=>new Set(s.map(e=>`${e.x},${e.y},${e.z}`)),pI=s=>{const e=hI(s);let t=0;s.forEach(i=>{[{x:i.x+1,y:i.y,z:i.z},{x:i.x-1,y:i.y,z:i.z},{x:i.x,y:i.y+1,z:i.z},{x:i.x,y:i.y-1,z:i.z},{x:i.x,y:i.y,z:i.z+1},{x:i.x,y:i.y,z:i.z-1}].forEach(u=>{e.has(`${u.x},${u.y},${u.z}`)||t++})});const n=s.length;return{count:n,volume:n,surfaceArea:t}},qy=s=>{const e=Array(St).fill(null).map(()=>Array(St).fill(!1)),t=Array(St).fill(null).map(()=>Array(St).fill(!1)),n=Array(St).fill(null).map(()=>Array(St).fill(!1));return s.forEach(i=>{i.x>=0&&i.x<St&&i.z>=0&&i.z<St&&(e[i.z][i.x]=!0),i.x>=0&&i.x<St&&i.y>=0&&i.y<Or&&(t[Or-1-i.y][i.x]=!0),i.z>=0&&i.z<St&&i.y>=0&&i.y<Or&&(n[Or-1-i.y][i.z]=!0)}),{top:e,front:t,side:n}},J0=s=>{for(let e=0;e<St;e++)for(let t=0;t<St;t++)if(s[t][e])return e;return-1},q1=s=>{const e=[],t=J0(s.top);let n=-1;e:for(let d=0;d<St;d++)for(let p=0;p<St;p++)if(s.top[d][p]){n=d;break e}const i=J0(s.front),o=J0(s.side),u=t!==-1&&i!==-1?i-t:0,f=n!==-1&&o!==-1?o-n:0;for(let d=0;d<St;d++)for(let p=0;p<Or;p++)for(let m=0;m<St;m++){const g=s.top[m][d],y=d+u,_=m+f;let M=!1;y>=0&&y<St&&(M=s.front[Or-1-p][y]);let A=!1;_>=0&&_<St&&(A=s.side[Or-1-p][_]),g&&M&&A&&e.push({x:d,y:p,z:m,id:`${d},${p},${m}`})}return e},$w=s=>{const e=Array(St).fill(null).map(()=>Array(St).fill(0));return s.forEach(t=>{e[t.z][t.x]<t.y+1&&(e[t.z][t.x]=t.y+1)}),e.map(t=>t.map(n=>n===0?null:n))},eE=s=>{const e=Array(Or).fill(null).map(()=>Array(St).fill(0));return s.forEach(t=>{const n=Or-1-t.y,i=t.x;n>=0&&n<Or&&i>=0&&i<St&&(e[n][i]+=1)}),e.map(t=>t.map(n=>n===0?null:n))},tE=s=>{const e=Array(Or).fill(null).map(()=>Array(St).fill(0));return s.forEach(t=>{const n=Or-1-t.y,i=t.z;n>=0&&n<Or&&i>=0&&i<St&&(e[n][i]+=1)}),e.map(t=>t.map(n=>n===0?null:n))},mI=({voxels:s,onSubmit:e,timeLimit:t})=>{const[n,i]=ve.useState(""),[o,u]=ve.useState("right"),[f,d]=ve.useState(t),[p,m]=ve.useState(!1),g=ve.useMemo(()=>qy(s),[s]),y=o==="left"?g.side.map(S=>[...S].reverse()):g.side,_=S=>{const P=Math.floor(S/60),b=S%60;return`${P.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`},M=()=>f<=10?"text-red-600 bg-red-100":f<=30?"text-amber-600 bg-amber-100":"text-indigo-600 bg-indigo-100",A=ve.useCallback(S=>{p||(m(!0),e(S))},[p,e]),E=S=>{S.preventDefault();const P=parseInt(n,10);!isNaN(P)&&P>0&&A(P)};return ve.useEffect(()=>{if(t<=0||p)return;const S=setInterval(()=>{d(P=>P<=1?(clearInterval(S),A(0),0):P-1)},1e3);return()=>clearInterval(S)},[t,p,A]),V.jsxs("div",{className:"flex flex-col h-full w-full",children:[V.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 md:p-6",children:V.jsxs("div",{className:"max-w-2xl mx-auto",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx(nI,{size:24}),V.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"  "})]}),t>0&&V.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full font-mono font-bold ${M()}`,children:[V.jsx(Qw,{size:16,className:f<=10?"animate-pulse":""}),V.jsx("span",{className:"text-lg",children:_(f)})]})]}),V.jsx("p",{className:"text-indigo-100 text-sm mt-2",children:" 3       !"})]})}),t>0&&f<=10&&f>0&&V.jsxs("div",{className:"bg-red-500 text-white text-center py-2 text-sm font-medium animate-pulse",children:["    ! ",f,""]}),V.jsx("div",{className:"flex-1 bg-gradient-to-br from-sky-50 to-indigo-50/50 p-4 md:p-6 overflow-y-auto",children:V.jsxs("div",{className:"max-w-2xl mx-auto space-y-4 md:space-y-6",children:[V.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md",children:[V.jsxs("h3",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[V.jsx("span",{className:"bg-indigo-100 text-indigo-600 px-2 py-1 rounded text-xs font-semibold",children:""}),"Top View (Above)"]}),V.jsx("div",{className:"flex justify-center",children:V.jsx(ys,{label:"",data:g.top,editable:!1,xAxisLabel:"X (Right)",yAxisLabel:"Z (Depth)"})})]}),V.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[V.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md",children:[V.jsxs("h3",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[V.jsx("span",{className:"bg-pink-100 text-pink-600 px-2 py-1 rounded text-xs font-semibold",children:""}),"Front View"]}),V.jsx("div",{className:"flex justify-center",children:V.jsx(ys,{label:"",data:g.front,editable:!1,xAxisLabel:"X (Right)",yAxisLabel:"Y (Up)"})})]}),V.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md",children:[V.jsxs("h3",{className:"text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[V.jsx("span",{className:"bg-emerald-100 text-emerald-600 px-2 py-1 rounded text-xs font-semibold",children:""}),"Side View (",o==="right"?"Right":"Left",")",V.jsx("button",{onClick:()=>u(S=>S==="right"?"left":"right"),className:"ml-auto p-1 hover:bg-gray-100 rounded text-indigo-600 transition-colors",title:"Switch Side View (Right/Left)",children:V.jsx(Fm,{size:14})})]}),V.jsx("div",{className:"flex justify-center",children:V.jsx(ys,{label:"",data:y,editable:!1,xAxisLabel:o==="right"?"Z (Depth)":"Z (Reversed)",yAxisLabel:"Y (Up)"})})]})]})]})}),V.jsx("div",{className:"bg-white border-t border-gray-200 p-4 md:p-6 shadow-lg",children:V.jsxs("form",{onSubmit:E,className:"max-w-md mx-auto",children:[V.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"   ?"}),V.jsxs("div",{className:"flex gap-3",children:[V.jsx("input",{type:"number",value:n,onChange:S=>i(S.target.value),placeholder:" ",min:"1",disabled:p,className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none text-lg font-medium text-center disabled:bg-gray-100 disabled:cursor-not-allowed",autoFocus:!0}),V.jsxs("button",{type:"submit",disabled:!n||parseInt(n,10)<=0||p,className:"px-6 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[V.jsx(lI,{size:18}),""]})]})]})})]})},gI=({voxels:s,correctAnswer:e,userAnswer:t,isCorrect:n,onNewQuiz:i,onShare:o})=>{const[u,f]=Pm.useState("right"),[d,p]=Pm.useState(!0),m=ve.useMemo(()=>qy(s),[s]),g=ve.useMemo(()=>$w(s),[s]),y=ve.useMemo(()=>eE(s),[s]),_=ve.useMemo(()=>tE(s),[s]),M=u==="left"?m.side.map(E=>[...E].reverse()):m.side,A=u==="left"?_.map(E=>[...E].reverse()):_;return V.jsxs("div",{className:"flex flex-col h-full w-full",children:[V.jsx("div",{className:`${n?"bg-gradient-to-r from-emerald-500 to-teal-500":"bg-gradient-to-r from-orange-500 to-red-500"} text-white px-4 py-3`,children:V.jsxs("div",{className:"max-w-6xl mx-auto flex items-center justify-between",children:[V.jsxs("div",{className:"flex items-center gap-3",children:[n?V.jsx(KL,{size:32,className:"text-emerald-100"}):V.jsx(cI,{size:32,className:"text-orange-100"}),V.jsxs("div",{children:[V.jsx("h1",{className:"text-xl font-bold",children:n?"!":"!"}),V.jsx("p",{className:"text-white/80 text-sm",children:n?" !":` : ${t}`})]})]}),V.jsxs("div",{className:"flex items-center gap-4",children:[V.jsxs("div",{className:"text-right",children:[V.jsx("div",{className:"text-xs text-white/70",children:""}),V.jsxs("div",{className:"text-2xl font-bold flex items-center gap-1",children:[V.jsx(Jv,{size:20}),e,""]})]}),V.jsxs("div",{className:"flex gap-2",children:[V.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors font-medium text-sm",children:[V.jsx(aI,{size:16}),V.jsx("span",{className:"hidden sm:inline",children:" "})]}),V.jsx("button",{onClick:o,className:"p-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-colors",title:"  ",children:V.jsx(Jw,{size:16})})]})]})]})}),V.jsxs("div",{className:"flex-1 relative bg-gradient-to-br from-sky-50 to-indigo-50/50",children:[V.jsx(qw,{voxels:s,mode:"3d-edit",onAddVoxel:()=>{},onRemoveVoxel:()=>{},showXRay:!1,selectedColor:Xs.voxelDefault}),V.jsxs("div",{className:"absolute top-4 left-4 bg-white/90 backdrop-blur px-4 py-2 rounded-lg shadow-sm",children:[V.jsx("div",{className:"text-xs text-gray-500",children:" "}),V.jsxs("div",{className:"text-xl font-bold text-indigo-600 flex items-center gap-1",children:[V.jsx(Zw,{size:18})," ",e,""]})]}),V.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur px-4 py-2 rounded-full text-sm text-gray-600 shadow-sm pointer-events-none select-none",children:"    /"})]}),V.jsxs("div",{className:"bg-white border-t border-gray-200 shadow-lg",children:[V.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-100",children:[V.jsx("div",{className:"text-sm font-semibold text-gray-700",children:" "}),V.jsxs("div",{className:"flex items-center gap-4",children:[V.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 cursor-pointer",children:[V.jsx("input",{type:"checkbox",checked:d,onChange:E=>p(E.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),V.jsx(Kw,{size:14})," "]}),V.jsxs("button",{onClick:()=>f(E=>E==="right"?"left":"right"),className:"flex items-center gap-1 px-2 py-1 text-sm text-indigo-600 hover:bg-indigo-50 rounded transition-colors",title:"Switch Side View (Right/Left)",children:[V.jsx(Fm,{size:14}),"Side: ",u==="right"?"Right":"Left"]})]})]}),V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("div",{className:"flex gap-4 p-4 min-w-max",children:[V.jsx("div",{className:"flex-shrink-0",children:V.jsx(ys,{label:"Top View ()",data:m.top,editable:!1,numbers:d?g:void 0,xAxisLabel:"X (Right)",yAxisLabel:"Z (Depth)"})}),V.jsx("div",{className:"flex-shrink-0",children:V.jsx(ys,{label:"Front View ()",data:m.front,editable:!1,numbers:d?y:void 0,xAxisLabel:"X (Right)",yAxisLabel:"Y (Up)"})}),V.jsx("div",{className:"flex-shrink-0",children:V.jsx(ys,{label:`Side View (${u==="right"?"":""})`,data:M,editable:!1,numbers:d?A:void 0,xAxisLabel:u==="right"?"Z (Depth)":"Z (Reversed)",yAxisLabel:"Y (Up)"})})]})})]})]})};var df={},$0,Z1;function nE(){return Z1||(Z1=1,$0={L:1,M:0,Q:3,H:2}),$0}var ev,Q1;function iE(){return Q1||(Q1=1,ev={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8}),ev}var tv,K1;function vI(){if(K1)return tv;K1=1;var s=iE();function e(t){this.mode=s.MODE_8BIT_BYTE,this.data=t}return e.prototype={getLength:function(t){return this.data.length},write:function(t){for(var n=0;n<this.data.length;n++)t.put(this.data.charCodeAt(n),8)}},tv=e,tv}var nv,J1;function yI(){if(J1)return nv;J1=1;var s=nE();function e(t,n){this.totalCount=t,this.dataCount=n}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,n){var i=e.getRsBlockTable(t,n);if(i==null)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+n);for(var o=i.length/3,u=new Array,f=0;f<o;f++)for(var d=i[f*3+0],p=i[f*3+1],m=i[f*3+2],g=0;g<d;g++)u.push(new e(p,m));return u},e.getRsBlockTable=function(t,n){switch(n){case s.L:return e.RS_BLOCK_TABLE[(t-1)*4+0];case s.M:return e.RS_BLOCK_TABLE[(t-1)*4+1];case s.Q:return e.RS_BLOCK_TABLE[(t-1)*4+2];case s.H:return e.RS_BLOCK_TABLE[(t-1)*4+3];default:return}},nv=e,nv}var iv,$1;function xI(){if($1)return iv;$1=1;function s(){this.buffer=new Array,this.length=0}return s.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},iv=s,iv}var rv,eS;function rE(){if(eS)return rv;eS=1;for(var s={glog:function(t){if(t<1)throw new Error("glog("+t+")");return s.LOG_TABLE[t]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return s.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},e=0;e<8;e++)s.EXP_TABLE[e]=1<<e;for(var e=8;e<256;e++)s.EXP_TABLE[e]=s.EXP_TABLE[e-4]^s.EXP_TABLE[e-5]^s.EXP_TABLE[e-6]^s.EXP_TABLE[e-8];for(var e=0;e<255;e++)s.LOG_TABLE[s.EXP_TABLE[e]]=e;return rv=s,rv}var sv,tS;function sE(){if(tS)return sv;tS=1;var s=rE();function e(t,n){if(t.length==null)throw new Error(t.length+"/"+n);for(var i=0;i<t.length&&t[i]==0;)i++;this.num=new Array(t.length-i+n);for(var o=0;o<t.length-i;o++)this.num[o]=t[o+i]}return e.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var n=new Array(this.getLength()+t.getLength()-1),i=0;i<this.getLength();i++)for(var o=0;o<t.getLength();o++)n[i+o]^=s.gexp(s.glog(this.get(i))+s.glog(t.get(o)));return new e(n,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var n=s.glog(this.get(0))-s.glog(t.get(0)),i=new Array(this.getLength()),o=0;o<this.getLength();o++)i[o]=this.get(o);for(var o=0;o<t.getLength();o++)i[o]^=s.gexp(s.glog(t.get(o))+n);return new e(i,0).mod(t)}},sv=e,sv}var ov,nS;function _I(){if(nS)return ov;nS=1;var s=iE(),e=sE(),t=rE(),n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},i={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(o){for(var u=o<<10;i.getBCHDigit(u)-i.getBCHDigit(i.G15)>=0;)u^=i.G15<<i.getBCHDigit(u)-i.getBCHDigit(i.G15);return(o<<10|u)^i.G15_MASK},getBCHTypeNumber:function(o){for(var u=o<<12;i.getBCHDigit(u)-i.getBCHDigit(i.G18)>=0;)u^=i.G18<<i.getBCHDigit(u)-i.getBCHDigit(i.G18);return o<<12|u},getBCHDigit:function(o){for(var u=0;o!=0;)u++,o>>>=1;return u},getPatternPosition:function(o){return i.PATTERN_POSITION_TABLE[o-1]},getMask:function(o,u,f){switch(o){case n.PATTERN000:return(u+f)%2==0;case n.PATTERN001:return u%2==0;case n.PATTERN010:return f%3==0;case n.PATTERN011:return(u+f)%3==0;case n.PATTERN100:return(Math.floor(u/2)+Math.floor(f/3))%2==0;case n.PATTERN101:return u*f%2+u*f%3==0;case n.PATTERN110:return(u*f%2+u*f%3)%2==0;case n.PATTERN111:return(u*f%3+(u+f)%2)%2==0;default:throw new Error("bad maskPattern:"+o)}},getErrorCorrectPolynomial:function(o){for(var u=new e([1],0),f=0;f<o;f++)u=u.multiply(new e([1,t.gexp(f)],0));return u},getLengthInBits:function(o,u){if(1<=u&&u<10)switch(o){case s.MODE_NUMBER:return 10;case s.MODE_ALPHA_NUM:return 9;case s.MODE_8BIT_BYTE:return 8;case s.MODE_KANJI:return 8;default:throw new Error("mode:"+o)}else if(u<27)switch(o){case s.MODE_NUMBER:return 12;case s.MODE_ALPHA_NUM:return 11;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 10;default:throw new Error("mode:"+o)}else if(u<41)switch(o){case s.MODE_NUMBER:return 14;case s.MODE_ALPHA_NUM:return 13;case s.MODE_8BIT_BYTE:return 16;case s.MODE_KANJI:return 12;default:throw new Error("mode:"+o)}else throw new Error("type:"+u)},getLostPoint:function(o){for(var u=o.getModuleCount(),f=0,d=0;d<u;d++)for(var p=0;p<u;p++){for(var m=0,g=o.isDark(d,p),y=-1;y<=1;y++)if(!(d+y<0||u<=d+y))for(var _=-1;_<=1;_++)p+_<0||u<=p+_||y==0&&_==0||g==o.isDark(d+y,p+_)&&m++;m>5&&(f+=3+m-5)}for(var d=0;d<u-1;d++)for(var p=0;p<u-1;p++){var M=0;o.isDark(d,p)&&M++,o.isDark(d+1,p)&&M++,o.isDark(d,p+1)&&M++,o.isDark(d+1,p+1)&&M++,(M==0||M==4)&&(f+=3)}for(var d=0;d<u;d++)for(var p=0;p<u-6;p++)o.isDark(d,p)&&!o.isDark(d,p+1)&&o.isDark(d,p+2)&&o.isDark(d,p+3)&&o.isDark(d,p+4)&&!o.isDark(d,p+5)&&o.isDark(d,p+6)&&(f+=40);for(var p=0;p<u;p++)for(var d=0;d<u-6;d++)o.isDark(d,p)&&!o.isDark(d+1,p)&&o.isDark(d+2,p)&&o.isDark(d+3,p)&&o.isDark(d+4,p)&&!o.isDark(d+5,p)&&o.isDark(d+6,p)&&(f+=40);for(var A=0,p=0;p<u;p++)for(var d=0;d<u;d++)o.isDark(d,p)&&A++;var E=Math.abs(100*A/u/u-50)/5;return f+=E*10,f}};return ov=i,ov}var av,iS;function SI(){if(iS)return av;iS=1;var s=vI(),e=yI(),t=xI(),n=_I(),i=sE();function o(f,d){this.typeNumber=f,this.errorCorrectLevel=d,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}var u=o.prototype;return u.addData=function(f){var d=new s(f);this.dataList.push(d),this.dataCache=null},u.isDark=function(f,d){if(f<0||this.moduleCount<=f||d<0||this.moduleCount<=d)throw new Error(f+","+d);return this.modules[f][d]},u.getModuleCount=function(){return this.moduleCount},u.make=function(){if(this.typeNumber<1){var f=1;for(f=1;f<40;f++){for(var d=e.getRSBlocks(f,this.errorCorrectLevel),p=new t,m=0,g=0;g<d.length;g++)m+=d[g].dataCount;for(var g=0;g<this.dataList.length;g++){var y=this.dataList[g];p.put(y.mode,4),p.put(y.getLength(),n.getLengthInBits(y.mode,f)),y.write(p)}if(p.getLengthInBits()<=m*8)break}this.typeNumber=f}this.makeImpl(!1,this.getBestMaskPattern())},u.makeImpl=function(f,d){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var p=0;p<this.moduleCount;p++){this.modules[p]=new Array(this.moduleCount);for(var m=0;m<this.moduleCount;m++)this.modules[p][m]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(f,d),this.typeNumber>=7&&this.setupTypeNumber(f),this.dataCache==null&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,d)},u.setupPositionProbePattern=function(f,d){for(var p=-1;p<=7;p++)if(!(f+p<=-1||this.moduleCount<=f+p))for(var m=-1;m<=7;m++)d+m<=-1||this.moduleCount<=d+m||(0<=p&&p<=6&&(m==0||m==6)||0<=m&&m<=6&&(p==0||p==6)||2<=p&&p<=4&&2<=m&&m<=4?this.modules[f+p][d+m]=!0:this.modules[f+p][d+m]=!1)},u.getBestMaskPattern=function(){for(var f=0,d=0,p=0;p<8;p++){this.makeImpl(!0,p);var m=n.getLostPoint(this);(p==0||f>m)&&(f=m,d=p)}return d},u.createMovieClip=function(f,d,p){var m=f.createEmptyMovieClip(d,p),g=1;this.make();for(var y=0;y<this.modules.length;y++)for(var _=y*g,M=0;M<this.modules[y].length;M++){var A=M*g,E=this.modules[y][M];E&&(m.beginFill(0,100),m.moveTo(A,_),m.lineTo(A+g,_),m.lineTo(A+g,_+g),m.lineTo(A,_+g),m.endFill())}return m},u.setupTimingPattern=function(){for(var f=8;f<this.moduleCount-8;f++)this.modules[f][6]==null&&(this.modules[f][6]=f%2==0);for(var d=8;d<this.moduleCount-8;d++)this.modules[6][d]==null&&(this.modules[6][d]=d%2==0)},u.setupPositionAdjustPattern=function(){for(var f=n.getPatternPosition(this.typeNumber),d=0;d<f.length;d++)for(var p=0;p<f.length;p++){var m=f[d],g=f[p];if(this.modules[m][g]==null)for(var y=-2;y<=2;y++)for(var _=-2;_<=2;_++)y==-2||y==2||_==-2||_==2||y==0&&_==0?this.modules[m+y][g+_]=!0:this.modules[m+y][g+_]=!1}},u.setupTypeNumber=function(f){for(var d=n.getBCHTypeNumber(this.typeNumber),p=0;p<18;p++){var m=!f&&(d>>p&1)==1;this.modules[Math.floor(p/3)][p%3+this.moduleCount-8-3]=m}for(var p=0;p<18;p++){var m=!f&&(d>>p&1)==1;this.modules[p%3+this.moduleCount-8-3][Math.floor(p/3)]=m}},u.setupTypeInfo=function(f,d){for(var p=this.errorCorrectLevel<<3|d,m=n.getBCHTypeInfo(p),g=0;g<15;g++){var y=!f&&(m>>g&1)==1;g<6?this.modules[g][8]=y:g<8?this.modules[g+1][8]=y:this.modules[this.moduleCount-15+g][8]=y}for(var g=0;g<15;g++){var y=!f&&(m>>g&1)==1;g<8?this.modules[8][this.moduleCount-g-1]=y:g<9?this.modules[8][15-g-1+1]=y:this.modules[8][15-g-1]=y}this.modules[this.moduleCount-8][8]=!f},u.mapData=function(f,d){for(var p=-1,m=this.moduleCount-1,g=7,y=0,_=this.moduleCount-1;_>0;_-=2)for(_==6&&_--;;){for(var M=0;M<2;M++)if(this.modules[m][_-M]==null){var A=!1;y<f.length&&(A=(f[y]>>>g&1)==1);var E=n.getMask(d,m,_-M);E&&(A=!A),this.modules[m][_-M]=A,g--,g==-1&&(y++,g=7)}if(m+=p,m<0||this.moduleCount<=m){m-=p,p=-p;break}}},o.PAD0=236,o.PAD1=17,o.createData=function(f,d,p){for(var m=e.getRSBlocks(f,d),g=new t,y=0;y<p.length;y++){var _=p[y];g.put(_.mode,4),g.put(_.getLength(),n.getLengthInBits(_.mode,f)),_.write(g)}for(var M=0,y=0;y<m.length;y++)M+=m[y].dataCount;if(g.getLengthInBits()>M*8)throw new Error("code length overflow. ("+g.getLengthInBits()+">"+M*8+")");for(g.getLengthInBits()+4<=M*8&&g.put(0,4);g.getLengthInBits()%8!=0;)g.putBit(!1);for(;!(g.getLengthInBits()>=M*8||(g.put(o.PAD0,8),g.getLengthInBits()>=M*8));)g.put(o.PAD1,8);return o.createBytes(g,m)},o.createBytes=function(f,d){for(var p=0,m=0,g=0,y=new Array(d.length),_=new Array(d.length),M=0;M<d.length;M++){var A=d[M].dataCount,E=d[M].totalCount-A;m=Math.max(m,A),g=Math.max(g,E),y[M]=new Array(A);for(var S=0;S<y[M].length;S++)y[M][S]=255&f.buffer[S+p];p+=A;var P=n.getErrorCorrectPolynomial(E),b=new i(y[M],P.getLength()-1),L=b.mod(P);_[M]=new Array(P.getLength()-1);for(var S=0;S<_[M].length;S++){var B=S+L.getLength()-_[M].length;_[M][S]=B>=0?L.get(B):0}}for(var D=0,S=0;S<d.length;S++)D+=d[S].totalCount;for(var F=new Array(D),j=0,S=0;S<m;S++)for(var M=0;M<d.length;M++)S<y[M].length&&(F[j++]=y[M][S]);for(var S=0;S<g;S++)for(var M=0;M<d.length;M++)S<_[M].length&&(F[j++]=_[M][S]);return F},av=o,av}var Sm={},rS;function MI(){if(rS)return Sm;rS=1,Object.defineProperty(Sm,"__esModule",{value:!0});var s=Object.assign||function(p){for(var m=1;m<arguments.length;m++){var g=arguments[m];for(var y in g)Object.prototype.hasOwnProperty.call(g,y)&&(p[y]=g[y])}return p},e=Yw(),t=o(e),n=Cf(),i=o(n);function o(p){return p&&p.__esModule?p:{default:p}}function u(p,m){var g={};for(var y in p)m.indexOf(y)>=0||Object.prototype.hasOwnProperty.call(p,y)&&(g[y]=p[y]);return g}var f={bgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,bgD:t.default.string.isRequired,fgColor:t.default.oneOfType([t.default.object,t.default.string]).isRequired,fgD:t.default.string.isRequired,size:t.default.number.isRequired,title:t.default.string,viewBoxSize:t.default.number.isRequired,xmlns:t.default.string},d=(0,n.forwardRef)(function(p,m){var g=p.bgColor,y=p.bgD,_=p.fgD,M=p.fgColor,A=p.size,E=p.title,S=p.viewBoxSize,P=p.xmlns,b=P===void 0?"http://www.w3.org/2000/svg":P,L=u(p,["bgColor","bgD","fgD","fgColor","size","title","viewBoxSize","xmlns"]);return i.default.createElement("svg",s({},L,{height:A,ref:m,viewBox:"0 0 "+S+" "+S,width:A,xmlns:b}),E?i.default.createElement("title",null,E):null,i.default.createElement("path",{d:y,fill:g}),i.default.createElement("path",{d:_,fill:M}))});return d.displayName="QRCodeSvg",d.propTypes=f,Sm.default=d,Sm}var sS;function wI(){if(sS)return df;sS=1,Object.defineProperty(df,"__esModule",{value:!0}),df.QRCode=void 0;var s=Object.assign||function(A){for(var E=1;E<arguments.length;E++){var S=arguments[E];for(var P in S)Object.prototype.hasOwnProperty.call(S,P)&&(A[P]=S[P])}return A},e=Yw(),t=g(e),n=nE(),i=g(n),o=SI(),u=g(o),f=Cf(),d=g(f),p=MI(),m=g(p);function g(A){return A&&A.__esModule?A:{default:A}}function y(A,E){var S={};for(var P in A)E.indexOf(P)>=0||Object.prototype.hasOwnProperty.call(A,P)&&(S[P]=A[P]);return S}var _={bgColor:t.default.oneOfType([t.default.object,t.default.string]),fgColor:t.default.oneOfType([t.default.object,t.default.string]),level:t.default.string,size:t.default.number,value:t.default.string.isRequired},M=(0,f.forwardRef)(function(A,E){var S=A.bgColor,P=S===void 0?"#FFFFFF":S,b=A.fgColor,L=b===void 0?"#000000":b,B=A.level,D=B===void 0?"L":B,F=A.size,j=F===void 0?256:F,O=A.value,N=y(A,["bgColor","fgColor","level","size","value"]),X=new u.default(-1,i.default[D]);X.addData(O),X.make();var te=X.modules;return d.default.createElement(m.default,s({},N,{bgColor:P,bgD:te.map(function(Q,ue){return Q.map(function(fe,ye){return fe?"":"M "+ye+" "+ue+" l 1 0 0 1 -1 0 Z"}).join(" ")}).join(" "),fgColor:L,fgD:te.map(function(Q,ue){return Q.map(function(fe,ye){return fe?"M "+ye+" "+ue+" l 1 0 0 1 -1 0 Z":""}).join(" ")}).join(" "),ref:E,size:j,viewBoxSize:te.length}))});return df.QRCode=M,M.displayName="QRCode",M.propTypes=_,df.default=M,df}var EI=wI();const TI=Bm(EI),oE=({isOpen:s,onClose:e,children:t,title:n,showCloseButton:i=!0})=>(ve.useEffect(()=>{const o=u=>{u.key==="Escape"&&e()};return s&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}},[s,e]),s?V.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[V.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:e}),V.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden animate-in fade-in zoom-in duration-200",children:[(n||i)&&V.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100",children:[n&&V.jsx("h2",{className:"text-lg font-bold text-gray-800",children:n}),i&&V.jsx("button",{onClick:e,className:"p-1 rounded-lg hover:bg-gray-100 transition-colors text-gray-400 hover:text-gray-600",children:V.jsx(fI,{size:20})})]}),V.jsx("div",{className:"p-6",children:t})]})]}):null),AI=({isOpen:s,isCorrect:e,correctAnswer:t,userAnswer:n,onReveal:i,onClose:o})=>s?V.jsx(oE,{isOpen:s,onClose:o,showCloseButton:!1,children:V.jsxs("div",{className:"text-center",children:[e?V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:V.jsx("svg",{className:"w-8 h-8 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),V.jsx("h3",{className:"text-2xl font-bold text-emerald-600 mb-2",children:"!"}),V.jsxs("p",{className:"text-gray-600 mb-6",children:["!  ",V.jsxs("span",{className:"font-bold text-indigo-600",children:[t,""]}),"."]})]}):V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:V.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:V.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),V.jsx("h3",{className:"text-2xl font-bold text-red-600 mb-2",children:""}),V.jsxs("p",{className:"text-gray-600 mb-2",children:[" : ",V.jsxs("span",{className:"font-bold",children:[n,""]})]}),V.jsxs("p",{className:"text-gray-600 mb-6",children:[" ",V.jsxs("span",{className:"font-bold text-indigo-600",children:[t,""]}),"."]})]}),V.jsx("button",{onClick:i,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-xl transition-colors",children:"3D  "})]})}):null,CI=({isOpen:s,onClose:e,baseShareUrl:t})=>{const[n,i]=ve.useState("url"),[o,u]=ve.useState(60),[f,d]=ve.useState(!1),p=o>0?`${t}&timer=${o}`:t,m=async()=>{try{await navigator.clipboard.writeText(p),d(!0),setTimeout(()=>d(!1),2e3)}catch(y){console.error("Failed to copy:",y)}},g=y=>{const _=parseInt(y.target.value,10);!isNaN(_)&&_>=0&&u(_)};return ve.useEffect(()=>{s&&d(!1)},[s]),V.jsx(oE,{isOpen:s,onClose:e,title:" ",children:V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:[V.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[V.jsx(Qw,{size:16,className:"text-amber-600"}),V.jsx("span",{className:"text-sm font-medium text-amber-800",children:"  "})]}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("input",{type:"number",value:o,onChange:g,min:"0",max:"3600",className:"w-24 px-3 py-2 border border-amber-300 rounded-lg text-center font-medium focus:ring-2 focus:ring-amber-500 focus:border-amber-500 outline-none"}),V.jsx("span",{className:"text-sm text-amber-700",children:""}),V.jsx("span",{className:"text-xs text-amber-600 ml-2",children:"(0 =  )"})]})]}),V.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[V.jsxs("button",{onClick:()=>i("url"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${n==="url"?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[V.jsx(iI,{size:16}),"URL "]}),V.jsxs("button",{onClick:()=>i("qr"),className:`flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md text-sm font-medium transition-colors ${n==="qr"?"bg-white text-indigo-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[V.jsx(oI,{size:16}),"QR "]})]}),n==="url"?V.jsxs("div",{className:"space-y-3",children:[V.jsx("p",{className:"text-sm text-gray-600",children:"    ."}),V.jsxs("div",{className:"flex gap-2",children:[V.jsx("input",{type:"text",value:p,readOnly:!0,className:"flex-1 px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm text-gray-600 overflow-hidden text-ellipsis"}),V.jsxs("button",{onClick:m,className:`flex items-center gap-1 px-4 py-2 rounded-lg font-medium transition-colors ${f?"bg-emerald-100 text-emerald-700":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[f?V.jsx(j1,{size:16}):V.jsx(X1,{size:16}),f?"!":""]})]})]}):V.jsxs("div",{className:"space-y-3",children:[V.jsx("p",{className:"text-sm text-gray-600 text-center",children:"QR    ."}),V.jsx("div",{className:"flex justify-center p-4 bg-white border border-gray-200 rounded-lg",children:V.jsx(TI,{value:p,size:200,level:"M",style:{height:"auto",maxWidth:"100%",width:"100%"}})}),V.jsxs("button",{onClick:m,className:`w-full flex items-center justify-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${f?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[f?V.jsx(j1,{size:16}):V.jsx(X1,{size:16}),f?"URL !":"URL "]})]}),V.jsxs("div",{className:"text-xs text-gray-400 text-center space-y-1",children:[V.jsx("p",{children:"  2D   , 3D    ."}),o>0&&V.jsxs("p",{className:"text-amber-600",children:["   ",o," ."]})]})]})})},bI=s=>{try{const e=s.map(i=>({x:i.x,y:i.y,z:i.z,c:i.color||void 0})),t=JSON.stringify(e);return btoa(encodeURIComponent(t))}catch(e){return console.error("Failed to encode voxels:",e),""}},RI=s=>{try{const e=decodeURIComponent(atob(s)),t=JSON.parse(e);return Array.isArray(t)?t.map(n=>({x:n.x,y:n.y,z:n.z,id:`${n.x},${n.y},${n.z}`,color:n.c})):null}catch(e){return console.error("Failed to decode voxels:",e),null}},oS=s=>{const e=bI(s);return`${window.location.origin+window.location.pathname}?puzzle=${e}`},PI=()=>new URLSearchParams(window.location.search).get("puzzle"),LI=()=>{const e=new URLSearchParams(window.location.search).get("timer");if(e){const t=parseInt(e,10);return isNaN(t)?0:Math.max(0,t)}return 0},II=()=>{const s=new URL(window.location.href);s.searchParams.delete("puzzle"),s.searchParams.delete("timer"),window.history.replaceState({},"",s.toString())},NI=()=>{const[s,e]=ve.useState(VE),[t,n]=ve.useState("3d-edit"),[i,o]=ve.useState("build"),[u,f]=ve.useState(!1),[d,p]=ve.useState(!0),[m,g]=ve.useState(Xs.voxelDefault),[y,_]=ve.useState("right"),[M,A]=ve.useState({top:Array(St).fill(Array(St).fill(!1)),front:Array(St).fill(Array(St).fill(!1)),side:Array(St).fill(Array(St).fill(!1))}),[E,S]=ve.useState(!1),[P,b]=ve.useState([]),[L,B]=ve.useState("playing"),[D,F]=ve.useState(0),[j,O]=ve.useState(0),[N,X]=ve.useState(!1),[te,Q]=ve.useState(!1),[ue,fe]=ve.useState(""),ye=ve.useMemo(()=>pI(s),[s]),Me=ve.useMemo(()=>qy(s),[s]),W=ve.useMemo(()=>$w(s),[s]),ee=ve.useMemo(()=>eE(s),[s]),k=ve.useMemo(()=>tE(s),[s]),J=(xe,Fe,$e)=>{if(t==="2d-blueprint"||xe<0||xe>=St||$e<0||$e>=St||Fe<0||Fe>=Or)return;s.some(z=>z.x===xe&&z.y===Fe&&z.z===$e)||e(z=>[...z,{x:xe,y:Fe,z:$e,id:`${xe},${Fe},${$e}`,color:m}])},Ce=xe=>{t!=="2d-blueprint"&&e(Fe=>Fe.filter($e=>$e.id!==xe))},Ve=(xe,Fe,$e)=>{i==="build"&&J(xe,Fe,$e)},se=(xe,Fe,$e)=>{A(q=>{const z=q[xe].map((de,Ie)=>de.map((ze,Ue)=>Ie===Fe&&Ue===$e?!ze:ze));return{...q,[xe]:z}})},Re=()=>{const Fe=q1(M).map($e=>({...$e,color:m}));e(Fe),n("3d-edit")},ke=()=>{e([]),A({top:Array(St).fill(Array(St).fill(!1)),front:Array(St).fill(Array(St).fill(!1)),side:Array(St).fill(Array(St).fill(!1))})};ve.useEffect(()=>{t==="2d-blueprint"&&A(Me)},[t]),ve.useEffect(()=>{const xe=PI();if(xe){const Fe=RI(xe);if(Fe&&Fe.length>0){b(Fe),S(!0),B("playing");const $e=LI();O($e)}}},[]);const Le=xe=>{F(xe);const Fe=P.length;B(xe===Fe?"correct":"incorrect"),X(!0)},tt=()=>{X(!1),B("revealed")},xt=()=>{S(!1),b([]),B("playing"),F(0),II()},ae=()=>{if(s.length===0){alert("  !");return}const xe=oS(s);fe(xe),Q(!0)},Mt=()=>{const xe=oS(P);fe(xe),Q(!0)},Ae=t==="3d-edit"?Me.side:M.side,Oe=y==="left"?Ae.map(xe=>[...xe].reverse()):Ae,De=y==="left"&&t==="3d-edit"?k.map(xe=>[...xe].reverse()):k,Xe=(xe,Fe)=>{const $e=y==="left"?St-1-Fe:Fe;se("side",xe,$e)};return V.jsxs("div",{className:"flex flex-col h-screen w-screen bg-sky-50 overflow-hidden",children:[V.jsxs("header",{className:"bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between shadow-sm z-10",children:[V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("div",{className:"bg-indigo-600 p-2 rounded-lg text-white",children:V.jsx(Zw,{size:20})}),V.jsx("h1",{className:"text-xl font-bold text-gray-800 tracking-tight",children:"Cube Master"})]}),V.jsxs("div",{className:"flex items-center gap-4",children:[V.jsx("div",{className:"text-sm text-gray-500 hidden sm:block",children:"Elementary Geometry Simulator"}),!E&&V.jsxs("button",{onClick:ae,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium text-sm",title:" ",children:[V.jsx(Jw,{size:16}),V.jsx("span",{className:"hidden sm:inline",children:" "})]})]})]}),V.jsxs("main",{className:"flex-1 flex flex-col md:flex-row relative overflow-hidden",children:[E&&L==="playing"&&V.jsx(mI,{voxels:P,onSubmit:Le,timeLimit:j}),E&&L==="revealed"&&V.jsx(gI,{voxels:P,correctAnswer:P.length,userAnswer:D,isCorrect:D===P.length,onNewQuiz:xt,onShare:Mt}),!E&&V.jsxs(V.Fragment,{children:[V.jsx("div",{className:"absolute top-4 left-4 z-20 md:static md:p-4 md:z-auto pointer-events-none md:pointer-events-auto",children:V.jsx("div",{className:"pointer-events-auto w-full max-w-[300px]",children:V.jsx(dI,{tool:i,setTool:o,onClear:ke,mode:t,setMode:n,showXRay:u,setShowXRay:f,showNumbers:d,setShowNumbers:p,selectedColor:m,setSelectedColor:g,onGenerate:Re})})}),V.jsxs("div",{className:"flex-1 relative bg-gradient-to-br from-sky-50 to-indigo-50/50",children:[V.jsx("div",{className:"absolute inset-0",children:V.jsx(qw,{voxels:t==="3d-edit"?s:q1(M),mode:t,onAddVoxel:Ve,onRemoveVoxel:xe=>{i==="erase"&&Ce(xe)},showXRay:u,selectedColor:m})}),V.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white/80 backdrop-blur px-4 py-2 rounded-full text-sm font-medium text-gray-600 shadow-sm pointer-events-none select-none",children:t==="3d-edit"?i==="build"?"Click grid to place  Click block faces to stack  Drag to rotate":"Click blocks to remove  Drag to rotate":"Edit the grids on the right to shape the block"})]}),V.jsxs("div",{className:"hidden md:flex w-72 bg-white border-l border-gray-200 flex-col z-10 shadow-xl",children:[V.jsxs("div",{className:"bg-indigo-50 p-4 border-b border-indigo-100 flex justify-around items-center",children:[V.jsxs("div",{className:"text-center",children:[V.jsx("div",{className:"text-xs text-indigo-400 font-semibold uppercase",children:"Count"}),V.jsxs("div",{className:"text-lg font-bold text-indigo-700 flex items-center gap-1 justify-center",children:[V.jsx(Jv,{size:14})," ",ye.count]})]}),V.jsx("div",{className:"w-px h-8 bg-indigo-200"}),V.jsxs("div",{className:"text-center group relative cursor-help",children:[V.jsx("div",{className:"text-xs text-indigo-400 font-semibold uppercase border-b border-indigo-300 border-dashed inline-block",children:"Area"}),V.jsxs("div",{className:"text-lg font-bold text-indigo-700 flex items-center gap-1 justify-center",children:[V.jsx(Y1,{size:14})," ",ye.surfaceArea]}),V.jsxs("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 bg-gray-700 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-lg",children:["  ",V.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 border-4 border-transparent border-t-gray-700"})]})]})]}),V.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[V.jsx("div",{className:"text-xs font-semibold text-gray-400 uppercase tracking-wider mb-2",children:t==="3d-edit"?"Real-time Projections":"Blueprint Editor"}),V.jsx(ys,{label:"Top View (Above)",data:t==="3d-edit"?Me.top:M.top,editable:t==="2d-blueprint",onToggle:(xe,Fe)=>se("top",xe,Fe),numbers:t==="3d-edit"&&d?W:void 0,xAxisLabel:"X (Right)",yAxisLabel:"Z (Depth)"}),V.jsx(ys,{label:"Front View",data:t==="3d-edit"?Me.front:M.front,editable:t==="2d-blueprint",onToggle:(xe,Fe)=>se("front",xe,Fe),numbers:t==="3d-edit"&&d?ee:void 0,xAxisLabel:"X (Right)",yAxisLabel:"Y (Up)"}),V.jsx(ys,{label:`Side View (${y==="right"?"Right":"Left"})`,data:Oe,editable:t==="2d-blueprint",onToggle:Xe,numbers:t==="3d-edit"&&d?De:void 0,xAxisLabel:y==="right"?"Z (Depth)":"Z (Reversed)",yAxisLabel:"Y (Up)",headerAction:V.jsx("button",{onClick:()=>_(xe=>xe==="right"?"left":"right"),className:"p-1 hover:bg-gray-100 rounded text-indigo-600 transition-colors",title:"Switch Side View (Right/Left)",children:V.jsx(Fm,{size:14})})}),t==="2d-blueprint"&&V.jsx("p",{className:"text-xs text-center text-gray-400 mt-2 italic",children:"Toggle cells to define the shape shadow."})]})]}),V.jsxs("div",{className:"md:hidden bg-white border-t border-gray-200 shadow-lg z-10",children:[V.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-indigo-50 border-b border-indigo-100",children:[V.jsxs("div",{className:"flex items-center gap-4",children:[V.jsxs("div",{className:"flex items-center gap-1 text-sm font-bold text-indigo-700",children:[V.jsx(Jv,{size:14})," ",ye.count]}),V.jsxs("div",{className:"flex items-center gap-1 text-sm font-bold text-indigo-700",children:[V.jsx(Y1,{size:14})," ",ye.surfaceArea]})]}),V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("span",{className:"text-xs text-gray-500",children:t==="3d-edit"?"Projections":"Blueprint"}),V.jsx("button",{onClick:()=>_(xe=>xe==="right"?"left":"right"),className:"p-1 hover:bg-indigo-100 rounded text-indigo-600 transition-colors",title:"Switch Side View",children:V.jsx(Fm,{size:14})})]})]}),V.jsx("div",{className:"overflow-x-auto",children:V.jsxs("div",{className:"flex gap-3 p-3 min-w-max",children:[V.jsx("div",{className:"flex-shrink-0",children:V.jsx(ys,{label:"Top ()",data:t==="3d-edit"?Me.top:M.top,editable:t==="2d-blueprint",onToggle:(xe,Fe)=>se("top",xe,Fe),numbers:t==="3d-edit"&&d?W:void 0})}),V.jsx("div",{className:"flex-shrink-0",children:V.jsx(ys,{label:"Front ()",data:t==="3d-edit"?Me.front:M.front,editable:t==="2d-blueprint",onToggle:(xe,Fe)=>se("front",xe,Fe),numbers:t==="3d-edit"&&d?ee:void 0})}),V.jsx("div",{className:"flex-shrink-0",children:V.jsx(ys,{label:`Side (${y==="right"?"":""})`,data:Oe,editable:t==="2d-blueprint",onToggle:Xe,numbers:t==="3d-edit"&&d?De:void 0})}),t==="2d-blueprint"&&V.jsx("div",{className:"flex-shrink-0 flex items-center px-4",children:V.jsxs("button",{onClick:Re,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-colors flex items-center gap-2 whitespace-nowrap",children:[V.jsx($v,{size:16}),"Generate 3D"]})})]})})]})]}),V.jsx(AI,{isOpen:N,isCorrect:D===P.length,correctAnswer:P.length,userAnswer:D,onReveal:tt,onClose:()=>X(!1)}),V.jsx(CI,{isOpen:te,onClose:()=>Q(!1),baseShareUrl:ue})]})]})},aE=document.getElementById("root");if(!aE)throw new Error("Could not find root element to mount to");const DI=HE.createRoot(aE);DI.render(V.jsx(Pm.StrictMode,{children:V.jsx(NI,{})}));
